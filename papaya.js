/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
 http://mths.be/fromcodepoint v0.1.0 by @mathias */
var $jscomp = $jscomp || {};
$jscomp.scope = {};
$jscomp.arrayIteratorImpl = function (a) {
  var b = 0;
  return function () {
    return b < a.length ? { done: !1, value: a[b++] } : { done: !0 };
  };
};
$jscomp.arrayIterator = function (a) {
  return { next: $jscomp.arrayIteratorImpl(a) };
};
$jscomp.ASSUME_ES5 = !1;
$jscomp.ASSUME_NO_NATIVE_MAP = !1;
$jscomp.ASSUME_NO_NATIVE_SET = !1;
$jscomp.SIMPLE_FROUND_POLYFILL = !1;
$jscomp.ISOLATE_POLYFILLS = !1;
$jscomp.FORCE_POLYFILL_PROMISE = !1;
$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION = !1;
$jscomp.defineProperty =
  $jscomp.ASSUME_ES5 || "function" == typeof Object.defineProperties
    ? Object.defineProperty
    : function (a, b, c) {
        if (a == Array.prototype || a == Object.prototype) return a;
        a[b] = c.value;
        return a;
      };
$jscomp.getGlobal = function (a) {
  a = [
    "object" == typeof globalThis && globalThis,
    a,
    "object" == typeof window && window,
    "object" == typeof self && self,
    "object" == typeof global && global,
  ];
  for (var b = 0; b < a.length; ++b) {
    var c = a[b];
    if (c && c.Math == Math) return c;
  }
  throw Error("Cannot find global object");
};
$jscomp.global = $jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE =
  "function" === typeof Symbol && "symbol" === typeof Symbol("x");
$jscomp.TRUST_ES6_POLYFILLS =
  !$jscomp.ISOLATE_POLYFILLS || $jscomp.IS_SYMBOL_NATIVE;
$jscomp.polyfills = {};
$jscomp.propertyToPolyfillSymbol = {};
$jscomp.POLYFILL_PREFIX = "$jscp$";
var $jscomp$lookupPolyfilledValue = function (a, b) {
  var c = $jscomp.propertyToPolyfillSymbol[b];
  if (null == c) return a[b];
  c = a[c];
  return void 0 !== c ? c : a[b];
};
$jscomp.polyfill = function (a, b, c, e) {
  b &&
    ($jscomp.ISOLATE_POLYFILLS
      ? $jscomp.polyfillIsolated(a, b, c, e)
      : $jscomp.polyfillUnisolated(a, b, c, e));
};
$jscomp.polyfillUnisolated = function (a, b, c, e) {
  c = $jscomp.global;
  a = a.split(".");
  for (e = 0; e < a.length - 1; e++) {
    var d = a[e];
    if (!(d in c)) return;
    c = c[d];
  }
  a = a[a.length - 1];
  e = c[a];
  b = b(e);
  b != e &&
    null != b &&
    $jscomp.defineProperty(c, a, { configurable: !0, writable: !0, value: b });
};
$jscomp.polyfillIsolated = function (a, b, c, e) {
  var d = a.split(".");
  a = 1 === d.length;
  e = d[0];
  e = !a && e in $jscomp.polyfills ? $jscomp.polyfills : $jscomp.global;
  for (var g = 0; g < d.length - 1; g++) {
    var h = d[g];
    if (!(h in e)) return;
    e = e[h];
  }
  d = d[d.length - 1];
  c = $jscomp.IS_SYMBOL_NATIVE && "es6" === c ? e[d] : null;
  b = b(c);
  null != b &&
    (a
      ? $jscomp.defineProperty($jscomp.polyfills, d, {
          configurable: !0,
          writable: !0,
          value: b,
        })
      : b !== c &&
        (void 0 === $jscomp.propertyToPolyfillSymbol[d] &&
          ($jscomp.propertyToPolyfillSymbol[d] = $jscomp.IS_SYMBOL_NATIVE
            ? $jscomp.global.Symbol(d)
            : $jscomp.POLYFILL_PREFIX + d),
        $jscomp.defineProperty(e, $jscomp.propertyToPolyfillSymbol[d], {
          configurable: !0,
          writable: !0,
          value: b,
        })));
};
$jscomp.initSymbol = function () {};
$jscomp.polyfill(
  "Symbol",
  function (a) {
    if (a) return a;
    var b = function (d, g) {
      this.$jscomp$symbol$id_ = d;
      $jscomp.defineProperty(this, "description", {
        configurable: !0,
        writable: !0,
        value: g,
      });
    };
    b.prototype.toString = function () {
      return this.$jscomp$symbol$id_;
    };
    var c = 0,
      e = function (d) {
        if (this instanceof e)
          throw new TypeError("Symbol is not a constructor");
        return new b("jscomp_symbol_" + (d || "") + "_" + c++, d);
      };
    return e;
  },
  "es6",
  "es3"
);
$jscomp.polyfill(
  "Symbol.iterator",
  function (a) {
    if (a) return a;
    a = Symbol("Symbol.iterator");
    for (
      var b =
          "Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(
            " "
          ),
        c = 0;
      c < b.length;
      c++
    ) {
      var e = $jscomp.global[b[c]];
      "function" === typeof e &&
        "function" != typeof e.prototype[a] &&
        $jscomp.defineProperty(e.prototype, a, {
          configurable: !0,
          writable: !0,
          value: function () {
            return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this));
          },
        });
    }
    return a;
  },
  "es6",
  "es3"
);
$jscomp.iteratorPrototype = function (a) {
  a = { next: a };
  a[Symbol.iterator] = function () {
    return this;
  };
  return a;
};
$jscomp.findInternal = function (a, b, c) {
  a instanceof String && (a = String(a));
  for (var e = a.length, d = 0; d < e; d++) {
    var g = a[d];
    if (b.call(c, g, d, a)) return { i: d, v: g };
  }
  return { i: -1, v: void 0 };
};
$jscomp.polyfill(
  "Array.prototype.find",
  function (a) {
    return a
      ? a
      : function (b, c) {
          return $jscomp.findInternal(this, b, c).v;
        };
  },
  "es6",
  "es3"
);
$jscomp.iteratorFromArray = function (a, b) {
  a instanceof String && (a += "");
  var c = 0,
    e = !1,
    d = {
      next: function () {
        if (!e && c < a.length) {
          var g = c++;
          return { value: b(g, a[g]), done: !1 };
        }
        e = !0;
        return { done: !0, value: void 0 };
      },
    };
  d[Symbol.iterator] = function () {
    return d;
  };
  return d;
};
$jscomp.polyfill(
  "Array.prototype.keys",
  function (a) {
    return a
      ? a
      : function () {
          return $jscomp.iteratorFromArray(this, function (b) {
            return b;
          });
        };
  },
  "es6",
  "es3"
);
$jscomp.polyfill(
  "String.fromCodePoint",
  function (a) {
    return a
      ? a
      : function (b) {
          for (var c = "", e = 0; e < arguments.length; e++) {
            var d = Number(arguments[e]);
            if (0 > d || 1114111 < d || d !== Math.floor(d))
              throw new RangeError("invalid_code_point " + d);
            65535 >= d
              ? (c += String.fromCharCode(d))
              : ((d -= 65536),
                (c += String.fromCharCode(((d >>> 10) & 1023) | 55296)),
                (c += String.fromCharCode((d & 1023) | 56320)));
          }
          return c;
        };
  },
  "es6",
  "es3"
);
$jscomp.polyfill(
  "Array.prototype.fill",
  function (a) {
    return a
      ? a
      : function (b, c, e) {
          var d = this.length || 0;
          0 > c && (c = Math.max(0, d + c));
          if (null == e || e > d) e = d;
          e = Number(e);
          0 > e && (e = Math.max(0, d + e));
          for (c = Number(c || 0); c < e; c++) this[c] = b;
          return this;
        };
  },
  "es6",
  "es3"
);
$jscomp.typedArrayFill = function (a) {
  return a ? a : Array.prototype.fill;
};
$jscomp.polyfill(
  "Int8Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Uint8Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Uint8ClampedArray.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Int16Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Uint16Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Int32Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Uint32Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Float32Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Float64Array.prototype.fill",
  $jscomp.typedArrayFill,
  "es6",
  "es5"
);
$jscomp.polyfill(
  "Number.EPSILON",
  function (a) {
    return Math.pow(2, -52);
  },
  "es6",
  "es3"
);
$jscomp.checkStringArgs = function (a, b, c) {
  if (null == a)
    throw new TypeError(
      "The 'this' value for String.prototype." +
        c +
        " must not be null or undefined"
    );
  if (b instanceof RegExp)
    throw new TypeError(
      "First argument to String.prototype." +
        c +
        " must not be a regular expression"
    );
  return a + "";
};
$jscomp.polyfill(
  "String.prototype.endsWith",
  function (a) {
    return a
      ? a
      : function (b, c) {
          var e = $jscomp.checkStringArgs(this, b, "endsWith");
          b += "";
          void 0 === c && (c = e.length);
          c = Math.max(0, Math.min(c | 0, e.length));
          for (var d = b.length; 0 < d && 0 < c; )
            if (e[--c] != b[--d]) return !1;
          return 0 >= d;
        };
  },
  "es6",
  "es3"
);
$jscomp.polyfill(
  "String.prototype.startsWith",
  function (a) {
    return a
      ? a
      : function (b, c) {
          var e = $jscomp.checkStringArgs(this, b, "startsWith");
          b += "";
          var d = e.length,
            g = b.length;
          c = Math.max(0, Math.min(c | 0, e.length));
          for (var h = 0; h < g && c < d; ) if (e[c++] != b[h++]) return !1;
          return h >= g;
        };
  },
  "es6",
  "es3"
);
PAPAYA_BUILD_NUM = "1455";
var papayaLoadableImages = [];
(function (a, b) {
  function c(f) {
    var l = f.length,
      x = v.type(f);
    return v.isWindow(f)
      ? !1
      : 1 === f.nodeType && l
      ? !0
      : "array" === x ||
        ("function" !== x &&
          (0 === l || ("number" === typeof l && 0 < l && l - 1 in f)));
  }
  function e(f) {
    var l = (jc[f] = {});
    v.each(f.match(mb) || [], function (x, E) {
      l[E] = !0;
    });
    return l;
  }
  function d(f, l, x, E) {
    if (v.acceptData(f)) {
      var J = v.expando,
        M = "string" === typeof l,
        Y = f.nodeType,
        da = Y ? v.cache : f,
        ia = Y ? f[J] : f[J] && J;
      if ((ia && da[ia] && (E || da[ia].data)) || !M || x !== b) {
        ia || (Y ? (f[J] = ia = ya.pop() || v.guid++) : (ia = J));
        da[ia] || ((da[ia] = {}), Y || (da[ia].toJSON = v.noop));
        if ("object" === typeof l || "function" === typeof l)
          E
            ? (da[ia] = v.extend(da[ia], l))
            : (da[ia].data = v.extend(da[ia].data, l));
        f = da[ia];
        E || (f.data || (f.data = {}), (f = f.data));
        x !== b && (f[v.camelCase(l)] = x);
        M ? ((x = f[l]), null == x && (x = f[v.camelCase(l)])) : (x = f);
        return x;
      }
    }
  }
  function g(f, l, x) {
    if (v.acceptData(f)) {
      var E,
        J,
        M = f.nodeType,
        Y = M ? v.cache : f,
        da = M ? f[v.expando] : v.expando;
      if (Y[da]) {
        if (l && (J = x ? Y[da] : Y[da].data)) {
          v.isArray(l)
            ? (l = l.concat(v.map(l, v.camelCase)))
            : l in J
            ? (l = [l])
            : ((l = v.camelCase(l)), (l = l in J ? [l] : l.split(" ")));
          var ia = 0;
          for (E = l.length; ia < E; ia++) delete J[l[ia]];
          if (!(x ? n : v.isEmptyObject)(J)) return;
        }
        if (!x && (delete Y[da].data, !n(Y[da]))) return;
        M
          ? v.cleanData([f], !0)
          : v.support.deleteExpando || Y != Y.window
          ? delete Y[da]
          : (Y[da] = null);
      }
    }
  }
  function h(f, l, x) {
    if (x === b && 1 === f.nodeType)
      if (
        ((x = "data-" + l.replace(Kc, "-$1").toLowerCase()),
        (x = f.getAttribute(x)),
        "string" === typeof x)
      ) {
        try {
          x =
            "true" === x
              ? !0
              : "false" === x
              ? !1
              : "null" === x
              ? null
              : +x + "" === x
              ? +x
              : Lc.test(x)
              ? v.parseJSON(x)
              : x;
        } catch (E) {}
        v.data(f, l, x);
      } else x = b;
    return x;
  }
  function n(f) {
    for (var l in f)
      if (("data" !== l || !v.isEmptyObject(f[l])) && "toJSON" !== l) return !1;
    return !0;
  }
  function q() {
    return !0;
  }
  function t() {
    return !1;
  }
  function u(f, l) {
    do f = f[l];
    while (f && 1 !== f.nodeType);
    return f;
  }
  function A(f, l, x) {
    l = l || 0;
    if (v.isFunction(l))
      return v.grep(f, function (J, M) {
        return !!l.call(J, M, J) === x;
      });
    if (l.nodeType)
      return v.grep(f, function (J) {
        return (J === l) === x;
      });
    if ("string" === typeof l) {
      var E = v.grep(f, function (J) {
        return 1 === J.nodeType;
      });
      if (Mc.test(l)) return v.filter(l, E, !x);
      l = v.filter(l, E);
    }
    return v.grep(f, function (J) {
      return 0 <= v.inArray(J, l) === x;
    });
  }
  function G(f) {
    var l = kc.split("|");
    f = f.createDocumentFragment();
    if (f.createElement) for (; l.length; ) f.createElement(l.pop());
    return f;
  }
  function O(f, l) {
    return (
      f.getElementsByTagName(l)[0] ||
      f.appendChild(f.ownerDocument.createElement(l))
    );
  }
  function H(f) {
    var l = f.getAttributeNode("type");
    f.type = (l && l.specified) + "/" + f.type;
    return f;
  }
  function P(f) {
    var l = Nc.exec(f.type);
    l ? (f.type = l[1]) : f.removeAttribute("type");
    return f;
  }
  function U(f, l) {
    for (var x, E = 0; null != (x = f[E]); E++)
      v._data(x, "globalEval", !l || v._data(l[E], "globalEval"));
  }
  function ha(f, l) {
    if (1 === l.nodeType && v.hasData(f)) {
      var x, E;
      var J = v._data(f);
      f = v._data(l, J);
      var M = J.events;
      if (M)
        for (x in (delete f.handle, (f.events = {}), M))
          for (J = 0, E = M[x].length; J < E; J++) v.event.add(l, x, M[x][J]);
      f.data && (f.data = v.extend({}, f.data));
    }
  }
  function w(f, l) {
    var x,
      E,
      J = 0,
      M =
        typeof f.getElementsByTagName !== ma
          ? f.getElementsByTagName(l || "*")
          : typeof f.querySelectorAll !== ma
          ? f.querySelectorAll(l || "*")
          : b;
    if (!M)
      for (M = [], x = f.childNodes || f; null != (E = x[J]); J++)
        !l || v.nodeName(E, l) ? M.push(E) : v.merge(M, w(E, l));
    return l === b || (l && v.nodeName(f, l)) ? v.merge([f], M) : M;
  }
  function I(f) {
    Rb.test(f.type) && (f.defaultChecked = f.checked);
  }
  function aa(f, l) {
    if (l in f) return l;
    for (
      var x = l.charAt(0).toUpperCase() + l.slice(1), E = l, J = lc.length;
      J--;

    )
      if (((l = lc[J] + x), l in f)) return l;
    return E;
  }
  function T(f, l) {
    f = l || f;
    return "none" === v.css(f, "display") || !v.contains(f.ownerDocument, f);
  }
  function ka(f, l) {
    for (var x, E, J, M = [], Y = 0, da = f.length; Y < da; Y++)
      (E = f[Y]),
        E.style &&
          ((M[Y] = v._data(E, "olddisplay")),
          (x = E.style.display),
          l
            ? (M[Y] || "none" !== x || (E.style.display = ""),
              "" === E.style.display &&
                T(E) &&
                (M[Y] = v._data(E, "olddisplay", p(E.nodeName))))
            : M[Y] ||
              ((J = T(E)),
              ((x && "none" !== x) || !J) &&
                v._data(E, "olddisplay", J ? x : v.css(E, "display"))));
    for (Y = 0; Y < da; Y++)
      (E = f[Y]),
        !E.style ||
          (l && "none" !== E.style.display && "" !== E.style.display) ||
          (E.style.display = l ? M[Y] || "" : "none");
    return f;
  }
  function k(f, l, x) {
    return (f = Oc.exec(l)) ? Math.max(0, f[1] - (x || 0)) + (f[2] || "px") : l;
  }
  function X(f, l, x, E, J) {
    l = x === (E ? "border" : "content") ? 4 : "width" === l ? 1 : 0;
    for (var M = 0; 4 > l; l += 2)
      "margin" === x && (M += v.css(f, x + qb[l], !0, J)),
        E
          ? ("content" === x && (M -= v.css(f, "padding" + qb[l], !0, J)),
            "margin" !== x &&
              (M -= v.css(f, "border" + qb[l] + "Width", !0, J)))
          : ((M += v.css(f, "padding" + qb[l], !0, J)),
            "padding" !== x &&
              (M += v.css(f, "border" + qb[l] + "Width", !0, J)));
    return M;
  }
  function V(f, l, x) {
    var E = !0,
      J = "width" === l ? f.offsetWidth : f.offsetHeight,
      M = wb(f),
      Y = v.support.boxSizing && "border-box" === v.css(f, "boxSizing", !1, M);
    if (0 >= J || null == J) {
      J = xb(f, l, M);
      if (0 > J || null == J) J = f.style[l];
      if (Jb.test(J)) return J;
      E = Y && (v.support.boxSizingReliable || J === f.style[l]);
      J = parseFloat(J) || 0;
    }
    return J + X(f, l, x || (Y ? "border" : "content"), E, M) + "px";
  }
  function p(f) {
    var l = Q,
      x = mc[f];
    x ||
      ((x = m(f, l)),
      ("none" !== x && x) ||
        ((Db = (
          Db ||
          v("<iframe frameborder='0' width='0' height='0'/>").css(
            "cssText",
            "display:block !important"
          )
        ).appendTo(l.documentElement)),
        (l = (Db[0].contentWindow || Db[0].contentDocument).document),
        l.write("<!doctype html><html><body>"),
        l.close(),
        (x = m(f, l)),
        Db.detach()),
      (mc[f] = x));
    return x;
  }
  function m(f, l) {
    f = v(l.createElement(f)).appendTo(l.body);
    l = v.css(f[0], "display");
    f.remove();
    return l;
  }
  function F(f, l, x, E) {
    var J;
    if (v.isArray(l))
      v.each(l, function (M, Y) {
        x || Pc.test(f)
          ? E(f, Y)
          : F(f + "[" + ("object" === typeof Y ? M : "") + "]", Y, x, E);
      });
    else if (x || "object" !== v.type(l)) E(f, l);
    else for (J in l) F(f + "[" + J + "]", l[J], x, E);
  }
  function r(f) {
    return function (l, x) {
      "string" !== typeof l && ((x = l), (l = "*"));
      var E = 0,
        J = l.toLowerCase().match(mb) || [];
      if (v.isFunction(x))
        for (; (l = J[E++]); )
          "+" === l[0]
            ? ((l = l.slice(1) || "*"), (f[l] = f[l] || []).unshift(x))
            : (f[l] = f[l] || []).push(x);
    };
  }
  function y(f, l, x, E) {
    function J(da) {
      var ia;
      M[da] = !0;
      v.each(f[da] || [], function (ja, pa) {
        ja = pa(l, x, E);
        if ("string" === typeof ja && !Y && !M[ja])
          return l.dataTypes.unshift(ja), J(ja), !1;
        if (Y) return !(ia = ja);
      });
      return ia;
    }
    var M = {},
      Y = f === Sb;
    return J(l.dataTypes[0]) || (!M["*"] && J("*"));
  }
  function D(f, l) {
    var x,
      E,
      J = v.ajaxSettings.flatOptions || {};
    for (E in l) l[E] !== b && ((J[E] ? f : x || (x = {}))[E] = l[E]);
    x && v.extend(!0, f, x);
    return f;
  }
  function B() {
    try {
      return new a.XMLHttpRequest();
    } catch (f) {}
  }
  function C() {
    setTimeout(function () {
      yb = b;
    });
    return (yb = v.now());
  }
  function L(f, l) {
    v.each(l, function (x, E) {
      for (
        var J = (Eb[x] || []).concat(Eb["*"]), M = 0, Y = J.length;
        M < Y && !J[M].call(f, x, E);
        M++
      );
    });
  }
  function N(f, l, x) {
    var E,
      J = 0,
      M = Kb.length,
      Y = v.Deferred().always(function () {
        delete da.elem;
      }),
      da = function () {
        if (E) return !1;
        var ja = yb || C();
        ja = Math.max(0, ia.startTime + ia.duration - ja);
        for (
          var pa = 1 - (ja / ia.duration || 0), na = 0, ra = ia.tweens.length;
          na < ra;
          na++
        )
          ia.tweens[na].run(pa);
        Y.notifyWith(f, [ia, pa, ja]);
        if (1 > pa && ra) return ja;
        Y.resolveWith(f, [ia]);
        return !1;
      },
      ia = Y.promise({
        elem: f,
        props: v.extend({}, l),
        opts: v.extend(!0, { specialEasing: {} }, x),
        originalProperties: l,
        originalOptions: x,
        startTime: yb || C(),
        duration: x.duration,
        tweens: [],
        createTween: function (ja, pa) {
          ja = v.Tween(
            f,
            ia.opts,
            ja,
            pa,
            ia.opts.specialEasing[ja] || ia.opts.easing
          );
          ia.tweens.push(ja);
          return ja;
        },
        stop: function (ja) {
          var pa = 0,
            na = ja ? ia.tweens.length : 0;
          if (E) return this;
          for (E = !0; pa < na; pa++) ia.tweens[pa].run(1);
          ja ? Y.resolveWith(f, [ia, ja]) : Y.rejectWith(f, [ia, ja]);
          return this;
        },
      });
    x = ia.props;
    for (K(x, ia.opts.specialEasing); J < M; J++)
      if ((l = Kb[J].call(ia, f, x, ia.opts))) return l;
    L(ia, x);
    v.isFunction(ia.opts.start) && ia.opts.start.call(f, ia);
    v.fx.timer(v.extend(da, { elem: f, anim: ia, queue: ia.opts.queue }));
    return ia
      .progress(ia.opts.progress)
      .done(ia.opts.done, ia.opts.complete)
      .fail(ia.opts.fail)
      .always(ia.opts.always);
  }
  function K(f, l) {
    var x, E;
    for (x in f) {
      var J = v.camelCase(x);
      var M = l[J];
      var Y = f[x];
      v.isArray(Y) && ((M = Y[1]), (Y = f[x] = Y[0]));
      x !== J && ((f[J] = Y), delete f[x]);
      if ((E = v.cssHooks[J]) && "expand" in E)
        for (x in ((Y = E.expand(Y)), delete f[J], Y))
          x in f || ((f[x] = Y[x]), (l[x] = M));
      else l[J] = M;
    }
  }
  function z(f, l, x, E, J) {
    return new z.prototype.init(f, l, x, E, J);
  }
  function R(f, l) {
    var x = { height: f },
      E = 0;
    for (l = l ? 1 : 0; 4 > E; E += 2 - l) {
      var J = qb[E];
      x["margin" + J] = x["padding" + J] = f;
    }
    l && (x.opacity = x.width = f);
    return x;
  }
  function ba(f) {
    return v.isWindow(f)
      ? f
      : 9 === f.nodeType
      ? f.defaultView || f.parentWindow
      : !1;
  }
  var S,
    ma = typeof b,
    Q = a.document,
    ea = a.location,
    ca = a.jQuery,
    qa = a.$,
    wa = {},
    ya = [],
    ua = ya.concat,
    Ja = ya.push,
    Ha = ya.slice,
    cb = ya.indexOf,
    kb = wa.toString,
    Fb = wa.hasOwnProperty,
    Tb = "1.9.1".trim,
    v = function (f, l) {
      return new v.fn.init(f, l, Qc);
    },
    Lb = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
    mb = /\S+/g,
    Rc = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
    Sc = /^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,
    nc = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
    Tc = /^[\],:{}\s]*$/,
    Uc = /(?:^|:|,)(?:\s*\[)+/g,
    Vc = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,
    Wc = /"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,
    Xc = /^-ms-/,
    Yc = /-([\da-z])/gi,
    Zc = function (f, l) {
      return l.toUpperCase();
    },
    nb = function (f) {
      if (
        Q.addEventListener ||
        "load" === f.type ||
        "complete" === Q.readyState
      )
        oc(), v.ready();
    },
    oc = function () {
      Q.addEventListener
        ? (Q.removeEventListener("DOMContentLoaded", nb, !1),
          a.removeEventListener("load", nb, !1))
        : (Q.detachEvent("onreadystatechange", nb),
          a.detachEvent("onload", nb));
    };
  v.fn = v.prototype = {
    jquery: "1.9.1",
    constructor: v,
    init: function (f, l, x) {
      if (!f) return this;
      if ("string" === typeof f) {
        var E =
          "<" === f.charAt(0) && ">" === f.charAt(f.length - 1) && 3 <= f.length
            ? [null, f, null]
            : Sc.exec(f);
        if (!E || (!E[1] && l))
          return !l || l.jquery
            ? (l || x).find(f)
            : this.constructor(l).find(f);
        if (E[1]) {
          if (
            ((l = l instanceof v ? l[0] : l),
            v.merge(
              this,
              v.parseHTML(E[1], l && l.nodeType ? l.ownerDocument || l : Q, !0)
            ),
            nc.test(E[1]) && v.isPlainObject(l))
          )
            for (E in l)
              if (v.isFunction(this[E])) this[E](l[E]);
              else this.attr(E, l[E]);
        } else {
          if ((l = Q.getElementById(E[2])) && l.parentNode) {
            if (l.id !== E[2]) return x.find(f);
            this.length = 1;
            this[0] = l;
          }
          this.context = Q;
          this.selector = f;
        }
        return this;
      }
      if (f.nodeType)
        return (this.context = this[0] = f), (this.length = 1), this;
      if (v.isFunction(f)) return x.ready(f);
      f.selector !== b &&
        ((this.selector = f.selector), (this.context = f.context));
      return v.makeArray(f, this);
    },
    selector: "",
    length: 0,
    size: function () {
      return this.length;
    },
    toArray: function () {
      return Ha.call(this);
    },
    get: function (f) {
      return null == f
        ? this.toArray()
        : 0 > f
        ? this[this.length + f]
        : this[f];
    },
    pushStack: function (f) {
      f = v.merge(this.constructor(), f);
      f.prevObject = this;
      f.context = this.context;
      return f;
    },
    each: function (f, l) {
      return v.each(this, f, l);
    },
    ready: function (f) {
      v.ready.promise().done(f);
      return this;
    },
    slice: function () {
      return this.pushStack(Ha.apply(this, arguments));
    },
    first: function () {
      return this.eq(0);
    },
    last: function () {
      return this.eq(-1);
    },
    eq: function (f) {
      var l = this.length;
      f = +f + (0 > f ? l : 0);
      return this.pushStack(0 <= f && f < l ? [this[f]] : []);
    },
    map: function (f) {
      return this.pushStack(
        v.map(this, function (l, x) {
          return f.call(l, x, l);
        })
      );
    },
    end: function () {
      return this.prevObject || this.constructor(null);
    },
    push: Ja,
    sort: [].sort,
    splice: [].splice,
  };
  v.fn.init.prototype = v.fn;
  v.extend = v.fn.extend = function () {
    var f,
      l,
      x,
      E = arguments[0] || {},
      J = 1,
      M = arguments.length,
      Y = !1;
    "boolean" === typeof E && ((Y = E), (E = arguments[1] || {}), (J = 2));
    "object" === typeof E || v.isFunction(E) || (E = {});
    M === J && ((E = this), --J);
    for (; J < M; J++)
      if (null != (x = arguments[J]))
        for (l in x) {
          var da = E[l];
          var ia = x[l];
          E !== ia &&
            (Y && ia && (v.isPlainObject(ia) || (f = v.isArray(ia)))
              ? (f
                  ? ((f = !1), (da = da && v.isArray(da) ? da : []))
                  : (da = da && v.isPlainObject(da) ? da : {}),
                (E[l] = v.extend(Y, da, ia)))
              : ia !== b && (E[l] = ia));
        }
    return E;
  };
  v.extend({
    noConflict: function (f) {
      a.$ === v && (a.$ = qa);
      f && a.jQuery === v && (a.jQuery = ca);
      return v;
    },
    isReady: !1,
    readyWait: 1,
    holdReady: function (f) {
      f ? v.readyWait++ : v.ready(!0);
    },
    ready: function (f) {
      if (!0 === f ? !--v.readyWait : !v.isReady) {
        if (!Q.body) return setTimeout(v.ready);
        v.isReady = !0;
        (!0 !== f && 0 < --v.readyWait) ||
          (S.resolveWith(Q, [v]),
          v.fn.trigger && v(Q).trigger("ready").off("ready"));
      }
    },
    isFunction: function (f) {
      return "function" === v.type(f);
    },
    isArray:
      Array.isArray ||
      function (f) {
        return "array" === v.type(f);
      },
    isWindow: function (f) {
      return null != f && f == f.window;
    },
    isNumeric: function (f) {
      return !isNaN(parseFloat(f)) && isFinite(f);
    },
    type: function (f) {
      return null == f
        ? String(f)
        : "object" === typeof f || "function" === typeof f
        ? wa[kb.call(f)] || "object"
        : typeof f;
    },
    isPlainObject: function (f) {
      if (!f || "object" !== v.type(f) || f.nodeType || v.isWindow(f))
        return !1;
      try {
        if (
          f.constructor &&
          !Fb.call(f, "constructor") &&
          !Fb.call(f.constructor.prototype, "isPrototypeOf")
        )
          return !1;
      } catch (x) {
        return !1;
      }
      for (var l in f);
      return l === b || Fb.call(f, l);
    },
    isEmptyObject: function (f) {
      for (var l in f) return !1;
      return !0;
    },
    error: function (f) {
      throw Error(f);
    },
    parseHTML: function (f, l, x) {
      if (!f || "string" !== typeof f) return null;
      "boolean" === typeof l && ((x = l), (l = !1));
      l = l || Q;
      var E = nc.exec(f);
      x = !x && [];
      if (E) return [l.createElement(E[1])];
      E = v.buildFragment([f], l, x);
      x && v(x).remove();
      return v.merge([], E.childNodes);
    },
    parseJSON: function (f) {
      if (a.JSON && a.JSON.parse) return a.JSON.parse(f);
      if (null === f) return f;
      if (
        "string" === typeof f &&
        (f = v.trim(f)) &&
        Tc.test(f.replace(Vc, "@").replace(Wc, "]").replace(Uc, ""))
      )
        return new Function("return " + f)();
      v.error("Invalid JSON: " + f);
    },
    parseXML: function (f) {
      if (!f || "string" !== typeof f) return null;
      try {
        if (a.DOMParser) {
          var l = new DOMParser();
          var x = l.parseFromString(f, "text/xml");
        } else
          (x = new ActiveXObject("Microsoft.XMLDOM")),
            (x.async = "false"),
            x.loadXML(f);
      } catch (E) {
        x = b;
      }
      (x &&
        x.documentElement &&
        !x.getElementsByTagName("parsererror").length) ||
        v.error("Invalid XML: " + f);
      return x;
    },
    noop: function () {},
    globalEval: function (f) {
      f &&
        v.trim(f) &&
        (
          a.execScript ||
          function (l) {
            a.eval.call(a, l);
          }
        )(f);
    },
    camelCase: function (f) {
      return f.replace(Xc, "ms-").replace(Yc, Zc);
    },
    nodeName: function (f, l) {
      return f.nodeName && f.nodeName.toLowerCase() === l.toLowerCase();
    },
    each: function (f, l, x) {
      var E = 0,
        J = f.length;
      var M = c(f);
      if (x)
        if (M) for (; E < J && ((M = l.apply(f[E], x)), !1 !== M); E++);
        else
          for (E in f) {
            if (((M = l.apply(f[E], x)), !1 === M)) break;
          }
      else if (M) for (; E < J && ((M = l.call(f[E], E, f[E])), !1 !== M); E++);
      else for (E in f) if (((M = l.call(f[E], E, f[E])), !1 === M)) break;
      return f;
    },
    trim:
      Tb && !Tb.call("\ufeff\u00a0")
        ? function (f) {
            return null == f ? "" : Tb.call(f);
          }
        : function (f) {
            return null == f ? "" : (f + "").replace(Rc, "");
          },
    makeArray: function (f, l) {
      l = l || [];
      null != f &&
        (c(Object(f))
          ? v.merge(l, "string" === typeof f ? [f] : f)
          : Ja.call(l, f));
      return l;
    },
    inArray: function (f, l, x) {
      if (l) {
        if (cb) return cb.call(l, f, x);
        var E = l.length;
        for (x = x ? (0 > x ? Math.max(0, E + x) : x) : 0; x < E; x++)
          if (x in l && l[x] === f) return x;
      }
      return -1;
    },
    merge: function (f, l) {
      var x = l.length,
        E = f.length,
        J = 0;
      if ("number" === typeof x) for (; J < x; J++) f[E++] = l[J];
      else for (; l[J] !== b; ) f[E++] = l[J++];
      f.length = E;
      return f;
    },
    grep: function (f, l, x) {
      var E = [],
        J = 0,
        M = f.length;
      for (x = !!x; J < M; J++) {
        var Y = !!l(f[J], J);
        x !== Y && E.push(f[J]);
      }
      return E;
    },
    map: function (f, l, x) {
      var E = 0,
        J = f.length,
        M = [];
      if (c(f))
        for (; E < J; E++) {
          var Y = l(f[E], E, x);
          null != Y && (M[M.length] = Y);
        }
      else for (E in f) (Y = l(f[E], E, x)), null != Y && (M[M.length] = Y);
      return ua.apply([], M);
    },
    guid: 1,
    proxy: function (f, l) {
      if ("string" === typeof l) {
        var x = f[l];
        l = f;
        f = x;
      }
      if (!v.isFunction(f)) return b;
      var E = Ha.call(arguments, 2);
      x = function () {
        return f.apply(l || this, E.concat(Ha.call(arguments)));
      };
      x.guid = f.guid = f.guid || v.guid++;
      return x;
    },
    access: function (f, l, x, E, J, M, Y) {
      var da = 0,
        ia = f.length,
        ja = null == x;
      if ("object" === v.type(x))
        for (da in ((J = !0), x)) v.access(f, l, da, x[da], !0, M, Y);
      else if (
        E !== b &&
        ((J = !0),
        v.isFunction(E) || (Y = !0),
        ja &&
          (Y
            ? (l.call(f, E), (l = null))
            : ((ja = l),
              (l = function (pa, na, ra) {
                return ja.call(v(pa), ra);
              }))),
        l)
      )
        for (; da < ia; da++)
          l(f[da], x, Y ? E : E.call(f[da], da, l(f[da], x)));
      return J ? f : ja ? l.call(f) : ia ? l(f[0], x) : M;
    },
    now: function () {
      return new Date().getTime();
    },
  });
  v.ready.promise = function (f) {
    if (!S)
      if (((S = v.Deferred()), "complete" === Q.readyState))
        setTimeout(v.ready);
      else if (Q.addEventListener)
        Q.addEventListener("DOMContentLoaded", nb, !1),
          a.addEventListener("load", nb, !1);
      else {
        Q.attachEvent("onreadystatechange", nb);
        a.attachEvent("onload", nb);
        var l = !1;
        try {
          l = null == a.frameElement && Q.documentElement;
        } catch (x) {}
        l &&
          l.doScroll &&
          (function E() {
            if (!v.isReady) {
              try {
                l.doScroll("left");
              } catch (J) {
                return setTimeout(E, 50);
              }
              oc();
              v.ready();
            }
          })();
      }
    return S.promise(f);
  };
  v.each(
    "Boolean Number String Function Array Date RegExp Object Error".split(" "),
    function (f, l) {
      wa["[object " + l + "]"] = l.toLowerCase();
    }
  );
  var Qc = v(Q);
  var jc = {};
  v.Callbacks = function (f) {
    f = "string" === typeof f ? jc[f] || e(f) : v.extend({}, f);
    var l,
      x,
      E,
      J,
      M,
      Y,
      da = [],
      ia = !f.once && [],
      ja = function (na) {
        x = f.memory && na;
        E = !0;
        M = Y || 0;
        Y = 0;
        J = da.length;
        for (l = !0; da && M < J; M++)
          if (!1 === da[M].apply(na[0], na[1]) && f.stopOnFalse) {
            x = !1;
            break;
          }
        l = !1;
        da && (ia ? ia.length && ja(ia.shift()) : x ? (da = []) : pa.disable());
      },
      pa = {
        add: function () {
          if (da) {
            var na = da.length;
            (function Na(Ba) {
              v.each(Ba, function (Ya, Ra) {
                Ya = v.type(Ra);
                "function" === Ya
                  ? (f.unique && pa.has(Ra)) || da.push(Ra)
                  : Ra && Ra.length && "string" !== Ya && Na(Ra);
              });
            })(arguments);
            l ? (J = da.length) : x && ((Y = na), ja(x));
          }
          return this;
        },
        remove: function () {
          da &&
            v.each(arguments, function (na, ra) {
              for (var Ba; -1 < (Ba = v.inArray(ra, da, Ba)); )
                da.splice(Ba, 1), l && (Ba <= J && J--, Ba <= M && M--);
            });
          return this;
        },
        has: function (na) {
          return na ? -1 < v.inArray(na, da) : !(!da || !da.length);
        },
        empty: function () {
          da = [];
          return this;
        },
        disable: function () {
          da = ia = x = b;
          return this;
        },
        disabled: function () {
          return !da;
        },
        lock: function () {
          ia = b;
          x || pa.disable();
          return this;
        },
        locked: function () {
          return !ia;
        },
        fireWith: function (na, ra) {
          ra = ra || [];
          ra = [na, ra.slice ? ra.slice() : ra];
          !da || (E && !ia) || (l ? ia.push(ra) : ja(ra));
          return this;
        },
        fire: function () {
          pa.fireWith(this, arguments);
          return this;
        },
        fired: function () {
          return !!E;
        },
      };
    return pa;
  };
  v.extend({
    Deferred: function (f) {
      var l = [
          ["resolve", "done", v.Callbacks("once memory"), "resolved"],
          ["reject", "fail", v.Callbacks("once memory"), "rejected"],
          ["notify", "progress", v.Callbacks("memory")],
        ],
        x = "pending",
        E = {
          state: function () {
            return x;
          },
          always: function () {
            J.done(arguments).fail(arguments);
            return this;
          },
          then: function () {
            var M = arguments;
            return v
              .Deferred(function (Y) {
                v.each(l, function (da, ia) {
                  var ja = ia[0],
                    pa = v.isFunction(M[da]) && M[da];
                  J[ia[1]](function () {
                    var na = pa && pa.apply(this, arguments);
                    if (na && v.isFunction(na.promise))
                      na.promise()
                        .done(Y.resolve)
                        .fail(Y.reject)
                        .progress(Y.notify);
                    else
                      Y[ja + "With"](
                        this === E ? Y.promise() : this,
                        pa ? [na] : arguments
                      );
                  });
                });
                M = null;
              })
              .promise();
          },
          promise: function (M) {
            return null != M ? v.extend(M, E) : E;
          },
        },
        J = {};
      E.pipe = E.then;
      v.each(l, function (M, Y) {
        var da = Y[2],
          ia = Y[3];
        E[Y[1]] = da.add;
        ia &&
          da.add(
            function () {
              x = ia;
            },
            l[M ^ 1][2].disable,
            l[2][2].lock
          );
        J[Y[0]] = function () {
          J[Y[0] + "With"](this === J ? E : this, arguments);
          return this;
        };
        J[Y[0] + "With"] = da.fireWith;
      });
      E.promise(J);
      f && f.call(J, J);
      return J;
    },
    when: function (f) {
      var l = 0,
        x = Ha.call(arguments),
        E = x.length,
        J = 1 !== E || (f && v.isFunction(f.promise)) ? E : 0,
        M = 1 === J ? f : v.Deferred(),
        Y = function (pa, na, ra) {
          return function (Ba) {
            na[pa] = this;
            ra[pa] = 1 < arguments.length ? Ha.call(arguments) : Ba;
            ra === ia ? M.notifyWith(na, ra) : --J || M.resolveWith(na, ra);
          };
        },
        da;
      if (1 < E) {
        var ia = Array(E);
        var ja = Array(E);
        for (da = Array(E); l < E; l++)
          x[l] && v.isFunction(x[l].promise)
            ? x[l]
                .promise()
                .done(Y(l, da, x))
                .fail(M.reject)
                .progress(Y(l, ja, ia))
            : --J;
      }
      J || M.resolveWith(da, x);
      return M.promise();
    },
  });
  v.support = (function () {
    var f,
      l,
      x = Q.createElement("div");
    x.setAttribute("className", "t");
    x.innerHTML =
      "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
    var E = x.getElementsByTagName("*");
    var J = x.getElementsByTagName("a")[0];
    if (!E || !J || !E.length) return {};
    var M = Q.createElement("select");
    var Y = M.appendChild(Q.createElement("option"));
    E = x.getElementsByTagName("input")[0];
    J.style.cssText = "top:1px;float:left;opacity:.5";
    var da = {
      getSetAttribute: "t" !== x.className,
      leadingWhitespace: 3 === x.firstChild.nodeType,
      tbody: !x.getElementsByTagName("tbody").length,
      htmlSerialize: !!x.getElementsByTagName("link").length,
      style: /top/.test(J.getAttribute("style")),
      hrefNormalized: "/a" === J.getAttribute("href"),
      opacity: /^0.5/.test(J.style.opacity),
      cssFloat: !!J.style.cssFloat,
      checkOn: !!E.value,
      optSelected: Y.selected,
      enctype: !!Q.createElement("form").enctype,
      html5Clone:
        "<:nav></:nav>" !== Q.createElement("nav").cloneNode(!0).outerHTML,
      boxModel: "CSS1Compat" === Q.compatMode,
      deleteExpando: !0,
      noCloneEvent: !0,
      inlineBlockNeedsLayout: !1,
      shrinkWrapBlocks: !1,
      reliableMarginRight: !0,
      boxSizingReliable: !0,
      pixelPosition: !1,
    };
    E.checked = !0;
    da.noCloneChecked = E.cloneNode(!0).checked;
    M.disabled = !0;
    da.optDisabled = !Y.disabled;
    try {
      delete x.test;
    } catch (ia) {
      da.deleteExpando = !1;
    }
    E = Q.createElement("input");
    E.setAttribute("value", "");
    da.input = "" === E.getAttribute("value");
    E.value = "t";
    E.setAttribute("type", "radio");
    da.radioValue = "t" === E.value;
    E.setAttribute("checked", "t");
    E.setAttribute("name", "t");
    J = Q.createDocumentFragment();
    J.appendChild(E);
    da.appendChecked = E.checked;
    da.checkClone = J.cloneNode(!0).cloneNode(!0).lastChild.checked;
    x.attachEvent &&
      (x.attachEvent("onclick", function () {
        da.noCloneEvent = !1;
      }),
      x.cloneNode(!0).click());
    for (l in { submit: !0, change: !0, focusin: !0 })
      x.setAttribute((J = "on" + l), "t"),
        (da[l + "Bubbles"] = J in a || !1 === x.attributes[J].expando);
    x.style.backgroundClip = "content-box";
    x.cloneNode(!0).style.backgroundClip = "";
    da.clearCloneStyle = "content-box" === x.style.backgroundClip;
    v(function () {
      var ia = Q.getElementsByTagName("body")[0];
      if (ia) {
        var ja = Q.createElement("div");
        ja.style.cssText =
          "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";
        ia.appendChild(ja).appendChild(x);
        x.innerHTML = "<table><tr><td></td><td>t</td></tr></table>";
        var pa = x.getElementsByTagName("td");
        pa[0].style.cssText = "padding:0;margin:0;border:0;display:none";
        f = 0 === pa[0].offsetHeight;
        pa[0].style.display = "";
        pa[1].style.display = "none";
        da.reliableHiddenOffsets = f && 0 === pa[0].offsetHeight;
        x.innerHTML = "";
        x.style.cssText =
          "box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";
        da.boxSizing = 4 === x.offsetWidth;
        da.doesNotIncludeMarginInBodyOffset = 1 !== ia.offsetTop;
        a.getComputedStyle &&
          ((da.pixelPosition =
            "1%" !== (a.getComputedStyle(x, null) || {}).top),
          (da.boxSizingReliable =
            "4px" === (a.getComputedStyle(x, null) || { width: "4px" }).width),
          (pa = x.appendChild(Q.createElement("div"))),
          (pa.style.cssText = x.style.cssText =
            "padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;"),
          (pa.style.marginRight = pa.style.width = "0"),
          (x.style.width = "1px"),
          (da.reliableMarginRight = !parseFloat(
            (a.getComputedStyle(pa, null) || {}).marginRight
          )));
        typeof x.style.zoom !== ma &&
          ((x.innerHTML = ""),
          (x.style.cssText =
            "padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1"),
          (da.inlineBlockNeedsLayout = 3 === x.offsetWidth),
          (x.style.display = "block"),
          (x.innerHTML = "<div></div>"),
          (x.firstChild.style.width = "5px"),
          (da.shrinkWrapBlocks = 3 !== x.offsetWidth),
          da.inlineBlockNeedsLayout && (ia.style.zoom = 1));
        ia.removeChild(ja);
        x = null;
      }
    });
    E = M = J = Y = J = E = null;
    return da;
  })();
  var Lc = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
    Kc = /([A-Z])/g;
  v.extend({
    cache: {},
    expando: "jQuery" + ("1.9.1" + Math.random()).replace(/\D/g, ""),
    noData: {
      embed: !0,
      object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",
      applet: !0,
    },
    hasData: function (f) {
      f = f.nodeType ? v.cache[f[v.expando]] : f[v.expando];
      return !!f && !n(f);
    },
    data: function (f, l, x) {
      return d(f, l, x);
    },
    removeData: function (f, l) {
      return g(f, l);
    },
    _data: function (f, l, x) {
      return d(f, l, x, !0);
    },
    _removeData: function (f, l) {
      return g(f, l, !0);
    },
    acceptData: function (f) {
      if (f.nodeType && 1 !== f.nodeType && 9 !== f.nodeType) return !1;
      var l = f.nodeName && v.noData[f.nodeName.toLowerCase()];
      return !l || (!0 !== l && f.getAttribute("classid") === l);
    },
  });
  v.fn.extend({
    data: function (f, l) {
      var x,
        E = this[0],
        J = 0,
        M = null;
      if (f === b) {
        if (
          this.length &&
          ((M = v.data(E)), 1 === E.nodeType && !v._data(E, "parsedAttrs"))
        ) {
          for (x = E.attributes; J < x.length; J++) {
            var Y = x[J].name;
            Y.indexOf("data-") ||
              ((Y = v.camelCase(Y.slice(5))), h(E, Y, M[Y]));
          }
          v._data(E, "parsedAttrs", !0);
        }
        return M;
      }
      return "object" === typeof f
        ? this.each(function () {
            v.data(this, f);
          })
        : v.access(
            this,
            function (da) {
              if (da === b) return E ? h(E, f, v.data(E, f)) : null;
              this.each(function () {
                v.data(this, f, da);
              });
            },
            null,
            l,
            1 < arguments.length,
            null,
            !0
          );
    },
    removeData: function (f) {
      return this.each(function () {
        v.removeData(this, f);
      });
    },
  });
  v.extend({
    queue: function (f, l, x) {
      if (f) {
        l = (l || "fx") + "queue";
        var E = v._data(f, l);
        x &&
          (!E || v.isArray(x)
            ? (E = v._data(f, l, v.makeArray(x)))
            : E.push(x));
        return E || [];
      }
    },
    dequeue: function (f, l) {
      l = l || "fx";
      var x = v.queue(f, l),
        E = x.length,
        J = x.shift(),
        M = v._queueHooks(f, l),
        Y = function () {
          v.dequeue(f, l);
        };
      "inprogress" === J && ((J = x.shift()), E--);
      if ((M.cur = J))
        "fx" === l && x.unshift("inprogress"), delete M.stop, J.call(f, Y, M);
      !E && M && M.empty.fire();
    },
    _queueHooks: function (f, l) {
      var x = l + "queueHooks";
      return (
        v._data(f, x) ||
        v._data(f, x, {
          empty: v.Callbacks("once memory").add(function () {
            v._removeData(f, l + "queue");
            v._removeData(f, x);
          }),
        })
      );
    },
  });
  v.fn.extend({
    queue: function (f, l) {
      var x = 2;
      "string" !== typeof f && ((l = f), (f = "fx"), x--);
      return arguments.length < x
        ? v.queue(this[0], f)
        : l === b
        ? this
        : this.each(function () {
            var E = v.queue(this, f, l);
            v._queueHooks(this, f);
            "fx" === f && "inprogress" !== E[0] && v.dequeue(this, f);
          });
    },
    dequeue: function (f) {
      return this.each(function () {
        v.dequeue(this, f);
      });
    },
    delay: function (f, l) {
      f = v.fx ? v.fx.speeds[f] || f : f;
      return this.queue(l || "fx", function (x, E) {
        var J = setTimeout(x, f);
        E.stop = function () {
          clearTimeout(J);
        };
      });
    },
    clearQueue: function (f) {
      return this.queue(f || "fx", []);
    },
    promise: function (f, l) {
      var x,
        E = 1,
        J = v.Deferred(),
        M = this,
        Y = this.length,
        da = function () {
          --E || J.resolveWith(M, [M]);
        };
      "string" !== typeof f && ((l = f), (f = b));
      for (f = f || "fx"; Y--; )
        (x = v._data(M[Y], f + "queueHooks")) &&
          x.empty &&
          (E++, x.empty.add(da));
      da();
      return J.promise(l);
    },
  });
  var Ub = /[\t\r\n]/g,
    $c = /\r/g,
    ad = /^(?:input|select|textarea|button|object)$/i,
    bd = /^(?:a|area)$/i,
    pc =
      /^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,
    Vb = /^(?:checked|selected)$/i,
    rb = v.support.getSetAttribute,
    Wb = v.support.input;
  v.fn.extend({
    attr: function (f, l) {
      return v.access(this, v.attr, f, l, 1 < arguments.length);
    },
    removeAttr: function (f) {
      return this.each(function () {
        v.removeAttr(this, f);
      });
    },
    prop: function (f, l) {
      return v.access(this, v.prop, f, l, 1 < arguments.length);
    },
    removeProp: function (f) {
      f = v.propFix[f] || f;
      return this.each(function () {
        try {
          (this[f] = b), delete this[f];
        } catch (l) {}
      });
    },
    addClass: function (f) {
      var l,
        x,
        E,
        J = 0,
        M = this.length;
      var Y = "string" === typeof f && f;
      if (v.isFunction(f))
        return this.each(function (ia) {
          v(this).addClass(f.call(this, ia, this.className));
        });
      if (Y)
        for (Y = (f || "").match(mb) || []; J < M; J++) {
          var da = this[J];
          if (
            (l =
              1 === da.nodeType &&
              (da.className
                ? (" " + da.className + " ").replace(Ub, " ")
                : " "))
          ) {
            for (E = 0; (x = Y[E++]); )
              0 > l.indexOf(" " + x + " ") && (l += x + " ");
            da.className = v.trim(l);
          }
        }
      return this;
    },
    removeClass: function (f) {
      var l,
        x,
        E,
        J = 0,
        M = this.length;
      var Y = 0 === arguments.length || ("string" === typeof f && f);
      if (v.isFunction(f))
        return this.each(function (ia) {
          v(this).removeClass(f.call(this, ia, this.className));
        });
      if (Y)
        for (Y = (f || "").match(mb) || []; J < M; J++) {
          var da = this[J];
          if (
            (l =
              1 === da.nodeType &&
              (da.className ? (" " + da.className + " ").replace(Ub, " ") : ""))
          ) {
            for (E = 0; (x = Y[E++]); )
              for (; 0 <= l.indexOf(" " + x + " "); )
                l = l.replace(" " + x + " ", " ");
            da.className = f ? v.trim(l) : "";
          }
        }
      return this;
    },
    toggleClass: function (f, l) {
      var x = typeof f,
        E = "boolean" === typeof l;
      return v.isFunction(f)
        ? this.each(function (J) {
            v(this).toggleClass(f.call(this, J, this.className, l), l);
          })
        : this.each(function () {
            if ("string" === x)
              for (
                var J, M = 0, Y = v(this), da = l, ia = f.match(mb) || [];
                (J = ia[M++]);

              )
                (da = E ? da : !Y.hasClass(J)),
                  Y[da ? "addClass" : "removeClass"](J);
            else if (x === ma || "boolean" === x)
              this.className && v._data(this, "__className__", this.className),
                (this.className =
                  this.className || !1 === f
                    ? ""
                    : v._data(this, "__className__") || "");
          });
    },
    hasClass: function (f) {
      f = " " + f + " ";
      for (var l = 0, x = this.length; l < x; l++)
        if (
          1 === this[l].nodeType &&
          0 <= (" " + this[l].className + " ").replace(Ub, " ").indexOf(f)
        )
          return !0;
      return !1;
    },
    val: function (f) {
      var l,
        x,
        E = this[0];
      if (arguments.length) {
        var J = v.isFunction(f);
        return this.each(function (M) {
          var Y = v(this);
          1 === this.nodeType &&
            ((M = J ? f.call(this, M, Y.val()) : f),
            null == M
              ? (M = "")
              : "number" === typeof M
              ? (M += "")
              : v.isArray(M) &&
                (M = v.map(M, function (da) {
                  return null == da ? "" : da + "";
                })),
            (x =
              v.valHooks[this.type] || v.valHooks[this.nodeName.toLowerCase()]),
            (x && "set" in x && x.set(this, M, "value") !== b) ||
              (this.value = M));
        });
      }
      if (E) {
        if (
          (x = v.valHooks[E.type] || v.valHooks[E.nodeName.toLowerCase()]) &&
          "get" in x &&
          (l = x.get(E, "value")) !== b
        )
          return l;
        l = E.value;
        return "string" === typeof l ? l.replace($c, "") : null == l ? "" : l;
      }
    },
  });
  v.extend({
    valHooks: {
      option: {
        get: function (f) {
          var l = f.attributes.value;
          return !l || l.specified ? f.value : f.text;
        },
      },
      select: {
        get: function (f) {
          for (
            var l,
              x = f.options,
              E = f.selectedIndex,
              J = (f = "select-one" === f.type || 0 > E) ? null : [],
              M = f ? E + 1 : x.length,
              Y = 0 > E ? M : f ? E : 0;
            Y < M;
            Y++
          )
            if (
              ((l = x[Y]),
              !(
                (!l.selected && Y !== E) ||
                (v.support.optDisabled
                  ? l.disabled
                  : null !== l.getAttribute("disabled")) ||
                (l.parentNode.disabled && v.nodeName(l.parentNode, "optgroup"))
              ))
            ) {
              l = v(l).val();
              if (f) return l;
              J.push(l);
            }
          return J;
        },
        set: function (f, l) {
          var x = v.makeArray(l);
          v(f)
            .find("option")
            .each(function () {
              this.selected = 0 <= v.inArray(v(this).val(), x);
            });
          x.length || (f.selectedIndex = -1);
          return x;
        },
      },
    },
    attr: function (f, l, x) {
      var E;
      var J = f.nodeType;
      if (f && 3 !== J && 8 !== J && 2 !== J) {
        if (typeof f.getAttribute === ma) return v.prop(f, l, x);
        if ((J = 1 !== J || !v.isXMLDoc(f))) {
          l = l.toLowerCase();
          var M = v.attrHooks[l] || (pc.test(l) ? cd : Gb);
        }
        if (x !== b)
          if (null === x) v.removeAttr(f, l);
          else {
            if (M && J && "set" in M && (E = M.set(f, x, l)) !== b) return E;
            f.setAttribute(l, x + "");
            return x;
          }
        else {
          if (M && J && "get" in M && null !== (E = M.get(f, l))) return E;
          typeof f.getAttribute !== ma && (E = f.getAttribute(l));
          return null == E ? b : E;
        }
      }
    },
    removeAttr: function (f, l) {
      var x = 0,
        E = l && l.match(mb);
      if (E && 1 === f.nodeType)
        for (; (l = E[x++]); ) {
          var J = v.propFix[l] || l;
          pc.test(l)
            ? !rb && Vb.test(l)
              ? (f[v.camelCase("default-" + l)] = f[J] = !1)
              : (f[J] = !1)
            : v.attr(f, l, "");
          f.removeAttribute(rb ? l : J);
        }
    },
    attrHooks: {
      type: {
        set: function (f, l) {
          if (
            !v.support.radioValue &&
            "radio" === l &&
            v.nodeName(f, "input")
          ) {
            var x = f.value;
            f.setAttribute("type", l);
            x && (f.value = x);
            return l;
          }
        },
      },
    },
    propFix: {
      tabindex: "tabIndex",
      readonly: "readOnly",
      for: "htmlFor",
      class: "className",
      maxlength: "maxLength",
      cellspacing: "cellSpacing",
      cellpadding: "cellPadding",
      rowspan: "rowSpan",
      colspan: "colSpan",
      usemap: "useMap",
      frameborder: "frameBorder",
      contenteditable: "contentEditable",
    },
    prop: function (f, l, x) {
      var E,
        J = f.nodeType;
      if (f && 3 !== J && 8 !== J && 2 !== J) {
        if (1 !== J || !v.isXMLDoc(f)) {
          l = v.propFix[l] || l;
          var M = v.propHooks[l];
        }
        return x !== b
          ? M && "set" in M && (E = M.set(f, x, l)) !== b
            ? E
            : (f[l] = x)
          : M && "get" in M && null !== (E = M.get(f, l))
          ? E
          : f[l];
      }
    },
    propHooks: {
      tabIndex: {
        get: function (f) {
          var l = f.getAttributeNode("tabindex");
          return l && l.specified
            ? parseInt(l.value, 10)
            : ad.test(f.nodeName) || (bd.test(f.nodeName) && f.href)
            ? 0
            : b;
        },
      },
    },
  });
  var cd = {
    get: function (f, l) {
      var x = v.prop(f, l),
        E = "boolean" === typeof x && f.getAttribute(l);
      return (f =
        "boolean" === typeof x
          ? Wb && rb
            ? null != E
            : Vb.test(l)
            ? f[v.camelCase("default-" + l)]
            : !!E
          : f.getAttributeNode(l)) && !1 !== f.value
        ? l.toLowerCase()
        : b;
    },
    set: function (f, l, x) {
      !1 === l
        ? v.removeAttr(f, x)
        : (Wb && rb) || !Vb.test(x)
        ? f.setAttribute((!rb && v.propFix[x]) || x, x)
        : (f[v.camelCase("default-" + x)] = f[x] = !0);
      return x;
    },
  };
  (Wb && rb) ||
    (v.attrHooks.value = {
      get: function (f, l) {
        l = f.getAttributeNode(l);
        return v.nodeName(f, "input")
          ? f.defaultValue
          : l && l.specified
          ? l.value
          : b;
      },
      set: function (f, l, x) {
        if (v.nodeName(f, "input")) f.defaultValue = l;
        else return Gb && Gb.set(f, l, x);
      },
    });
  if (!rb) {
    var Gb = (v.valHooks.button = {
      get: function (f, l) {
        return (f = f.getAttributeNode(l)) &&
          ("id" === l || "name" === l || "coords" === l
            ? "" !== f.value
            : f.specified)
          ? f.value
          : b;
      },
      set: function (f, l, x) {
        var E = f.getAttributeNode(x);
        E || f.setAttributeNode((E = f.ownerDocument.createAttribute(x)));
        E.value = l += "";
        return "value" === x || l === f.getAttribute(x) ? l : b;
      },
    });
    v.attrHooks.contenteditable = {
      get: Gb.get,
      set: function (f, l, x) {
        Gb.set(f, "" === l ? !1 : l, x);
      },
    };
    v.each(["width", "height"], function (f, l) {
      v.attrHooks[l] = v.extend(v.attrHooks[l], {
        set: function (x, E) {
          if ("" === E) return x.setAttribute(l, "auto"), E;
        },
      });
    });
  }
  v.support.hrefNormalized ||
    (v.each(["href", "src", "width", "height"], function (f, l) {
      v.attrHooks[l] = v.extend(v.attrHooks[l], {
        get: function (x) {
          x = x.getAttribute(l, 2);
          return null == x ? b : x;
        },
      });
    }),
    v.each(["href", "src"], function (f, l) {
      v.propHooks[l] = {
        get: function (x) {
          return x.getAttribute(l, 4);
        },
      };
    }));
  v.support.style ||
    (v.attrHooks.style = {
      get: function (f) {
        return f.style.cssText || b;
      },
      set: function (f, l) {
        return (f.style.cssText = l + "");
      },
    });
  v.support.optSelected ||
    (v.propHooks.selected = v.extend(v.propHooks.selected, {
      get: function (f) {
        if ((f = f.parentNode))
          f.selectedIndex, f.parentNode && f.parentNode.selectedIndex;
        return null;
      },
    }));
  v.support.enctype || (v.propFix.enctype = "encoding");
  v.support.checkOn ||
    v.each(["radio", "checkbox"], function () {
      v.valHooks[this] = {
        get: function (f) {
          return null === f.getAttribute("value") ? "on" : f.value;
        },
      };
    });
  v.each(["radio", "checkbox"], function () {
    v.valHooks[this] = v.extend(v.valHooks[this], {
      set: function (f, l) {
        if (v.isArray(l)) return (f.checked = 0 <= v.inArray(v(f).val(), l));
      },
    });
  });
  var Xb = /^(?:input|select|textarea)$/i,
    dd = /^key/,
    ed = /^(?:mouse|contextmenu)|click/,
    qc = /^(?:focusinfocus|focusoutblur)$/,
    rc = /^([^.]*)(?:\.(.+)|)$/;
  v.event = {
    global: {},
    add: function (f, l, x, E, J) {
      var M, Y, da, ia, ja;
      if ((Y = v._data(f))) {
        if (x.handler) {
          var pa = x;
          x = pa.handler;
          J = pa.selector;
        }
        x.guid || (x.guid = v.guid++);
        (M = Y.events) || (M = Y.events = {});
        (da = Y.handle) ||
          ((da = Y.handle =
            function (Na) {
              return typeof v === ma || (Na && v.event.triggered === Na.type)
                ? b
                : v.event.dispatch.apply(da.elem, arguments);
            }),
          (da.elem = f));
        l = (l || "").match(mb) || [""];
        for (Y = l.length; Y--; ) {
          var na = rc.exec(l[Y]) || [];
          var ra = (ia = na[1]);
          var Ba = (na[2] || "").split(".").sort();
          na = v.event.special[ra] || {};
          ra = (J ? na.delegateType : na.bindType) || ra;
          na = v.event.special[ra] || {};
          ia = v.extend(
            {
              type: ra,
              origType: ia,
              data: E,
              handler: x,
              guid: x.guid,
              selector: J,
              needsContext: J && v.expr.match.needsContext.test(J),
              namespace: Ba.join("."),
            },
            pa
          );
          (ja = M[ra]) ||
            ((ja = M[ra] = []),
            (ja.delegateCount = 0),
            (na.setup && !1 !== na.setup.call(f, E, Ba, da)) ||
              (f.addEventListener
                ? f.addEventListener(ra, da, !1)
                : f.attachEvent && f.attachEvent("on" + ra, da)));
          na.add &&
            (na.add.call(f, ia), ia.handler.guid || (ia.handler.guid = x.guid));
          J ? ja.splice(ja.delegateCount++, 0, ia) : ja.push(ia);
          v.event.global[ra] = !0;
        }
        f = null;
      }
    },
    remove: function (f, l, x, E, J) {
      var M,
        Y,
        da,
        ia,
        ja,
        pa = v.hasData(f) && v._data(f);
      if (pa && (ia = pa.events)) {
        l = (l || "").match(mb) || [""];
        for (da = l.length; da--; ) {
          var na = rc.exec(l[da]) || [];
          var ra = (ja = na[1]);
          var Ba = (na[2] || "").split(".").sort();
          if (ra) {
            var Na = v.event.special[ra] || {};
            ra = (E ? Na.delegateType : Na.bindType) || ra;
            var Ya = ia[ra] || [];
            na =
              na[2] &&
              new RegExp("(^|\\.)" + Ba.join("\\.(?:.*\\.|)") + "(\\.|$)");
            for (Y = M = Ya.length; M--; ) {
              var Ra = Ya[M];
              (!J && ja !== Ra.origType) ||
                (x && x.guid !== Ra.guid) ||
                (na && !na.test(Ra.namespace)) ||
                (E && E !== Ra.selector && ("**" !== E || !Ra.selector)) ||
                (Ya.splice(M, 1),
                Ra.selector && Ya.delegateCount--,
                Na.remove && Na.remove.call(f, Ra));
            }
            Y &&
              !Ya.length &&
              ((Na.teardown && !1 !== Na.teardown.call(f, Ba, pa.handle)) ||
                v.removeEvent(f, ra, pa.handle),
              delete ia[ra]);
          } else for (ra in ia) v.event.remove(f, ra + l[da], x, E, !0);
        }
        v.isEmptyObject(ia) && (delete pa.handle, v._removeData(f, "events"));
      }
    },
    trigger: function (f, l, x, E) {
      var J,
        M,
        Y = [x || Q],
        da = Fb.call(f, "type") ? f.type : f;
      var ia = Fb.call(f, "namespace") ? f.namespace.split(".") : [];
      var ja = (J = x = x || Q);
      if (
        3 !== x.nodeType &&
        8 !== x.nodeType &&
        !qc.test(da + v.event.triggered)
      ) {
        0 <= da.indexOf(".") &&
          ((ia = da.split(".")), (da = ia.shift()), ia.sort());
        var pa = 0 > da.indexOf(":") && "on" + da;
        f = f[v.expando] ? f : new v.Event(da, "object" === typeof f && f);
        f.isTrigger = !0;
        f.namespace = ia.join(".");
        f.namespace_re = f.namespace
          ? new RegExp("(^|\\.)" + ia.join("\\.(?:.*\\.|)") + "(\\.|$)")
          : null;
        f.result = b;
        f.target || (f.target = x);
        l = null == l ? [f] : v.makeArray(l, [f]);
        ia = v.event.special[da] || {};
        if (E || !ia.trigger || !1 !== ia.trigger.apply(x, l)) {
          if (!E && !ia.noBubble && !v.isWindow(x)) {
            var na = ia.delegateType || da;
            qc.test(na + da) || (ja = ja.parentNode);
            for (; ja; ja = ja.parentNode) Y.push(ja), (J = ja);
            J === (x.ownerDocument || Q) &&
              Y.push(J.defaultView || J.parentWindow || a);
          }
          for (M = 0; (ja = Y[M++]) && !f.isPropagationStopped(); )
            (f.type = 1 < M ? na : ia.bindType || da),
              (J =
                (v._data(ja, "events") || {})[f.type] &&
                v._data(ja, "handle")) && J.apply(ja, l),
              (J = pa && ja[pa]) &&
                v.acceptData(ja) &&
                J.apply &&
                !1 === J.apply(ja, l) &&
                f.preventDefault();
          f.type = da;
          if (
            !(
              E ||
              f.isDefaultPrevented() ||
              (ia._default && !1 !== ia._default.apply(x.ownerDocument, l)) ||
              ("click" === da && v.nodeName(x, "a"))
            ) &&
            v.acceptData(x) &&
            pa &&
            x[da] &&
            !v.isWindow(x)
          ) {
            (J = x[pa]) && (x[pa] = null);
            v.event.triggered = da;
            try {
              x[da]();
            } catch (ra) {}
            v.event.triggered = b;
            J && (x[pa] = J);
          }
          return f.result;
        }
      }
    },
    dispatch: function (f) {
      f = v.event.fix(f);
      var l,
        x,
        E,
        J = Ha.call(arguments);
      var M = (v._data(this, "events") || {})[f.type] || [];
      var Y = v.event.special[f.type] || {};
      J[0] = f;
      f.delegateTarget = this;
      if (!Y.preDispatch || !1 !== Y.preDispatch.call(this, f)) {
        var da = v.event.handlers.call(this, f, M);
        for (M = 0; (x = da[M++]) && !f.isPropagationStopped(); )
          for (
            f.currentTarget = x.elem, E = 0;
            (l = x.handlers[E++]) && !f.isImmediatePropagationStopped();

          )
            if (!f.namespace_re || f.namespace_re.test(l.namespace))
              (f.handleObj = l),
                (f.data = l.data),
                (l = (
                  (v.event.special[l.origType] || {}).handle || l.handler
                ).apply(x.elem, J)),
                l !== b &&
                  !1 === (f.result = l) &&
                  (f.preventDefault(), f.stopPropagation());
        Y.postDispatch && Y.postDispatch.call(this, f);
        return f.result;
      }
    },
    handlers: function (f, l) {
      var x,
        E = [],
        J = l.delegateCount,
        M = f.target;
      if (J && M.nodeType && (!f.button || "click" !== f.type))
        for (; M != this; M = M.parentNode || this)
          if (1 === M.nodeType && (!0 !== M.disabled || "click" !== f.type)) {
            var Y = [];
            for (x = 0; x < J; x++) {
              var da = l[x];
              var ia = da.selector + " ";
              Y[ia] === b &&
                (Y[ia] = da.needsContext
                  ? 0 <= v(ia, this).index(M)
                  : v.find(ia, this, null, [M]).length);
              Y[ia] && Y.push(da);
            }
            Y.length && E.push({ elem: M, handlers: Y });
          }
      J < l.length && E.push({ elem: this, handlers: l.slice(J) });
      return E;
    },
    fix: function (f) {
      if (f[v.expando]) return f;
      var l = f.type;
      var x = f,
        E = this.fixHooks[l];
      E ||
        (this.fixHooks[l] = E =
          ed.test(l) ? this.mouseHooks : dd.test(l) ? this.keyHooks : {});
      var J = E.props ? this.props.concat(E.props) : this.props;
      f = new v.Event(x);
      for (l = J.length; l--; ) {
        var M = J[l];
        f[M] = x[M];
      }
      f.target || (f.target = x.srcElement || Q);
      3 === f.target.nodeType && (f.target = f.target.parentNode);
      f.metaKey = !!f.metaKey;
      return E.filter ? E.filter(f, x) : f;
    },
    props:
      "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(
        " "
      ),
    fixHooks: {},
    keyHooks: {
      props: ["char", "charCode", "key", "keyCode"],
      filter: function (f, l) {
        null == f.which &&
          (f.which = null != l.charCode ? l.charCode : l.keyCode);
        return f;
      },
    },
    mouseHooks: {
      props:
        "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(
          " "
        ),
      filter: function (f, l) {
        var x = l.button,
          E = l.fromElement;
        if (null == f.pageX && null != l.clientX) {
          var J = f.target.ownerDocument || Q;
          var M = J.documentElement;
          J = J.body;
          f.pageX =
            l.clientX +
            ((M && M.scrollLeft) || (J && J.scrollLeft) || 0) -
            ((M && M.clientLeft) || (J && J.clientLeft) || 0);
          f.pageY =
            l.clientY +
            ((M && M.scrollTop) || (J && J.scrollTop) || 0) -
            ((M && M.clientTop) || (J && J.clientTop) || 0);
        }
        !f.relatedTarget &&
          E &&
          (f.relatedTarget = E === f.target ? l.toElement : E);
        f.which || x === b || (f.which = x & 1 ? 1 : x & 2 ? 3 : x & 4 ? 2 : 0);
        return f;
      },
    },
    special: {
      load: { noBubble: !0 },
      click: {
        trigger: function () {
          if (
            v.nodeName(this, "input") &&
            "checkbox" === this.type &&
            this.click
          )
            return this.click(), !1;
        },
      },
      focus: {
        trigger: function () {
          if (this !== Q.activeElement && this.focus)
            try {
              return this.focus(), !1;
            } catch (f) {}
        },
        delegateType: "focusin",
      },
      blur: {
        trigger: function () {
          if (this === Q.activeElement && this.blur) return this.blur(), !1;
        },
        delegateType: "focusout",
      },
      beforeunload: {
        postDispatch: function (f) {
          f.result !== b && (f.originalEvent.returnValue = f.result);
        },
      },
    },
    simulate: function (f, l, x, E) {
      f = v.extend(new v.Event(), x, {
        type: f,
        isSimulated: !0,
        originalEvent: {},
      });
      E ? v.event.trigger(f, null, l) : v.event.dispatch.call(l, f);
      f.isDefaultPrevented() && x.preventDefault();
    },
  };
  v.removeEvent = Q.removeEventListener
    ? function (f, l, x) {
        f.removeEventListener && f.removeEventListener(l, x, !1);
      }
    : function (f, l, x) {
        l = "on" + l;
        f.detachEvent &&
          (typeof f[l] === ma && (f[l] = null), f.detachEvent(l, x));
      };
  v.Event = function (f, l) {
    if (!(this instanceof v.Event)) return new v.Event(f, l);
    f && f.type
      ? ((this.originalEvent = f),
        (this.type = f.type),
        (this.isDefaultPrevented =
          f.defaultPrevented ||
          !1 === f.returnValue ||
          (f.getPreventDefault && f.getPreventDefault())
            ? q
            : t))
      : (this.type = f);
    l && v.extend(this, l);
    this.timeStamp = (f && f.timeStamp) || v.now();
    this[v.expando] = !0;
  };
  v.Event.prototype = {
    isDefaultPrevented: t,
    isPropagationStopped: t,
    isImmediatePropagationStopped: t,
    preventDefault: function () {
      var f = this.originalEvent;
      this.isDefaultPrevented = q;
      f && (f.preventDefault ? f.preventDefault() : (f.returnValue = !1));
    },
    stopPropagation: function () {
      var f = this.originalEvent;
      this.isPropagationStopped = q;
      f && (f.stopPropagation && f.stopPropagation(), (f.cancelBubble = !0));
    },
    stopImmediatePropagation: function () {
      this.isImmediatePropagationStopped = q;
      this.stopPropagation();
    },
  };
  v.each({ mouseenter: "mouseover", mouseleave: "mouseout" }, function (f, l) {
    v.event.special[f] = {
      delegateType: l,
      bindType: l,
      handle: function (x) {
        var E = x.relatedTarget,
          J = x.handleObj;
        if (!E || (E !== this && !v.contains(this, E))) {
          x.type = J.origType;
          var M = J.handler.apply(this, arguments);
          x.type = l;
        }
        return M;
      },
    };
  });
  v.support.submitBubbles ||
    (v.event.special.submit = {
      setup: function () {
        if (v.nodeName(this, "form")) return !1;
        v.event.add(this, "click._submit keypress._submit", function (f) {
          f = f.target;
          (f =
            v.nodeName(f, "input") || v.nodeName(f, "button") ? f.form : b) &&
            !v._data(f, "submitBubbles") &&
            (v.event.add(f, "submit._submit", function (l) {
              l._submit_bubble = !0;
            }),
            v._data(f, "submitBubbles", !0));
        });
      },
      postDispatch: function (f) {
        f._submit_bubble &&
          (delete f._submit_bubble,
          this.parentNode &&
            !f.isTrigger &&
            v.event.simulate("submit", this.parentNode, f, !0));
      },
      teardown: function () {
        if (v.nodeName(this, "form")) return !1;
        v.event.remove(this, "._submit");
      },
    });
  v.support.changeBubbles ||
    (v.event.special.change = {
      setup: function () {
        if (Xb.test(this.nodeName)) {
          if ("checkbox" === this.type || "radio" === this.type)
            v.event.add(this, "propertychange._change", function (f) {
              "checked" === f.originalEvent.propertyName &&
                (this._just_changed = !0);
            }),
              v.event.add(this, "click._change", function (f) {
                this._just_changed && !f.isTrigger && (this._just_changed = !1);
                v.event.simulate("change", this, f, !0);
              });
          return !1;
        }
        v.event.add(this, "beforeactivate._change", function (f) {
          f = f.target;
          Xb.test(f.nodeName) &&
            !v._data(f, "changeBubbles") &&
            (v.event.add(f, "change._change", function (l) {
              !this.parentNode ||
                l.isSimulated ||
                l.isTrigger ||
                v.event.simulate("change", this.parentNode, l, !0);
            }),
            v._data(f, "changeBubbles", !0));
        });
      },
      handle: function (f) {
        var l = f.target;
        if (
          this !== l ||
          f.isSimulated ||
          f.isTrigger ||
          ("radio" !== l.type && "checkbox" !== l.type)
        )
          return f.handleObj.handler.apply(this, arguments);
      },
      teardown: function () {
        v.event.remove(this, "._change");
        return !Xb.test(this.nodeName);
      },
    });
  v.support.focusinBubbles ||
    v.each({ focus: "focusin", blur: "focusout" }, function (f, l) {
      var x = 0,
        E = function (J) {
          v.event.simulate(l, J.target, v.event.fix(J), !0);
        };
      v.event.special[l] = {
        setup: function () {
          0 === x++ && Q.addEventListener(f, E, !0);
        },
        teardown: function () {
          0 === --x && Q.removeEventListener(f, E, !0);
        },
      };
    });
  v.fn.extend({
    on: function (f, l, x, E, J) {
      var M;
      if ("object" === typeof f) {
        "string" !== typeof l && ((x = x || l), (l = b));
        for (M in f) this.on(M, l, x, f[M], J);
        return this;
      }
      null == x && null == E
        ? ((E = l), (x = l = b))
        : null == E &&
          ("string" === typeof l
            ? ((E = x), (x = b))
            : ((E = x), (x = l), (l = b)));
      if (!1 === E) E = t;
      else if (!E) return this;
      if (1 === J) {
        var Y = E;
        E = function (da) {
          v().off(da);
          return Y.apply(this, arguments);
        };
        E.guid = Y.guid || (Y.guid = v.guid++);
      }
      return this.each(function () {
        v.event.add(this, f, E, x, l);
      });
    },
    one: function (f, l, x, E) {
      return this.on(f, l, x, E, 1);
    },
    off: function (f, l, x) {
      if (f && f.preventDefault && f.handleObj) {
        var E = f.handleObj;
        v(f.delegateTarget).off(
          E.namespace ? E.origType + "." + E.namespace : E.origType,
          E.selector,
          E.handler
        );
        return this;
      }
      if ("object" === typeof f) {
        for (E in f) this.off(E, l, f[E]);
        return this;
      }
      if (!1 === l || "function" === typeof l) (x = l), (l = b);
      !1 === x && (x = t);
      return this.each(function () {
        v.event.remove(this, f, x, l);
      });
    },
    bind: function (f, l, x) {
      return this.on(f, null, l, x);
    },
    unbind: function (f, l) {
      return this.off(f, null, l);
    },
    delegate: function (f, l, x, E) {
      return this.on(l, f, x, E);
    },
    undelegate: function (f, l, x) {
      return 1 === arguments.length
        ? this.off(f, "**")
        : this.off(l, f || "**", x);
    },
    trigger: function (f, l) {
      return this.each(function () {
        v.event.trigger(f, l, this);
      });
    },
    triggerHandler: function (f, l) {
      var x = this[0];
      if (x) return v.event.trigger(f, l, x, !0);
    },
  });
  (function (f, l) {
    function x() {
      var W,
        fa = [];
      return (W = function (Z, la) {
        fa.push((Z += " ")) > Ka.cacheLength && delete W[fa.shift()];
        return (W[Z] = la);
      });
    }
    function E(W) {
      W[La] = !0;
      return W;
    }
    function J(W) {
      var fa = Ca.createElement("div");
      try {
        return W(fa);
      } catch (Z) {
        return !1;
      } finally {
      }
    }
    function M(W, fa, Z, la) {
      var oa, ta, sa, xa;
      (fa ? fa.ownerDocument || fa : lb) !== Ca && Hb(fa);
      fa = fa || Ca;
      Z = Z || [];
      if (!W || "string" !== typeof W) return Z;
      if (1 !== (xa = fa.nodeType) && 9 !== xa) return [];
      if (!Ma && !la) {
        if ((oa = fd.exec(W)))
          if ((sa = oa[1]))
            if (9 === xa)
              if ((ta = fa.getElementById(sa)) && ta.parentNode) {
                if (ta.id === sa) return Z.push(ta), Z;
              } else return Z;
            else {
              if (
                fa.ownerDocument &&
                (ta = fa.ownerDocument.getElementById(sa)) &&
                Va(fa, ta) &&
                ta.id === sa
              )
                return Z.push(ta), Z;
            }
          else {
            if (oa[2])
              return zb.apply(Z, Ab.call(fa.getElementsByTagName(W), 0)), Z;
            if ((sa = oa[3]) && Ia.getByClassName && fa.getElementsByClassName)
              return zb.apply(Z, Ab.call(fa.getElementsByClassName(sa), 0)), Z;
          }
        if (Ia.qsa && !Ua.test(W)) {
          oa = !0;
          ta = La;
          sa = fa;
          var va = 9 === xa && W;
          if (1 === xa && "object" !== fa.nodeName.toLowerCase()) {
            xa = pa(W);
            (oa = fa.getAttribute("id"))
              ? (ta = oa.replace(gd, "\\$&"))
              : fa.setAttribute("id", ta);
            ta = "[id='" + ta + "'] ";
            for (sa = xa.length; sa--; ) xa[sa] = ta + na(xa[sa]);
            sa = (Yb.test(W) && fa.parentNode) || fa;
            va = xa.join(",");
          }
          if (va)
            try {
              return zb.apply(Z, Ab.call(sa.querySelectorAll(va), 0)), Z;
            } catch (za) {
            } finally {
              oa || fa.removeAttribute("id");
            }
        }
      }
      var Da;
      a: {
        W = W.replace(Mb, "$1");
        ta = pa(W);
        if (!la && 1 === ta.length) {
          oa = ta[0] = ta[0].slice(0);
          if (
            2 < oa.length &&
            "ID" === (Da = oa[0]).type &&
            9 === fa.nodeType &&
            !Ma &&
            Ka.relative[oa[1].type]
          ) {
            fa = Ka.find.ID(Da.matches[0].replace(ob, pb), fa)[0];
            if (!fa) {
              Da = Z;
              break a;
            }
            W = W.slice(oa.shift().value.length);
          }
          for (xa = Nb.needsContext.test(W) ? 0 : oa.length; xa--; ) {
            Da = oa[xa];
            if (Ka.relative[(sa = Da.type)]) break;
            if ((sa = Ka.find[sa]))
              if (
                (la = sa(
                  Da.matches[0].replace(ob, pb),
                  (Yb.test(oa[0].type) && fa.parentNode) || fa
                ))
              ) {
                oa.splice(xa, 1);
                W = la.length && na(oa);
                if (!W) {
                  zb.apply(Z, Ab.call(la, 0));
                  Da = Z;
                  break a;
                }
                break;
              }
          }
        }
        sc(W, ta)(la, fa, Ma, Z, Yb.test(W));
        Da = Z;
      }
      return Da;
    }
    function Y(W, fa) {
      var Z = fa && W,
        la =
          Z &&
          (~fa.sourceIndex || -2147483648) - (~W.sourceIndex || -2147483648);
      if (la) return la;
      if (Z) for (; (Z = Z.nextSibling); ) if (Z === fa) return -1;
      return W ? 1 : -1;
    }
    function da(W) {
      return function (fa) {
        return "input" === fa.nodeName.toLowerCase() && fa.type === W;
      };
    }
    function ia(W) {
      return function (fa) {
        var Z = fa.nodeName.toLowerCase();
        return ("input" === Z || "button" === Z) && fa.type === W;
      };
    }
    function ja(W) {
      return E(function (fa) {
        fa = +fa;
        return E(function (Z, la) {
          for (var oa, ta = W([], Z.length, fa), sa = ta.length; sa--; )
            Z[(oa = ta[sa])] && (Z[oa] = !(la[oa] = Z[oa]));
        });
      });
    }
    function pa(W, fa) {
      var Z, la, oa, ta, sa;
      if ((ta = sb[W + " "])) return fa ? 0 : ta.slice(0);
      ta = W;
      var xa = [];
      for (sa = Ka.preFilter; ta; ) {
        if (!va || (Z = hd.exec(ta)))
          Z && (ta = ta.slice(Z[0].length) || ta), xa.push((la = []));
        var va = !1;
        if ((Z = id.exec(ta)))
          (va = Z.shift()),
            la.push({ value: va, type: Z[0].replace(Mb, " ") }),
            (ta = ta.slice(va.length));
        for (oa in Ka.filter)
          !(Z = Nb[oa].exec(ta)) ||
            (sa[oa] && !(Z = sa[oa](Z))) ||
            ((va = Z.shift()),
            la.push({ value: va, type: oa, matches: Z }),
            (ta = ta.slice(va.length)));
        if (!va) break;
      }
      return fa ? ta.length : ta ? M.error(W) : sb(W, xa).slice(0);
    }
    function na(W) {
      for (var fa = 0, Z = W.length, la = ""; fa < Z; fa++) la += W[fa].value;
      return la;
    }
    function ra(W, fa, Z) {
      var la = fa.dir,
        oa = Z && "parentNode" === la,
        ta = gb++;
      return fa.first
        ? function (sa, xa, va) {
            for (; (sa = sa[la]); )
              if (1 === sa.nodeType || oa) return W(sa, xa, va);
          }
        : function (sa, xa, va) {
            var Da,
              za,
              Fa = Oa + " " + ta;
            if (va)
              for (; (sa = sa[la]); ) {
                if ((1 === sa.nodeType || oa) && W(sa, xa, va)) return !0;
              }
            else
              for (; (sa = sa[la]); )
                if (1 === sa.nodeType || oa) {
                  var Pa = sa[La] || (sa[La] = {});
                  if ((za = Pa[la]) && za[0] === Fa) {
                    if (!0 === (Da = za[1]) || Da === Xa) return !0 === Da;
                  } else if (
                    ((za = Pa[la] = [Fa]),
                    (za[1] = W(sa, xa, va) || Xa),
                    !0 === za[1])
                  )
                    return !0;
                }
          };
    }
    function Ba(W) {
      return 1 < W.length
        ? function (fa, Z, la) {
            for (var oa = W.length; oa--; ) if (!W[oa](fa, Z, la)) return !1;
            return !0;
          }
        : W[0];
    }
    function Na(W, fa, Z, la, oa) {
      for (
        var ta, sa = [], xa = 0, va = W.length, Da = null != fa;
        xa < va;
        xa++
      )
        if ((ta = W[xa]))
          if (!Z || Z(ta, la, oa)) sa.push(ta), Da && fa.push(xa);
      return sa;
    }
    function Ya(W, fa, Z, la, oa, ta) {
      la && !la[La] && (la = Ya(la));
      oa && !oa[La] && (oa = Ya(oa, ta));
      return E(function (sa, xa, va, Da) {
        var za,
          Fa = [],
          Pa = [],
          db = xa.length,
          Qa;
        if (!(Qa = sa)) {
          Qa = fa || "*";
          for (
            var Ga = va.nodeType ? [va] : va, Za = [], Ta = 0, Ob = Ga.length;
            Ta < Ob;
            Ta++
          )
            M(Qa, Ga[Ta], Za);
          Qa = Za;
        }
        Qa = !W || (!sa && fa) ? Qa : Na(Qa, Fa, W, va, Da);
        Ga = Z ? (oa || (sa ? W : db || la) ? [] : xa) : Qa;
        Z && Z(Qa, Ga, va, Da);
        if (la) {
          var ib = Na(Ga, Pa);
          la(ib, [], va, Da);
          for (va = ib.length; va--; )
            if ((za = ib[va])) Ga[Pa[va]] = !(Qa[Pa[va]] = za);
        }
        if (sa) {
          if (oa || W) {
            if (oa) {
              ib = [];
              for (va = Ga.length; va--; )
                (za = Ga[va]) && ib.push((Qa[va] = za));
              oa(null, (Ga = []), ib, Da);
            }
            for (va = Ga.length; va--; )
              (za = Ga[va]) &&
                -1 < (ib = oa ? Zb.call(sa, za) : Fa[va]) &&
                (sa[ib] = !(xa[ib] = za));
          }
        } else (Ga = Na(Ga === xa ? Ga.splice(db, Ga.length) : Ga)), oa ? oa(null, xa, Ga, Da) : zb.apply(xa, Ga);
      });
    }
    function Ra(W) {
      var fa,
        Z,
        la = W.length,
        oa = Ka.relative[W[0].type];
      var ta = oa || Ka.relative[" "];
      for (
        var sa = oa ? 1 : 0,
          xa = ra(
            function (za) {
              return za === fa;
            },
            ta,
            !0
          ),
          va = ra(
            function (za) {
              return -1 < Zb.call(fa, za);
            },
            ta,
            !0
          ),
          Da = [
            function (za, Fa, Pa) {
              return (
                (!oa && (Pa || Fa !== Sa)) ||
                ((fa = Fa).nodeType ? xa(za, Fa, Pa) : va(za, Fa, Pa))
              );
            },
          ];
        sa < la;
        sa++
      )
        if ((ta = Ka.relative[W[sa].type])) Da = [ra(Ba(Da), ta)];
        else {
          ta = Ka.filter[W[sa].type].apply(null, W[sa].matches);
          if (ta[La]) {
            for (Z = ++sa; Z < la && !Ka.relative[W[Z].type]; Z++);
            return Ya(
              1 < sa && Ba(Da),
              1 < sa && na(W.slice(0, sa - 1)).replace(Mb, "$1"),
              ta,
              sa < Z && Ra(W.slice(sa, Z)),
              Z < la && Ra((W = W.slice(Z))),
              Z < la && na(W)
            );
          }
          Da.push(ta);
        }
      return Ba(Da);
    }
    function eb(W, fa) {
      var Z = 0,
        la = 0 < fa.length,
        oa = 0 < W.length,
        ta = function (sa, xa, va, Da, za) {
          var Fa,
            Pa,
            db = [],
            Qa = 0,
            Ga = "0",
            Za = sa && [],
            Ta = null != za,
            Ob = Sa,
            ib = sa || (oa && Ka.find.TAG("*", (za && xa.parentNode) || xa)),
            tc = (Oa += null == Ob ? 1 : Math.random() || 0.1);
          Ta && ((Sa = xa !== Ca && xa), (Xa = Z));
          for (; null != (za = ib[Ga]); Ga++) {
            if (oa && za) {
              for (Fa = 0; (Pa = W[Fa++]); )
                if (Pa(za, xa, va)) {
                  Da.push(za);
                  break;
                }
              Ta && ((Oa = tc), (Xa = ++Z));
            }
            la && ((za = !Pa && za) && Qa--, sa && Za.push(za));
          }
          Qa += Ga;
          if (la && Ga !== Qa) {
            for (Fa = 0; (Pa = fa[Fa++]); ) Pa(Za, db, xa, va);
            if (sa) {
              if (0 < Qa)
                for (; Ga--; ) Za[Ga] || db[Ga] || (db[Ga] = jd.call(Da));
              db = Na(db);
            }
            zb.apply(Da, db);
            Ta &&
              !sa &&
              0 < db.length &&
              1 < Qa + fa.length &&
              M.uniqueSort(Da);
          }
          Ta && ((Oa = tc), (Sa = Ob));
          return Za;
        };
      return la ? E(ta) : ta;
    }
    function Ib() {}
    var Aa,
      Xa,
      Ea,
      Sa,
      Ca,
      Wa,
      Ma,
      Ua,
      fb,
      bb,
      Va,
      tb,
      La = "sizzle" + -new Date(),
      lb = f.document,
      Ia = {},
      Oa = 0,
      gb = 0,
      $a = x(),
      sb = x(),
      ab = x(),
      jb = typeof l,
      ub = [],
      jd = ub.pop,
      zb = ub.push,
      Ab = ub.slice,
      Zb =
        ub.indexOf ||
        function (W) {
          for (var fa = 0, Z = this.length; fa < Z; fa++)
            if (this[fa] === W) return fa;
          return -1;
        };
    ub = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w", "w#");
    var uc =
        "\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|(" +
        ub +
        ")|)|)[\\x20\\t\\r\\n\\f]*\\]",
      $b =
        ":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|" +
        uc.replace(3, 8) +
        ")*)|.*)\\)|)",
      Mb = /^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,
      hd = /^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,
      id = /^[\x20\t\r\n\f]*([\x20\t\r\n\f>+~])[\x20\t\r\n\f]*/,
      kd = new RegExp($b),
      ld = new RegExp("^" + ub + "$"),
      Nb = {
        ID: /^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,
        CLASS: /^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,
        NAME: /^\[name=['"]?((?:\\.|[\w-]|[^\x00-\xa0])+)['"]?\]/,
        TAG: new RegExp(
          "^(" + "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w", "w*") + ")"
        ),
        ATTR: new RegExp("^" + uc),
        PSEUDO: new RegExp("^" + $b),
        CHILD:
          /^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,
        needsContext:
          /^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i,
      },
      Yb = /[\x20\t\r\n\f]*[+~]/,
      ac = /^[^{]+\{\s*\[native code/,
      fd = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
      md = /^(?:input|select|textarea|button)$/i,
      nd = /^h\d$/i,
      gd = /'|\\/g,
      od = /=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,
      ob = /\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,
      pb = function (W, fa) {
        W = "0x" + fa - 65536;
        return W !== W
          ? fa
          : 0 > W
          ? String.fromCharCode(W + 65536)
          : String.fromCharCode((W >> 10) | 55296, (W & 1023) | 56320);
      };
    try {
      Ab.call(lb.documentElement.childNodes, 0)[0].nodeType;
    } catch (W) {
      Ab = function (fa) {
        for (var Z, la = []; (Z = this[fa++]); ) la.push(Z);
        return la;
      };
    }
    var pd = (M.isXML = function (W) {
      return (W = W && (W.ownerDocument || W).documentElement)
        ? "HTML" !== W.nodeName
        : !1;
    });
    var Hb = (M.setDocument = function (W) {
      var fa = W ? W.ownerDocument || W : lb;
      if (fa === Ca || 9 !== fa.nodeType || !fa.documentElement) return Ca;
      Ca = fa;
      Wa = fa.documentElement;
      Ma = pd(fa);
      Ia.tagNameNoComments = J(function (Z) {
        Z.appendChild(fa.createComment(""));
        return !Z.getElementsByTagName("*").length;
      });
      Ia.attributes = J(function (Z) {
        Z.innerHTML = "<select></select>";
        Z = typeof Z.lastChild.getAttribute("multiple");
        return "boolean" !== Z && "string" !== Z;
      });
      Ia.getByClassName = J(function (Z) {
        Z.innerHTML = "<div class='hidden e'></div><div class='hidden'></div>";
        if (!Z.getElementsByClassName || !Z.getElementsByClassName("e").length)
          return !1;
        Z.lastChild.className = "e";
        return 2 === Z.getElementsByClassName("e").length;
      });
      Ia.getByName = J(function (Z) {
        Z.id = La + 0;
        Z.innerHTML = "<a name='" + La + "'></a><div name='" + La + "'></div>";
        Wa.insertBefore(Z, Wa.firstChild);
        var la =
          fa.getElementsByName &&
          fa.getElementsByName(La).length ===
            2 + fa.getElementsByName(La + 0).length;
        Ia.getIdNotName = !fa.getElementById(La);
        Wa.removeChild(Z);
        return la;
      });
      Ka.attrHandle = J(function (Z) {
        Z.innerHTML = "<a href='#'></a>";
        return (
          Z.firstChild &&
          typeof Z.firstChild.getAttribute !== jb &&
          "#" === Z.firstChild.getAttribute("href")
        );
      })
        ? {}
        : {
            href: function (Z) {
              return Z.getAttribute("href", 2);
            },
            type: function (Z) {
              return Z.getAttribute("type");
            },
          };
      Ia.getIdNotName
        ? ((Ka.find.ID = function (Z, la) {
            if (typeof la.getElementById !== jb && !Ma)
              return (Z = la.getElementById(Z)) && Z.parentNode ? [Z] : [];
          }),
          (Ka.filter.ID = function (Z) {
            var la = Z.replace(ob, pb);
            return function (oa) {
              return oa.getAttribute("id") === la;
            };
          }))
        : ((Ka.find.ID = function (Z, la) {
            if (typeof la.getElementById !== jb && !Ma)
              return (la = la.getElementById(Z))
                ? la.id === Z ||
                  (typeof la.getAttributeNode !== jb &&
                    la.getAttributeNode("id").value === Z)
                  ? [la]
                  : l
                : [];
          }),
          (Ka.filter.ID = function (Z) {
            var la = Z.replace(ob, pb);
            return function (oa) {
              return (
                (oa =
                  typeof oa.getAttributeNode !== jb &&
                  oa.getAttributeNode("id")) && oa.value === la
              );
            };
          }));
      Ka.find.TAG = Ia.tagNameNoComments
        ? function (Z, la) {
            if (typeof la.getElementsByTagName !== jb)
              return la.getElementsByTagName(Z);
          }
        : function (Z, la) {
            var oa = [],
              ta = 0;
            la = la.getElementsByTagName(Z);
            if ("*" === Z) {
              for (; (Z = la[ta++]); ) 1 === Z.nodeType && oa.push(Z);
              return oa;
            }
            return la;
          };
      Ka.find.NAME =
        Ia.getByName &&
        function (Z, la) {
          if (typeof la.getElementsByName !== jb)
            return la.getElementsByName(name);
        };
      Ka.find.CLASS =
        Ia.getByClassName &&
        function (Z, la) {
          if (typeof la.getElementsByClassName !== jb && !Ma)
            return la.getElementsByClassName(Z);
        };
      fb = [];
      Ua = [":focus"];
      if ((Ia.qsa = ac.test(fa.querySelectorAll + "")))
        J(function (Z) {
          Z.innerHTML = "<select><option selected=''></option></select>";
          Z.querySelectorAll("[selected]").length ||
            Ua.push(
              "\\[[\\x20\\t\\r\\n\\f]*(?:checked|disabled|ismap|multiple|readonly|selected|value)"
            );
          Z.querySelectorAll(":checked").length || Ua.push(":checked");
        }),
          J(function (Z) {
            Z.innerHTML = "<input type='hidden' i=''/>";
            Z.querySelectorAll("[i^='']").length &&
              Ua.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:\"\"|'')");
            Z.querySelectorAll(":enabled").length ||
              Ua.push(":enabled", ":disabled");
            Z.querySelectorAll("*,:x");
            Ua.push(",.*:");
          });
      (Ia.matchesSelector = ac.test(
        (bb =
          Wa.matchesSelector ||
          Wa.mozMatchesSelector ||
          Wa.webkitMatchesSelector ||
          Wa.oMatchesSelector ||
          Wa.msMatchesSelector) + ""
      )) &&
        J(function (Z) {
          Ia.disconnectedMatch = bb.call(Z, "div");
          bb.call(Z, "[s!='']:x");
          fb.push("!=", $b);
        });
      Ua = new RegExp(Ua.join("|"));
      fb = new RegExp(fb.join("|"));
      Va =
        ac.test(Wa.contains + "") || Wa.compareDocumentPosition
          ? function (Z, la) {
              var oa = 9 === Z.nodeType ? Z.documentElement : Z;
              la = la && la.parentNode;
              return (
                Z === la ||
                !!(
                  la &&
                  1 === la.nodeType &&
                  (oa.contains
                    ? oa.contains(la)
                    : Z.compareDocumentPosition &&
                      Z.compareDocumentPosition(la) & 16)
                )
              );
            }
          : function (Z, la) {
              if (la) for (; (la = la.parentNode); ) if (la === Z) return !0;
              return !1;
            };
      tb = Wa.compareDocumentPosition
        ? function (Z, la) {
            var oa;
            return Z === la
              ? ((Ea = !0), 0)
              : (oa =
                  la.compareDocumentPosition &&
                  Z.compareDocumentPosition &&
                  Z.compareDocumentPosition(la))
              ? oa & 1 || (Z.parentNode && 11 === Z.parentNode.nodeType)
                ? Z === fa || Va(lb, Z)
                  ? -1
                  : la === fa || Va(lb, la)
                  ? 1
                  : 0
                : oa & 4
                ? -1
                : 1
              : Z.compareDocumentPosition
              ? -1
              : 1;
          }
        : function (Z, la) {
            var oa = 0,
              ta = Z.parentNode,
              sa = la.parentNode,
              xa = [Z],
              va = [la];
            if (Z === la) return (Ea = !0), 0;
            if (!ta || !sa)
              return Z === fa ? -1 : la === fa ? 1 : ta ? -1 : sa ? 1 : 0;
            if (ta === sa) return Y(Z, la);
            for (; (Z = Z.parentNode); ) xa.unshift(Z);
            for (Z = la; (Z = Z.parentNode); ) va.unshift(Z);
            for (; xa[oa] === va[oa]; ) oa++;
            return oa
              ? Y(xa[oa], va[oa])
              : xa[oa] === lb
              ? -1
              : va[oa] === lb
              ? 1
              : 0;
          };
      Ea = !1;
      [0, 0].sort(tb);
      Ia.detectDuplicates = Ea;
      return Ca;
    });
    M.matches = function (W, fa) {
      return M(W, null, null, fa);
    };
    M.matchesSelector = function (W, fa) {
      (W.ownerDocument || W) !== Ca && Hb(W);
      fa = fa.replace(od, "='$1']");
      if (!(!Ia.matchesSelector || Ma || (fb && fb.test(fa)) || Ua.test(fa)))
        try {
          var Z = bb.call(W, fa);
          if (
            Z ||
            Ia.disconnectedMatch ||
            (W.document && 11 !== W.document.nodeType)
          )
            return Z;
        } catch (la) {}
      return 0 < M(fa, Ca, null, [W]).length;
    };
    M.contains = function (W, fa) {
      (W.ownerDocument || W) !== Ca && Hb(W);
      return Va(W, fa);
    };
    M.attr = function (W, fa) {
      var Z;
      (W.ownerDocument || W) !== Ca && Hb(W);
      Ma || (fa = fa.toLowerCase());
      return (Z = Ka.attrHandle[fa])
        ? Z(W)
        : Ma || Ia.attributes
        ? W.getAttribute(fa)
        : ((Z = W.getAttributeNode(fa)) || W.getAttribute(fa)) && !0 === W[fa]
        ? fa
        : Z && Z.specified
        ? Z.value
        : null;
    };
    M.error = function (W) {
      throw Error("Syntax error, unrecognized expression: " + W);
    };
    M.uniqueSort = function (W) {
      var fa,
        Z = [],
        la = 1,
        oa = 0;
      Ea = !Ia.detectDuplicates;
      W.sort(tb);
      if (Ea) {
        for (; (fa = W[la]); la++) fa === W[la - 1] && (oa = Z.push(la));
        for (; oa--; ) W.splice(Z[oa], 1);
      }
      return W;
    };
    var bc = (M.getText = function (W) {
      var fa = "",
        Z = 0;
      var la = W.nodeType;
      if (!la) for (; (la = W[Z]); Z++) fa += bc(la);
      else if (1 === la || 9 === la || 11 === la) {
        if ("string" === typeof W.textContent) return W.textContent;
        for (W = W.firstChild; W; W = W.nextSibling) fa += bc(W);
      } else if (3 === la || 4 === la) return W.nodeValue;
      return fa;
    });
    var Ka = (M.selectors = {
      cacheLength: 50,
      createPseudo: E,
      match: Nb,
      find: {},
      relative: {
        ">": { dir: "parentNode", first: !0 },
        " ": { dir: "parentNode" },
        "+": { dir: "previousSibling", first: !0 },
        "~": { dir: "previousSibling" },
      },
      preFilter: {
        ATTR: function (W) {
          W[1] = W[1].replace(ob, pb);
          W[3] = (W[4] || W[5] || "").replace(ob, pb);
          "~=" === W[2] && (W[3] = " " + W[3] + " ");
          return W.slice(0, 4);
        },
        CHILD: function (W) {
          W[1] = W[1].toLowerCase();
          "nth" === W[1].slice(0, 3)
            ? (W[3] || M.error(W[0]),
              (W[4] = +(W[4]
                ? W[5] + (W[6] || 1)
                : 2 * ("even" === W[3] || "odd" === W[3]))),
              (W[5] = +(W[7] + W[8] || "odd" === W[3])))
            : W[3] && M.error(W[0]);
          return W;
        },
        PSEUDO: function (W) {
          var fa,
            Z = !W[5] && W[2];
          if (Nb.CHILD.test(W[0])) return null;
          W[4]
            ? (W[2] = W[4])
            : Z &&
              kd.test(Z) &&
              (fa = pa(Z, !0)) &&
              (fa = Z.indexOf(")", Z.length - fa) - Z.length) &&
              ((W[0] = W[0].slice(0, fa)), (W[2] = Z.slice(0, fa)));
          return W.slice(0, 3);
        },
      },
      filter: {
        TAG: function (W) {
          if ("*" === W)
            return function () {
              return !0;
            };
          W = W.replace(ob, pb).toLowerCase();
          return function (fa) {
            return fa.nodeName && fa.nodeName.toLowerCase() === W;
          };
        },
        CLASS: function (W) {
          var fa = $a[W + " "];
          return (
            fa ||
            ((fa = new RegExp(
              "(^|[\\x20\\t\\r\\n\\f])" + W + "([\\x20\\t\\r\\n\\f]|$)"
            )),
            $a(W, function (Z) {
              return fa.test(
                Z.className ||
                  (typeof Z.getAttribute !== jb && Z.getAttribute("class")) ||
                  ""
              );
            }))
          );
        },
        ATTR: function (W, fa, Z) {
          return function (la) {
            la = M.attr(la, W);
            if (null == la) return "!=" === fa;
            if (!fa) return !0;
            la += "";
            return "=" === fa
              ? la === Z
              : "!=" === fa
              ? la !== Z
              : "^=" === fa
              ? Z && 0 === la.indexOf(Z)
              : "*=" === fa
              ? Z && -1 < la.indexOf(Z)
              : "$=" === fa
              ? Z && la.slice(-Z.length) === Z
              : "~=" === fa
              ? -1 < (" " + la + " ").indexOf(Z)
              : "|=" === fa
              ? la === Z || la.slice(0, Z.length + 1) === Z + "-"
              : !1;
          };
        },
        CHILD: function (W, fa, Z, la, oa) {
          var ta = "nth" !== W.slice(0, 3),
            sa = "last" !== W.slice(-4),
            xa = "of-type" === fa;
          return 1 === la && 0 === oa
            ? function (va) {
                return !!va.parentNode;
              }
            : function (va, Da, za) {
                var Fa;
                Da = ta !== sa ? "nextSibling" : "previousSibling";
                var Pa = va.parentNode,
                  db = xa && va.nodeName.toLowerCase();
                za = !za && !xa;
                if (Pa) {
                  if (ta) {
                    for (; Da; ) {
                      for (Fa = va; (Fa = Fa[Da]); )
                        if (
                          xa
                            ? Fa.nodeName.toLowerCase() === db
                            : 1 === Fa.nodeType
                        )
                          return !1;
                      var Qa = (Da = "only" === W && !Qa && "nextSibling");
                    }
                    return !0;
                  }
                  Qa = [sa ? Pa.firstChild : Pa.lastChild];
                  if (sa && za) {
                    za = Pa[La] || (Pa[La] = {});
                    var Ga = za[W] || [];
                    var Za = Ga[0] === Oa && Ga[1];
                    var Ta = Ga[0] === Oa && Ga[2];
                    for (
                      Fa = Za && Pa.childNodes[Za];
                      (Fa =
                        (++Za && Fa && Fa[Da]) || (Ta = Za = 0) || Qa.pop());

                    )
                      if (1 === Fa.nodeType && ++Ta && Fa === va) {
                        za[W] = [Oa, Za, Ta];
                        break;
                      }
                  } else if (
                    za &&
                    (Ga = (va[La] || (va[La] = {}))[W]) &&
                    Ga[0] === Oa
                  )
                    Ta = Ga[1];
                  else
                    for (
                      ;
                      (Fa =
                        (++Za && Fa && Fa[Da]) || (Ta = Za = 0) || Qa.pop()) &&
                      ((xa
                        ? Fa.nodeName.toLowerCase() !== db
                        : 1 !== Fa.nodeType) ||
                        !++Ta ||
                        (za && ((Fa[La] || (Fa[La] = {}))[W] = [Oa, Ta]),
                        Fa !== va));

                    );
                  Ta -= oa;
                  return Ta === la || (0 === Ta % la && 0 <= Ta / la);
                }
              };
        },
        PSEUDO: function (W, fa) {
          var Z =
            Ka.pseudos[W] ||
            Ka.setFilters[W.toLowerCase()] ||
            M.error("unsupported pseudo: " + W);
          if (Z[La]) return Z(fa);
          if (1 < Z.length) {
            var la = [W, W, "", fa];
            return Ka.setFilters.hasOwnProperty(W.toLowerCase())
              ? E(function (oa, ta) {
                  for (var sa, xa = Z(oa, fa), va = xa.length; va--; )
                    (sa = Zb.call(oa, xa[va])), (oa[sa] = !(ta[sa] = xa[va]));
                })
              : function (oa) {
                  return Z(oa, 0, la);
                };
          }
          return Z;
        },
      },
      pseudos: {
        not: E(function (W) {
          var fa = [],
            Z = [],
            la = sc(W.replace(Mb, "$1"));
          return la[La]
            ? E(function (oa, ta, sa, xa) {
                xa = la(oa, null, xa, []);
                for (var va = oa.length; va--; )
                  if ((sa = xa[va])) oa[va] = !(ta[va] = sa);
              })
            : function (oa, ta, sa) {
                fa[0] = oa;
                la(fa, null, sa, Z);
                return !Z.pop();
              };
        }),
        has: E(function (W) {
          return function (fa) {
            return 0 < M(W, fa).length;
          };
        }),
        contains: E(function (W) {
          return function (fa) {
            return -1 < (fa.textContent || fa.innerText || bc(fa)).indexOf(W);
          };
        }),
        lang: E(function (W) {
          ld.test(W || "") || M.error("unsupported lang: " + W);
          W = W.replace(ob, pb).toLowerCase();
          return function (fa) {
            var Z;
            do
              if (
                (Z = Ma
                  ? fa.getAttribute("xml:lang") || fa.getAttribute("lang")
                  : fa.lang)
              )
                return (
                  (Z = Z.toLowerCase()), Z === W || 0 === Z.indexOf(W + "-")
                );
            while ((fa = fa.parentNode) && 1 === fa.nodeType);
            return !1;
          };
        }),
        target: function (W) {
          var fa = f.location && f.location.hash;
          return fa && fa.slice(1) === W.id;
        },
        root: function (W) {
          return W === Wa;
        },
        focus: function (W) {
          return (
            W === Ca.activeElement &&
            (!Ca.hasFocus || Ca.hasFocus()) &&
            !!(W.type || W.href || ~W.tabIndex)
          );
        },
        enabled: function (W) {
          return !1 === W.disabled;
        },
        disabled: function (W) {
          return !0 === W.disabled;
        },
        checked: function (W) {
          var fa = W.nodeName.toLowerCase();
          return (
            ("input" === fa && !!W.checked) || ("option" === fa && !!W.selected)
          );
        },
        selected: function (W) {
          W.parentNode && W.parentNode.selectedIndex;
          return !0 === W.selected;
        },
        empty: function (W) {
          for (W = W.firstChild; W; W = W.nextSibling)
            if ("@" < W.nodeName || 3 === W.nodeType || 4 === W.nodeType)
              return !1;
          return !0;
        },
        parent: function (W) {
          return !Ka.pseudos.empty(W);
        },
        header: function (W) {
          return nd.test(W.nodeName);
        },
        input: function (W) {
          return md.test(W.nodeName);
        },
        button: function (W) {
          var fa = W.nodeName.toLowerCase();
          return ("input" === fa && "button" === W.type) || "button" === fa;
        },
        text: function (W) {
          var fa;
          return (
            "input" === W.nodeName.toLowerCase() &&
            "text" === W.type &&
            (null == (fa = W.getAttribute("type")) ||
              fa.toLowerCase() === W.type)
          );
        },
        first: ja(function () {
          return [0];
        }),
        last: ja(function (W, fa) {
          return [fa - 1];
        }),
        eq: ja(function (W, fa, Z) {
          return [0 > Z ? Z + fa : Z];
        }),
        even: ja(function (W, fa) {
          for (var Z = 0; Z < fa; Z += 2) W.push(Z);
          return W;
        }),
        odd: ja(function (W, fa) {
          for (var Z = 1; Z < fa; Z += 2) W.push(Z);
          return W;
        }),
        lt: ja(function (W, fa, Z) {
          for (fa = 0 > Z ? Z + fa : Z; 0 <= --fa; ) W.push(fa);
          return W;
        }),
        gt: ja(function (W, fa, Z) {
          for (Z = 0 > Z ? Z + fa : Z; ++Z < fa; ) W.push(Z);
          return W;
        }),
      },
    });
    for (Aa in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 })
      Ka.pseudos[Aa] = da(Aa);
    for (Aa in { submit: !0, reset: !0 }) Ka.pseudos[Aa] = ia(Aa);
    var sc = (M.compile = function (W, fa) {
      var Z,
        la = [],
        oa = [],
        ta = ab[W + " "];
      if (!ta) {
        fa || (fa = pa(W));
        for (Z = fa.length; Z--; )
          (ta = Ra(fa[Z])), ta[La] ? la.push(ta) : oa.push(ta);
        ta = ab(W, eb(oa, la));
      }
      return ta;
    });
    Ka.pseudos.nth = Ka.pseudos.eq;
    Ka.filters = Ib.prototype = Ka.pseudos;
    Ka.setFilters = new Ib();
    Hb();
    M.attr = v.attr;
    v.find = M;
    v.expr = M.selectors;
    v.expr[":"] = v.expr.pseudos;
    v.unique = M.uniqueSort;
    v.text = M.getText;
    v.isXMLDoc = M.isXML;
    v.contains = M.contains;
  })(a);
  var qd = /Until$/,
    rd = /^(?:parents|prev(?:Until|All))/,
    Mc = /^.[^:#\[\.,]*$/,
    vc = v.expr.match.needsContext,
    sd = { children: !0, contents: !0, next: !0, prev: !0 };
  v.fn.extend({
    find: function (f) {
      var l,
        x = this.length;
      if ("string" !== typeof f) {
        var E = this;
        return this.pushStack(
          v(f).filter(function () {
            for (l = 0; l < x; l++) if (v.contains(E[l], this)) return !0;
          })
        );
      }
      var J = [];
      for (l = 0; l < x; l++) v.find(f, this[l], J);
      J = this.pushStack(1 < x ? v.unique(J) : J);
      J.selector = (this.selector ? this.selector + " " : "") + f;
      return J;
    },
    has: function (f) {
      var l,
        x = v(f, this),
        E = x.length;
      return this.filter(function () {
        for (l = 0; l < E; l++) if (v.contains(this, x[l])) return !0;
      });
    },
    not: function (f) {
      return this.pushStack(A(this, f, !1));
    },
    filter: function (f) {
      return this.pushStack(A(this, f, !0));
    },
    is: function (f) {
      return (
        !!f &&
        ("string" === typeof f
          ? vc.test(f)
            ? 0 <= v(f, this.context).index(this[0])
            : 0 < v.filter(f, this).length
          : 0 < this.filter(f).length)
      );
    },
    closest: function (f, l) {
      for (
        var x,
          E = 0,
          J = this.length,
          M = [],
          Y = vc.test(f) || "string" !== typeof f ? v(f, l || this.context) : 0;
        E < J;
        E++
      )
        for (
          x = this[E];
          x && x.ownerDocument && x !== l && 11 !== x.nodeType;

        ) {
          if (Y ? -1 < Y.index(x) : v.find.matchesSelector(x, f)) {
            M.push(x);
            break;
          }
          x = x.parentNode;
        }
      return this.pushStack(1 < M.length ? v.unique(M) : M);
    },
    index: function (f) {
      return f
        ? "string" === typeof f
          ? v.inArray(this[0], v(f))
          : v.inArray(f.jquery ? f[0] : f, this)
        : this[0] && this[0].parentNode
        ? this.first().prevAll().length
        : -1;
    },
    add: function (f, l) {
      f =
        "string" === typeof f
          ? v(f, l)
          : v.makeArray(f && f.nodeType ? [f] : f);
      f = v.merge(this.get(), f);
      return this.pushStack(v.unique(f));
    },
    addBack: function (f) {
      return this.add(null == f ? this.prevObject : this.prevObject.filter(f));
    },
  });
  v.fn.andSelf = v.fn.addBack;
  v.each(
    {
      parent: function (f) {
        return (f = f.parentNode) && 11 !== f.nodeType ? f : null;
      },
      parents: function (f) {
        return v.dir(f, "parentNode");
      },
      parentsUntil: function (f, l, x) {
        return v.dir(f, "parentNode", x);
      },
      next: function (f) {
        return u(f, "nextSibling");
      },
      prev: function (f) {
        return u(f, "previousSibling");
      },
      nextAll: function (f) {
        return v.dir(f, "nextSibling");
      },
      prevAll: function (f) {
        return v.dir(f, "previousSibling");
      },
      nextUntil: function (f, l, x) {
        return v.dir(f, "nextSibling", x);
      },
      prevUntil: function (f, l, x) {
        return v.dir(f, "previousSibling", x);
      },
      siblings: function (f) {
        return v.sibling((f.parentNode || {}).firstChild, f);
      },
      children: function (f) {
        return v.sibling(f.firstChild);
      },
      contents: function (f) {
        return v.nodeName(f, "iframe")
          ? f.contentDocument || f.contentWindow.document
          : v.merge([], f.childNodes);
      },
    },
    function (f, l) {
      v.fn[f] = function (x, E) {
        var J = v.map(this, l, x);
        qd.test(f) || (E = x);
        E && "string" === typeof E && (J = v.filter(E, J));
        J = 1 < this.length && !sd[f] ? v.unique(J) : J;
        1 < this.length && rd.test(f) && (J = J.reverse());
        return this.pushStack(J);
      };
    }
  );
  v.extend({
    filter: function (f, l, x) {
      x && (f = ":not(" + f + ")");
      return 1 === l.length
        ? v.find.matchesSelector(l[0], f)
          ? [l[0]]
          : []
        : v.find.matches(f, l);
    },
    dir: function (f, l, x) {
      var E = [];
      for (
        f = f[l];
        f && 9 !== f.nodeType && (x === b || 1 !== f.nodeType || !v(f).is(x));

      )
        1 === f.nodeType && E.push(f), (f = f[l]);
      return E;
    },
    sibling: function (f, l) {
      for (var x = []; f; f = f.nextSibling)
        1 === f.nodeType && f !== l && x.push(f);
      return x;
    },
  });
  var kc =
      "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
    td = / jQuery\d+="(?:null|\d+)"/g,
    wc = new RegExp("<(?:" + kc + ")[\\s/>]", "i"),
    cc = /^\s+/,
    xc =
      /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
    yc = /<([\w:]+)/,
    zc = /<tbody/i,
    ud = /<|&#?\w+;/,
    vd = /<(?:script|style|link)/i,
    Rb = /^(?:checkbox|radio)$/i,
    wd = /checked\s*(?:[^=]|=\s*.checked.)/i,
    Ac = /^$|\/(?:java|ecma)script/i,
    Nc = /^true\/(.*)/,
    xd = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
    hb = {
      option: [1, "<select multiple='multiple'>", "</select>"],
      legend: [1, "<fieldset>", "</fieldset>"],
      area: [1, "<map>", "</map>"],
      param: [1, "<object>", "</object>"],
      thead: [1, "<table>", "</table>"],
      tr: [2, "<table><tbody>", "</tbody></table>"],
      col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
      td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
      _default: v.support.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"],
    },
    dc = G(Q).appendChild(Q.createElement("div"));
  hb.optgroup = hb.option;
  hb.tbody = hb.tfoot = hb.colgroup = hb.caption = hb.thead;
  hb.th = hb.td;
  v.fn.extend({
    text: function (f) {
      return v.access(
        this,
        function (l) {
          return l === b
            ? v.text(this)
            : this.empty().append(
                ((this[0] && this[0].ownerDocument) || Q).createTextNode(l)
              );
        },
        null,
        f,
        arguments.length
      );
    },
    wrapAll: function (f) {
      if (v.isFunction(f))
        return this.each(function (x) {
          v(this).wrapAll(f.call(this, x));
        });
      if (this[0]) {
        var l = v(f, this[0].ownerDocument).eq(0).clone(!0);
        this[0].parentNode && l.insertBefore(this[0]);
        l.map(function () {
          for (var x = this; x.firstChild && 1 === x.firstChild.nodeType; )
            x = x.firstChild;
          return x;
        }).append(this);
      }
      return this;
    },
    wrapInner: function (f) {
      return v.isFunction(f)
        ? this.each(function (l) {
            v(this).wrapInner(f.call(this, l));
          })
        : this.each(function () {
            var l = v(this),
              x = l.contents();
            x.length ? x.wrapAll(f) : l.append(f);
          });
    },
    wrap: function (f) {
      var l = v.isFunction(f);
      return this.each(function (x) {
        v(this).wrapAll(l ? f.call(this, x) : f);
      });
    },
    unwrap: function () {
      return this.parent()
        .each(function () {
          v.nodeName(this, "body") || v(this).replaceWith(this.childNodes);
        })
        .end();
    },
    append: function () {
      return this.domManip(arguments, !0, function (f) {
        (1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType) ||
          this.appendChild(f);
      });
    },
    prepend: function () {
      return this.domManip(arguments, !0, function (f) {
        (1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType) ||
          this.insertBefore(f, this.firstChild);
      });
    },
    before: function () {
      return this.domManip(arguments, !1, function (f) {
        this.parentNode && this.parentNode.insertBefore(f, this);
      });
    },
    after: function () {
      return this.domManip(arguments, !1, function (f) {
        this.parentNode && this.parentNode.insertBefore(f, this.nextSibling);
      });
    },
    remove: function (f, l) {
      for (var x, E = 0; null != (x = this[E]); E++)
        if (!f || 0 < v.filter(f, [x]).length)
          l || 1 !== x.nodeType || v.cleanData(w(x)),
            x.parentNode &&
              (l && v.contains(x.ownerDocument, x) && U(w(x, "script")),
              x.parentNode.removeChild(x));
      return this;
    },
    empty: function () {
      for (var f, l = 0; null != (f = this[l]); l++) {
        for (1 === f.nodeType && v.cleanData(w(f, !1)); f.firstChild; )
          f.removeChild(f.firstChild);
        f.options && v.nodeName(f, "select") && (f.options.length = 0);
      }
      return this;
    },
    clone: function (f, l) {
      f = null == f ? !1 : f;
      l = null == l ? f : l;
      return this.map(function () {
        return v.clone(this, f, l);
      });
    },
    html: function (f) {
      return v.access(
        this,
        function (l) {
          var x = this[0] || {},
            E = 0,
            J = this.length;
          if (l === b)
            return 1 === x.nodeType ? x.innerHTML.replace(td, "") : b;
          if (
            !(
              "string" !== typeof l ||
              vd.test(l) ||
              (!v.support.htmlSerialize && wc.test(l)) ||
              (!v.support.leadingWhitespace && cc.test(l)) ||
              hb[(yc.exec(l) || ["", ""])[1].toLowerCase()]
            )
          ) {
            l = l.replace(xc, "<$1></$2>");
            try {
              for (; E < J; E++)
                (x = this[E] || {}),
                  1 === x.nodeType &&
                    (v.cleanData(w(x, !1)), (x.innerHTML = l));
              x = 0;
            } catch (M) {}
          }
          x && this.empty().append(l);
        },
        null,
        f,
        arguments.length
      );
    },
    replaceWith: function (f) {
      v.isFunction(f) || "string" === typeof f || (f = v(f).not(this).detach());
      return this.domManip([f], !0, function (l) {
        var x = this.nextSibling,
          E = this.parentNode;
        E && (v(this).remove(), E.insertBefore(l, x));
      });
    },
    detach: function (f) {
      return this.remove(f, !0);
    },
    domManip: function (f, l, x) {
      f = ua.apply([], f);
      var E,
        J = 0,
        M = this.length,
        Y = this,
        da = M - 1,
        ia = f[0],
        ja = v.isFunction(ia);
      if (
        ja ||
        (!(1 >= M || "string" !== typeof ia || v.support.checkClone) &&
          wd.test(ia))
      )
        return this.each(function (Ba) {
          var Na = Y.eq(Ba);
          ja && (f[0] = ia.call(this, Ba, l ? Na.html() : b));
          Na.domManip(f, l, x);
        });
      if (M) {
        var pa = v.buildFragment(f, this[0].ownerDocument, !1, this);
        var na = pa.firstChild;
        1 === pa.childNodes.length && (pa = na);
        if (na) {
          l = l && v.nodeName(na, "tr");
          var ra = v.map(w(pa, "script"), H);
          for (E = ra.length; J < M; J++)
            (na = pa),
              J !== da &&
                ((na = v.clone(na, !0, !0)), E && v.merge(ra, w(na, "script"))),
              x.call(
                l && v.nodeName(this[J], "table")
                  ? O(this[J], "tbody")
                  : this[J],
                na,
                J
              );
          if (E)
            for (
              pa = ra[ra.length - 1].ownerDocument, v.map(ra, P), J = 0;
              J < E;
              J++
            )
              (na = ra[J]),
                Ac.test(na.type || "") &&
                  !v._data(na, "globalEval") &&
                  v.contains(pa, na) &&
                  (na.src
                    ? v.ajax({
                        url: na.src,
                        type: "GET",
                        dataType: "script",
                        async: !1,
                        global: !1,
                        throws: !0,
                      })
                    : v.globalEval(
                        (
                          na.text ||
                          na.textContent ||
                          na.innerHTML ||
                          ""
                        ).replace(xd, "")
                      ));
          pa = na = null;
        }
      }
      return this;
    },
  });
  v.each(
    {
      appendTo: "append",
      prependTo: "prepend",
      insertBefore: "before",
      insertAfter: "after",
      replaceAll: "replaceWith",
    },
    function (f, l) {
      v.fn[f] = function (x) {
        for (var E = 0, J = [], M = v(x), Y = M.length - 1; E <= Y; E++)
          (x = E === Y ? this : this.clone(!0)),
            v(M[E])[l](x),
            Ja.apply(J, x.get());
        return this.pushStack(J);
      };
    }
  );
  v.extend({
    clone: function (f, l, x) {
      var E,
        J,
        M = v.contains(f.ownerDocument, f);
      if (
        v.support.html5Clone ||
        v.isXMLDoc(f) ||
        !wc.test("<" + f.nodeName + ">")
      )
        var Y = f.cloneNode(!0);
      else (dc.innerHTML = f.outerHTML), dc.removeChild((Y = dc.firstChild));
      if (
        !(
          (v.support.noCloneEvent && v.support.noCloneChecked) ||
          (1 !== f.nodeType && 11 !== f.nodeType) ||
          v.isXMLDoc(f)
        )
      ) {
        var da = w(Y);
        var ia = w(f);
        for (J = 0; null != (E = ia[J]); ++J)
          if (da[J]) {
            var ja = void 0,
              pa = E,
              na = da[J];
            if (1 === na.nodeType) {
              var ra = na.nodeName.toLowerCase();
              if (!v.support.noCloneEvent && na[v.expando]) {
                E = v._data(na);
                for (ja in E.events) v.removeEvent(na, ja, E.handle);
                na.removeAttribute(v.expando);
              }
              if ("script" === ra && na.text !== pa.text)
                (H(na).text = pa.text), P(na);
              else if ("object" === ra)
                na.parentNode && (na.outerHTML = pa.outerHTML),
                  v.support.html5Clone &&
                    pa.innerHTML &&
                    !v.trim(na.innerHTML) &&
                    (na.innerHTML = pa.innerHTML);
              else if ("input" === ra && Rb.test(pa.type))
                (na.defaultChecked = na.checked = pa.checked),
                  na.value !== pa.value && (na.value = pa.value);
              else if ("option" === ra)
                na.defaultSelected = na.selected = pa.defaultSelected;
              else if ("input" === ra || "textarea" === ra)
                na.defaultValue = pa.defaultValue;
            }
          }
      }
      if (l)
        if (x)
          for (
            ia = ia || w(f), da = da || w(Y), J = 0;
            null != (E = ia[J]);
            J++
          )
            ha(E, da[J]);
        else ha(f, Y);
      da = w(Y, "script");
      0 < da.length && U(da, !M && w(f, "script"));
      return Y;
    },
    buildFragment: function (f, l, x, E) {
      for (
        var J, M, Y, da, ia, ja, pa = f.length, na = G(l), ra = [], Ba = 0;
        Ba < pa;
        Ba++
      )
        if ((M = f[Ba]) || 0 === M)
          if ("object" === v.type(M)) v.merge(ra, M.nodeType ? [M] : M);
          else if (ud.test(M)) {
            Y = Y || na.appendChild(l.createElement("div"));
            da = (yc.exec(M) || ["", ""])[1].toLowerCase();
            ja = hb[da] || hb._default;
            Y.innerHTML = ja[1] + M.replace(xc, "<$1></$2>") + ja[2];
            for (J = ja[0]; J--; ) Y = Y.lastChild;
            !v.support.leadingWhitespace &&
              cc.test(M) &&
              ra.push(l.createTextNode(cc.exec(M)[0]));
            if (!v.support.tbody)
              for (
                J =
                  (M =
                    "table" !== da || zc.test(M)
                      ? "<table>" !== ja[1] || zc.test(M)
                        ? 0
                        : Y
                      : Y.firstChild) && M.childNodes.length;
                J--;

              )
                v.nodeName((ia = M.childNodes[J]), "tbody") &&
                  !ia.childNodes.length &&
                  M.removeChild(ia);
            v.merge(ra, Y.childNodes);
            for (Y.textContent = ""; Y.firstChild; )
              Y.removeChild(Y.firstChild);
            Y = na.lastChild;
          } else ra.push(l.createTextNode(M));
      Y && na.removeChild(Y);
      v.support.appendChecked || v.grep(w(ra, "input"), I);
      for (Ba = 0; (M = ra[Ba++]); )
        if (!E || -1 === v.inArray(M, E))
          if (
            ((f = v.contains(M.ownerDocument, M)),
            (Y = w(na.appendChild(M), "script")),
            f && U(Y),
            x)
          )
            for (J = 0; (M = Y[J++]); ) Ac.test(M.type || "") && x.push(M);
      return na;
    },
    cleanData: function (f, l) {
      for (
        var x,
          E,
          J,
          M,
          Y = 0,
          da = v.expando,
          ia = v.cache,
          ja = v.support.deleteExpando,
          pa = v.event.special;
        null != (x = f[Y]);
        Y++
      )
        if (l || v.acceptData(x))
          if ((M = (J = x[da]) && ia[J])) {
            if (M.events)
              for (E in M.events)
                pa[E] ? v.event.remove(x, E) : v.removeEvent(x, E, M.handle);
            ia[J] &&
              (delete ia[J],
              ja
                ? delete x[da]
                : typeof x.removeAttribute !== ma
                ? x.removeAttribute(da)
                : (x[da] = null),
              ya.push(J));
          }
    },
  });
  var Db,
    ec = /alpha\([^)]*\)/i,
    yd = /opacity\s*=\s*([^)]*)/,
    zd = /^(top|right|bottom|left)$/,
    Ad = /^(none|table(?!-c[ea]).+)/,
    Bc = /^margin/,
    Oc = new RegExp("^(" + Lb + ")(.*)$", "i"),
    Jb = new RegExp("^(" + Lb + ")(?!px)[a-z%]+$", "i"),
    Bd = new RegExp("^([+-])=(" + Lb + ")", "i"),
    mc = { BODY: "block" },
    Cd = { position: "absolute", visibility: "hidden", display: "block" },
    Cc = { letterSpacing: 0, fontWeight: 400 },
    qb = ["Top", "Right", "Bottom", "Left"],
    lc = ["Webkit", "O", "Moz", "ms"];
  v.fn.extend({
    css: function (f, l) {
      return v.access(
        this,
        function (x, E, J) {
          var M = {},
            Y = 0;
          if (v.isArray(E)) {
            var da = wb(x);
            for (J = E.length; Y < J; Y++) M[E[Y]] = v.css(x, E[Y], !1, da);
            return M;
          }
          return J !== b ? v.style(x, E, J) : v.css(x, E);
        },
        f,
        l,
        1 < arguments.length
      );
    },
    show: function () {
      return ka(this, !0);
    },
    hide: function () {
      return ka(this);
    },
    toggle: function (f) {
      var l = "boolean" === typeof f;
      return this.each(function () {
        (l ? f : T(this)) ? v(this).show() : v(this).hide();
      });
    },
  });
  v.extend({
    cssHooks: {
      opacity: {
        get: function (f, l) {
          if (l) return (f = xb(f, "opacity")), "" === f ? "1" : f;
        },
      },
    },
    cssNumber: {
      columnCount: !0,
      fillOpacity: !0,
      fontWeight: !0,
      lineHeight: !0,
      opacity: !0,
      orphans: !0,
      widows: !0,
      zIndex: !0,
      zoom: !0,
    },
    cssProps: { float: v.support.cssFloat ? "cssFloat" : "styleFloat" },
    style: function (f, l, x, E) {
      if (f && 3 !== f.nodeType && 8 !== f.nodeType && f.style) {
        var J,
          M = v.camelCase(l),
          Y = f.style;
        l = v.cssProps[M] || (v.cssProps[M] = aa(Y, M));
        var da = v.cssHooks[l] || v.cssHooks[M];
        if (x !== b) {
          var ia = typeof x;
          "string" === ia &&
            (J = Bd.exec(x)) &&
            ((x = (J[1] + 1) * J[2] + parseFloat(v.css(f, l))),
            (ia = "number"));
          if (
            !(
              null == x ||
              ("number" === ia && isNaN(x)) ||
              ("number" !== ia || v.cssNumber[M] || (x += "px"),
              v.support.clearCloneStyle ||
                "" !== x ||
                0 !== l.indexOf("background") ||
                (Y[l] = "inherit"),
              da && "set" in da && (x = da.set(f, x, E)) === b)
            )
          )
            try {
              Y[l] = x;
            } catch (ja) {}
        } else
          return da && "get" in da && (J = da.get(f, !1, E)) !== b ? J : Y[l];
      }
    },
    css: function (f, l, x, E) {
      var J;
      var M = v.camelCase(l);
      l = v.cssProps[M] || (v.cssProps[M] = aa(f.style, M));
      (M = v.cssHooks[l] || v.cssHooks[M]) &&
        "get" in M &&
        (J = M.get(f, !0, x));
      J === b && (J = xb(f, l, E));
      "normal" === J && l in Cc && (J = Cc[l]);
      return "" === x || x
        ? ((f = parseFloat(J)), !0 === x || v.isNumeric(f) ? f || 0 : J)
        : J;
    },
    swap: function (f, l, x, E) {
      var J,
        M = {};
      for (J in l) (M[J] = f.style[J]), (f.style[J] = l[J]);
      x = x.apply(f, E || []);
      for (J in l) f.style[J] = M[J];
      return x;
    },
  });
  if (a.getComputedStyle) {
    var wb = function (f) {
      return a.getComputedStyle(f, null);
    };
    var xb = function (f, l, x) {
      var E = (x = x || wb(f)) ? x.getPropertyValue(l) || x[l] : b,
        J = f.style;
      if (
        x &&
        ("" !== E || v.contains(f.ownerDocument, f) || (E = v.style(f, l)),
        Jb.test(E) && Bc.test(l))
      ) {
        f = J.width;
        l = J.minWidth;
        var M = J.maxWidth;
        J.minWidth = J.maxWidth = J.width = E;
        E = x.width;
        J.width = f;
        J.minWidth = l;
        J.maxWidth = M;
      }
      return E;
    };
  } else
    Q.documentElement.currentStyle &&
      ((wb = function (f) {
        return f.currentStyle;
      }),
      (xb = function (f, l, x) {
        var E,
          J,
          M = (x = x || wb(f)) ? x[l] : b,
          Y = f.style;
        null == M && Y && Y[l] && (M = Y[l]);
        if (Jb.test(M) && !zd.test(l)) {
          x = Y.left;
          if ((J = (E = f.runtimeStyle) && E.left))
            E.left = f.currentStyle.left;
          Y.left = "fontSize" === l ? "1em" : M;
          M = Y.pixelLeft + "px";
          Y.left = x;
          J && (E.left = J);
        }
        return "" === M ? "auto" : M;
      }));
  v.each(["height", "width"], function (f, l) {
    v.cssHooks[l] = {
      get: function (x, E, J) {
        if (E)
          return 0 === x.offsetWidth && Ad.test(v.css(x, "display"))
            ? v.swap(x, Cd, function () {
                return V(x, l, J);
              })
            : V(x, l, J);
      },
      set: function (x, E, J) {
        var M = J && wb(x);
        return k(
          x,
          E,
          J
            ? X(
                x,
                l,
                J,
                v.support.boxSizing &&
                  "border-box" === v.css(x, "boxSizing", !1, M),
                M
              )
            : 0
        );
      },
    };
  });
  v.support.opacity ||
    (v.cssHooks.opacity = {
      get: function (f, l) {
        return yd.test(
          (l && f.currentStyle ? f.currentStyle.filter : f.style.filter) || ""
        )
          ? 0.01 * parseFloat(RegExp.$1) + ""
          : l
          ? "1"
          : "";
      },
      set: function (f, l) {
        var x = f.style;
        f = f.currentStyle;
        var E = v.isNumeric(l) ? "alpha(opacity=" + 100 * l + ")" : "",
          J = (f && f.filter) || x.filter || "";
        x.zoom = 1;
        if (
          (1 <= l || "" === l) &&
          "" === v.trim(J.replace(ec, "")) &&
          x.removeAttribute &&
          (x.removeAttribute("filter"), "" === l || (f && !f.filter))
        )
          return;
        x.filter = ec.test(J) ? J.replace(ec, E) : J + " " + E;
      },
    });
  v(function () {
    v.support.reliableMarginRight ||
      (v.cssHooks.marginRight = {
        get: function (f, l) {
          if (l)
            return v.swap(f, { display: "inline-block" }, xb, [
              f,
              "marginRight",
            ]);
        },
      });
    !v.support.pixelPosition &&
      v.fn.position &&
      v.each(["top", "left"], function (f, l) {
        v.cssHooks[l] = {
          get: function (x, E) {
            if (E)
              return (E = xb(x, l)), Jb.test(E) ? v(x).position()[l] + "px" : E;
          },
        };
      });
  });
  v.expr &&
    v.expr.filters &&
    ((v.expr.filters.hidden = function (f) {
      return (
        (0 >= f.offsetWidth && 0 >= f.offsetHeight) ||
        (!v.support.reliableHiddenOffsets &&
          "none" === ((f.style && f.style.display) || v.css(f, "display")))
      );
    }),
    (v.expr.filters.visible = function (f) {
      return !v.expr.filters.hidden(f);
    }));
  v.each(
    {
      margin: "",
      padding: "",
      border: "Width",
    },
    function (f, l) {
      v.cssHooks[f + l] = {
        expand: function (x) {
          var E = 0,
            J = {};
          for (x = "string" === typeof x ? x.split(" ") : [x]; 4 > E; E++)
            J[f + qb[E] + l] = x[E] || x[E - 2] || x[0];
          return J;
        },
      };
      Bc.test(f) || (v.cssHooks[f + l].set = k);
    }
  );
  var Dd = /%20/g,
    Pc = /\[\]$/,
    Dc = /\r?\n/g,
    Ed = /^(?:submit|button|image|reset|file)$/i,
    Fd = /^(?:input|select|textarea|keygen)/i;
  v.fn.extend({
    serialize: function () {
      return v.param(this.serializeArray());
    },
    serializeArray: function () {
      return this.map(function () {
        var f = v.prop(this, "elements");
        return f ? v.makeArray(f) : this;
      })
        .filter(function () {
          var f = this.type;
          return (
            this.name &&
            !v(this).is(":disabled") &&
            Fd.test(this.nodeName) &&
            !Ed.test(f) &&
            (this.checked || !Rb.test(f))
          );
        })
        .map(function (f, l) {
          f = v(this).val();
          return null == f
            ? null
            : v.isArray(f)
            ? v.map(f, function (x) {
                return { name: l.name, value: x.replace(Dc, "\r\n") };
              })
            : { name: l.name, value: f.replace(Dc, "\r\n") };
        })
        .get();
    },
  });
  v.param = function (f, l) {
    var x,
      E = [],
      J = function (M, Y) {
        Y = v.isFunction(Y) ? Y() : null == Y ? "" : Y;
        E[E.length] = encodeURIComponent(M) + "=" + encodeURIComponent(Y);
      };
    l === b && (l = v.ajaxSettings && v.ajaxSettings.traditional);
    if (v.isArray(f) || (f.jquery && !v.isPlainObject(f)))
      v.each(f, function () {
        J(this.name, this.value);
      });
    else for (x in f) F(x, f[x], l, J);
    return E.join("&").replace(Dd, "+");
  };
  v.each(
    "blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(
      " "
    ),
    function (f, l) {
      v.fn[l] = function (x, E) {
        return 0 < arguments.length ? this.on(l, null, x, E) : this.trigger(l);
      };
    }
  );
  v.fn.hover = function (f, l) {
    return this.mouseenter(f).mouseleave(l || f);
  };
  var fc = v.now(),
    gc = /\?/,
    Gd = /#.*$/,
    Ec = /([?&])_=[^&]*/,
    Hd = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
    Id = /^(?:GET|HEAD)$/,
    Jd = /^\/\//,
    Fc = /^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,
    Gc = v.fn.load,
    Hc = {},
    Sb = {},
    Ic = "*/".concat("*");
  try {
    var vb = ea.href;
  } catch (f) {
    (vb = Q.createElement("a")), (vb.href = ""), (vb = vb.href);
  }
  var Bb = Fc.exec(vb.toLowerCase()) || [];
  v.fn.load = function (f, l, x) {
    if ("string" !== typeof f && Gc) return Gc.apply(this, arguments);
    var E,
      J,
      M = this,
      Y = f.indexOf(" ");
    if (0 <= Y) {
      var da = f.slice(Y, f.length);
      f = f.slice(0, Y);
    }
    v.isFunction(l)
      ? ((x = l), (l = b))
      : l && "object" === typeof l && (J = "POST");
    0 < M.length &&
      v
        .ajax({ url: f, type: J, dataType: "html", data: l })
        .done(function (ia) {
          E = arguments;
          M.html(da ? v("<div>").append(v.parseHTML(ia)).find(da) : ia);
        })
        .complete(
          x &&
            function (ia, ja) {
              M.each(x, E || [ia.responseText, ja, ia]);
            }
        );
    return this;
  };
  v.each(
    "ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
    function (f, l) {
      v.fn[l] = function (x) {
        return this.on(l, x);
      };
    }
  );
  v.each(["get", "post"], function (f, l) {
    v[l] = function (x, E, J, M) {
      v.isFunction(E) && ((M = M || J), (J = E), (E = b));
      return v.ajax({ url: x, type: l, dataType: M, data: E, success: J });
    };
  });
  v.extend({
    active: 0,
    lastModified: {},
    etag: {},
    ajaxSettings: {
      url: vb,
      type: "GET",
      isLocal: /^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(
        Bb[1]
      ),
      global: !0,
      processData: !0,
      async: !0,
      contentType: "application/x-www-form-urlencoded; charset=UTF-8",
      accepts: {
        "*": Ic,
        text: "text/plain",
        html: "text/html",
        xml: "application/xml, text/xml",
        json: "application/json, text/javascript",
      },
      contents: { xml: /xml/, html: /html/, json: /json/ },
      responseFields: { xml: "responseXML", text: "responseText" },
      converters: {
        "* text": a.String,
        "text html": !0,
        "text json": v.parseJSON,
        "text xml": v.parseXML,
      },
      flatOptions: { url: !0, context: !0 },
    },
    ajaxSetup: function (f, l) {
      return l ? D(D(f, v.ajaxSettings), l) : D(v.ajaxSettings, f);
    },
    ajaxPrefilter: r(Hc),
    ajaxTransport: r(Sb),
    ajax: function (f, l) {
      function x(Ea, Sa, Ca, Wa) {
        var Ma = Sa;
        if (2 !== eb) {
          eb = 2;
          M && clearTimeout(M);
          da = b;
          J = Wa || "";
          Aa.readyState = 0 < Ea ? 4 : 0;
          if (Ca) {
            var Ua = ja;
            Wa = Aa;
            var fb,
              bb,
              Va,
              tb = Ua.contents,
              La = Ua.dataTypes,
              lb = Ua.responseFields;
            for (Va in lb) Va in Ca && (Wa[lb[Va]] = Ca[Va]);
            for (; "*" === La[0]; )
              La.shift(),
                bb === b &&
                  (bb = Ua.mimeType || Wa.getResponseHeader("Content-Type"));
            if (bb)
              for (Va in tb)
                if (tb[Va] && tb[Va].test(bb)) {
                  La.unshift(Va);
                  break;
                }
            if (La[0] in Ca) var Ia = La[0];
            else {
              for (Va in Ca) {
                if (!La[0] || Ua.converters[Va + " " + La[0]]) {
                  Ia = Va;
                  break;
                }
                fb || (fb = Va);
              }
              Ia = Ia || fb;
            }
            Ia
              ? (Ia !== La[0] && La.unshift(Ia), (Ua = Ca[Ia]))
              : (Ua = void 0);
          }
          if ((200 <= Ea && 300 > Ea) || 304 === Ea)
            if (
              (ja.ifModified &&
                ((Ca = Aa.getResponseHeader("Last-Modified")) &&
                  (v.lastModified[Xa] = Ca),
                (Ca = Aa.getResponseHeader("etag")) && (v.etag[Xa] = Ca)),
              204 === Ea)
            ) {
              var Oa = !0;
              Ma = "nocontent";
            } else if (304 === Ea) (Oa = !0), (Ma = "notmodified");
            else {
              a: {
                var gb = ja;
                var $a = Ua;
                var sb;
                Ma = {};
                fb = 0;
                bb = gb.dataTypes.slice();
                Ia = bb[0];
                gb.dataFilter && ($a = gb.dataFilter($a, gb.dataType));
                if (bb[1])
                  for (ab in gb.converters)
                    Ma[ab.toLowerCase()] = gb.converters[ab];
                for (; (Ca = bb[++fb]); )
                  if ("*" !== Ca) {
                    if ("*" !== Ia && Ia !== Ca) {
                      var ab = Ma[Ia + " " + Ca] || Ma["* " + Ca];
                      if (!ab)
                        for (sb in Ma)
                          if (
                            ((Oa = sb.split(" ")),
                            Oa[1] === Ca &&
                              (ab = Ma[Ia + " " + Oa[0]] || Ma["* " + Oa[0]]))
                          ) {
                            !0 === ab
                              ? (ab = Ma[sb])
                              : !0 !== Ma[sb] &&
                                ((Ca = Oa[0]), bb.splice(fb--, 0, Ca));
                            break;
                          }
                      if (!0 !== ab)
                        if (ab && gb["throws"]) $a = ab($a);
                        else
                          try {
                            $a = ab($a);
                          } catch (jb) {
                            Oa = {
                              state: "parsererror",
                              error: ab
                                ? jb
                                : "No conversion from " + Ia + " to " + Ca,
                            };
                            break a;
                          }
                    }
                    Ia = Ca;
                  }
                Oa = { state: "success", data: $a };
              }
              Ma = Oa.state;
              gb = Oa.data;
              $a = Oa.error;
              Oa = !$a;
            }
          else if ((($a = Ma), Ea || !Ma)) (Ma = "error"), 0 > Ea && (Ea = 0);
          Aa.status = Ea;
          Aa.statusText = (Sa || Ma) + "";
          Oa
            ? ra.resolveWith(pa, [gb, Ma, Aa])
            : ra.rejectWith(pa, [Aa, Ma, $a]);
          Aa.statusCode(Na);
          Na = b;
          Y &&
            na.trigger(Oa ? "ajaxSuccess" : "ajaxError", [
              Aa,
              ja,
              Oa ? gb : $a,
            ]);
          Ba.fireWith(pa, [Aa, Ma]);
          Y &&
            (na.trigger("ajaxComplete", [Aa, ja]),
            --v.active || v.event.trigger("ajaxStop"));
        }
      }
      "object" === typeof f && ((l = f), (f = b));
      l = l || {};
      var E,
        J,
        M,
        Y,
        da,
        ia,
        ja = v.ajaxSetup({}, l),
        pa = ja.context || ja,
        na = ja.context && (pa.nodeType || pa.jquery) ? v(pa) : v.event,
        ra = v.Deferred(),
        Ba = v.Callbacks("once memory"),
        Na = ja.statusCode || {},
        Ya = {},
        Ra = {},
        eb = 0,
        Ib = "canceled",
        Aa = {
          readyState: 0,
          getResponseHeader: function (Ea) {
            var Sa;
            if (2 === eb) {
              if (!ia)
                for (ia = {}; (Sa = Hd.exec(J)); )
                  ia[Sa[1].toLowerCase()] = Sa[2];
              Sa = ia[Ea.toLowerCase()];
            }
            return null == Sa ? null : Sa;
          },
          getAllResponseHeaders: function () {
            return 2 === eb ? J : null;
          },
          setRequestHeader: function (Ea, Sa) {
            var Ca = Ea.toLowerCase();
            eb || ((Ea = Ra[Ca] = Ra[Ca] || Ea), (Ya[Ea] = Sa));
            return this;
          },
          overrideMimeType: function (Ea) {
            eb || (ja.mimeType = Ea);
            return this;
          },
          statusCode: function (Ea) {
            var Sa;
            if (Ea)
              if (2 > eb) for (Sa in Ea) Na[Sa] = [Na[Sa], Ea[Sa]];
              else Aa.always(Ea[Aa.status]);
            return this;
          },
          abort: function (Ea) {
            Ea = Ea || Ib;
            da && da.abort(Ea);
            x(0, Ea);
            return this;
          },
        };
      ra.promise(Aa).complete = Ba.add;
      Aa.success = Aa.done;
      Aa.error = Aa.fail;
      ja.url = ((f || ja.url || vb) + "")
        .replace(Gd, "")
        .replace(Jd, Bb[1] + "//");
      ja.type = l.method || l.type || ja.method || ja.type;
      ja.dataTypes = v
        .trim(ja.dataType || "*")
        .toLowerCase()
        .match(mb) || [""];
      null == ja.crossDomain &&
        ((f = Fc.exec(ja.url.toLowerCase())),
        (ja.crossDomain = !(
          !f ||
          (f[1] === Bb[1] &&
            f[2] === Bb[2] &&
            (f[3] || ("http:" === f[1] ? 80 : 443)) ==
              (Bb[3] || ("http:" === Bb[1] ? 80 : 443)))
        )));
      ja.data &&
        ja.processData &&
        "string" !== typeof ja.data &&
        (ja.data = v.param(ja.data, ja.traditional));
      y(Hc, ja, l, Aa);
      if (2 === eb) return Aa;
      (Y = ja.global) && 0 === v.active++ && v.event.trigger("ajaxStart");
      ja.type = ja.type.toUpperCase();
      ja.hasContent = !Id.test(ja.type);
      var Xa = ja.url;
      ja.hasContent ||
        (ja.data &&
          ((Xa = ja.url += (gc.test(Xa) ? "&" : "?") + ja.data),
          delete ja.data),
        !1 === ja.cache &&
          (ja.url = Ec.test(Xa)
            ? Xa.replace(Ec, "$1_=" + fc++)
            : Xa + (gc.test(Xa) ? "&" : "?") + "_=" + fc++));
      ja.ifModified &&
        (v.lastModified[Xa] &&
          Aa.setRequestHeader("If-Modified-Since", v.lastModified[Xa]),
        v.etag[Xa] && Aa.setRequestHeader("If-None-Match", v.etag[Xa]));
      ((ja.data && ja.hasContent && !1 !== ja.contentType) || l.contentType) &&
        Aa.setRequestHeader("Content-Type", ja.contentType);
      Aa.setRequestHeader(
        "Accept",
        ja.dataTypes[0] && ja.accepts[ja.dataTypes[0]]
          ? ja.accepts[ja.dataTypes[0]] +
              ("*" !== ja.dataTypes[0] ? ", " + Ic + "; q=0.01" : "")
          : ja.accepts["*"]
      );
      for (E in ja.headers) Aa.setRequestHeader(E, ja.headers[E]);
      if (ja.beforeSend && (!1 === ja.beforeSend.call(pa, Aa, ja) || 2 === eb))
        return Aa.abort();
      Ib = "abort";
      for (E in { success: 1, error: 1, complete: 1 }) Aa[E](ja[E]);
      if ((da = y(Sb, ja, l, Aa))) {
        Aa.readyState = 1;
        Y && na.trigger("ajaxSend", [Aa, ja]);
        ja.async &&
          0 < ja.timeout &&
          (M = setTimeout(function () {
            Aa.abort("timeout");
          }, ja.timeout));
        try {
          (eb = 1), da.send(Ya, x);
        } catch (Ea) {
          if (2 > eb) x(-1, Ea);
          else throw Ea;
        }
      } else x(-1, "No Transport");
      return Aa;
    },
    getScript: function (f, l) {
      return v.get(f, b, l, "script");
    },
    getJSON: function (f, l, x) {
      return v.get(f, l, x, "json");
    },
  });
  v.ajaxSetup({
    accepts: {
      script:
        "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript",
    },
    contents: { script: /(?:java|ecma)script/ },
    converters: {
      "text script": function (f) {
        v.globalEval(f);
        return f;
      },
    },
  });
  v.ajaxPrefilter("script", function (f) {
    f.cache === b && (f.cache = !1);
    f.crossDomain && ((f.type = "GET"), (f.global = !1));
  });
  v.ajaxTransport("script", function (f) {
    if (f.crossDomain) {
      var l,
        x = Q.head || v("head")[0] || Q.documentElement;
      return {
        send: function (E, J) {
          l = Q.createElement("script");
          l.async = !0;
          f.scriptCharset && (l.charset = f.scriptCharset);
          l.src = f.url;
          l.onload = l.onreadystatechange = function (M, Y) {
            if (Y || !l.readyState || /loaded|complete/.test(l.readyState))
              (l.onload = l.onreadystatechange = null),
                l.parentNode && l.parentNode.removeChild(l),
                (l = null),
                Y || J(200, "success");
          };
          x.insertBefore(l, x.firstChild);
        },
        abort: function () {
          if (l) l.onload(b, !0);
        },
      };
    }
  });
  var Jc = [],
    hc = /(=)\?(?=&|$)|\?\?/;
  v.ajaxSetup({
    jsonp: "callback",
    jsonpCallback: function () {
      var f = Jc.pop() || v.expando + "_" + fc++;
      this[f] = !0;
      return f;
    },
  });
  v.ajaxPrefilter("json jsonp", function (f, l, x) {
    var E,
      J =
        !1 !== f.jsonp &&
        (hc.test(f.url)
          ? "url"
          : "string" === typeof f.data &&
            !(f.contentType || "").indexOf(
              "application/x-www-form-urlencoded"
            ) &&
            hc.test(f.data) &&
            "data");
    if (J || "jsonp" === f.dataTypes[0]) {
      var M = (f.jsonpCallback = v.isFunction(f.jsonpCallback)
        ? f.jsonpCallback()
        : f.jsonpCallback);
      J
        ? (f[J] = f[J].replace(hc, "$1" + M))
        : !1 !== f.jsonp &&
          (f.url += (gc.test(f.url) ? "&" : "?") + f.jsonp + "=" + M);
      f.converters["script json"] = function () {
        E || v.error(M + " was not called");
        return E[0];
      };
      f.dataTypes[0] = "json";
      var Y = a[M];
      a[M] = function () {
        E = arguments;
      };
      x.always(function () {
        a[M] = Y;
        f[M] && ((f.jsonpCallback = l.jsonpCallback), Jc.push(M));
        E && v.isFunction(Y) && Y(E[0]);
        E = Y = b;
      });
      return "script";
    }
  });
  var Cb,
    Kd = 0,
    ic =
      a.ActiveXObject &&
      function () {
        for (var f in Cb) Cb[f](b, !0);
      };
  v.ajaxSettings.xhr = a.ActiveXObject
    ? function () {
        var f;
        if (!(f = !this.isLocal && B()))
          a: {
            try {
              f = new a.ActiveXObject("Microsoft.XMLHTTP");
              break a;
            } catch (l) {}
            f = void 0;
          }
        return f;
      }
    : B;
  var Pb = v.ajaxSettings.xhr();
  v.support.cors = !!Pb && "withCredentials" in Pb;
  (Pb = v.support.ajax = !!Pb) &&
    v.ajaxTransport(function (f) {
      if (!f.crossDomain || v.support.cors) {
        var l;
        return {
          send: function (x, E) {
            var J,
              M = f.xhr();
            f.username
              ? M.open(f.type, f.url, f.async, f.username, f.password)
              : M.open(f.type, f.url, f.async);
            if (f.xhrFields) for (J in f.xhrFields) M[J] = f.xhrFields[J];
            f.mimeType && M.overrideMimeType && M.overrideMimeType(f.mimeType);
            f.crossDomain ||
              x["X-Requested-With"] ||
              (x["X-Requested-With"] = "XMLHttpRequest");
            try {
              for (J in x) M.setRequestHeader(J, x[J]);
            } catch (da) {}
            M.send((f.hasContent && f.data) || null);
            l = function (da, ia) {
              try {
                if (l && (ia || 4 === M.readyState))
                  if (
                    ((l = b),
                    Y && ((M.onreadystatechange = v.noop), ic && delete Cb[Y]),
                    ia)
                  )
                    4 !== M.readyState && M.abort();
                  else {
                    var ja = {};
                    var pa = M.status;
                    var na = M.getAllResponseHeaders();
                    "string" === typeof M.responseText &&
                      (ja.text = M.responseText);
                    try {
                      var ra = M.statusText;
                    } catch (Ba) {
                      ra = "";
                    }
                    pa || !f.isLocal || f.crossDomain
                      ? 1223 === pa && (pa = 204)
                      : (pa = ja.text ? 200 : 404);
                  }
              } catch (Ba) {
                ia || E(-1, Ba);
              }
              ja && E(pa, ra, ja, na);
            };
            if (f.async)
              if (4 === M.readyState) setTimeout(l);
              else {
                var Y = ++Kd;
                ic && (Cb || ((Cb = {}), v(a).unload(ic)), (Cb[Y] = l));
                M.onreadystatechange = l;
              }
            else l();
          },
          abort: function () {
            l && l(b, !0);
          },
        };
      }
    });
  var yb,
    Qb,
    Ld = /^(?:toggle|show|hide)$/,
    Md = new RegExp("^(?:([+-])=|)(" + Lb + ")([a-z%]*)$", "i"),
    Nd = /queueHooks$/,
    Kb = [
      function (f, l, x) {
        var E,
          J = this,
          M = f.style,
          Y = {},
          da = [],
          ia = f.nodeType && T(f);
        if (!x.queue) {
          var ja = v._queueHooks(f, "fx");
          if (null == ja.unqueued) {
            ja.unqueued = 0;
            var pa = ja.empty.fire;
            ja.empty.fire = function () {
              ja.unqueued || pa();
            };
          }
          ja.unqueued++;
          J.always(function () {
            J.always(function () {
              ja.unqueued--;
              v.queue(f, "fx").length || ja.empty.fire();
            });
          });
        }
        1 === f.nodeType &&
          ("height" in l || "width" in l) &&
          ((x.overflow = [M.overflow, M.overflowX, M.overflowY]),
          "inline" === v.css(f, "display") &&
            "none" === v.css(f, "float") &&
            (v.support.inlineBlockNeedsLayout && "inline" !== p(f.nodeName)
              ? (M.zoom = 1)
              : (M.display = "inline-block")));
        x.overflow &&
          ((M.overflow = "hidden"),
          v.support.shrinkWrapBlocks ||
            J.always(function () {
              M.overflow = x.overflow[0];
              M.overflowX = x.overflow[1];
              M.overflowY = x.overflow[2];
            }));
        for (E in l) {
          var na = l[E];
          if (Ld.exec(na)) {
            delete l[E];
            var ra = ra || "toggle" === na;
            na !== (ia ? "hide" : "show") && da.push(E);
          }
        }
        if ((l = da.length))
          for (
            na = v._data(f, "fxshow") || v._data(f, "fxshow", {}),
              ("hidden" in na) && (ia = na.hidden),
              ra && (na.hidden = !ia),
              ia
                ? v(f).show()
                : J.done(function () {
                    v(f).hide();
                  }),
              J.done(function () {
                var Na;
                v._removeData(f, "fxshow");
                for (Na in Y) v.style(f, Na, Y[Na]);
              }),
              E = 0;
            E < l;
            E++
          ) {
            ra = da[E];
            var Ba = J.createTween(ra, ia ? na[ra] : 0);
            Y[ra] = na[ra] || v.style(f, ra);
            ra in na ||
              ((na[ra] = Ba.start),
              ia &&
                ((Ba.end = Ba.start),
                (Ba.start = "width" === ra || "height" === ra ? 1 : 0)));
          }
      },
    ],
    Eb = {
      "*": [
        function (f, l) {
          var x = this.createTween(f, l),
            E = Md.exec(l),
            J = x.cur(),
            M = +J || 0,
            Y = 1,
            da = 20;
          if (E) {
            l = +E[2];
            var ia = E[3] || (v.cssNumber[f] ? "" : "px");
            if ("px" !== ia && M) {
              M = v.css(x.elem, f, !0) || l || 1;
              do (Y = Y || ".5"), (M /= Y), v.style(x.elem, f, M + ia);
              while (Y !== (Y = x.cur() / J) && 1 !== Y && --da);
            }
            x.unit = ia;
            x.start = M;
            x.end = E[1] ? M + (E[1] + 1) * l : l;
          }
          return x;
        },
      ],
    };
  v.Animation = v.extend(N, {
    tweener: function (f, l) {
      v.isFunction(f) ? ((l = f), (f = ["*"])) : (f = f.split(" "));
      for (var x, E = 0, J = f.length; E < J; E++)
        (x = f[E]), (Eb[x] = Eb[x] || []), Eb[x].unshift(l);
    },
    prefilter: function (f, l) {
      l ? Kb.unshift(f) : Kb.push(f);
    },
  });
  v.Tween = z;
  z.prototype = {
    constructor: z,
    init: function (f, l, x, E, J, M) {
      this.elem = f;
      this.prop = x;
      this.easing = J || "swing";
      this.options = l;
      this.start = this.now = this.cur();
      this.end = E;
      this.unit = M || (v.cssNumber[x] ? "" : "px");
    },
    cur: function () {
      var f = z.propHooks[this.prop];
      return f && f.get ? f.get(this) : z.propHooks._default.get(this);
    },
    run: function (f) {
      var l,
        x = z.propHooks[this.prop];
      this.pos = this.options.duration
        ? (l = v.easing[this.easing](
            f,
            this.options.duration * f,
            0,
            1,
            this.options.duration
          ))
        : (l = f);
      this.now = (this.end - this.start) * l + this.start;
      this.options.step && this.options.step.call(this.elem, this.now, this);
      x && x.set ? x.set(this) : z.propHooks._default.set(this);
      return this;
    },
  };
  z.prototype.init.prototype = z.prototype;
  z.propHooks = {
    _default: {
      get: function (f) {
        return null == f.elem[f.prop] ||
          (f.elem.style && null != f.elem.style[f.prop])
          ? (f = v.css(f.elem, f.prop, "")) && "auto" !== f
            ? f
            : 0
          : f.elem[f.prop];
      },
      set: function (f) {
        if (v.fx.step[f.prop]) v.fx.step[f.prop](f);
        else
          f.elem.style &&
          (null != f.elem.style[v.cssProps[f.prop]] || v.cssHooks[f.prop])
            ? v.style(f.elem, f.prop, f.now + f.unit)
            : (f.elem[f.prop] = f.now);
      },
    },
  };
  z.propHooks.scrollTop = z.propHooks.scrollLeft = {
    set: function (f) {
      f.elem.nodeType && f.elem.parentNode && (f.elem[f.prop] = f.now);
    },
  };
  v.each(["toggle", "show", "hide"], function (f, l) {
    var x = v.fn[l];
    v.fn[l] = function (E, J, M) {
      return null == E || "boolean" === typeof E
        ? x.apply(this, arguments)
        : this.animate(R(l, !0), E, J, M);
    };
  });
  v.fn.extend({
    fadeTo: function (f, l, x, E) {
      return this.filter(T)
        .css("opacity", 0)
        .show()
        .end()
        .animate({ opacity: l }, f, x, E);
    },
    animate: function (f, l, x, E) {
      var J = v.isEmptyObject(f),
        M = v.speed(l, x, E),
        Y = function () {
          var da = N(this, v.extend({}, f), M);
          Y.finish = function () {
            da.stop(!0);
          };
          (J || v._data(this, "finish")) && da.stop(!0);
        };
      Y.finish = Y;
      return J || !1 === M.queue ? this.each(Y) : this.queue(M.queue, Y);
    },
    stop: function (f, l, x) {
      var E = function (J) {
        var M = J.stop;
        delete J.stop;
        M(x);
      };
      "string" !== typeof f && ((x = l), (l = f), (f = b));
      l && !1 !== f && this.queue(f || "fx", []);
      return this.each(function () {
        var J = !0,
          M = null != f && f + "queueHooks",
          Y = v.timers,
          da = v._data(this);
        if (M) da[M] && da[M].stop && E(da[M]);
        else for (M in da) da[M] && da[M].stop && Nd.test(M) && E(da[M]);
        for (M = Y.length; M--; )
          Y[M].elem !== this ||
            (null != f && Y[M].queue !== f) ||
            (Y[M].anim.stop(x), (J = !1), Y.splice(M, 1));
        (!J && x) || v.dequeue(this, f);
      });
    },
    finish: function (f) {
      !1 !== f && (f = f || "fx");
      return this.each(function () {
        var l = v._data(this),
          x = l[f + "queue"];
        var E = l[f + "queueHooks"];
        var J = v.timers,
          M = x ? x.length : 0;
        l.finish = !0;
        v.queue(this, f, []);
        E && E.cur && E.cur.finish && E.cur.finish.call(this);
        for (E = J.length; E--; )
          J[E].elem === this &&
            J[E].queue === f &&
            (J[E].anim.stop(!0), J.splice(E, 1));
        for (E = 0; E < M; E++) x[E] && x[E].finish && x[E].finish.call(this);
        delete l.finish;
      });
    },
  });
  v.each(
    {
      slideDown: R("show"),
      slideUp: R("hide"),
      slideToggle: R("toggle"),
      fadeIn: { opacity: "show" },
      fadeOut: { opacity: "hide" },
      fadeToggle: { opacity: "toggle" },
    },
    function (f, l) {
      v.fn[f] = function (x, E, J) {
        return this.animate(l, x, E, J);
      };
    }
  );
  v.speed = function (f, l, x) {
    var E =
      f && "object" === typeof f
        ? v.extend({}, f)
        : {
            complete: x || (!x && l) || (v.isFunction(f) && f),
            duration: f,
            easing: (x && l) || (l && !v.isFunction(l) && l),
          };
    E.duration = v.fx.off
      ? 0
      : "number" === typeof E.duration
      ? E.duration
      : E.duration in v.fx.speeds
      ? v.fx.speeds[E.duration]
      : v.fx.speeds._default;
    if (null == E.queue || !0 === E.queue) E.queue = "fx";
    E.old = E.complete;
    E.complete = function () {
      v.isFunction(E.old) && E.old.call(this);
      E.queue && v.dequeue(this, E.queue);
    };
    return E;
  };
  v.easing = {
    linear: function (f) {
      return f;
    },
    swing: function (f) {
      return 0.5 - Math.cos(f * Math.PI) / 2;
    },
  };
  v.timers = [];
  v.fx = z.prototype.init;
  v.fx.tick = function () {
    var f = v.timers,
      l = 0;
    for (yb = v.now(); l < f.length; l++) {
      var x = f[l];
      x() || f[l] !== x || f.splice(l--, 1);
    }
    f.length || v.fx.stop();
    yb = b;
  };
  v.fx.timer = function (f) {
    f() && v.timers.push(f) && v.fx.start();
  };
  v.fx.interval = 13;
  v.fx.start = function () {
    Qb || (Qb = setInterval(v.fx.tick, v.fx.interval));
  };
  v.fx.stop = function () {
    clearInterval(Qb);
    Qb = null;
  };
  v.fx.speeds = { slow: 600, fast: 200, _default: 400 };
  v.fx.step = {};
  v.expr &&
    v.expr.filters &&
    (v.expr.filters.animated = function (f) {
      return v.grep(v.timers, function (l) {
        return f === l.elem;
      }).length;
    });
  v.fn.offset = function (f) {
    if (arguments.length)
      return f === b
        ? this
        : this.each(function (M) {
            v.offset.setOffset(this, f, M);
          });
    var l,
      x = { top: 0, left: 0 },
      E = (l = this[0]) && l.ownerDocument;
    if (E) {
      var J = E.documentElement;
      if (!v.contains(J, l)) return x;
      typeof l.getBoundingClientRect !== ma && (x = l.getBoundingClientRect());
      l = ba(E);
      return {
        top: x.top + (l.pageYOffset || J.scrollTop) - (J.clientTop || 0),
        left: x.left + (l.pageXOffset || J.scrollLeft) - (J.clientLeft || 0),
      };
    }
  };
  v.offset = {
    setOffset: function (f, l, x) {
      var E = v.css(f, "position");
      "static" === E && (f.style.position = "relative");
      var J = v(f),
        M = J.offset(),
        Y = v.css(f, "top"),
        da = v.css(f, "left"),
        ia = {};
      ("absolute" === E || "fixed" === E) && -1 < v.inArray("auto", [Y, da])
        ? ((da = J.position()), (E = da.top), (da = da.left))
        : ((E = parseFloat(Y) || 0), (da = parseFloat(da) || 0));
      v.isFunction(l) && (l = l.call(f, x, M));
      null != l.top && (ia.top = l.top - M.top + E);
      null != l.left && (ia.left = l.left - M.left + da);
      "using" in l ? l.using.call(f, ia) : J.css(ia);
    },
  };
  v.fn.extend({
    position: function () {
      if (this[0]) {
        var f = { top: 0, left: 0 },
          l = this[0];
        if ("fixed" === v.css(l, "position")) var x = l.getBoundingClientRect();
        else {
          var E = this.offsetParent();
          x = this.offset();
          v.nodeName(E[0], "html") || (f = E.offset());
          f.top += v.css(E[0], "borderTopWidth", !0);
          f.left += v.css(E[0], "borderLeftWidth", !0);
        }
        return {
          top: x.top - f.top - v.css(l, "marginTop", !0),
          left: x.left - f.left - v.css(l, "marginLeft", !0),
        };
      }
    },
    offsetParent: function () {
      return this.map(function () {
        for (
          var f = this.offsetParent || Q.documentElement;
          f && !v.nodeName(f, "html") && "static" === v.css(f, "position");

        )
          f = f.offsetParent;
        return f || Q.documentElement;
      });
    },
  });
  v.each(
    { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" },
    function (f, l) {
      var x = /Y/.test(l);
      v.fn[f] = function (E) {
        return v.access(
          this,
          function (J, M, Y) {
            var da = ba(J);
            if (Y === b)
              return da
                ? l in da
                  ? da[l]
                  : da.document.documentElement[M]
                : J[M];
            da
              ? da.scrollTo(
                  x ? v(da).scrollLeft() : Y,
                  x ? Y : v(da).scrollTop()
                )
              : (J[M] = Y);
          },
          f,
          E,
          arguments.length,
          null
        );
      };
    }
  );
  v.each({ Height: "height", Width: "width" }, function (f, l) {
    v.each(
      { padding: "inner" + f, content: l, "": "outer" + f },
      function (x, E) {
        v.fn[E] = function (J, M) {
          var Y = arguments.length && (x || "boolean" !== typeof J),
            da = x || (!0 === J || !0 === M ? "margin" : "border");
          return v.access(
            this,
            function (ia, ja, pa) {
              return v.isWindow(ia)
                ? ia.document.documentElement["client" + f]
                : 9 === ia.nodeType
                ? ((ja = ia.documentElement),
                  Math.max(
                    ia.body["scroll" + f],
                    ja["scroll" + f],
                    ia.body["offset" + f],
                    ja["offset" + f],
                    ja["client" + f]
                  ))
                : pa === b
                ? v.css(ia, ja, da)
                : v.style(ia, ja, pa, da);
            },
            l,
            Y ? J : b,
            Y,
            null
          );
        };
      }
    );
  });
  a.jQuery = a.$ = v;
  "function" === typeof define &&
    define.amd &&
    define.amd.jQuery &&
    define("jquery", [], function () {
      return v;
    });
})(window);
var Base64Binary = {
  _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
  decodeArrayBuffer: function (a) {
    var b = this._keyStr.indexOf(a.charAt(a.length - 1)),
      c = this._keyStr.indexOf(a.charAt(a.length - 2)),
      e = (a.length / 4) * 3;
    64 == b && e--;
    64 == c && e--;
    b = new ArrayBuffer(e);
    this.decode(a, b, e);
    return b;
  },
  decode: function (a, b, c) {
    var e,
      d = 0;
    b = b ? new Uint8Array(b) : new Uint8Array(c);
    a = a.replace(/[^A-Za-z0-9\+\/=]/g, "");
    for (e = 0; e < c; e += 3) {
      var g = this._keyStr.indexOf(a.charAt(d++));
      var h = this._keyStr.indexOf(a.charAt(d++));
      var n = this._keyStr.indexOf(a.charAt(d++));
      var q = this._keyStr.indexOf(a.charAt(d++));
      g = (g << 2) | (h >> 4);
      h = ((h & 15) << 4) | (n >> 2);
      var t = ((n & 3) << 6) | q;
      b[e] = g;
      64 != n && (b[e + 1] = h);
      64 != q && (b[e + 2] = t);
    }
    return b;
  },
};
!(function (a, b) {
  "undefined" != typeof module && module.exports
    ? (module.exports.browser = b())
    : "function" == typeof define
    ? define(b)
    : (this[a] = b());
})("bowser", function () {
  function a(d, g, h) {
    return ((d = d.match(g)) && d.length > h && d[h]) || 0;
  }
  function b(d) {
    var g = /(msie|trident)/i.test(d),
      h = /chrome|crios/i.test(d),
      n = /phantom/i.test(d),
      q = /iphone/i.test(d),
      t = /ipad/i.test(d),
      u = /ipod/i.test(d),
      A = /touchpad/i.test(d),
      G = /silk/i.test(d),
      O = /safari/i.test(d) && !h && !n && !G,
      H = /android/i.test(d),
      P = /opera/i.test(d) || /opr/i.test(d),
      U = /firefox/i.test(d),
      ha = /gecko\//i.test(d),
      w = /seamonkey\//i.test(d),
      I = /webos/i.test(d),
      aa = /windows phone/i.test(d),
      T = /blackberry/i.test(d),
      ka = /version\/(\d+(\.\d+)?)/i,
      k = /firefox[ \/](\d+(\.\d+)?)/i,
      X = {};
    u && (q = !1);
    if (aa)
      X = {
        name: "Windows Phone",
        windowsphone: !0,
        msie: !0,
        mobile: !0,
        version: a(d, /iemobile\/(\d+(\.\d+)?)/i, 1),
      };
    else if (P)
      (c =
        a(d, ka, 1) ||
        a(d, /opr\/(\d+(\.\d+)?)/i, 1) ||
        a(d, /opera[ \/](\d+(\.\d+)?)/i, 1)),
        (X = { name: "Opera", opera: !0, version: c }),
        H && ((X.android = !0), (X.mobile = !0)),
        h && (X.webkit = !0);
    else if (g)
      X = {
        name: "Internet Explorer",
        msie: !0,
        version: a(d, /(msie |rv:)(\d+(\.\d+)?)/i, 2),
      };
    else if (h) {
      X = {
        name: "Chrome",
        webkit: !0,
        chrome: !0,
        version: a(d, /(?:chrome|crios)\/(\d+(\.\d+)?)/i, 1),
      };
      H && (X.android = !0);
      if (t || u || q)
        (X[q ? "iphone" : t ? "ipad" : "ipod"] = !0), (X.ios = !0);
      if (X.android || X.ios) X.mobile = !0;
    } else
      n
        ? (X = {
            name: "PhantomJS",
            webkit: !0,
            phantom: !0,
            version: a(d, /phantomjs\/(\d+(\.\d+)?)/i, 1),
          })
        : A
        ? (X = {
            name: "TouchPad",
            webkit: !0,
            touchpad: !0,
            version: a(d, /touchpad\/(\d+(\.\d+)?)/i, 1),
          })
        : G
        ? (X = {
            name: "Amazon Silk",
            webkit: !0,
            android: !0,
            mobile: !0,
            version: a(d, /silk\/(\d+(\.\d+)?)/i, 1),
          })
        : q || t || u
        ? ((X = {
            name: q ? "iPhone" : t ? "iPad" : "iPod",
            webkit: !0,
            mobile: !0,
            ios: !0,
          }),
          (X[q ? "iphone" : t ? "ipad" : "ipod"] = !0),
          ka.test(d) && (X.version = a(d, ka, 1)))
        : T
        ? ((X = { name: "BlackBerry", blackberry: !0, mobile: !0 }),
          (c = a(d, ka, 1))
            ? ((X.version = c), (X.webkit = !0))
            : (X.version = a(d, /blackberry[\d]+\/(\d+(\.\d+)?)/i, 1)))
        : I
        ? (X = {
            name: "WebOS",
            mobile: !0,
            webkit: !0,
            webos: !0,
            version: a(d, ka, 1) || a(d, /wosbrowser\/(\d+(\.\d+)?)/i, 1),
          })
        : ha
        ? ((X = { name: "Gecko", gecko: !0, mozilla: !0, version: a(d, k, 1) }),
          w
            ? ((X.name = "SeaMonkey"),
              (X.seamonkey = !0),
              (X.version = a(d, /seamonkey\/(\d+(\.\d+)?)/i, 1)))
            : U && ((X.name = "Firefox"), (X.firefox = !0)),
          H
            ? ((X.android = !0), (X.mobile = !0))
            : !H &&
              U &&
              /\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(d) &&
              ((X.firefoxos = !0), (X.mobile = !0)))
        : H
        ? (X = {
            name: "Android",
            webkit: !0,
            android: !0,
            mobile: !0,
            version: a(d, ka, 1),
          })
        : O &&
          (X = {
            name: "Safari",
            webkit: !0,
            safari: !0,
            version: a(d, ka, 1),
          });
    if (H) {
      if ((d = a(d, /android[ \/](\d+(\.\d+)*)/i, 1))) X.osversion = d;
    } else if (q || t || u) {
      if ((d = a(d, /os (\d+([_\s]\d+)*) like mac os x/i, 1)))
        X.osversion = d.replace(/[_\s]/g, ".");
    } else
      aa &&
        (d = a(d, /windows phone (?:os)?\s?(\d+(\.\d+)*)/i, 1)) &&
        (X.osversion = d);
    (X.msie && 9 <= X.version) ||
    (X.chrome && 20 <= X.version) ||
    (X.firefox && 10 <= X.version) ||
    (X.safari && 5 <= X.version) ||
    (X.opera && 10 <= X.version) ||
    (X.ios && X.osversion && 6 <= X.osversion.split(".")[0])
      ? (X.a = !0)
      : (X.msie && 9 > X.version) ||
        (X.chrome && 20 > X.version) ||
        (X.firefox && 10 > X.version) ||
        (X.safari && 5 > X.version) ||
        (X.opera && 10 > X.version) ||
        (X.ios && X.osversion && 6 > X.osversion.split(".")[0])
      ? (X.c = !0)
      : (X.x = !0);
    return X;
  }
  var c,
    e = b("undefined" !== typeof navigator ? navigator.userAgent : "");
  e._detect = b;
  return e;
});
("use strict");
var numeric = {
  inv: function (a) {
    var b = numeric.dim(a),
      c = Math.abs,
      e = b[0];
    b = b[1];
    var d = a.clone(),
      g = numeric.identity(e),
      h,
      n;
    for (n = 0; n < b; ++n) {
      var q = (a = -1);
      for (h = n; h !== e; ++h) {
        var t = c(d[h][n]);
        t > q && ((a = h), (q = t));
      }
      q = d[a];
      d[a] = d[n];
      d[n] = q;
      var u = g[a];
      g[a] = g[n];
      g[n] = u;
      a = q[n];
      for (t = n; t !== b; ++t) q[t] /= a;
      for (t = b - 1; -1 !== t; --t) u[t] /= a;
      for (h = e - 1; -1 !== h; --h)
        if (h !== n) {
          var A = d[h];
          var G = g[h];
          a = A[n];
          for (t = n + 1; t !== b; ++t) A[t] -= q[t] * a;
          for (t = b - 1; 0 < t; --t)
            (G[t] -= u[t] * a), --t, (G[t] -= u[t] * a);
          0 === t && (G[0] -= u[0] * a);
        }
    }
    return g;
  },
  dim: function (a) {
    if ("object" === typeof a) {
      var b = a[0];
      if ("object" === typeof b) {
        var c = b[0];
        return "object" === typeof c ? numeric._dim(a) : [a.length, b.length];
      }
      return [a.length];
    }
    return [];
  },
  _dim: function (a) {
    for (var b = []; "object" === typeof a; ) b.push(a.length), (a = a[0]);
    return b;
  },
  identity: function (a) {
    return numeric.diag(numeric.rep([a], 1));
  },
  rep: function (a, b, c) {
    "undefined" === typeof c && (c = 0);
    var e = a[c],
      d = Array(e);
    if (c === a.length - 1) {
      for (e -= 2; 0 <= e; e -= 2) (d[e + 1] = b), (d[e] = b);
      -1 === e && (d[0] = b);
      return d;
    }
    for (--e; 0 <= e; e--) d[e] = numeric.rep(a, b, c + 1);
    return d;
  },
  diag: function (a) {
    var b,
      c,
      e = a.length,
      d = Array(e);
    for (b = e - 1; 0 <= b; b--) {
      var g = Array(e);
      var h = b + 2;
      for (c = e - 1; c >= h; c -= 2) (g[c] = 0), (g[c - 1] = 0);
      c > b && (g[c] = 0);
      g[b] = a[b];
      for (c = b - 1; 1 <= c; c -= 2) (g[c] = 0), (g[c - 1] = 0);
      0 === c && (g[0] = 0);
      d[b] = g;
    }
    return d;
  },
};
!(function (a) {
  if ("object" == typeof exports && "undefined" != typeof module)
    module.exports = a();
  else if ("function" == typeof define && define.amd) define([], a);
  else {
    var b;
    "undefined" != typeof window
      ? (b = window)
      : "undefined" != typeof global
      ? (b = global)
      : "undefined" != typeof self && (b = self);
    b.pako = a();
  }
})(function () {
  return (function d(b, c, e) {
    function g(q, t) {
      if (!c[q]) {
        if (!b[q]) {
          var u = "function" == typeof require && require;
          if (!t && u) return u(q, !0);
          if (h) return h(q, !0);
          throw Error("Cannot find module '" + q + "'");
        }
        t = c[q] = { exports: {} };
        b[q][0].call(
          t.exports,
          function (A) {
            var G = b[q][1][A];
            return g(G ? G : A);
          },
          t,
          t.exports,
          d,
          b,
          c,
          e
        );
      }
      return c[q].exports;
    }
    for (
      var h = "function" == typeof require && require, n = 0;
      n < e.length;
      n++
    )
      g(e[n]);
    return g;
  })(
    {
      1: [
        function (b, c, e) {
          function d(O, H, P, U) {
            H = new G(H);
            H.onFinish = U;
            H.push(O, !0, P);
          }
          var g = b("./zlib/inflate.js"),
            h = b("./utils/common"),
            n = b("./utils/strings"),
            q = b("./zlib/constants"),
            t = b("./zlib/messages"),
            u = b("./zlib/zstream"),
            A = b("./zlib/gzheader"),
            G = function (O) {
              var H = (this.options = h.assign(
                { chunkSize: 16384, windowBits: 0, to: "" },
                O || {}
              ));
              H.raw &&
                0 <= H.windowBits &&
                16 > H.windowBits &&
                ((H.windowBits = -H.windowBits),
                0 === H.windowBits && (H.windowBits = -15));
              !(0 <= H.windowBits && 16 > H.windowBits) ||
                (O && O.windowBits) ||
                (H.windowBits += 32);
              15 < H.windowBits &&
                48 > H.windowBits &&
                0 === (H.windowBits & 15) &&
                (H.windowBits |= 15);
              this.err = 0;
              this.msg = "";
              this.ended = !1;
              this.chunks = [];
              this.strm = new u();
              this.strm.avail_out = 0;
              O = g.inflateInit2(this.strm, H.windowBits);
              if (O !== q.Z_OK) throw Error(t[O]);
              this.header = new A();
              g.inflateGetHeader(this.strm, this.header);
            };
          G.prototype.push = function (O, H, P) {
            var U = this.strm;
            H = this.options.chunkSize;
            if (this.ended) return !1;
            U.input = "string" === typeof O ? n.binstring2buf(O) : O;
            U.next_in = 0;
            U.avail_in = U.input.length;
            O = new DataView(O.buffer).getUint32(O.byteLength - 4, !0);
            this.progressMeter = P;
            this.progressIterations = O / H;
            this.progressIndex = 0;
            this.progressNextGoal = 0.25;
            this.progressMeter &&
              this.progressMeter.drawProgress(0.1, "Unpacking");
            setTimeout(this.pushProcess.bind(this), 0);
          };
          G.prototype.pushProcess = function () {
            var O = this.strm,
              H = this.options.chunkSize;
            do {
              0 === O.avail_out &&
                ((O.output = new h.Buf8(H)),
                (O.next_out = 0),
                (O.avail_out = H));
              var P = g.inflate(O, q.Z_NO_FLUSH);
              if (P !== q.Z_STREAM_END && P !== q.Z_OK)
                return this.onEnd(P), (this.ended = !0), !1;
              if (
                O.next_out &&
                (0 === O.avail_out ||
                  P === q.Z_STREAM_END ||
                  (0 === O.avail_in && ha === q.Z_FINISH))
              )
                this.onData(h.shrinkBuf(O.output, O.next_out));
              this.progressIndex += 1;
              var U = this.progressIndex / this.progressIterations;
              this.progressMeter &&
                this.progressMeter.drawProgress(U, "Unpacking");
            } while (
              U < this.progressNextGoal &&
              (0 < O.avail_in || 0 === O.avail_out) &&
              P !== q.Z_STREAM_END
            );
            if ((0 < O.avail_in || 0 === O.avail_out) && P !== q.Z_STREAM_END)
              (this.progressNextGoal += 0.1),
                setTimeout(this.pushProcess.bind(this), 0);
            else {
              if (P === q.Z_STREAM_END) var ha = q.Z_FINISH;
              ha === q.Z_FINISH &&
                ((P = g.inflateEnd(this.strm)),
                this.onEnd(P),
                (this.ended = !0));
              this.onFinish(this.result);
            }
          };
          G.prototype.onData = function (O) {
            this.chunks.push(O);
          };
          G.prototype.onEnd = function (O) {
            O === q.Z_OK &&
              (this.result =
                "string" === this.options.to
                  ? this.chunks.join("")
                  : h.flattenChunks(this.chunks));
            this.chunks = [];
            this.err = O;
            this.msg = this.strm.msg;
          };
          e.Inflate = G;
          e.inflate = d;
          e.inflateRaw = function (O, H) {
            H = H || {};
            H.raw = !0;
            return d(O, H);
          };
          e.ungzip = d;
        },
        {
          "./utils/common": 2,
          "./utils/strings": 3,
          "./zlib/constants": 5,
          "./zlib/gzheader": 7,
          "./zlib/inflate.js": 9,
          "./zlib/messages": 11,
          "./zlib/zstream": 12,
        },
      ],
      2: [
        function (b, c, e) {
          b =
            "undefined" !== typeof Uint8Array &&
            "undefined" !== typeof Uint16Array &&
            "undefined" !== typeof Int32Array;
          e.assign = function (h) {
            for (var n = Array.prototype.slice.call(arguments, 1); n.length; ) {
              var q = n.shift();
              if (q) {
                if ("object" !== typeof q)
                  throw new TypeError(q + "must be non-object");
                for (var t in q) q.hasOwnProperty(t) && (h[t] = q[t]);
              }
            }
            return h;
          };
          e.shrinkBuf = function (h, n) {
            if (h.length === n) return h;
            if (h.subarray) return h.subarray(0, n);
            h.length = n;
            return h;
          };
          var d = {
              arraySet: function (h, n, q, t, u) {
                if (n.subarray && h.subarray) h.set(n.subarray(q, q + t), u);
                else for (var A = 0; A < t; A++) h[u + A] = n[q + A];
              },
              flattenChunks: function (h) {
                var n, q;
                var t = (q = 0);
                for (n = h.length; t < n; t++) q += h[t].length;
                var u = new Uint8Array(q);
                t = q = 0;
                for (n = h.length; t < n; t++) {
                  var A = h[t];
                  u.set(A, q);
                  q += A.length;
                }
                return u;
              },
            },
            g = {
              arraySet: function (h, n, q, t, u) {
                for (var A = 0; A < t; A++) h[u + A] = n[q + A];
              },
              flattenChunks: function (h) {
                return [].concat.apply([], h);
              },
            };
          e.setTyped = function (h) {
            h
              ? ((e.Buf8 = Uint8Array),
                (e.Buf16 = Uint16Array),
                (e.Buf32 = Int32Array),
                e.assign(e, d))
              : ((e.Buf8 = Array),
                (e.Buf16 = Array),
                (e.Buf32 = Array),
                e.assign(e, g));
          };
          e.setTyped(b);
        },
        {},
      ],
      3: [
        function (b, c, e) {
          function d(t, u) {
            if (65537 > u && ((t.subarray && n) || (!t.subarray && h)))
              return String.fromCharCode.apply(null, g.shrinkBuf(t, u));
            for (var A = "", G = 0; G < u; G++) A += String.fromCharCode(t[G]);
            return A;
          }
          var g = b("./common"),
            h = !0,
            n = !0;
          try {
            String.fromCharCode.apply(null, [0]);
          } catch (t) {
            h = !1;
          }
          try {
            String.fromCharCode.apply(null, new Uint8Array(1));
          } catch (t) {
            n = !1;
          }
          var q = new g.Buf8(256);
          for (b = 0; 256 > b; b++)
            q[b] =
              252 <= b
                ? 6
                : 248 <= b
                ? 5
                : 240 <= b
                ? 4
                : 224 <= b
                ? 3
                : 192 <= b
                ? 2
                : 1;
          q[254] = q[254] = 1;
          e.string2buf = function (t) {
            var u,
              A,
              G = t.length,
              O = 0;
            for (u = 0; u < G; u++) {
              var H = t.charCodeAt(u);
              if (55296 === (H & 64512) && u + 1 < G) {
                var P = t.charCodeAt(u + 1);
                56320 === (P & 64512) &&
                  ((H = 65536 + ((H - 55296) << 10) + (P - 56320)), u++);
              }
              O += 128 > H ? 1 : 2048 > H ? 2 : 65536 > H ? 3 : 4;
            }
            var U = new g.Buf8(O);
            for (u = A = 0; A < O; u++)
              (H = t.charCodeAt(u)),
                55296 === (H & 64512) &&
                  u + 1 < G &&
                  ((P = t.charCodeAt(u + 1)),
                  56320 === (P & 64512) &&
                    ((H = 65536 + ((H - 55296) << 10) + (P - 56320)), u++)),
                128 > H
                  ? (U[A++] = H)
                  : (2048 > H
                      ? (U[A++] = 192 | (H >>> 6))
                      : (65536 > H
                          ? (U[A++] = 224 | (H >>> 12))
                          : ((U[A++] = 240 | (H >>> 18)),
                            (U[A++] = 128 | ((H >>> 12) & 63))),
                        (U[A++] = 128 | ((H >>> 6) & 63))),
                    (U[A++] = 128 | (H & 63)));
            return U;
          };
          e.buf2binstring = function (t) {
            return d(t, t.length);
          };
          e.binstring2buf = function (t) {
            for (var u = new g.Buf8(t.length), A = 0, G = u.length; A < G; A++)
              u[A] = t.charCodeAt(A);
            return u;
          };
          e.buf2string = function (t, u) {
            var A,
              G = u || t.length,
              O = Array(2 * G);
            for (u = A = 0; u < G; ) {
              var H = t[u++];
              if (128 > H) O[A++] = H;
              else {
                var P = q[H];
                if (4 < P) (O[A++] = 65533), (u += P - 1);
                else {
                  for (H &= 2 === P ? 31 : 3 === P ? 15 : 7; 1 < P && u < G; )
                    (H = (H << 6) | (t[u++] & 63)), P--;
                  1 < P
                    ? (O[A++] = 65533)
                    : 65536 > H
                    ? (O[A++] = H)
                    : ((H -= 65536),
                      (O[A++] = 55296 | ((H >> 10) & 1023)),
                      (O[A++] = 56320 | (H & 1023)));
                }
              }
            }
            return d(O, A);
          };
          e.utf8border = function (t, u) {
            var A;
            u = u || t.length;
            u > t.length && (u = t.length);
            for (A = u - 1; 0 <= A && 128 === (t[A] & 192); ) A--;
            return 0 > A || 0 === A ? u : A + q[t[A]] > u ? A : u;
          };
        },
        { "./common": 2 },
      ],
      4: [
        function (b, c, e) {
          c.exports = function (d, g, h, n) {
            var q = (d & 65535) | 0;
            d = ((d >>> 16) & 65535) | 0;
            for (var t; 0 !== h; ) {
              t = 2e3 < h ? 2e3 : h;
              h -= t;
              do (q = (q + g[n++]) | 0), (d = (d + q) | 0);
              while (--t);
              q %= 65521;
              d %= 65521;
            }
            return q | (d << 16) | 0;
          };
        },
        {},
      ],
      5: [
        function (b, c, e) {
          c.exports = {
            Z_NO_FLUSH: 0,
            Z_PARTIAL_FLUSH: 1,
            Z_SYNC_FLUSH: 2,
            Z_FULL_FLUSH: 3,
            Z_FINISH: 4,
            Z_BLOCK: 5,
            Z_TREES: 6,
            Z_OK: 0,
            Z_STREAM_END: 1,
            Z_NEED_DICT: 2,
            Z_ERRNO: -1,
            Z_STREAM_ERROR: -2,
            Z_DATA_ERROR: -3,
            Z_BUF_ERROR: -5,
            Z_NO_COMPRESSION: 0,
            Z_BEST_SPEED: 1,
            Z_BEST_COMPRESSION: 9,
            Z_DEFAULT_COMPRESSION: -1,
            Z_FILTERED: 1,
            Z_HUFFMAN_ONLY: 2,
            Z_RLE: 3,
            Z_FIXED: 4,
            Z_DEFAULT_STRATEGY: 0,
            Z_BINARY: 0,
            Z_TEXT: 1,
            Z_UNKNOWN: 2,
            Z_DEFLATED: 8,
          };
        },
        {},
      ],
      6: [
        function (b, c, e) {
          var d = (function () {
            for (var g, h = [], n = 0; 256 > n; n++) {
              g = n;
              for (var q = 0; 8 > q; q++)
                g = g & 1 ? 3988292384 ^ (g >>> 1) : g >>> 1;
              h[n] = g;
            }
            return h;
          })();
          c.exports = function (g, h, n, q) {
            n = q + n;
            for (g ^= -1; q < n; q++) g = (g >>> 8) ^ d[(g ^ h[q]) & 255];
            return g ^ -1;
          };
        },
        {},
      ],
      7: [
        function (b, c, e) {
          c.exports = function () {
            this.os = this.xflags = this.time = this.text = 0;
            this.extra = null;
            this.extra_len = 0;
            this.comment = this.name = "";
            this.hcrc = 0;
            this.done = !1;
          };
        },
        {},
      ],
      8: [
        function (b, c, e) {
          c.exports = function (d, g) {
            var h = d.state;
            var n = d.next_in;
            var q = d.input;
            var t = n + (d.avail_in - 5);
            var u = d.next_out;
            var A = d.output;
            g = u - (g - d.avail_out);
            var G = u + (d.avail_out - 257);
            var O = h.dmax;
            var H = h.wsize;
            var P = h.whave;
            var U = h.wnext;
            var ha = h.window;
            var w = h.hold;
            var I = h.bits;
            var aa = h.lencode;
            var T = h.distcode;
            var ka = (1 << h.lenbits) - 1;
            var k = (1 << h.distbits) - 1;
            a: do {
              15 > I &&
                ((w += q[n++] << I), (I += 8), (w += q[n++] << I), (I += 8));
              var X = aa[w & ka];
              b: for (;;) {
                var V = X >>> 24;
                w >>>= V;
                I -= V;
                V = (X >>> 16) & 255;
                if (0 === V) A[u++] = X & 65535;
                else if (V & 16) {
                  var p = X & 65535;
                  if ((V &= 15))
                    I < V && ((w += q[n++] << I), (I += 8)),
                      (p += w & ((1 << V) - 1)),
                      (w >>>= V),
                      (I -= V);
                  15 > I &&
                    ((w += q[n++] << I),
                    (I += 8),
                    (w += q[n++] << I),
                    (I += 8));
                  X = T[w & k];
                  c: for (;;) {
                    V = X >>> 24;
                    w >>>= V;
                    I -= V;
                    V = (X >>> 16) & 255;
                    if (V & 16) {
                      X &= 65535;
                      V &= 15;
                      I < V &&
                        ((w += q[n++] << I),
                        (I += 8),
                        I < V && ((w += q[n++] << I), (I += 8)));
                      X += w & ((1 << V) - 1);
                      if (X > O) {
                        d.msg = "invalid distance too far back";
                        h.mode = 30;
                        break a;
                      }
                      w >>>= V;
                      I -= V;
                      V = u - g;
                      if (X > V) {
                        V = X - V;
                        if (V > P && h.sane) {
                          d.msg = "invalid distance too far back";
                          h.mode = 30;
                          break a;
                        }
                        var m = 0;
                        var F = ha;
                        if (0 === U) {
                          if (((m += H - V), V < p)) {
                            p -= V;
                            do A[u++] = ha[m++];
                            while (--V);
                            m = u - X;
                            F = A;
                          }
                        } else if (U < V) {
                          if (((m += H + U - V), (V -= U), V < p)) {
                            p -= V;
                            do A[u++] = ha[m++];
                            while (--V);
                            m = 0;
                            if (U < p) {
                              V = U;
                              p -= V;
                              do A[u++] = ha[m++];
                              while (--V);
                              m = u - X;
                              F = A;
                            }
                          }
                        } else if (((m += U - V), V < p)) {
                          p -= V;
                          do A[u++] = ha[m++];
                          while (--V);
                          m = u - X;
                          F = A;
                        }
                        for (; 2 < p; )
                          (A[u++] = F[m++]),
                            (A[u++] = F[m++]),
                            (A[u++] = F[m++]),
                            (p -= 3);
                        p && ((A[u++] = F[m++]), 1 < p && (A[u++] = F[m++]));
                      } else {
                        m = u - X;
                        do
                          (A[u++] = A[m++]),
                            (A[u++] = A[m++]),
                            (A[u++] = A[m++]),
                            (p -= 3);
                        while (2 < p);
                        p && ((A[u++] = A[m++]), 1 < p && (A[u++] = A[m++]));
                      }
                    } else if (0 === (V & 64)) {
                      X = T[(X & 65535) + (w & ((1 << V) - 1))];
                      continue c;
                    } else {
                      d.msg = "invalid distance code";
                      h.mode = 30;
                      break a;
                    }
                    break;
                  }
                } else if (0 === (V & 64)) {
                  X = aa[(X & 65535) + (w & ((1 << V) - 1))];
                  continue b;
                } else {
                  V & 32
                    ? (h.mode = 12)
                    : ((d.msg = "invalid literal/length code"), (h.mode = 30));
                  break a;
                }
                break;
              }
            } while (n < t && u < G);
            p = I >> 3;
            n -= p;
            I -= p << 3;
            d.next_in = n;
            d.next_out = u;
            d.avail_in = n < t ? 5 + (t - n) : 5 - (n - t);
            d.avail_out = u < G ? 257 + (G - u) : 257 - (u - G);
            h.hold = w & ((1 << I) - 1);
            h.bits = I;
          };
        },
        {},
      ],
      9: [
        function (b, c, e) {
          function d(w) {
            return (
              ((w >>> 24) & 255) +
              ((w >>> 8) & 65280) +
              ((w & 65280) << 8) +
              ((w & 255) << 24)
            );
          }
          function g() {
            this.mode = 0;
            this.last = !1;
            this.wrap = 0;
            this.havedict = !1;
            this.total = this.check = this.dmax = this.flags = 0;
            this.head = null;
            this.wnext = this.whave = this.wsize = this.wbits = 0;
            this.window = null;
            this.extra = this.offset = this.length = this.bits = this.hold = 0;
            this.distcode = this.lencode = null;
            this.have =
              this.ndist =
              this.nlen =
              this.ncode =
              this.distbits =
              this.lenbits =
                0;
            this.next = null;
            this.lens = new u.Buf16(320);
            this.work = new u.Buf16(288);
            this.distdyn = this.lendyn = null;
            this.was = this.back = this.sane = 0;
          }
          function h(w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            w.total_in = w.total_out = I.total = 0;
            w.msg = "";
            I.wrap && (w.adler = I.wrap & 1);
            I.mode = 1;
            I.last = 0;
            I.havedict = 0;
            I.dmax = 32768;
            I.head = null;
            I.hold = 0;
            I.bits = 0;
            I.lencode = I.lendyn = new u.Buf32(852);
            I.distcode = I.distdyn = new u.Buf32(592);
            I.sane = 1;
            I.back = -1;
            return 0;
          }
          function n(w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            I.wsize = 0;
            I.whave = 0;
            I.wnext = 0;
            return h(w);
          }
          function q(w, I) {
            if (!w || !w.state) return -2;
            var aa = w.state;
            if (0 > I) {
              var T = 0;
              I = -I;
            } else (T = (I >> 4) + 1), 48 > I && (I &= 15);
            if (I && (8 > I || 15 < I)) return -2;
            null !== aa.window && aa.wbits !== I && (aa.window = null);
            aa.wrap = T;
            aa.wbits = I;
            return n(w);
          }
          function t(w, I) {
            if (!w) return -2;
            var aa = new g();
            w.state = aa;
            aa.window = null;
            I = q(w, I);
            0 !== I && (w.state = null);
            return I;
          }
          var u = b("../utils/common"),
            A = b("./adler32"),
            G = b("./crc32"),
            O = b("./inffast"),
            H = b("./inftrees"),
            P = !0,
            U,
            ha;
          e.inflateReset = n;
          e.inflateReset2 = q;
          e.inflateResetKeep = h;
          e.inflateInit = function (w) {
            return t(w, 15);
          };
          e.inflateInit2 = t;
          e.inflate = function (w, I) {
            var aa,
              T = new u.Buf8(4),
              ka = [
                16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1,
                15,
              ];
            if (!w || !w.state || !w.output || (!w.input && 0 !== w.avail_in))
              return -2;
            var k = w.state;
            12 === k.mode && (k.mode = 13);
            var X = w.next_out;
            var V = w.output;
            var p = w.avail_out;
            var m = w.next_in;
            var F = w.input;
            var r = w.avail_in;
            var y = k.hold;
            var D = k.bits;
            var B = r;
            var C = p;
            var L = 0;
            a: for (;;)
              switch (k.mode) {
                case 1:
                  if (0 === k.wrap) {
                    k.mode = 13;
                    break;
                  }
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (k.wrap & 2 && 35615 === y) {
                    k.check = 0;
                    T[0] = y & 255;
                    T[1] = (y >>> 8) & 255;
                    k.check = G(k.check, T, 2, 0);
                    D = y = 0;
                    k.mode = 2;
                    break;
                  }
                  k.flags = 0;
                  k.head && (k.head.done = !1);
                  if (!(k.wrap & 1) || (((y & 255) << 8) + (y >> 8)) % 31) {
                    w.msg = "incorrect header check";
                    k.mode = 30;
                    break;
                  }
                  if (8 !== (y & 15)) {
                    w.msg = "unknown compression method";
                    k.mode = 30;
                    break;
                  }
                  y >>>= 4;
                  D -= 4;
                  var N = (y & 15) + 8;
                  if (0 === k.wbits) k.wbits = N;
                  else if (N > k.wbits) {
                    w.msg = "invalid window size";
                    k.mode = 30;
                    break;
                  }
                  k.dmax = 1 << N;
                  w.adler = k.check = 1;
                  k.mode = y & 512 ? 10 : 12;
                  D = y = 0;
                  break;
                case 2:
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.flags = y;
                  if (8 !== (k.flags & 255)) {
                    w.msg = "unknown compression method";
                    k.mode = 30;
                    break;
                  }
                  if (k.flags & 57344) {
                    w.msg = "unknown header flags set";
                    k.mode = 30;
                    break;
                  }
                  k.head && (k.head.text = (y >> 8) & 1);
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (k.check = G(k.check, T, 2, 0)));
                  D = y = 0;
                  k.mode = 3;
                case 3:
                  for (; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.head && (k.head.time = y);
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (T[2] = (y >>> 16) & 255),
                    (T[3] = (y >>> 24) & 255),
                    (k.check = G(k.check, T, 4, 0)));
                  D = y = 0;
                  k.mode = 4;
                case 4:
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.head && ((k.head.xflags = y & 255), (k.head.os = y >> 8));
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (k.check = G(k.check, T, 2, 0)));
                  D = y = 0;
                  k.mode = 5;
                case 5:
                  if (k.flags & 1024) {
                    for (; 16 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.length = y;
                    k.head && (k.head.extra_len = y);
                    k.flags & 512 &&
                      ((T[0] = y & 255),
                      (T[1] = (y >>> 8) & 255),
                      (k.check = G(k.check, T, 2, 0)));
                    D = y = 0;
                  } else k.head && (k.head.extra = null);
                  k.mode = 6;
                case 6:
                  if (k.flags & 1024) {
                    var K = k.length;
                    K > r && (K = r);
                    K &&
                      (k.head &&
                        ((N = k.head.extra_len - k.length),
                        k.head.extra ||
                          (k.head.extra = Array(k.head.extra_len)),
                        u.arraySet(k.head.extra, F, m, K, N)),
                      k.flags & 512 && (k.check = G(k.check, F, K, m)),
                      (r -= K),
                      (m += K),
                      (k.length -= K));
                    if (k.length) break a;
                  }
                  k.length = 0;
                  k.mode = 7;
                case 7:
                  if (k.flags & 2048) {
                    if (0 === r) break a;
                    K = 0;
                    do
                      (N = F[m + K++]),
                        k.head &&
                          N &&
                          65536 > k.length &&
                          (k.head.name += String.fromCharCode(N));
                    while (N && K < r);
                    k.flags & 512 && (k.check = G(k.check, F, K, m));
                    r -= K;
                    m += K;
                    if (N) break a;
                  } else k.head && (k.head.name = null);
                  k.length = 0;
                  k.mode = 8;
                case 8:
                  if (k.flags & 4096) {
                    if (0 === r) break a;
                    K = 0;
                    do
                      (N = F[m + K++]),
                        k.head &&
                          N &&
                          65536 > k.length &&
                          (k.head.comment += String.fromCharCode(N));
                    while (N && K < r);
                    k.flags & 512 && (k.check = G(k.check, F, K, m));
                    r -= K;
                    m += K;
                    if (N) break a;
                  } else k.head && (k.head.comment = null);
                  k.mode = 9;
                case 9:
                  if (k.flags & 512) {
                    for (; 16 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (y !== (k.check & 65535)) {
                      w.msg = "header crc mismatch";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.head &&
                    ((k.head.hcrc = (k.flags >> 9) & 1), (k.head.done = !0));
                  w.adler = k.check = 0;
                  k.mode = 12;
                  break;
                case 10:
                  for (; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  w.adler = k.check = d(y);
                  D = y = 0;
                  k.mode = 11;
                case 11:
                  if (0 === k.havedict)
                    return (
                      (w.next_out = X),
                      (w.avail_out = p),
                      (w.next_in = m),
                      (w.avail_in = r),
                      (k.hold = y),
                      (k.bits = D),
                      2
                    );
                  w.adler = k.check = 1;
                  k.mode = 12;
                case 12:
                  if (5 === I || 6 === I) break a;
                case 13:
                  if (k.last) {
                    y >>>= D & 7;
                    D -= D & 7;
                    k.mode = 27;
                    break;
                  }
                  for (; 3 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.last = y & 1;
                  y >>>= 1;
                  --D;
                  switch (y & 3) {
                    case 0:
                      k.mode = 14;
                      break;
                    case 1:
                      N = k;
                      if (P) {
                        U = new u.Buf32(512);
                        ha = new u.Buf32(32);
                        for (K = 0; 144 > K; ) N.lens[K++] = 8;
                        for (; 256 > K; ) N.lens[K++] = 9;
                        for (; 280 > K; ) N.lens[K++] = 7;
                        for (; 288 > K; ) N.lens[K++] = 8;
                        H(1, N.lens, 0, 288, U, 0, N.work, { bits: 9 });
                        for (K = 0; 32 > K; ) N.lens[K++] = 5;
                        H(2, N.lens, 0, 32, ha, 0, N.work, { bits: 5 });
                        P = !1;
                      }
                      N.lencode = U;
                      N.lenbits = 9;
                      N.distcode = ha;
                      N.distbits = 5;
                      k.mode = 20;
                      if (6 === I) {
                        y >>>= 2;
                        D -= 2;
                        break a;
                      }
                      break;
                    case 2:
                      k.mode = 17;
                      break;
                    case 3:
                      (w.msg = "invalid block type"), (k.mode = 30);
                  }
                  y >>>= 2;
                  D -= 2;
                  break;
                case 14:
                  y >>>= D & 7;
                  for (D -= D & 7; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if ((y & 65535) !== ((y >>> 16) ^ 65535)) {
                    w.msg = "invalid stored block lengths";
                    k.mode = 30;
                    break;
                  }
                  k.length = y & 65535;
                  D = y = 0;
                  k.mode = 15;
                  if (6 === I) break a;
                case 15:
                  k.mode = 16;
                case 16:
                  if ((K = k.length)) {
                    K > r && (K = r);
                    K > p && (K = p);
                    if (0 === K) break a;
                    u.arraySet(V, F, m, K, X);
                    r -= K;
                    m += K;
                    p -= K;
                    X += K;
                    k.length -= K;
                    break;
                  }
                  k.mode = 12;
                  break;
                case 17:
                  for (; 14 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.nlen = (y & 31) + 257;
                  y >>>= 5;
                  D -= 5;
                  k.ndist = (y & 31) + 1;
                  y >>>= 5;
                  D -= 5;
                  k.ncode = (y & 15) + 4;
                  y >>>= 4;
                  D -= 4;
                  if (286 < k.nlen || 30 < k.ndist) {
                    w.msg = "too many length or distance symbols";
                    k.mode = 30;
                    break;
                  }
                  k.have = 0;
                  k.mode = 18;
                case 18:
                  for (; k.have < k.ncode; ) {
                    for (; 3 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.lens[ka[k.have++]] = y & 7;
                    y >>>= 3;
                    D -= 3;
                  }
                  for (; 19 > k.have; ) k.lens[ka[k.have++]] = 0;
                  k.lencode = k.lendyn;
                  k.lenbits = 7;
                  K = { bits: k.lenbits };
                  L = H(0, k.lens, 0, 19, k.lencode, 0, k.work, K);
                  k.lenbits = K.bits;
                  if (L) {
                    w.msg = "invalid code lengths set";
                    k.mode = 30;
                    break;
                  }
                  k.have = 0;
                  k.mode = 19;
                case 19:
                  for (; k.have < k.nlen + k.ndist; ) {
                    for (;;) {
                      var z = k.lencode[y & ((1 << k.lenbits) - 1)];
                      K = z >>> 24;
                      z &= 65535;
                      if (K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (16 > z) (y >>>= K), (D -= K), (k.lens[k.have++] = z);
                    else {
                      if (16 === z) {
                        for (N = K + 2; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        if (0 === k.have) {
                          w.msg = "invalid bit length repeat";
                          k.mode = 30;
                          break;
                        }
                        N = k.lens[k.have - 1];
                        K = 3 + (y & 3);
                        y >>>= 2;
                        D -= 2;
                      } else if (17 === z) {
                        for (N = K + 3; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        N = 0;
                        K = 3 + (y & 7);
                        y >>>= 3;
                        D -= 3;
                      } else {
                        for (N = K + 7; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        N = 0;
                        K = 11 + (y & 127);
                        y >>>= 7;
                        D -= 7;
                      }
                      if (k.have + K > k.nlen + k.ndist) {
                        w.msg = "invalid bit length repeat";
                        k.mode = 30;
                        break;
                      }
                      for (; K--; ) k.lens[k.have++] = N;
                    }
                  }
                  if (30 === k.mode) break;
                  if (0 === k.lens[256]) {
                    w.msg = "invalid code -- missing end-of-block";
                    k.mode = 30;
                    break;
                  }
                  k.lenbits = 9;
                  K = { bits: k.lenbits };
                  L = H(1, k.lens, 0, k.nlen, k.lencode, 0, k.work, K);
                  k.lenbits = K.bits;
                  if (L) {
                    w.msg = "invalid literal/lengths set";
                    k.mode = 30;
                    break;
                  }
                  k.distbits = 6;
                  k.distcode = k.distdyn;
                  K = { bits: k.distbits };
                  L = H(2, k.lens, k.nlen, k.ndist, k.distcode, 0, k.work, K);
                  k.distbits = K.bits;
                  if (L) {
                    w.msg = "invalid distances set";
                    k.mode = 30;
                    break;
                  }
                  k.mode = 20;
                  if (6 === I) break a;
                case 20:
                  k.mode = 21;
                case 21:
                  if (6 <= r && 258 <= p) {
                    w.next_out = X;
                    w.avail_out = p;
                    w.next_in = m;
                    w.avail_in = r;
                    k.hold = y;
                    k.bits = D;
                    O(w, C);
                    X = w.next_out;
                    V = w.output;
                    p = w.avail_out;
                    m = w.next_in;
                    F = w.input;
                    r = w.avail_in;
                    y = k.hold;
                    D = k.bits;
                    12 === k.mode && (k.back = -1);
                    break;
                  }
                  for (k.back = 0; ; ) {
                    z = k.lencode[y & ((1 << k.lenbits) - 1)];
                    K = z >>> 24;
                    N = (z >>> 16) & 255;
                    z &= 65535;
                    if (K <= D) break;
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (N && 0 === (N & 240)) {
                    var R = K;
                    var ba = N;
                    for (aa = z; ; ) {
                      z = k.lencode[aa + ((y & ((1 << (R + ba)) - 1)) >> R)];
                      K = z >>> 24;
                      N = (z >>> 16) & 255;
                      z &= 65535;
                      if (R + K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    y >>>= R;
                    D -= R;
                    k.back += R;
                  }
                  y >>>= K;
                  D -= K;
                  k.back += K;
                  k.length = z;
                  if (0 === N) {
                    k.mode = 26;
                    break;
                  }
                  if (N & 32) {
                    k.back = -1;
                    k.mode = 12;
                    break;
                  }
                  if (N & 64) {
                    w.msg = "invalid literal/length code";
                    k.mode = 30;
                    break;
                  }
                  k.extra = N & 15;
                  k.mode = 22;
                case 22:
                  if (k.extra) {
                    for (N = k.extra; D < N; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.length += y & ((1 << k.extra) - 1);
                    y >>>= k.extra;
                    D -= k.extra;
                    k.back += k.extra;
                  }
                  k.was = k.length;
                  k.mode = 23;
                case 23:
                  for (;;) {
                    z = k.distcode[y & ((1 << k.distbits) - 1)];
                    K = z >>> 24;
                    N = (z >>> 16) & 255;
                    z &= 65535;
                    if (K <= D) break;
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (0 === (N & 240)) {
                    R = K;
                    ba = N;
                    for (aa = z; ; ) {
                      z = k.distcode[aa + ((y & ((1 << (R + ba)) - 1)) >> R)];
                      K = z >>> 24;
                      N = (z >>> 16) & 255;
                      z &= 65535;
                      if (R + K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    y >>>= R;
                    D -= R;
                    k.back += R;
                  }
                  y >>>= K;
                  D -= K;
                  k.back += K;
                  if (N & 64) {
                    w.msg = "invalid distance code";
                    k.mode = 30;
                    break;
                  }
                  k.offset = z;
                  k.extra = N & 15;
                  k.mode = 24;
                case 24:
                  if (k.extra) {
                    for (N = k.extra; D < N; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.offset += y & ((1 << k.extra) - 1);
                    y >>>= k.extra;
                    D -= k.extra;
                    k.back += k.extra;
                  }
                  if (k.offset > k.dmax) {
                    w.msg = "invalid distance too far back";
                    k.mode = 30;
                    break;
                  }
                  k.mode = 25;
                case 25:
                  if (0 === p) break a;
                  K = C - p;
                  if (k.offset > K) {
                    K = k.offset - K;
                    if (K > k.whave && k.sane) {
                      w.msg = "invalid distance too far back";
                      k.mode = 30;
                      break;
                    }
                    K > k.wnext
                      ? ((K -= k.wnext), (N = k.wsize - K))
                      : (N = k.wnext - K);
                    K > k.length && (K = k.length);
                    R = k.window;
                  } else (R = V), (N = X - k.offset), (K = k.length);
                  K > p && (K = p);
                  p -= K;
                  k.length -= K;
                  do V[X++] = R[N++];
                  while (--K);
                  0 === k.length && (k.mode = 21);
                  break;
                case 26:
                  if (0 === p) break a;
                  V[X++] = k.length;
                  p--;
                  k.mode = 21;
                  break;
                case 27:
                  if (k.wrap) {
                    for (; 32 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y |= F[m++] << D;
                      D += 8;
                    }
                    C -= p;
                    w.total_out += C;
                    k.total += C;
                    C &&
                      (w.adler = k.check =
                        k.flags
                          ? G(k.check, V, C, X - C)
                          : A(k.check, V, C, X - C));
                    C = p;
                    if ((k.flags ? y : d(y)) !== k.check) {
                      w.msg = "incorrect data check";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.mode = 28;
                case 28:
                  if (k.wrap && k.flags) {
                    for (; 32 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (y !== (k.total & 4294967295)) {
                      w.msg = "incorrect length check";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.mode = 29;
                case 29:
                  L = 1;
                  break a;
                case 30:
                  L = -3;
                  break a;
                case 31:
                  return -4;
                default:
                  return -2;
              }
            w.next_out = X;
            w.avail_out = p;
            w.next_in = m;
            w.avail_in = r;
            k.hold = y;
            k.bits = D;
            if (
              k.wsize ||
              (C !== w.avail_out && 30 > k.mode && (27 > k.mode || 4 !== I))
            )
              (F = w.output),
                (m = w.next_out),
                (X = C - w.avail_out),
                (p = w.state),
                null === p.window &&
                  ((p.wsize = 1 << p.wbits),
                  (p.wnext = 0),
                  (p.whave = 0),
                  (p.window = new u.Buf8(p.wsize))),
                X >= p.wsize
                  ? (u.arraySet(p.window, F, m - p.wsize, p.wsize, 0),
                    (p.wnext = 0),
                    (p.whave = p.wsize))
                  : ((r = p.wsize - p.wnext),
                    r > X && (r = X),
                    u.arraySet(p.window, F, m - X, r, p.wnext),
                    (X -= r)
                      ? (u.arraySet(p.window, F, m - X, X, 0),
                        (p.wnext = X),
                        (p.whave = p.wsize))
                      : ((p.wnext += r),
                        p.wnext === p.wsize && (p.wnext = 0),
                        p.whave < p.wsize && (p.whave += r)));
            B -= w.avail_in;
            C -= w.avail_out;
            w.total_in += B;
            w.total_out += C;
            k.total += C;
            k.wrap &&
              C &&
              (w.adler = k.check =
                k.flags
                  ? G(k.check, V, C, w.next_out - C)
                  : A(k.check, V, C, w.next_out - C));
            w.data_type =
              k.bits +
              (k.last ? 64 : 0) +
              (12 === k.mode ? 128 : 0) +
              (20 === k.mode || 15 === k.mode ? 256 : 0);
            ((0 === B && 0 === C) || 4 === I) && 0 === L && (L = -5);
            return L;
          };
          e.inflateEnd = function (w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            I.window && (I.window = null);
            w.state = null;
            return 0;
          };
          e.inflateGetHeader = function (w, I) {
            if (!w || !w.state) return -2;
            w = w.state;
            if (0 === (w.wrap & 2)) return -2;
            w.head = I;
            I.done = !1;
            return 0;
          };
          e.inflateInfo = "pako inflate (from Nodeca project)";
        },
        {
          "../utils/common": 2,
          "./adler32": 4,
          "./crc32": 6,
          "./inffast": 8,
          "./inftrees": 10,
        },
      ],
      10: [
        function (b, c, e) {
          var d = b("../utils/common"),
            g = [
              3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43,
              51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0,
            ],
            h = [
              16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18,
              19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78,
            ],
            n = [
              1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257,
              385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289,
              16385, 24577, 0, 0,
            ],
            q = [
              16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22,
              23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64,
            ];
          c.exports = function (t, u, A, G, O, H, P, U) {
            var ha = U.bits,
              w,
              I,
              aa,
              T,
              ka,
              k,
              X = 0,
              V = new d.Buf16(16);
            var p = new d.Buf16(16);
            var m,
              F = 0;
            for (w = 0; 15 >= w; w++) V[w] = 0;
            for (I = 0; I < G; I++) V[u[A + I]]++;
            var r = ha;
            for (aa = 15; 1 <= aa && 0 === V[aa]; aa--);
            r > aa && (r = aa);
            if (0 === aa)
              return (O[H++] = 20971520), (O[H++] = 20971520), (U.bits = 1), 0;
            for (ha = 1; ha < aa && 0 === V[ha]; ha++);
            r < ha && (r = ha);
            for (w = T = 1; 15 >= w; w++)
              if (((T <<= 1), (T -= V[w]), 0 > T)) return -1;
            if (0 < T && (0 === t || 1 !== aa)) return -1;
            p[1] = 0;
            for (w = 1; 15 > w; w++) p[w + 1] = p[w] + V[w];
            for (I = 0; I < G; I++) 0 !== u[A + I] && (P[p[u[A + I]]++] = I);
            switch (t) {
              case 0:
                var y = (m = P);
                var D = 19;
                break;
              case 1:
                y = g;
                X -= 257;
                m = h;
                F -= 257;
                D = 256;
                break;
              default:
                (y = n), (m = q), (D = -1);
            }
            I = ka = 0;
            w = ha;
            var B = H;
            G = r;
            p = 0;
            var C = -1;
            var L = 1 << r;
            var N = L - 1;
            if ((1 === t && 852 < L) || (2 === t && 592 < L)) return 1;
            for (var K = 0; ; ) {
              K++;
              var z = w - p;
              if (P[I] < D) {
                var R = 0;
                var ba = P[I];
              } else
                P[I] > D
                  ? ((R = m[F + P[I]]), (ba = y[X + P[I]]))
                  : ((R = 96), (ba = 0));
              T = 1 << (w - p);
              ha = k = 1 << G;
              do
                (k -= T),
                  (O[B + (ka >> p) + k] = (z << 24) | (R << 16) | ba | 0);
              while (0 !== k);
              for (T = 1 << (w - 1); ka & T; ) T >>= 1;
              0 !== T ? ((ka &= T - 1), (ka += T)) : (ka = 0);
              I++;
              if (0 === --V[w]) {
                if (w === aa) break;
                w = u[A + P[I]];
              }
              if (w > r && (ka & N) !== C) {
                0 === p && (p = r);
                B += ha;
                G = w - p;
                for (T = 1 << G; G + p < aa; ) {
                  T -= V[G + p];
                  if (0 >= T) break;
                  G++;
                  T <<= 1;
                }
                L += 1 << G;
                if ((1 === t && 852 < L) || (2 === t && 592 < L)) return 1;
                C = ka & N;
                O[C] = (r << 24) | (G << 16) | (B - H) | 0;
              }
            }
            0 !== ka && (O[B + ka] = ((w - p) << 24) | 4194304);
            U.bits = r;
            return 0;
          };
        },
        { "../utils/common": 2 },
      ],
      11: [
        function (b, c, e) {
          c.exports = {
            2: "need dictionary",
            1: "stream end",
            0: "",
            "-1": "file error",
            "-2": "stream error",
            "-3": "data error",
            "-4": "insufficient memory",
            "-5": "buffer error",
            "-6": "incompatible version",
          };
        },
        {},
      ],
      12: [
        function (b, c, e) {
          c.exports = function () {
            this.input = null;
            this.total_in = this.avail_in = this.next_in = 0;
            this.output = null;
            this.total_out = this.avail_out = this.next_out = 0;
            this.msg = "";
            this.state = null;
            this.data_type = 2;
            this.adler = 0;
          };
        },
        {},
      ],
    },
    {},
    [1]
  )(1);
});
(function (a) {
  "object" === typeof exports && "undefined" !== typeof module
    ? (module.exports = a())
    : "function" === typeof define && define.amd
    ? define([], a)
    : (("undefined" !== typeof window
        ? window
        : "undefined" !== typeof global
        ? global
        : "undefined" !== typeof self
        ? self
        : this
      ).nifti = a());
})(function () {
  return (function d(b, c, e) {
    function g(q, t) {
      if (!c[q]) {
        if (!b[q]) {
          var u = "function" == typeof require && require;
          if (!t && u) return u(q, !0);
          if (h) return h(q, !0);
          t = Error("Cannot find module '" + q + "'");
          throw ((t.code = "MODULE_NOT_FOUND"), t);
        }
        t = c[q] = { exports: {} };
        b[q][0].call(
          t.exports,
          function (A) {
            var G = b[q][1][A];
            return g(G ? G : A);
          },
          t,
          t.exports,
          d,
          b,
          c,
          e
        );
      }
      return c[q].exports;
    }
    for (
      var h = "function" == typeof require && require, n = 0;
      n < e.length;
      n++
    )
      g(e[n]);
    return g;
  })(
    {
      1: [
        function (b, c, e) {
          e = b("./lib/utils/common").assign;
          var d = b("./lib/deflate"),
            g = b("./lib/inflate");
          b = b("./lib/zlib/constants");
          var h = {};
          e(h, d, g, b);
          c.exports = h;
        },
        {
          "./lib/deflate": 2,
          "./lib/inflate": 3,
          "./lib/utils/common": 4,
          "./lib/zlib/constants": 7,
        },
      ],
      2: [
        function (b, c, e) {
          function d(G, O) {
            O = new A(O);
            O.push(G, !0);
            if (O.err) throw O.msg;
            return O.result;
          }
          var g = b("./zlib/deflate.js"),
            h = b("./utils/common"),
            n = b("./utils/strings"),
            q = b("./zlib/messages"),
            t = b("./zlib/zstream"),
            u = Object.prototype.toString,
            A = function (G) {
              G = this.options = h.assign(
                {
                  level: -1,
                  method: 8,
                  chunkSize: 16384,
                  windowBits: 15,
                  memLevel: 8,
                  strategy: 0,
                  to: "",
                },
                G || {}
              );
              G.raw && 0 < G.windowBits
                ? (G.windowBits = -G.windowBits)
                : G.gzip &&
                  0 < G.windowBits &&
                  16 > G.windowBits &&
                  (G.windowBits += 16);
              this.err = 0;
              this.msg = "";
              this.ended = !1;
              this.chunks = [];
              this.strm = new t();
              this.strm.avail_out = 0;
              var O = g.deflateInit2(
                this.strm,
                G.level,
                G.method,
                G.windowBits,
                G.memLevel,
                G.strategy
              );
              if (0 !== O) throw Error(q[O]);
              G.header && g.deflateSetHeader(this.strm, G.header);
            };
          A.prototype.push = function (G, O) {
            var H = this.strm,
              P = this.options.chunkSize;
            if (this.ended) return !1;
            O = O === ~~O ? O : !0 === O ? 4 : 0;
            "string" === typeof G
              ? (H.input = n.string2buf(G))
              : "[object ArrayBuffer]" === u.call(G)
              ? (H.input = new Uint8Array(G))
              : (H.input = G);
            H.next_in = 0;
            H.avail_in = H.input.length;
            do {
              0 === H.avail_out &&
                ((H.output = new h.Buf8(P)),
                (H.next_out = 0),
                (H.avail_out = P));
              G = g.deflate(H, O);
              if (1 !== G && 0 !== G)
                return this.onEnd(G), (this.ended = !0), !1;
              if (
                0 === H.avail_out ||
                (0 === H.avail_in && (4 === O || 2 === O))
              )
                if ("string" === this.options.to)
                  this.onData(
                    n.buf2binstring(h.shrinkBuf(H.output, H.next_out))
                  );
                else this.onData(h.shrinkBuf(H.output, H.next_out));
            } while ((0 < H.avail_in || 0 === H.avail_out) && 1 !== G);
            if (4 === O)
              return (
                (G = g.deflateEnd(this.strm)),
                this.onEnd(G),
                (this.ended = !0),
                0 === G
              );
            2 === O && (this.onEnd(0), (H.avail_out = 0));
            return !0;
          };
          A.prototype.onData = function (G) {
            this.chunks.push(G);
          };
          A.prototype.onEnd = function (G) {
            0 === G &&
              (this.result =
                "string" === this.options.to
                  ? this.chunks.join("")
                  : h.flattenChunks(this.chunks));
            this.chunks = [];
            this.err = G;
            this.msg = this.strm.msg;
          };
          e.Deflate = A;
          e.deflate = d;
          e.deflateRaw = function (G, O) {
            O = O || {};
            O.raw = !0;
            return d(G, O);
          };
          e.gzip = function (G, O) {
            O = O || {};
            O.gzip = !0;
            return d(G, O);
          };
        },
        {
          "./utils/common": 4,
          "./utils/strings": 5,
          "./zlib/deflate.js": 9,
          "./zlib/messages": 14,
          "./zlib/zstream": 16,
        },
      ],
      3: [
        function (b, c, e) {
          function d(H, P) {
            P = new O(P);
            P.push(H, !0);
            if (P.err) throw P.msg;
            return P.result;
          }
          var g = b("./zlib/inflate.js"),
            h = b("./utils/common"),
            n = b("./utils/strings"),
            q = b("./zlib/constants"),
            t = b("./zlib/messages"),
            u = b("./zlib/zstream"),
            A = b("./zlib/gzheader"),
            G = Object.prototype.toString,
            O = function (H) {
              var P = (this.options = h.assign(
                { chunkSize: 16384, windowBits: 0, to: "" },
                H || {}
              ));
              P.raw &&
                0 <= P.windowBits &&
                16 > P.windowBits &&
                ((P.windowBits = -P.windowBits),
                0 === P.windowBits && (P.windowBits = -15));
              !(0 <= P.windowBits && 16 > P.windowBits) ||
                (H && H.windowBits) ||
                (P.windowBits += 32);
              15 < P.windowBits &&
                48 > P.windowBits &&
                0 === (P.windowBits & 15) &&
                (P.windowBits |= 15);
              this.err = 0;
              this.msg = "";
              this.ended = !1;
              this.chunks = [];
              this.strm = new u();
              this.strm.avail_out = 0;
              H = g.inflateInit2(this.strm, P.windowBits);
              if (H !== q.Z_OK) throw Error(t[H]);
              this.header = new A();
              g.inflateGetHeader(this.strm, this.header);
            };
          O.prototype.push = function (H, P) {
            var U = this.strm,
              ha = this.options.chunkSize,
              w = !1;
            if (this.ended) return !1;
            P = P === ~~P ? P : !0 === P ? q.Z_FINISH : q.Z_NO_FLUSH;
            "string" === typeof H
              ? (U.input = n.binstring2buf(H))
              : "[object ArrayBuffer]" === G.call(H)
              ? (U.input = new Uint8Array(H))
              : (U.input = H);
            U.next_in = 0;
            U.avail_in = U.input.length;
            do {
              0 === U.avail_out &&
                ((U.output = new h.Buf8(ha)),
                (U.next_out = 0),
                (U.avail_out = ha));
              H = g.inflate(U, q.Z_NO_FLUSH);
              H === q.Z_BUF_ERROR && !0 === w && ((H = q.Z_OK), (w = !1));
              if (H !== q.Z_STREAM_END && H !== q.Z_OK)
                return this.onEnd(H), (this.ended = !0), !1;
              if (
                U.next_out &&
                (0 === U.avail_out ||
                  H === q.Z_STREAM_END ||
                  (0 === U.avail_in &&
                    (P === q.Z_FINISH || P === q.Z_SYNC_FLUSH)))
              )
                if ("string" === this.options.to) {
                  var I = n.utf8border(U.output, U.next_out);
                  var aa = U.next_out - I;
                  var T = n.buf2string(U.output, I);
                  U.next_out = aa;
                  U.avail_out = ha - aa;
                  aa && h.arraySet(U.output, U.output, I, aa, 0);
                  this.onData(T);
                } else this.onData(h.shrinkBuf(U.output, U.next_out));
              0 === U.avail_in && 0 === U.avail_out && (w = !0);
            } while (
              (0 < U.avail_in || 0 === U.avail_out) &&
              H !== q.Z_STREAM_END
            );
            H === q.Z_STREAM_END && (P = q.Z_FINISH);
            if (P === q.Z_FINISH)
              return (
                (H = g.inflateEnd(this.strm)),
                this.onEnd(H),
                (this.ended = !0),
                H === q.Z_OK
              );
            P === q.Z_SYNC_FLUSH && (this.onEnd(q.Z_OK), (U.avail_out = 0));
            return !0;
          };
          O.prototype.onData = function (H) {
            this.chunks.push(H);
          };
          O.prototype.onEnd = function (H) {
            H === q.Z_OK &&
              (this.result =
                "string" === this.options.to
                  ? this.chunks.join("")
                  : h.flattenChunks(this.chunks));
            this.chunks = [];
            this.err = H;
            this.msg = this.strm.msg;
          };
          e.Inflate = O;
          e.inflate = d;
          e.inflateRaw = function (H, P) {
            P = P || {};
            P.raw = !0;
            return d(H, P);
          };
          e.ungzip = d;
        },
        {
          "./utils/common": 4,
          "./utils/strings": 5,
          "./zlib/constants": 7,
          "./zlib/gzheader": 10,
          "./zlib/inflate.js": 12,
          "./zlib/messages": 14,
          "./zlib/zstream": 16,
        },
      ],
      4: [
        function (b, c, e) {
          b =
            "undefined" !== typeof Uint8Array &&
            "undefined" !== typeof Uint16Array &&
            "undefined" !== typeof Int32Array;
          e.assign = function (h) {
            for (var n = Array.prototype.slice.call(arguments, 1); n.length; ) {
              var q = n.shift();
              if (q) {
                if ("object" !== typeof q)
                  throw new TypeError(q + "must be non-object");
                for (var t in q) q.hasOwnProperty(t) && (h[t] = q[t]);
              }
            }
            return h;
          };
          e.shrinkBuf = function (h, n) {
            if (h.length === n) return h;
            if (h.subarray) return h.subarray(0, n);
            h.length = n;
            return h;
          };
          var d = {
              arraySet: function (h, n, q, t, u) {
                if (n.subarray && h.subarray) h.set(n.subarray(q, q + t), u);
                else for (var A = 0; A < t; A++) h[u + A] = n[q + A];
              },
              flattenChunks: function (h) {
                var n, q;
                var t = (q = 0);
                for (n = h.length; t < n; t++) q += h[t].length;
                var u = new Uint8Array(q);
                t = q = 0;
                for (n = h.length; t < n; t++) {
                  var A = h[t];
                  u.set(A, q);
                  q += A.length;
                }
                return u;
              },
            },
            g = {
              arraySet: function (h, n, q, t, u) {
                for (var A = 0; A < t; A++) h[u + A] = n[q + A];
              },
              flattenChunks: function (h) {
                return [].concat.apply([], h);
              },
            };
          e.setTyped = function (h) {
            h
              ? ((e.Buf8 = Uint8Array),
                (e.Buf16 = Uint16Array),
                (e.Buf32 = Int32Array),
                e.assign(e, d))
              : ((e.Buf8 = Array),
                (e.Buf16 = Array),
                (e.Buf32 = Array),
                e.assign(e, g));
          };
          e.setTyped(b);
        },
        {},
      ],
      5: [
        function (b, c, e) {
          function d(t, u) {
            if (65537 > u && ((t.subarray && n) || (!t.subarray && h)))
              return String.fromCharCode.apply(null, g.shrinkBuf(t, u));
            for (var A = "", G = 0; G < u; G++) A += String.fromCharCode(t[G]);
            return A;
          }
          var g = b("./common"),
            h = !0,
            n = !0;
          try {
            String.fromCharCode.apply(null, [0]);
          } catch (t) {
            h = !1;
          }
          try {
            String.fromCharCode.apply(null, new Uint8Array(1));
          } catch (t) {
            n = !1;
          }
          var q = new g.Buf8(256);
          for (b = 0; 256 > b; b++)
            q[b] =
              252 <= b
                ? 6
                : 248 <= b
                ? 5
                : 240 <= b
                ? 4
                : 224 <= b
                ? 3
                : 192 <= b
                ? 2
                : 1;
          q[254] = q[254] = 1;
          e.string2buf = function (t) {
            var u,
              A,
              G = t.length,
              O = 0;
            for (u = 0; u < G; u++) {
              var H = t.charCodeAt(u);
              if (55296 === (H & 64512) && u + 1 < G) {
                var P = t.charCodeAt(u + 1);
                56320 === (P & 64512) &&
                  ((H = 65536 + ((H - 55296) << 10) + (P - 56320)), u++);
              }
              O += 128 > H ? 1 : 2048 > H ? 2 : 65536 > H ? 3 : 4;
            }
            var U = new g.Buf8(O);
            for (u = A = 0; A < O; u++)
              (H = t.charCodeAt(u)),
                55296 === (H & 64512) &&
                  u + 1 < G &&
                  ((P = t.charCodeAt(u + 1)),
                  56320 === (P & 64512) &&
                    ((H = 65536 + ((H - 55296) << 10) + (P - 56320)), u++)),
                128 > H
                  ? (U[A++] = H)
                  : (2048 > H
                      ? (U[A++] = 192 | (H >>> 6))
                      : (65536 > H
                          ? (U[A++] = 224 | (H >>> 12))
                          : ((U[A++] = 240 | (H >>> 18)),
                            (U[A++] = 128 | ((H >>> 12) & 63))),
                        (U[A++] = 128 | ((H >>> 6) & 63))),
                    (U[A++] = 128 | (H & 63)));
            return U;
          };
          e.buf2binstring = function (t) {
            return d(t, t.length);
          };
          e.binstring2buf = function (t) {
            for (var u = new g.Buf8(t.length), A = 0, G = u.length; A < G; A++)
              u[A] = t.charCodeAt(A);
            return u;
          };
          e.buf2string = function (t, u) {
            var A,
              G = u || t.length,
              O = Array(2 * G);
            for (u = A = 0; u < G; ) {
              var H = t[u++];
              if (128 > H) O[A++] = H;
              else {
                var P = q[H];
                if (4 < P) (O[A++] = 65533), (u += P - 1);
                else {
                  for (H &= 2 === P ? 31 : 3 === P ? 15 : 7; 1 < P && u < G; )
                    (H = (H << 6) | (t[u++] & 63)), P--;
                  1 < P
                    ? (O[A++] = 65533)
                    : 65536 > H
                    ? (O[A++] = H)
                    : ((H -= 65536),
                      (O[A++] = 55296 | ((H >> 10) & 1023)),
                      (O[A++] = 56320 | (H & 1023)));
                }
              }
            }
            return d(O, A);
          };
          e.utf8border = function (t, u) {
            var A;
            u = u || t.length;
            u > t.length && (u = t.length);
            for (A = u - 1; 0 <= A && 128 === (t[A] & 192); ) A--;
            return 0 > A || 0 === A ? u : A + q[t[A]] > u ? A : u;
          };
        },
        { "./common": 4 },
      ],
      6: [
        function (b, c, e) {
          c.exports = function (d, g, h, n) {
            var q = (d & 65535) | 0;
            d = ((d >>> 16) & 65535) | 0;
            for (var t; 0 !== h; ) {
              t = 2e3 < h ? 2e3 : h;
              h -= t;
              do (q = (q + g[n++]) | 0), (d = (d + q) | 0);
              while (--t);
              q %= 65521;
              d %= 65521;
            }
            return q | (d << 16) | 0;
          };
        },
        {},
      ],
      7: [
        function (b, c, e) {
          c.exports = {
            Z_NO_FLUSH: 0,
            Z_PARTIAL_FLUSH: 1,
            Z_SYNC_FLUSH: 2,
            Z_FULL_FLUSH: 3,
            Z_FINISH: 4,
            Z_BLOCK: 5,
            Z_TREES: 6,
            Z_OK: 0,
            Z_STREAM_END: 1,
            Z_NEED_DICT: 2,
            Z_ERRNO: -1,
            Z_STREAM_ERROR: -2,
            Z_DATA_ERROR: -3,
            Z_BUF_ERROR: -5,
            Z_NO_COMPRESSION: 0,
            Z_BEST_SPEED: 1,
            Z_BEST_COMPRESSION: 9,
            Z_DEFAULT_COMPRESSION: -1,
            Z_FILTERED: 1,
            Z_HUFFMAN_ONLY: 2,
            Z_RLE: 3,
            Z_FIXED: 4,
            Z_DEFAULT_STRATEGY: 0,
            Z_BINARY: 0,
            Z_TEXT: 1,
            Z_UNKNOWN: 2,
            Z_DEFLATED: 8,
          };
        },
        {},
      ],
      8: [
        function (b, c, e) {
          var d = (function () {
            for (var g, h = [], n = 0; 256 > n; n++) {
              g = n;
              for (var q = 0; 8 > q; q++)
                g = g & 1 ? 3988292384 ^ (g >>> 1) : g >>> 1;
              h[n] = g;
            }
            return h;
          })();
          c.exports = function (g, h, n, q) {
            n = q + n;
            for (g ^= -1; q < n; q++) g = (g >>> 8) ^ d[(g ^ h[q]) & 255];
            return g ^ -1;
          };
        },
        {},
      ],
      9: [
        function (b, c, e) {
          function d(p, m) {
            p.msg = X[m];
            return m;
          }
          function g(p) {
            for (var m = p.length; 0 <= --m; ) p[m] = 0;
          }
          function h(p) {
            var m = p.state,
              F = m.pending;
            F > p.avail_out && (F = p.avail_out);
            0 !== F &&
              (aa.arraySet(
                p.output,
                m.pending_buf,
                m.pending_out,
                F,
                p.next_out
              ),
              (p.next_out += F),
              (m.pending_out += F),
              (p.total_out += F),
              (p.avail_out -= F),
              (m.pending -= F),
              0 === m.pending && (m.pending_out = 0));
          }
          function n(p, m) {
            T._tr_flush_block(
              p,
              0 <= p.block_start ? p.block_start : -1,
              p.strstart - p.block_start,
              m
            );
            p.block_start = p.strstart;
            h(p.strm);
          }
          function q(p, m) {
            p.pending_buf[p.pending++] = m;
          }
          function t(p, m) {
            p.pending_buf[p.pending++] = (m >>> 8) & 255;
            p.pending_buf[p.pending++] = m & 255;
          }
          function u(p, m) {
            var F = p.max_chain_length,
              r = p.strstart,
              y = p.prev_length,
              D = p.nice_match,
              B =
                p.strstart > p.w_size - 262 ? p.strstart - (p.w_size - 262) : 0,
              C = p.window,
              L = p.w_mask,
              N = p.prev,
              K = p.strstart + 258,
              z = C[r + y - 1],
              R = C[r + y];
            p.prev_length >= p.good_match && (F >>= 2);
            D > p.lookahead && (D = p.lookahead);
            do {
              var ba = m;
              if (
                C[ba + y] === R &&
                C[ba + y - 1] === z &&
                C[ba] === C[r] &&
                C[++ba] === C[r + 1]
              ) {
                r += 2;
                for (
                  ba++;
                  C[++r] === C[++ba] &&
                  C[++r] === C[++ba] &&
                  C[++r] === C[++ba] &&
                  C[++r] === C[++ba] &&
                  C[++r] === C[++ba] &&
                  C[++r] === C[++ba] &&
                  C[++r] === C[++ba] &&
                  C[++r] === C[++ba] &&
                  r < K;

                );
                ba = 258 - (K - r);
                r = K - 258;
                if (ba > y) {
                  p.match_start = m;
                  y = ba;
                  if (ba >= D) break;
                  z = C[r + y - 1];
                  R = C[r + y];
                }
              }
            } while ((m = N[m & L]) > B && 0 !== --F);
            return y <= p.lookahead ? y : p.lookahead;
          }
          function A(p) {
            var m = p.w_size,
              F;
            do {
              var r = p.window_size - p.lookahead - p.strstart;
              if (p.strstart >= m + (m - 262)) {
                aa.arraySet(p.window, p.window, m, m, 0);
                p.match_start -= m;
                p.strstart -= m;
                p.block_start -= m;
                var y = (F = p.hash_size);
                do {
                  var D = p.head[--y];
                  p.head[y] = D >= m ? D - m : 0;
                } while (--F);
                y = F = m;
                do (D = p.prev[--y]), (p.prev[y] = D >= m ? D - m : 0);
                while (--F);
                r += m;
              }
              if (0 === p.strm.avail_in) break;
              y = p.strm;
              F = p.window;
              D = p.strstart + p.lookahead;
              var B = y.avail_in;
              B > r && (B = r);
              0 === B
                ? (F = 0)
                : ((y.avail_in -= B),
                  aa.arraySet(F, y.input, y.next_in, B, D),
                  1 === y.state.wrap
                    ? (y.adler = ka(y.adler, F, B, D))
                    : 2 === y.state.wrap && (y.adler = k(y.adler, F, B, D)),
                  (y.next_in += B),
                  (y.total_in += B),
                  (F = B));
              p.lookahead += F;
              if (3 <= p.lookahead + p.insert)
                for (
                  r = p.strstart - p.insert,
                    p.ins_h = p.window[r],
                    p.ins_h =
                      ((p.ins_h << p.hash_shift) ^ p.window[r + 1]) &
                      p.hash_mask;
                  p.insert &&
                  !((p.ins_h =
                    ((p.ins_h << p.hash_shift) ^ p.window[r + 3 - 1]) &
                    p.hash_mask),
                  (p.prev[r & p.w_mask] = p.head[p.ins_h]),
                  (p.head[p.ins_h] = r),
                  r++,
                  p.insert--,
                  3 > p.lookahead + p.insert);

                );
            } while (262 > p.lookahead && 0 !== p.strm.avail_in);
          }
          function G(p, m) {
            for (var F; ; ) {
              if (262 > p.lookahead) {
                A(p);
                if (262 > p.lookahead && 0 === m) return 1;
                if (0 === p.lookahead) break;
              }
              F = 0;
              3 <= p.lookahead &&
                ((p.ins_h =
                  ((p.ins_h << p.hash_shift) ^ p.window[p.strstart + 3 - 1]) &
                  p.hash_mask),
                (F = p.prev[p.strstart & p.w_mask] = p.head[p.ins_h]),
                (p.head[p.ins_h] = p.strstart));
              0 !== F &&
                p.strstart - F <= p.w_size - 262 &&
                (p.match_length = u(p, F));
              if (3 <= p.match_length)
                if (
                  ((F = T._tr_tally(
                    p,
                    p.strstart - p.match_start,
                    p.match_length - 3
                  )),
                  (p.lookahead -= p.match_length),
                  p.match_length <= p.max_lazy_match && 3 <= p.lookahead)
                ) {
                  p.match_length--;
                  do
                    p.strstart++,
                      (p.ins_h =
                        ((p.ins_h << p.hash_shift) ^
                          p.window[p.strstart + 3 - 1]) &
                        p.hash_mask),
                      (p.prev[p.strstart & p.w_mask] = p.head[p.ins_h]),
                      (p.head[p.ins_h] = p.strstart);
                  while (0 !== --p.match_length);
                  p.strstart++;
                } else
                  (p.strstart += p.match_length),
                    (p.match_length = 0),
                    (p.ins_h = p.window[p.strstart]),
                    (p.ins_h =
                      ((p.ins_h << p.hash_shift) ^ p.window[p.strstart + 1]) &
                      p.hash_mask);
              else
                (F = T._tr_tally(p, 0, p.window[p.strstart])),
                  p.lookahead--,
                  p.strstart++;
              if (F && (n(p, !1), 0 === p.strm.avail_out)) return 1;
            }
            p.insert = 2 > p.strstart ? p.strstart : 2;
            return 4 === m
              ? (n(p, !0), 0 === p.strm.avail_out ? 3 : 4)
              : p.last_lit && (n(p, !1), 0 === p.strm.avail_out)
              ? 1
              : 2;
          }
          function O(p, m) {
            for (var F, r; ; ) {
              if (262 > p.lookahead) {
                A(p);
                if (262 > p.lookahead && 0 === m) return 1;
                if (0 === p.lookahead) break;
              }
              F = 0;
              3 <= p.lookahead &&
                ((p.ins_h =
                  ((p.ins_h << p.hash_shift) ^ p.window[p.strstart + 3 - 1]) &
                  p.hash_mask),
                (F = p.prev[p.strstart & p.w_mask] = p.head[p.ins_h]),
                (p.head[p.ins_h] = p.strstart));
              p.prev_length = p.match_length;
              p.prev_match = p.match_start;
              p.match_length = 2;
              0 !== F &&
                p.prev_length < p.max_lazy_match &&
                p.strstart - F <= p.w_size - 262 &&
                ((p.match_length = u(p, F)),
                5 >= p.match_length &&
                  (1 === p.strategy ||
                    (3 === p.match_length &&
                      4096 < p.strstart - p.match_start)) &&
                  (p.match_length = 2));
              if (3 <= p.prev_length && p.match_length <= p.prev_length) {
                r = p.strstart + p.lookahead - 3;
                F = T._tr_tally(
                  p,
                  p.strstart - 1 - p.prev_match,
                  p.prev_length - 3
                );
                p.lookahead -= p.prev_length - 1;
                p.prev_length -= 2;
                do
                  ++p.strstart <= r &&
                    ((p.ins_h =
                      ((p.ins_h << p.hash_shift) ^
                        p.window[p.strstart + 3 - 1]) &
                      p.hash_mask),
                    (p.prev[p.strstart & p.w_mask] = p.head[p.ins_h]),
                    (p.head[p.ins_h] = p.strstart));
                while (0 !== --p.prev_length);
                p.match_available = 0;
                p.match_length = 2;
                p.strstart++;
                if (F && (n(p, !1), 0 === p.strm.avail_out)) return 1;
              } else if (p.match_available) {
                if (
                  ((F = T._tr_tally(p, 0, p.window[p.strstart - 1])) &&
                    n(p, !1),
                  p.strstart++,
                  p.lookahead--,
                  0 === p.strm.avail_out)
                )
                  return 1;
              } else (p.match_available = 1), p.strstart++, p.lookahead--;
            }
            p.match_available &&
              (T._tr_tally(p, 0, p.window[p.strstart - 1]),
              (p.match_available = 0));
            p.insert = 2 > p.strstart ? p.strstart : 2;
            return 4 === m
              ? (n(p, !0), 0 === p.strm.avail_out ? 3 : 4)
              : p.last_lit && (n(p, !1), 0 === p.strm.avail_out)
              ? 1
              : 2;
          }
          function H(p, m) {
            for (var F, r, y, D = p.window; ; ) {
              if (258 >= p.lookahead) {
                A(p);
                if (258 >= p.lookahead && 0 === m) return 1;
                if (0 === p.lookahead) break;
              }
              p.match_length = 0;
              if (
                3 <= p.lookahead &&
                0 < p.strstart &&
                ((r = p.strstart - 1),
                (F = D[r]),
                F === D[++r] && F === D[++r] && F === D[++r])
              ) {
                for (
                  y = p.strstart + 258;
                  F === D[++r] &&
                  F === D[++r] &&
                  F === D[++r] &&
                  F === D[++r] &&
                  F === D[++r] &&
                  F === D[++r] &&
                  F === D[++r] &&
                  F === D[++r] &&
                  r < y;

                );
                p.match_length = 258 - (y - r);
                p.match_length > p.lookahead && (p.match_length = p.lookahead);
              }
              3 <= p.match_length
                ? ((F = T._tr_tally(p, 1, p.match_length - 3)),
                  (p.lookahead -= p.match_length),
                  (p.strstart += p.match_length),
                  (p.match_length = 0))
                : ((F = T._tr_tally(p, 0, p.window[p.strstart])),
                  p.lookahead--,
                  p.strstart++);
              if (F && (n(p, !1), 0 === p.strm.avail_out)) return 1;
            }
            p.insert = 0;
            return 4 === m
              ? (n(p, !0), 0 === p.strm.avail_out ? 3 : 4)
              : p.last_lit && (n(p, !1), 0 === p.strm.avail_out)
              ? 1
              : 2;
          }
          function P(p, m) {
            for (var F; ; ) {
              if (0 === p.lookahead && (A(p), 0 === p.lookahead)) {
                if (0 === m) return 1;
                break;
              }
              p.match_length = 0;
              F = T._tr_tally(p, 0, p.window[p.strstart]);
              p.lookahead--;
              p.strstart++;
              if (F && (n(p, !1), 0 === p.strm.avail_out)) return 1;
            }
            p.insert = 0;
            return 4 === m
              ? (n(p, !0), 0 === p.strm.avail_out ? 3 : 4)
              : p.last_lit && (n(p, !1), 0 === p.strm.avail_out)
              ? 1
              : 2;
          }
          function U() {
            this.strm = null;
            this.status = 0;
            this.pending_buf = null;
            this.wrap =
              this.pending =
              this.pending_out =
              this.pending_buf_size =
                0;
            this.gzhead = null;
            this.gzindex = 0;
            this.method = 8;
            this.last_flush = -1;
            this.w_mask = this.w_bits = this.w_size = 0;
            this.window = null;
            this.window_size = 0;
            this.head = this.prev = null;
            this.nice_match =
              this.good_match =
              this.strategy =
              this.level =
              this.max_lazy_match =
              this.max_chain_length =
              this.prev_length =
              this.lookahead =
              this.match_start =
              this.strstart =
              this.match_available =
              this.prev_match =
              this.match_length =
              this.block_start =
              this.hash_shift =
              this.hash_mask =
              this.hash_bits =
              this.hash_size =
              this.ins_h =
                0;
            this.dyn_ltree = new aa.Buf16(1146);
            this.dyn_dtree = new aa.Buf16(122);
            this.bl_tree = new aa.Buf16(78);
            g(this.dyn_ltree);
            g(this.dyn_dtree);
            g(this.bl_tree);
            this.bl_desc = this.d_desc = this.l_desc = null;
            this.bl_count = new aa.Buf16(16);
            this.heap = new aa.Buf16(573);
            g(this.heap);
            this.heap_max = this.heap_len = 0;
            this.depth = new aa.Buf16(573);
            g(this.depth);
            this.bi_valid =
              this.bi_buf =
              this.insert =
              this.matches =
              this.static_len =
              this.opt_len =
              this.d_buf =
              this.last_lit =
              this.lit_bufsize =
              this.l_buf =
                0;
          }
          function ha(p) {
            if (!p || !p.state) return d(p, -2);
            p.total_in = p.total_out = 0;
            p.data_type = 2;
            var m = p.state;
            m.pending = 0;
            m.pending_out = 0;
            0 > m.wrap && (m.wrap = -m.wrap);
            m.status = m.wrap ? 42 : 113;
            p.adler = 2 === m.wrap ? 0 : 1;
            m.last_flush = 0;
            T._tr_init(m);
            return 0;
          }
          function w(p) {
            var m = ha(p);
            0 === m &&
              ((p = p.state),
              (p.window_size = 2 * p.w_size),
              g(p.head),
              (p.max_lazy_match = V[p.level].max_lazy),
              (p.good_match = V[p.level].good_length),
              (p.nice_match = V[p.level].nice_length),
              (p.max_chain_length = V[p.level].max_chain),
              (p.strstart = 0),
              (p.block_start = 0),
              (p.lookahead = 0),
              (p.insert = 0),
              (p.match_length = p.prev_length = 2),
              (p.match_available = 0),
              (p.ins_h = 0));
            return m;
          }
          function I(p, m, F, r, y, D) {
            if (!p) return -2;
            var B = 1;
            -1 === m && (m = 6);
            0 > r ? ((B = 0), (r = -r)) : 15 < r && ((B = 2), (r -= 16));
            if (
              1 > y ||
              9 < y ||
              8 !== F ||
              8 > r ||
              15 < r ||
              0 > m ||
              9 < m ||
              0 > D ||
              4 < D
            )
              return d(p, -2);
            8 === r && (r = 9);
            var C = new U();
            p.state = C;
            C.strm = p;
            C.wrap = B;
            C.gzhead = null;
            C.w_bits = r;
            C.w_size = 1 << C.w_bits;
            C.w_mask = C.w_size - 1;
            C.hash_bits = y + 7;
            C.hash_size = 1 << C.hash_bits;
            C.hash_mask = C.hash_size - 1;
            C.hash_shift = ~~((C.hash_bits + 3 - 1) / 3);
            C.window = new aa.Buf8(2 * C.w_size);
            C.head = new aa.Buf16(C.hash_size);
            C.prev = new aa.Buf16(C.w_size);
            C.lit_bufsize = 1 << (y + 6);
            C.pending_buf_size = 4 * C.lit_bufsize;
            C.pending_buf = new aa.Buf8(C.pending_buf_size);
            C.d_buf = C.lit_bufsize >> 1;
            C.l_buf = 3 * C.lit_bufsize;
            C.level = m;
            C.strategy = D;
            C.method = F;
            return w(p);
          }
          var aa = b("../utils/common"),
            T = b("./trees"),
            ka = b("./adler32"),
            k = b("./crc32"),
            X = b("./messages");
          b = function (p, m, F, r, y) {
            this.good_length = p;
            this.max_lazy = m;
            this.nice_length = F;
            this.max_chain = r;
            this.func = y;
          };
          var V = [
            new b(0, 0, 0, 0, function (p, m) {
              var F = 65535;
              for (
                F > p.pending_buf_size - 5 && (F = p.pending_buf_size - 5);
                ;

              ) {
                if (1 >= p.lookahead) {
                  A(p);
                  if (0 === p.lookahead && 0 === m) return 1;
                  if (0 === p.lookahead) break;
                }
                p.strstart += p.lookahead;
                p.lookahead = 0;
                var r = p.block_start + F;
                if (0 === p.strstart || p.strstart >= r)
                  if (
                    ((p.lookahead = p.strstart - r),
                    (p.strstart = r),
                    n(p, !1),
                    0 === p.strm.avail_out)
                  )
                    return 1;
                if (
                  p.strstart - p.block_start >= p.w_size - 262 &&
                  (n(p, !1), 0 === p.strm.avail_out)
                )
                  return 1;
              }
              p.insert = 0;
              if (4 === m) return n(p, !0), 0 === p.strm.avail_out ? 3 : 4;
              p.strstart > p.block_start && n(p, !1);
              return 1;
            }),
            new b(4, 4, 8, 4, G),
            new b(4, 5, 16, 8, G),
            new b(4, 6, 32, 32, G),
            new b(4, 4, 16, 16, O),
            new b(8, 16, 32, 32, O),
            new b(8, 16, 128, 128, O),
            new b(8, 32, 128, 256, O),
            new b(32, 128, 258, 1024, O),
            new b(32, 258, 258, 4096, O),
          ];
          e.deflateInit = function (p, m) {
            return I(p, m, 8, 15, 8, 0);
          };
          e.deflateInit2 = I;
          e.deflateReset = w;
          e.deflateResetKeep = ha;
          e.deflateSetHeader = function (p, m) {
            if (!p || !p.state || 2 !== p.state.wrap) return -2;
            p.state.gzhead = m;
            return 0;
          };
          e.deflate = function (p, m) {
            if (!p || !p.state || 5 < m || 0 > m) return p ? d(p, -2) : -2;
            var F = p.state;
            if (
              !p.output ||
              (!p.input && 0 !== p.avail_in) ||
              (666 === F.status && 4 !== m)
            )
              return d(p, 0 === p.avail_out ? -5 : -2);
            F.strm = p;
            var r = F.last_flush;
            F.last_flush = m;
            if (42 === F.status)
              if (2 === F.wrap)
                (p.adler = 0),
                  q(F, 31),
                  q(F, 139),
                  q(F, 8),
                  F.gzhead
                    ? (q(
                        F,
                        (F.gzhead.text ? 1 : 0) +
                          (F.gzhead.hcrc ? 2 : 0) +
                          (F.gzhead.extra ? 4 : 0) +
                          (F.gzhead.name ? 8 : 0) +
                          (F.gzhead.comment ? 16 : 0)
                      ),
                      q(F, F.gzhead.time & 255),
                      q(F, (F.gzhead.time >> 8) & 255),
                      q(F, (F.gzhead.time >> 16) & 255),
                      q(F, (F.gzhead.time >> 24) & 255),
                      q(
                        F,
                        9 === F.level
                          ? 2
                          : 2 <= F.strategy || 2 > F.level
                          ? 4
                          : 0
                      ),
                      q(F, F.gzhead.os & 255),
                      F.gzhead.extra &&
                        F.gzhead.extra.length &&
                        (q(F, F.gzhead.extra.length & 255),
                        q(F, (F.gzhead.extra.length >> 8) & 255)),
                      F.gzhead.hcrc &&
                        (p.adler = k(p.adler, F.pending_buf, F.pending, 0)),
                      (F.gzindex = 0),
                      (F.status = 69))
                    : (q(F, 0),
                      q(F, 0),
                      q(F, 0),
                      q(F, 0),
                      q(F, 0),
                      q(
                        F,
                        9 === F.level
                          ? 2
                          : 2 <= F.strategy || 2 > F.level
                          ? 4
                          : 0
                      ),
                      q(F, 3),
                      (F.status = 113));
              else {
                var y = (8 + ((F.w_bits - 8) << 4)) << 8;
                y |=
                  (2 <= F.strategy || 2 > F.level
                    ? 0
                    : 6 > F.level
                    ? 1
                    : 6 === F.level
                    ? 2
                    : 3) << 6;
                0 !== F.strstart && (y |= 32);
                F.status = 113;
                t(F, y + (31 - (y % 31)));
                0 !== F.strstart &&
                  (t(F, p.adler >>> 16), t(F, p.adler & 65535));
                p.adler = 1;
              }
            if (69 === F.status)
              if (F.gzhead.extra) {
                for (
                  y = F.pending;
                  F.gzindex < (F.gzhead.extra.length & 65535) &&
                  (F.pending !== F.pending_buf_size ||
                    (F.gzhead.hcrc &&
                      F.pending > y &&
                      (p.adler = k(p.adler, F.pending_buf, F.pending - y, y)),
                    h(p),
                    (y = F.pending),
                    F.pending !== F.pending_buf_size));

                )
                  q(F, F.gzhead.extra[F.gzindex] & 255), F.gzindex++;
                F.gzhead.hcrc &&
                  F.pending > y &&
                  (p.adler = k(p.adler, F.pending_buf, F.pending - y, y));
                F.gzindex === F.gzhead.extra.length &&
                  ((F.gzindex = 0), (F.status = 73));
              } else F.status = 73;
            if (73 === F.status)
              if (F.gzhead.name) {
                y = F.pending;
                do {
                  if (
                    F.pending === F.pending_buf_size &&
                    (F.gzhead.hcrc &&
                      F.pending > y &&
                      (p.adler = k(p.adler, F.pending_buf, F.pending - y, y)),
                    h(p),
                    (y = F.pending),
                    F.pending === F.pending_buf_size)
                  ) {
                    var D = 1;
                    break;
                  }
                  D =
                    F.gzindex < F.gzhead.name.length
                      ? F.gzhead.name.charCodeAt(F.gzindex++) & 255
                      : 0;
                  q(F, D);
                } while (0 !== D);
                F.gzhead.hcrc &&
                  F.pending > y &&
                  (p.adler = k(p.adler, F.pending_buf, F.pending - y, y));
                0 === D && ((F.gzindex = 0), (F.status = 91));
              } else F.status = 91;
            if (91 === F.status)
              if (F.gzhead.comment) {
                y = F.pending;
                do {
                  if (
                    F.pending === F.pending_buf_size &&
                    (F.gzhead.hcrc &&
                      F.pending > y &&
                      (p.adler = k(p.adler, F.pending_buf, F.pending - y, y)),
                    h(p),
                    (y = F.pending),
                    F.pending === F.pending_buf_size)
                  ) {
                    D = 1;
                    break;
                  }
                  D =
                    F.gzindex < F.gzhead.comment.length
                      ? F.gzhead.comment.charCodeAt(F.gzindex++) & 255
                      : 0;
                  q(F, D);
                } while (0 !== D);
                F.gzhead.hcrc &&
                  F.pending > y &&
                  (p.adler = k(p.adler, F.pending_buf, F.pending - y, y));
                0 === D && (F.status = 103);
              } else F.status = 103;
            103 === F.status &&
              (F.gzhead.hcrc
                ? (F.pending + 2 > F.pending_buf_size && h(p),
                  F.pending + 2 <= F.pending_buf_size &&
                    (q(F, p.adler & 255),
                    q(F, (p.adler >> 8) & 255),
                    (p.adler = 0),
                    (F.status = 113)))
                : (F.status = 113));
            if (0 !== F.pending) {
              if ((h(p), 0 === p.avail_out)) return (F.last_flush = -1), 0;
            } else if (
              0 === p.avail_in &&
              (m << 1) - (4 < m ? 9 : 0) <= (r << 1) - (4 < r ? 9 : 0) &&
              4 !== m
            )
              return d(p, -5);
            if (666 === F.status && 0 !== p.avail_in) return d(p, -5);
            if (
              0 !== p.avail_in ||
              0 !== F.lookahead ||
              (0 !== m && 666 !== F.status)
            ) {
              r =
                2 === F.strategy
                  ? P(F, m)
                  : 3 === F.strategy
                  ? H(F, m)
                  : V[F.level].func(F, m);
              if (3 === r || 4 === r) F.status = 666;
              if (1 === r || 3 === r)
                return 0 === p.avail_out && (F.last_flush = -1), 0;
              if (
                2 === r &&
                (1 === m
                  ? T._tr_align(F)
                  : 5 !== m &&
                    (T._tr_stored_block(F, 0, 0, !1),
                    3 === m &&
                      (g(F.head),
                      0 === F.lookahead &&
                        ((F.strstart = 0),
                        (F.block_start = 0),
                        (F.insert = 0)))),
                h(p),
                0 === p.avail_out)
              )
                return (F.last_flush = -1), 0;
            }
            if (4 !== m) return 0;
            if (0 >= F.wrap) return 1;
            2 === F.wrap
              ? (q(F, p.adler & 255),
                q(F, (p.adler >> 8) & 255),
                q(F, (p.adler >> 16) & 255),
                q(F, (p.adler >> 24) & 255),
                q(F, p.total_in & 255),
                q(F, (p.total_in >> 8) & 255),
                q(F, (p.total_in >> 16) & 255),
                q(F, (p.total_in >> 24) & 255))
              : (t(F, p.adler >>> 16), t(F, p.adler & 65535));
            h(p);
            0 < F.wrap && (F.wrap = -F.wrap);
            return 0 !== F.pending ? 0 : 1;
          };
          e.deflateEnd = function (p) {
            if (!p || !p.state) return -2;
            var m = p.state.status;
            if (
              42 !== m &&
              69 !== m &&
              73 !== m &&
              91 !== m &&
              103 !== m &&
              113 !== m &&
              666 !== m
            )
              return d(p, -2);
            p.state = null;
            return 113 === m ? d(p, -3) : 0;
          };
          e.deflateInfo = "pako deflate (from Nodeca project)";
        },
        {
          "../utils/common": 4,
          "./adler32": 6,
          "./crc32": 8,
          "./messages": 14,
          "./trees": 15,
        },
      ],
      10: [
        function (b, c, e) {
          c.exports = function () {
            this.os = this.xflags = this.time = this.text = 0;
            this.extra = null;
            this.extra_len = 0;
            this.comment = this.name = "";
            this.hcrc = 0;
            this.done = !1;
          };
        },
        {},
      ],
      11: [
        function (b, c, e) {
          c.exports = function (d, g) {
            var h = d.state;
            var n = d.next_in;
            var q = d.input;
            var t = n + (d.avail_in - 5);
            var u = d.next_out;
            var A = d.output;
            g = u - (g - d.avail_out);
            var G = u + (d.avail_out - 257);
            var O = h.dmax;
            var H = h.wsize;
            var P = h.whave;
            var U = h.wnext;
            var ha = h.window;
            var w = h.hold;
            var I = h.bits;
            var aa = h.lencode;
            var T = h.distcode;
            var ka = (1 << h.lenbits) - 1;
            var k = (1 << h.distbits) - 1;
            a: do {
              15 > I &&
                ((w += q[n++] << I), (I += 8), (w += q[n++] << I), (I += 8));
              var X = aa[w & ka];
              b: for (;;) {
                var V = X >>> 24;
                w >>>= V;
                I -= V;
                V = (X >>> 16) & 255;
                if (0 === V) A[u++] = X & 65535;
                else if (V & 16) {
                  var p = X & 65535;
                  if ((V &= 15))
                    I < V && ((w += q[n++] << I), (I += 8)),
                      (p += w & ((1 << V) - 1)),
                      (w >>>= V),
                      (I -= V);
                  15 > I &&
                    ((w += q[n++] << I),
                    (I += 8),
                    (w += q[n++] << I),
                    (I += 8));
                  X = T[w & k];
                  c: for (;;) {
                    V = X >>> 24;
                    w >>>= V;
                    I -= V;
                    V = (X >>> 16) & 255;
                    if (V & 16) {
                      X &= 65535;
                      V &= 15;
                      I < V &&
                        ((w += q[n++] << I),
                        (I += 8),
                        I < V && ((w += q[n++] << I), (I += 8)));
                      X += w & ((1 << V) - 1);
                      if (X > O) {
                        d.msg = "invalid distance too far back";
                        h.mode = 30;
                        break a;
                      }
                      w >>>= V;
                      I -= V;
                      V = u - g;
                      if (X > V) {
                        V = X - V;
                        if (V > P && h.sane) {
                          d.msg = "invalid distance too far back";
                          h.mode = 30;
                          break a;
                        }
                        var m = 0;
                        var F = ha;
                        if (0 === U) {
                          if (((m += H - V), V < p)) {
                            p -= V;
                            do A[u++] = ha[m++];
                            while (--V);
                            m = u - X;
                            F = A;
                          }
                        } else if (U < V) {
                          if (((m += H + U - V), (V -= U), V < p)) {
                            p -= V;
                            do A[u++] = ha[m++];
                            while (--V);
                            m = 0;
                            if (U < p) {
                              V = U;
                              p -= V;
                              do A[u++] = ha[m++];
                              while (--V);
                              m = u - X;
                              F = A;
                            }
                          }
                        } else if (((m += U - V), V < p)) {
                          p -= V;
                          do A[u++] = ha[m++];
                          while (--V);
                          m = u - X;
                          F = A;
                        }
                        for (; 2 < p; )
                          (A[u++] = F[m++]),
                            (A[u++] = F[m++]),
                            (A[u++] = F[m++]),
                            (p -= 3);
                        p && ((A[u++] = F[m++]), 1 < p && (A[u++] = F[m++]));
                      } else {
                        m = u - X;
                        do
                          (A[u++] = A[m++]),
                            (A[u++] = A[m++]),
                            (A[u++] = A[m++]),
                            (p -= 3);
                        while (2 < p);
                        p && ((A[u++] = A[m++]), 1 < p && (A[u++] = A[m++]));
                      }
                    } else if (0 === (V & 64)) {
                      X = T[(X & 65535) + (w & ((1 << V) - 1))];
                      continue c;
                    } else {
                      d.msg = "invalid distance code";
                      h.mode = 30;
                      break a;
                    }
                    break;
                  }
                } else if (0 === (V & 64)) {
                  X = aa[(X & 65535) + (w & ((1 << V) - 1))];
                  continue b;
                } else {
                  V & 32
                    ? (h.mode = 12)
                    : ((d.msg = "invalid literal/length code"), (h.mode = 30));
                  break a;
                }
                break;
              }
            } while (n < t && u < G);
            p = I >> 3;
            n -= p;
            I -= p << 3;
            d.next_in = n;
            d.next_out = u;
            d.avail_in = n < t ? 5 + (t - n) : 5 - (n - t);
            d.avail_out = u < G ? 257 + (G - u) : 257 - (u - G);
            h.hold = w & ((1 << I) - 1);
            h.bits = I;
          };
        },
        {},
      ],
      12: [
        function (b, c, e) {
          function d(w) {
            return (
              ((w >>> 24) & 255) +
              ((w >>> 8) & 65280) +
              ((w & 65280) << 8) +
              ((w & 255) << 24)
            );
          }
          function g() {
            this.mode = 0;
            this.last = !1;
            this.wrap = 0;
            this.havedict = !1;
            this.total = this.check = this.dmax = this.flags = 0;
            this.head = null;
            this.wnext = this.whave = this.wsize = this.wbits = 0;
            this.window = null;
            this.extra = this.offset = this.length = this.bits = this.hold = 0;
            this.distcode = this.lencode = null;
            this.have =
              this.ndist =
              this.nlen =
              this.ncode =
              this.distbits =
              this.lenbits =
                0;
            this.next = null;
            this.lens = new u.Buf16(320);
            this.work = new u.Buf16(288);
            this.distdyn = this.lendyn = null;
            this.was = this.back = this.sane = 0;
          }
          function h(w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            w.total_in = w.total_out = I.total = 0;
            w.msg = "";
            I.wrap && (w.adler = I.wrap & 1);
            I.mode = 1;
            I.last = 0;
            I.havedict = 0;
            I.dmax = 32768;
            I.head = null;
            I.hold = 0;
            I.bits = 0;
            I.lencode = I.lendyn = new u.Buf32(852);
            I.distcode = I.distdyn = new u.Buf32(592);
            I.sane = 1;
            I.back = -1;
            return 0;
          }
          function n(w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            I.wsize = 0;
            I.whave = 0;
            I.wnext = 0;
            return h(w);
          }
          function q(w, I) {
            if (!w || !w.state) return -2;
            var aa = w.state;
            if (0 > I) {
              var T = 0;
              I = -I;
            } else (T = (I >> 4) + 1), 48 > I && (I &= 15);
            if (I && (8 > I || 15 < I)) return -2;
            null !== aa.window && aa.wbits !== I && (aa.window = null);
            aa.wrap = T;
            aa.wbits = I;
            return n(w);
          }
          function t(w, I) {
            if (!w) return -2;
            var aa = new g();
            w.state = aa;
            aa.window = null;
            I = q(w, I);
            0 !== I && (w.state = null);
            return I;
          }
          var u = b("../utils/common"),
            A = b("./adler32"),
            G = b("./crc32"),
            O = b("./inffast"),
            H = b("./inftrees"),
            P = !0,
            U,
            ha;
          e.inflateReset = n;
          e.inflateReset2 = q;
          e.inflateResetKeep = h;
          e.inflateInit = function (w) {
            return t(w, 15);
          };
          e.inflateInit2 = t;
          e.inflate = function (w, I) {
            var aa,
              T = new u.Buf8(4),
              ka = [
                16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1,
                15,
              ];
            if (!w || !w.state || !w.output || (!w.input && 0 !== w.avail_in))
              return -2;
            var k = w.state;
            12 === k.mode && (k.mode = 13);
            var X = w.next_out;
            var V = w.output;
            var p = w.avail_out;
            var m = w.next_in;
            var F = w.input;
            var r = w.avail_in;
            var y = k.hold;
            var D = k.bits;
            var B = r;
            var C = p;
            var L = 0;
            a: for (;;)
              switch (k.mode) {
                case 1:
                  if (0 === k.wrap) {
                    k.mode = 13;
                    break;
                  }
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (k.wrap & 2 && 35615 === y) {
                    k.check = 0;
                    T[0] = y & 255;
                    T[1] = (y >>> 8) & 255;
                    k.check = G(k.check, T, 2, 0);
                    D = y = 0;
                    k.mode = 2;
                    break;
                  }
                  k.flags = 0;
                  k.head && (k.head.done = !1);
                  if (!(k.wrap & 1) || (((y & 255) << 8) + (y >> 8)) % 31) {
                    w.msg = "incorrect header check";
                    k.mode = 30;
                    break;
                  }
                  if (8 !== (y & 15)) {
                    w.msg = "unknown compression method";
                    k.mode = 30;
                    break;
                  }
                  y >>>= 4;
                  D -= 4;
                  var N = (y & 15) + 8;
                  if (0 === k.wbits) k.wbits = N;
                  else if (N > k.wbits) {
                    w.msg = "invalid window size";
                    k.mode = 30;
                    break;
                  }
                  k.dmax = 1 << N;
                  w.adler = k.check = 1;
                  k.mode = y & 512 ? 10 : 12;
                  D = y = 0;
                  break;
                case 2:
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.flags = y;
                  if (8 !== (k.flags & 255)) {
                    w.msg = "unknown compression method";
                    k.mode = 30;
                    break;
                  }
                  if (k.flags & 57344) {
                    w.msg = "unknown header flags set";
                    k.mode = 30;
                    break;
                  }
                  k.head && (k.head.text = (y >> 8) & 1);
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (k.check = G(k.check, T, 2, 0)));
                  D = y = 0;
                  k.mode = 3;
                case 3:
                  for (; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.head && (k.head.time = y);
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (T[2] = (y >>> 16) & 255),
                    (T[3] = (y >>> 24) & 255),
                    (k.check = G(k.check, T, 4, 0)));
                  D = y = 0;
                  k.mode = 4;
                case 4:
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.head && ((k.head.xflags = y & 255), (k.head.os = y >> 8));
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (k.check = G(k.check, T, 2, 0)));
                  D = y = 0;
                  k.mode = 5;
                case 5:
                  if (k.flags & 1024) {
                    for (; 16 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.length = y;
                    k.head && (k.head.extra_len = y);
                    k.flags & 512 &&
                      ((T[0] = y & 255),
                      (T[1] = (y >>> 8) & 255),
                      (k.check = G(k.check, T, 2, 0)));
                    D = y = 0;
                  } else k.head && (k.head.extra = null);
                  k.mode = 6;
                case 6:
                  if (k.flags & 1024) {
                    var K = k.length;
                    K > r && (K = r);
                    K &&
                      (k.head &&
                        ((N = k.head.extra_len - k.length),
                        k.head.extra ||
                          (k.head.extra = Array(k.head.extra_len)),
                        u.arraySet(k.head.extra, F, m, K, N)),
                      k.flags & 512 && (k.check = G(k.check, F, K, m)),
                      (r -= K),
                      (m += K),
                      (k.length -= K));
                    if (k.length) break a;
                  }
                  k.length = 0;
                  k.mode = 7;
                case 7:
                  if (k.flags & 2048) {
                    if (0 === r) break a;
                    K = 0;
                    do
                      (N = F[m + K++]),
                        k.head &&
                          N &&
                          65536 > k.length &&
                          (k.head.name += String.fromCharCode(N));
                    while (N && K < r);
                    k.flags & 512 && (k.check = G(k.check, F, K, m));
                    r -= K;
                    m += K;
                    if (N) break a;
                  } else k.head && (k.head.name = null);
                  k.length = 0;
                  k.mode = 8;
                case 8:
                  if (k.flags & 4096) {
                    if (0 === r) break a;
                    K = 0;
                    do
                      (N = F[m + K++]),
                        k.head &&
                          N &&
                          65536 > k.length &&
                          (k.head.comment += String.fromCharCode(N));
                    while (N && K < r);
                    k.flags & 512 && (k.check = G(k.check, F, K, m));
                    r -= K;
                    m += K;
                    if (N) break a;
                  } else k.head && (k.head.comment = null);
                  k.mode = 9;
                case 9:
                  if (k.flags & 512) {
                    for (; 16 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (y !== (k.check & 65535)) {
                      w.msg = "header crc mismatch";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.head &&
                    ((k.head.hcrc = (k.flags >> 9) & 1), (k.head.done = !0));
                  w.adler = k.check = 0;
                  k.mode = 12;
                  break;
                case 10:
                  for (; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  w.adler = k.check = d(y);
                  D = y = 0;
                  k.mode = 11;
                case 11:
                  if (0 === k.havedict)
                    return (
                      (w.next_out = X),
                      (w.avail_out = p),
                      (w.next_in = m),
                      (w.avail_in = r),
                      (k.hold = y),
                      (k.bits = D),
                      2
                    );
                  w.adler = k.check = 1;
                  k.mode = 12;
                case 12:
                  if (5 === I || 6 === I) break a;
                case 13:
                  if (k.last) {
                    y >>>= D & 7;
                    D -= D & 7;
                    k.mode = 27;
                    break;
                  }
                  for (; 3 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.last = y & 1;
                  y >>>= 1;
                  --D;
                  switch (y & 3) {
                    case 0:
                      k.mode = 14;
                      break;
                    case 1:
                      N = k;
                      if (P) {
                        U = new u.Buf32(512);
                        ha = new u.Buf32(32);
                        for (K = 0; 144 > K; ) N.lens[K++] = 8;
                        for (; 256 > K; ) N.lens[K++] = 9;
                        for (; 280 > K; ) N.lens[K++] = 7;
                        for (; 288 > K; ) N.lens[K++] = 8;
                        H(1, N.lens, 0, 288, U, 0, N.work, { bits: 9 });
                        for (K = 0; 32 > K; ) N.lens[K++] = 5;
                        H(2, N.lens, 0, 32, ha, 0, N.work, { bits: 5 });
                        P = !1;
                      }
                      N.lencode = U;
                      N.lenbits = 9;
                      N.distcode = ha;
                      N.distbits = 5;
                      k.mode = 20;
                      if (6 === I) {
                        y >>>= 2;
                        D -= 2;
                        break a;
                      }
                      break;
                    case 2:
                      k.mode = 17;
                      break;
                    case 3:
                      (w.msg = "invalid block type"), (k.mode = 30);
                  }
                  y >>>= 2;
                  D -= 2;
                  break;
                case 14:
                  y >>>= D & 7;
                  for (D -= D & 7; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if ((y & 65535) !== ((y >>> 16) ^ 65535)) {
                    w.msg = "invalid stored block lengths";
                    k.mode = 30;
                    break;
                  }
                  k.length = y & 65535;
                  D = y = 0;
                  k.mode = 15;
                  if (6 === I) break a;
                case 15:
                  k.mode = 16;
                case 16:
                  if ((K = k.length)) {
                    K > r && (K = r);
                    K > p && (K = p);
                    if (0 === K) break a;
                    u.arraySet(V, F, m, K, X);
                    r -= K;
                    m += K;
                    p -= K;
                    X += K;
                    k.length -= K;
                    break;
                  }
                  k.mode = 12;
                  break;
                case 17:
                  for (; 14 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.nlen = (y & 31) + 257;
                  y >>>= 5;
                  D -= 5;
                  k.ndist = (y & 31) + 1;
                  y >>>= 5;
                  D -= 5;
                  k.ncode = (y & 15) + 4;
                  y >>>= 4;
                  D -= 4;
                  if (286 < k.nlen || 30 < k.ndist) {
                    w.msg = "too many length or distance symbols";
                    k.mode = 30;
                    break;
                  }
                  k.have = 0;
                  k.mode = 18;
                case 18:
                  for (; k.have < k.ncode; ) {
                    for (; 3 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.lens[ka[k.have++]] = y & 7;
                    y >>>= 3;
                    D -= 3;
                  }
                  for (; 19 > k.have; ) k.lens[ka[k.have++]] = 0;
                  k.lencode = k.lendyn;
                  k.lenbits = 7;
                  K = { bits: k.lenbits };
                  L = H(0, k.lens, 0, 19, k.lencode, 0, k.work, K);
                  k.lenbits = K.bits;
                  if (L) {
                    w.msg = "invalid code lengths set";
                    k.mode = 30;
                    break;
                  }
                  k.have = 0;
                  k.mode = 19;
                case 19:
                  for (; k.have < k.nlen + k.ndist; ) {
                    for (;;) {
                      var z = k.lencode[y & ((1 << k.lenbits) - 1)];
                      K = z >>> 24;
                      z &= 65535;
                      if (K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (16 > z) (y >>>= K), (D -= K), (k.lens[k.have++] = z);
                    else {
                      if (16 === z) {
                        for (N = K + 2; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        if (0 === k.have) {
                          w.msg = "invalid bit length repeat";
                          k.mode = 30;
                          break;
                        }
                        N = k.lens[k.have - 1];
                        K = 3 + (y & 3);
                        y >>>= 2;
                        D -= 2;
                      } else if (17 === z) {
                        for (N = K + 3; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        N = 0;
                        K = 3 + (y & 7);
                        y >>>= 3;
                        D -= 3;
                      } else {
                        for (N = K + 7; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        N = 0;
                        K = 11 + (y & 127);
                        y >>>= 7;
                        D -= 7;
                      }
                      if (k.have + K > k.nlen + k.ndist) {
                        w.msg = "invalid bit length repeat";
                        k.mode = 30;
                        break;
                      }
                      for (; K--; ) k.lens[k.have++] = N;
                    }
                  }
                  if (30 === k.mode) break;
                  if (0 === k.lens[256]) {
                    w.msg = "invalid code -- missing end-of-block";
                    k.mode = 30;
                    break;
                  }
                  k.lenbits = 9;
                  K = { bits: k.lenbits };
                  L = H(1, k.lens, 0, k.nlen, k.lencode, 0, k.work, K);
                  k.lenbits = K.bits;
                  if (L) {
                    w.msg = "invalid literal/lengths set";
                    k.mode = 30;
                    break;
                  }
                  k.distbits = 6;
                  k.distcode = k.distdyn;
                  K = { bits: k.distbits };
                  L = H(2, k.lens, k.nlen, k.ndist, k.distcode, 0, k.work, K);
                  k.distbits = K.bits;
                  if (L) {
                    w.msg = "invalid distances set";
                    k.mode = 30;
                    break;
                  }
                  k.mode = 20;
                  if (6 === I) break a;
                case 20:
                  k.mode = 21;
                case 21:
                  if (6 <= r && 258 <= p) {
                    w.next_out = X;
                    w.avail_out = p;
                    w.next_in = m;
                    w.avail_in = r;
                    k.hold = y;
                    k.bits = D;
                    O(w, C);
                    X = w.next_out;
                    V = w.output;
                    p = w.avail_out;
                    m = w.next_in;
                    F = w.input;
                    r = w.avail_in;
                    y = k.hold;
                    D = k.bits;
                    12 === k.mode && (k.back = -1);
                    break;
                  }
                  for (k.back = 0; ; ) {
                    z = k.lencode[y & ((1 << k.lenbits) - 1)];
                    K = z >>> 24;
                    N = (z >>> 16) & 255;
                    z &= 65535;
                    if (K <= D) break;
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (N && 0 === (N & 240)) {
                    var R = K;
                    var ba = N;
                    for (aa = z; ; ) {
                      z = k.lencode[aa + ((y & ((1 << (R + ba)) - 1)) >> R)];
                      K = z >>> 24;
                      N = (z >>> 16) & 255;
                      z &= 65535;
                      if (R + K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    y >>>= R;
                    D -= R;
                    k.back += R;
                  }
                  y >>>= K;
                  D -= K;
                  k.back += K;
                  k.length = z;
                  if (0 === N) {
                    k.mode = 26;
                    break;
                  }
                  if (N & 32) {
                    k.back = -1;
                    k.mode = 12;
                    break;
                  }
                  if (N & 64) {
                    w.msg = "invalid literal/length code";
                    k.mode = 30;
                    break;
                  }
                  k.extra = N & 15;
                  k.mode = 22;
                case 22:
                  if (k.extra) {
                    for (N = k.extra; D < N; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.length += y & ((1 << k.extra) - 1);
                    y >>>= k.extra;
                    D -= k.extra;
                    k.back += k.extra;
                  }
                  k.was = k.length;
                  k.mode = 23;
                case 23:
                  for (;;) {
                    z = k.distcode[y & ((1 << k.distbits) - 1)];
                    K = z >>> 24;
                    N = (z >>> 16) & 255;
                    z &= 65535;
                    if (K <= D) break;
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (0 === (N & 240)) {
                    R = K;
                    ba = N;
                    for (aa = z; ; ) {
                      z = k.distcode[aa + ((y & ((1 << (R + ba)) - 1)) >> R)];
                      K = z >>> 24;
                      N = (z >>> 16) & 255;
                      z &= 65535;
                      if (R + K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    y >>>= R;
                    D -= R;
                    k.back += R;
                  }
                  y >>>= K;
                  D -= K;
                  k.back += K;
                  if (N & 64) {
                    w.msg = "invalid distance code";
                    k.mode = 30;
                    break;
                  }
                  k.offset = z;
                  k.extra = N & 15;
                  k.mode = 24;
                case 24:
                  if (k.extra) {
                    for (N = k.extra; D < N; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.offset += y & ((1 << k.extra) - 1);
                    y >>>= k.extra;
                    D -= k.extra;
                    k.back += k.extra;
                  }
                  if (k.offset > k.dmax) {
                    w.msg = "invalid distance too far back";
                    k.mode = 30;
                    break;
                  }
                  k.mode = 25;
                case 25:
                  if (0 === p) break a;
                  K = C - p;
                  if (k.offset > K) {
                    K = k.offset - K;
                    if (K > k.whave && k.sane) {
                      w.msg = "invalid distance too far back";
                      k.mode = 30;
                      break;
                    }
                    K > k.wnext
                      ? ((K -= k.wnext), (N = k.wsize - K))
                      : (N = k.wnext - K);
                    K > k.length && (K = k.length);
                    R = k.window;
                  } else (R = V), (N = X - k.offset), (K = k.length);
                  K > p && (K = p);
                  p -= K;
                  k.length -= K;
                  do V[X++] = R[N++];
                  while (--K);
                  0 === k.length && (k.mode = 21);
                  break;
                case 26:
                  if (0 === p) break a;
                  V[X++] = k.length;
                  p--;
                  k.mode = 21;
                  break;
                case 27:
                  if (k.wrap) {
                    for (; 32 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y |= F[m++] << D;
                      D += 8;
                    }
                    C -= p;
                    w.total_out += C;
                    k.total += C;
                    C &&
                      (w.adler = k.check =
                        k.flags
                          ? G(k.check, V, C, X - C)
                          : A(k.check, V, C, X - C));
                    C = p;
                    if ((k.flags ? y : d(y)) !== k.check) {
                      w.msg = "incorrect data check";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.mode = 28;
                case 28:
                  if (k.wrap && k.flags) {
                    for (; 32 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (y !== (k.total & 4294967295)) {
                      w.msg = "incorrect length check";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.mode = 29;
                case 29:
                  L = 1;
                  break a;
                case 30:
                  L = -3;
                  break a;
                case 31:
                  return -4;
                default:
                  return -2;
              }
            w.next_out = X;
            w.avail_out = p;
            w.next_in = m;
            w.avail_in = r;
            k.hold = y;
            k.bits = D;
            if (
              k.wsize ||
              (C !== w.avail_out && 30 > k.mode && (27 > k.mode || 4 !== I))
            )
              (F = w.output),
                (m = w.next_out),
                (X = C - w.avail_out),
                (p = w.state),
                null === p.window &&
                  ((p.wsize = 1 << p.wbits),
                  (p.wnext = 0),
                  (p.whave = 0),
                  (p.window = new u.Buf8(p.wsize))),
                X >= p.wsize
                  ? (u.arraySet(p.window, F, m - p.wsize, p.wsize, 0),
                    (p.wnext = 0),
                    (p.whave = p.wsize))
                  : ((r = p.wsize - p.wnext),
                    r > X && (r = X),
                    u.arraySet(p.window, F, m - X, r, p.wnext),
                    (X -= r)
                      ? (u.arraySet(p.window, F, m - X, X, 0),
                        (p.wnext = X),
                        (p.whave = p.wsize))
                      : ((p.wnext += r),
                        p.wnext === p.wsize && (p.wnext = 0),
                        p.whave < p.wsize && (p.whave += r)));
            B -= w.avail_in;
            C -= w.avail_out;
            w.total_in += B;
            w.total_out += C;
            k.total += C;
            k.wrap &&
              C &&
              (w.adler = k.check =
                k.flags
                  ? G(k.check, V, C, w.next_out - C)
                  : A(k.check, V, C, w.next_out - C));
            w.data_type =
              k.bits +
              (k.last ? 64 : 0) +
              (12 === k.mode ? 128 : 0) +
              (20 === k.mode || 15 === k.mode ? 256 : 0);
            ((0 === B && 0 === C) || 4 === I) && 0 === L && (L = -5);
            return L;
          };
          e.inflateEnd = function (w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            I.window && (I.window = null);
            w.state = null;
            return 0;
          };
          e.inflateGetHeader = function (w, I) {
            if (!w || !w.state) return -2;
            w = w.state;
            if (0 === (w.wrap & 2)) return -2;
            w.head = I;
            I.done = !1;
            return 0;
          };
          e.inflateInfo = "pako inflate (from Nodeca project)";
        },
        {
          "../utils/common": 4,
          "./adler32": 6,
          "./crc32": 8,
          "./inffast": 11,
          "./inftrees": 13,
        },
      ],
      13: [
        function (b, c, e) {
          var d = b("../utils/common"),
            g = [
              3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43,
              51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0,
            ],
            h = [
              16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18,
              19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78,
            ],
            n = [
              1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257,
              385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289,
              16385, 24577, 0, 0,
            ],
            q = [
              16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22,
              23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64,
            ];
          c.exports = function (t, u, A, G, O, H, P, U) {
            var ha = U.bits,
              w,
              I,
              aa,
              T,
              ka,
              k,
              X = 0,
              V = new d.Buf16(16);
            var p = new d.Buf16(16);
            var m,
              F = 0;
            for (w = 0; 15 >= w; w++) V[w] = 0;
            for (I = 0; I < G; I++) V[u[A + I]]++;
            var r = ha;
            for (aa = 15; 1 <= aa && 0 === V[aa]; aa--);
            r > aa && (r = aa);
            if (0 === aa)
              return (O[H++] = 20971520), (O[H++] = 20971520), (U.bits = 1), 0;
            for (ha = 1; ha < aa && 0 === V[ha]; ha++);
            r < ha && (r = ha);
            for (w = T = 1; 15 >= w; w++)
              if (((T <<= 1), (T -= V[w]), 0 > T)) return -1;
            if (0 < T && (0 === t || 1 !== aa)) return -1;
            p[1] = 0;
            for (w = 1; 15 > w; w++) p[w + 1] = p[w] + V[w];
            for (I = 0; I < G; I++) 0 !== u[A + I] && (P[p[u[A + I]]++] = I);
            if (0 === t) {
              var y = (m = P);
              var D = 19;
            } else
              1 === t
                ? ((y = g), (X -= 257), (m = h), (F -= 257), (D = 256))
                : ((y = n), (m = q), (D = -1));
            I = ka = 0;
            w = ha;
            var B = H;
            G = r;
            p = 0;
            var C = -1;
            var L = 1 << r;
            var N = L - 1;
            if ((1 === t && 852 < L) || (2 === t && 592 < L)) return 1;
            for (var K = 0; ; ) {
              K++;
              var z = w - p;
              if (P[I] < D) {
                var R = 0;
                var ba = P[I];
              } else
                P[I] > D
                  ? ((R = m[F + P[I]]), (ba = y[X + P[I]]))
                  : ((R = 96), (ba = 0));
              T = 1 << (w - p);
              ha = k = 1 << G;
              do
                (k -= T),
                  (O[B + (ka >> p) + k] = (z << 24) | (R << 16) | ba | 0);
              while (0 !== k);
              for (T = 1 << (w - 1); ka & T; ) T >>= 1;
              0 !== T ? ((ka &= T - 1), (ka += T)) : (ka = 0);
              I++;
              if (0 === --V[w]) {
                if (w === aa) break;
                w = u[A + P[I]];
              }
              if (w > r && (ka & N) !== C) {
                0 === p && (p = r);
                B += ha;
                G = w - p;
                for (T = 1 << G; G + p < aa; ) {
                  T -= V[G + p];
                  if (0 >= T) break;
                  G++;
                  T <<= 1;
                }
                L += 1 << G;
                if ((1 === t && 852 < L) || (2 === t && 592 < L)) return 1;
                C = ka & N;
                O[C] = (r << 24) | (G << 16) | (B - H) | 0;
              }
            }
            0 !== ka && (O[B + ka] = ((w - p) << 24) | 4194304);
            U.bits = r;
            return 0;
          };
        },
        { "../utils/common": 4 },
      ],
      14: [
        function (b, c, e) {
          c.exports = {
            2: "need dictionary",
            1: "stream end",
            0: "",
            "-1": "file error",
            "-2": "stream error",
            "-3": "data error",
            "-4": "insufficient memory",
            "-5": "buffer error",
            "-6": "incompatible version",
          };
        },
        {},
      ],
      15: [
        function (b, c, e) {
          function d(z) {
            for (var R = z.length; 0 <= --R; ) z[R] = 0;
          }
          function g(z, R) {
            z.pending_buf[z.pending++] = R & 255;
            z.pending_buf[z.pending++] = (R >>> 8) & 255;
          }
          function h(z, R, ba) {
            z.bi_valid > 16 - ba
              ? ((z.bi_buf |= (R << z.bi_valid) & 65535),
                g(z, z.bi_buf),
                (z.bi_buf = R >> (16 - z.bi_valid)),
                (z.bi_valid += ba - 16))
              : ((z.bi_buf |= (R << z.bi_valid) & 65535), (z.bi_valid += ba));
          }
          function n(z, R, ba) {
            h(z, ba[2 * R], ba[2 * R + 1]);
          }
          function q(z, R) {
            var ba = 0;
            do (ba |= z & 1), (z >>>= 1), (ba <<= 1);
            while (0 < --R);
            return ba >>> 1;
          }
          function t(z, R, ba) {
            var S = Array(16),
              ma = 0,
              Q;
            for (Q = 1; 15 >= Q; Q++) S[Q] = ma = (ma + ba[Q - 1]) << 1;
            for (ba = 0; ba <= R; ba++)
              (ma = z[2 * ba + 1]), 0 !== ma && (z[2 * ba] = q(S[ma]++, ma));
          }
          function u(z) {
            var R;
            for (R = 0; 286 > R; R++) z.dyn_ltree[2 * R] = 0;
            for (R = 0; 30 > R; R++) z.dyn_dtree[2 * R] = 0;
            for (R = 0; 19 > R; R++) z.bl_tree[2 * R] = 0;
            z.dyn_ltree[512] = 1;
            z.opt_len = z.static_len = 0;
            z.last_lit = z.matches = 0;
          }
          function A(z) {
            8 < z.bi_valid
              ? g(z, z.bi_buf)
              : 0 < z.bi_valid && (z.pending_buf[z.pending++] = z.bi_buf);
            z.bi_buf = 0;
            z.bi_valid = 0;
          }
          function G(z, R, ba, S) {
            var ma = 2 * R,
              Q = 2 * ba;
            return z[ma] < z[Q] || (z[ma] === z[Q] && S[R] <= S[ba]);
          }
          function O(z, R, ba) {
            for (var S = z.heap[ba], ma = ba << 1; ma <= z.heap_len; ) {
              ma < z.heap_len &&
                G(R, z.heap[ma + 1], z.heap[ma], z.depth) &&
                ma++;
              if (G(R, S, z.heap[ma], z.depth)) break;
              z.heap[ba] = z.heap[ma];
              ba = ma;
              ma <<= 1;
            }
            z.heap[ba] = S;
          }
          function H(z, R, ba) {
            var S = 0;
            if (0 !== z.last_lit) {
              do {
                var ma =
                  (z.pending_buf[z.d_buf + 2 * S] << 8) |
                  z.pending_buf[z.d_buf + 2 * S + 1];
                var Q = z.pending_buf[z.l_buf + S];
                S++;
                if (0 === ma) n(z, Q, R);
                else {
                  var ea = F[Q];
                  n(z, ea + 256 + 1, R);
                  var ca = T[ea];
                  0 !== ca && ((Q -= r[ea]), h(z, Q, ca));
                  ma--;
                  ea = 256 > ma ? m[ma] : m[256 + (ma >>> 7)];
                  n(z, ea, ba);
                  ca = ka[ea];
                  0 !== ca && ((ma -= y[ea]), h(z, ma, ca));
                }
              } while (S < z.last_lit);
            }
            n(z, 256, R);
          }
          function P(z, R) {
            var ba = R.dyn_tree,
              S = R.stat_desc.static_tree,
              ma = R.stat_desc.has_stree,
              Q = R.stat_desc.elems,
              ea,
              ca = -1;
            z.heap_len = 0;
            z.heap_max = 573;
            for (ea = 0; ea < Q; ea++)
              0 !== ba[2 * ea]
                ? ((z.heap[++z.heap_len] = ca = ea), (z.depth[ea] = 0))
                : (ba[2 * ea + 1] = 0);
            for (; 2 > z.heap_len; ) {
              var qa = (z.heap[++z.heap_len] = 2 > ca ? ++ca : 0);
              ba[2 * qa] = 1;
              z.depth[qa] = 0;
              z.opt_len--;
              ma && (z.static_len -= S[2 * qa + 1]);
            }
            R.max_code = ca;
            for (ea = z.heap_len >> 1; 1 <= ea; ea--) O(z, ba, ea);
            qa = Q;
            do
              (ea = z.heap[1]),
                (z.heap[1] = z.heap[z.heap_len--]),
                O(z, ba, 1),
                (S = z.heap[1]),
                (z.heap[--z.heap_max] = ea),
                (z.heap[--z.heap_max] = S),
                (ba[2 * qa] = ba[2 * ea] + ba[2 * S]),
                (z.depth[qa] =
                  (z.depth[ea] >= z.depth[S] ? z.depth[ea] : z.depth[S]) + 1),
                (ba[2 * ea + 1] = ba[2 * S + 1] = qa),
                (z.heap[1] = qa++),
                O(z, ba, 1);
            while (2 <= z.heap_len);
            z.heap[--z.heap_max] = z.heap[1];
            ea = R.dyn_tree;
            qa = R.max_code;
            S = R.stat_desc.static_tree;
            ma = R.stat_desc.has_stree;
            Q = R.stat_desc.extra_bits;
            var wa = R.stat_desc.extra_base,
              ya = R.stat_desc.max_length,
              ua,
              Ja = 0;
            for (ua = 0; 15 >= ua; ua++) z.bl_count[ua] = 0;
            ea[2 * z.heap[z.heap_max] + 1] = 0;
            for (R = z.heap_max + 1; 573 > R; R++) {
              var Ha = z.heap[R];
              ua = ea[2 * ea[2 * Ha + 1] + 1] + 1;
              ua > ya && ((ua = ya), Ja++);
              ea[2 * Ha + 1] = ua;
              if (!(Ha > qa)) {
                z.bl_count[ua]++;
                var cb = 0;
                Ha >= wa && (cb = Q[Ha - wa]);
                var kb = ea[2 * Ha];
                z.opt_len += kb * (ua + cb);
                ma && (z.static_len += kb * (S[2 * Ha + 1] + cb));
              }
            }
            if (0 !== Ja) {
              do {
                for (ua = ya - 1; 0 === z.bl_count[ua]; ) ua--;
                z.bl_count[ua]--;
                z.bl_count[ua + 1] += 2;
                z.bl_count[ya]--;
                Ja -= 2;
              } while (0 < Ja);
              for (ua = ya; 0 !== ua; ua--)
                for (Ha = z.bl_count[ua]; 0 !== Ha; )
                  (S = z.heap[--R]),
                    S > qa ||
                      (ea[2 * S + 1] !== ua &&
                        ((z.opt_len += (ua - ea[2 * S + 1]) * ea[2 * S]),
                        (ea[2 * S + 1] = ua)),
                      Ha--);
            }
            t(ba, ca, z.bl_count);
          }
          function U(z, R, ba) {
            var S,
              ma = -1,
              Q = R[1],
              ea = 0,
              ca = 7,
              qa = 4;
            0 === Q && ((ca = 138), (qa = 3));
            R[2 * (ba + 1) + 1] = 65535;
            for (S = 0; S <= ba; S++) {
              var wa = Q;
              Q = R[2 * (S + 1) + 1];
              (++ea < ca && wa === Q) ||
                (ea < qa
                  ? (z.bl_tree[2 * wa] += ea)
                  : 0 !== wa
                  ? (wa !== ma && z.bl_tree[2 * wa]++, z.bl_tree[32]++)
                  : 10 >= ea
                  ? z.bl_tree[34]++
                  : z.bl_tree[36]++,
                (ea = 0),
                (ma = wa),
                0 === Q
                  ? ((ca = 138), (qa = 3))
                  : wa === Q
                  ? ((ca = 6), (qa = 3))
                  : ((ca = 7), (qa = 4)));
            }
          }
          function ha(z, R, ba) {
            var S,
              ma = -1,
              Q = R[1],
              ea = 0,
              ca = 7,
              qa = 4;
            0 === Q && ((ca = 138), (qa = 3));
            for (S = 0; S <= ba; S++) {
              var wa = Q;
              Q = R[2 * (S + 1) + 1];
              if (!(++ea < ca && wa === Q)) {
                if (ea < qa) {
                  do n(z, wa, z.bl_tree);
                  while (0 !== --ea);
                } else
                  0 !== wa
                    ? (wa !== ma && (n(z, wa, z.bl_tree), ea--),
                      n(z, 16, z.bl_tree),
                      h(z, ea - 3, 2))
                    : 10 >= ea
                    ? (n(z, 17, z.bl_tree), h(z, ea - 3, 3))
                    : (n(z, 18, z.bl_tree), h(z, ea - 11, 7));
                ea = 0;
                ma = wa;
                0 === Q
                  ? ((ca = 138), (qa = 3))
                  : wa === Q
                  ? ((ca = 6), (qa = 3))
                  : ((ca = 7), (qa = 4));
              }
            }
          }
          function w(z) {
            var R = 4093624447,
              ba;
            for (ba = 0; 31 >= ba; ba++, R >>>= 1)
              if (R & 1 && 0 !== z.dyn_ltree[2 * ba]) return 0;
            if (
              0 !== z.dyn_ltree[18] ||
              0 !== z.dyn_ltree[20] ||
              0 !== z.dyn_ltree[26]
            )
              return 1;
            for (ba = 32; 256 > ba; ba++)
              if (0 !== z.dyn_ltree[2 * ba]) return 1;
            return 0;
          }
          function I(z, R, ba, S) {
            h(z, S ? 1 : 0, 3);
            A(z);
            g(z, ba);
            g(z, ~ba);
            aa.arraySet(z.pending_buf, z.window, R, ba, z.pending);
            z.pending += ba;
          }
          var aa = b("../utils/common"),
            T = [
              0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4,
              4, 4, 5, 5, 5, 5, 0,
            ],
            ka = [
              0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9,
              10, 10, 11, 11, 12, 12, 13, 13,
            ],
            k = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7],
            X = [
              16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15,
            ],
            V = Array(576);
          d(V);
          var p = Array(60);
          d(p);
          var m = Array(512);
          d(m);
          var F = Array(256);
          d(F);
          var r = Array(29);
          d(r);
          var y = Array(30);
          d(y);
          var D = function (z, R, ba, S, ma) {
              this.static_tree = z;
              this.extra_bits = R;
              this.extra_base = ba;
              this.elems = S;
              this.max_length = ma;
              this.has_stree = z && z.length;
            },
            B,
            C,
            L,
            N = function (z, R) {
              this.dyn_tree = z;
              this.max_code = 0;
              this.stat_desc = R;
            },
            K = !1;
          e._tr_init = function (z) {
            if (!K) {
              var R,
                ba,
                S,
                ma = Array(16);
              for (S = ba = 0; 28 > S; S++)
                for (r[S] = ba, R = 0; R < 1 << T[S]; R++) F[ba++] = S;
              F[ba - 1] = S;
              for (S = ba = 0; 16 > S; S++)
                for (y[S] = ba, R = 0; R < 1 << ka[S]; R++) m[ba++] = S;
              for (ba >>= 7; 30 > S; S++)
                for (y[S] = ba << 7, R = 0; R < 1 << (ka[S] - 7); R++)
                  m[256 + ba++] = S;
              for (R = 0; 15 >= R; R++) ma[R] = 0;
              for (R = 0; 143 >= R; ) (V[2 * R + 1] = 8), R++, ma[8]++;
              for (; 255 >= R; ) (V[2 * R + 1] = 9), R++, ma[9]++;
              for (; 279 >= R; ) (V[2 * R + 1] = 7), R++, ma[7]++;
              for (; 287 >= R; ) (V[2 * R + 1] = 8), R++, ma[8]++;
              t(V, 287, ma);
              for (R = 0; 30 > R; R++) (p[2 * R + 1] = 5), (p[2 * R] = q(R, 5));
              B = new D(V, T, 257, 286, 15);
              C = new D(p, ka, 0, 30, 15);
              L = new D([], k, 0, 19, 7);
              K = !0;
            }
            z.l_desc = new N(z.dyn_ltree, B);
            z.d_desc = new N(z.dyn_dtree, C);
            z.bl_desc = new N(z.bl_tree, L);
            z.bi_buf = 0;
            z.bi_valid = 0;
            u(z);
          };
          e._tr_stored_block = I;
          e._tr_flush_block = function (z, R, ba, S) {
            var ma = 0;
            if (0 < z.level) {
              2 === z.strm.data_type && (z.strm.data_type = w(z));
              P(z, z.l_desc);
              P(z, z.d_desc);
              U(z, z.dyn_ltree, z.l_desc.max_code);
              U(z, z.dyn_dtree, z.d_desc.max_code);
              P(z, z.bl_desc);
              for (ma = 18; 3 <= ma && 0 === z.bl_tree[2 * X[ma] + 1]; ma--);
              z.opt_len += 3 * (ma + 1) + 14;
              var Q = (z.opt_len + 3 + 7) >>> 3;
              var ea = (z.static_len + 3 + 7) >>> 3;
              ea <= Q && (Q = ea);
            } else Q = ea = ba + 5;
            if (ba + 4 <= Q && -1 !== R) I(z, R, ba, S);
            else if (4 === z.strategy || ea === Q)
              h(z, 2 + (S ? 1 : 0), 3), H(z, V, p);
            else {
              h(z, 4 + (S ? 1 : 0), 3);
              R = z.l_desc.max_code + 1;
              ba = z.d_desc.max_code + 1;
              ma += 1;
              h(z, R - 257, 5);
              h(z, ba - 1, 5);
              h(z, ma - 4, 4);
              for (Q = 0; Q < ma; Q++) h(z, z.bl_tree[2 * X[Q] + 1], 3);
              ha(z, z.dyn_ltree, R - 1);
              ha(z, z.dyn_dtree, ba - 1);
              H(z, z.dyn_ltree, z.dyn_dtree);
            }
            u(z);
            S && A(z);
          };
          e._tr_tally = function (z, R, ba) {
            z.pending_buf[z.d_buf + 2 * z.last_lit] = (R >>> 8) & 255;
            z.pending_buf[z.d_buf + 2 * z.last_lit + 1] = R & 255;
            z.pending_buf[z.l_buf + z.last_lit] = ba & 255;
            z.last_lit++;
            0 === R
              ? z.dyn_ltree[2 * ba]++
              : (z.matches++,
                R--,
                z.dyn_ltree[2 * (F[ba] + 256 + 1)]++,
                z.dyn_dtree[2 * (256 > R ? m[R] : m[256 + (R >>> 7)])]++);
            return z.last_lit === z.lit_bufsize - 1;
          };
          e._tr_align = function (z) {
            h(z, 2, 3);
            n(z, 256, V);
            16 === z.bi_valid
              ? (g(z, z.bi_buf), (z.bi_buf = 0), (z.bi_valid = 0))
              : 8 <= z.bi_valid &&
                ((z.pending_buf[z.pending++] = z.bi_buf & 255),
                (z.bi_buf >>= 8),
                (z.bi_valid -= 8));
          };
        },
        { "../utils/common": 4 },
      ],
      16: [
        function (b, c, e) {
          c.exports = function () {
            this.input = null;
            this.total_in = this.avail_in = this.next_in = 0;
            this.output = null;
            this.total_out = this.avail_out = this.next_out = 0;
            this.msg = "";
            this.state = null;
            this.data_type = 2;
            this.adler = 0;
          };
        },
        {},
      ],
      17: [
        function (b, c, e) {
          var d = d || {};
          d.NIFTI1 =
            d.NIFTI1 || ("undefined" !== typeof b ? b("./nifti1.js") : null);
          d.NIFTI2 =
            d.NIFTI2 || ("undefined" !== typeof b ? b("./nifti2.js") : null);
          d.Utils =
            d.Utils || ("undefined" !== typeof b ? b("./utilities.js") : null);
          var g = g || ("undefined" !== typeof b ? b("pako") : null);
          d.isNIFTI1 = function (h) {
            if (h.byteLength < d.NIFTI1.STANDARD_HEADER_SIZE) return !1;
            var n = new DataView(h);
            h = n.getUint8(d.NIFTI1.MAGIC_NUMBER_LOCATION);
            var q = n.getUint8(d.NIFTI1.MAGIC_NUMBER_LOCATION + 1);
            n = n.getUint8(d.NIFTI1.MAGIC_NUMBER_LOCATION + 2);
            return !(
              h !== d.NIFTI1.MAGIC_NUMBER[0] ||
              q !== d.NIFTI1.MAGIC_NUMBER[1] ||
              n !== d.NIFTI1.MAGIC_NUMBER[2]
            );
          };
          d.isNIFTI2 = function (h) {
            if (h.byteLength < d.NIFTI1.STANDARD_HEADER_SIZE) return !1;
            var n = new DataView(h);
            h = n.getUint8(d.NIFTI2.MAGIC_NUMBER_LOCATION);
            var q = n.getUint8(d.NIFTI2.MAGIC_NUMBER_LOCATION + 1);
            n = n.getUint8(d.NIFTI2.MAGIC_NUMBER_LOCATION + 2);
            return !(
              h !== d.NIFTI2.MAGIC_NUMBER[0] ||
              q !== d.NIFTI2.MAGIC_NUMBER[1] ||
              n !== d.NIFTI2.MAGIC_NUMBER[2]
            );
          };
          d.isNIFTI = function (h) {
            return d.isNIFTI1(h) || d.isNIFTI2(h);
          };
          d.isCompressed = function (h) {
            if (h) {
              var n = new DataView(h);
              h = n.getUint8(0);
              n = n.getUint8(1);
              if (
                h === d.Utils.GUNZIP_MAGIC_COOKIE1 ||
                n === d.Utils.GUNZIP_MAGIC_COOKIE2
              )
                return !0;
            }
            return !1;
          };
          d.decompress = function (h) {
            return g.inflate(h).buffer;
          };
          d.readHeader = function (h) {
            var n = null;
            d.isCompressed(h) && (h = d.decompress(h));
            d.isNIFTI1(h)
              ? (n = new d.NIFTI1())
              : d.isNIFTI2(h) && (n = new d.NIFTI2());
            n
              ? n.readHeader(h)
              : console.error("That file does not appear to be NIFTI!");
            return n;
          };
          d.hasExtension = function (h) {
            return 0 != h.extensionFlag[0];
          };
          d.readImage = function (h, n) {
            var q = h.vox_offset,
              t = 1,
              u = 1;
            h.dims[4] && (t = h.dims[4]);
            h.dims[5] && (u = h.dims[5]);
            return n.slice(
              q,
              q +
                (h.numBitsPerVoxel / 8) *
                  h.dims[2] *
                  h.dims[3] *
                  t *
                  u *
                  h.dims[1]
            );
          };
          d.readExtension = function (h, n) {
            var q = h.getExtensionLocation();
            return n.slice(q, q + h.extensionSize);
          };
          d.readExtensionData = function (h, n) {
            var q = h.getExtensionLocation();
            return n.slice(q + 8, q + h.extensionSize + 8);
          };
          "undefined" !== typeof c && c.exports && (c.exports = d);
        },
        { "./nifti1.js": 18, "./nifti2.js": 19, "./utilities.js": 20, pako: 1 },
      ],
      18: [
        function (b, c, e) {
          var d = d || {};
          d.Utils =
            d.Utils || ("undefined" !== typeof b ? b("./utilities.js") : null);
          d.NIFTI1 =
            d.NIFTI1 ||
            function () {
              this.littleEndian = !1;
              this.dim_info = 0;
              this.dims = [];
              this.slice_code =
                this.slice_end =
                this.slice_start =
                this.numBitsPerVoxel =
                this.datatypeCode =
                this.intent_code =
                this.intent_p3 =
                this.intent_p2 =
                this.intent_p1 =
                  0;
              this.pixDims = [];
              this.vox_offset = 0;
              this.scl_slope = 1;
              this.toffset =
                this.slice_duration =
                this.cal_min =
                this.cal_max =
                this.xyzt_units =
                this.scl_inter =
                  0;
              this.intent_name = this.aux_file = this.description = "";
              this.qoffset_z =
                this.qoffset_y =
                this.qoffset_x =
                this.quatern_d =
                this.quatern_c =
                this.quatern_b =
                this.sform_code =
                this.qform_code =
                  0;
              this.affine = [
                [1, 0, 0, 0],
                [0, 1, 0, 0],
                [0, 0, 1, 0],
                [0, 0, 0, 1],
              ];
              this.magic = 0;
              this.isHDR = !1;
              this.extensionFlag = [0, 0, 0, 0];
              this.extensionCode = this.extensionSize = 0;
            };
          d.NIFTI1.TYPE_NONE = 0;
          d.NIFTI1.TYPE_BINARY = 1;
          d.NIFTI1.TYPE_UINT8 = 2;
          d.NIFTI1.TYPE_INT16 = 4;
          d.NIFTI1.TYPE_INT32 = 8;
          d.NIFTI1.TYPE_FLOAT32 = 16;
          d.NIFTI1.TYPE_COMPLEX64 = 32;
          d.NIFTI1.TYPE_FLOAT64 = 64;
          d.NIFTI1.TYPE_RGB24 = 128;
          d.NIFTI1.TYPE_INT8 = 256;
          d.NIFTI1.TYPE_UINT16 = 512;
          d.NIFTI1.TYPE_UINT32 = 768;
          d.NIFTI1.TYPE_INT64 = 1024;
          d.NIFTI1.TYPE_UINT64 = 1280;
          d.NIFTI1.TYPE_FLOAT128 = 1536;
          d.NIFTI1.TYPE_COMPLEX128 = 1792;
          d.NIFTI1.TYPE_COMPLEX256 = 2048;
          d.NIFTI1.XFORM_UNKNOWN = 0;
          d.NIFTI1.XFORM_SCANNER_ANAT = 1;
          d.NIFTI1.XFORM_ALIGNED_ANAT = 2;
          d.NIFTI1.XFORM_TALAIRACH = 3;
          d.NIFTI1.XFORM_MNI_152 = 4;
          d.NIFTI1.SPATIAL_UNITS_MASK = 7;
          d.NIFTI1.TEMPORAL_UNITS_MASK = 56;
          d.NIFTI1.UNITS_UNKNOWN = 0;
          d.NIFTI1.UNITS_METER = 1;
          d.NIFTI1.UNITS_MM = 2;
          d.NIFTI1.UNITS_MICRON = 3;
          d.NIFTI1.UNITS_SEC = 8;
          d.NIFTI1.UNITS_MSEC = 16;
          d.NIFTI1.UNITS_USEC = 24;
          d.NIFTI1.UNITS_HZ = 32;
          d.NIFTI1.UNITS_PPM = 40;
          d.NIFTI1.UNITS_RADS = 48;
          d.NIFTI1.MAGIC_COOKIE = 348;
          d.NIFTI1.STANDARD_HEADER_SIZE = 348;
          d.NIFTI1.MAGIC_NUMBER_LOCATION = 344;
          d.NIFTI1.MAGIC_NUMBER = [110, 43, 49];
          d.NIFTI1.MAGIC_NUMBER2 = [110, 105, 49];
          d.NIFTI1.EXTENSION_HEADER_SIZE = 8;
          d.NIFTI1.prototype.readHeader = function (g) {
            g = new DataView(g);
            var h = d.Utils.getIntAt(g, 0, this.littleEndian),
              n,
              q;
            h !== d.NIFTI1.MAGIC_COOKIE &&
              ((this.littleEndian = !0),
              (h = d.Utils.getIntAt(g, 0, this.littleEndian)));
            if (h !== d.NIFTI1.MAGIC_COOKIE)
              throw Error("This does not appear to be a NIFTI file!");
            this.dim_info = d.Utils.getByteAt(g, 39);
            for (n = 0; 8 > n; n += 1)
              (h = 40 + 2 * n),
                (this.dims[n] = d.Utils.getShortAt(g, h, this.littleEndian));
            this.intent_p1 = d.Utils.getFloatAt(g, 56, this.littleEndian);
            this.intent_p2 = d.Utils.getFloatAt(g, 60, this.littleEndian);
            this.intent_p3 = d.Utils.getFloatAt(g, 64, this.littleEndian);
            this.intent_code = d.Utils.getShortAt(g, 68, this.littleEndian);
            this.datatypeCode = d.Utils.getShortAt(g, 70, this.littleEndian);
            this.numBitsPerVoxel = d.Utils.getShortAt(g, 72, this.littleEndian);
            this.slice_start = d.Utils.getShortAt(g, 74, this.littleEndian);
            for (n = 0; 8 > n; n += 1)
              (h = 76 + 4 * n),
                (this.pixDims[n] = d.Utils.getFloatAt(g, h, this.littleEndian));
            this.vox_offset = d.Utils.getFloatAt(g, 108, this.littleEndian);
            this.scl_slope = d.Utils.getFloatAt(g, 112, this.littleEndian);
            this.scl_inter = d.Utils.getFloatAt(g, 116, this.littleEndian);
            this.slice_end = d.Utils.getShortAt(g, 120, this.littleEndian);
            this.slice_code = d.Utils.getByteAt(g, 122);
            this.xyzt_units = d.Utils.getByteAt(g, 123);
            this.cal_max = d.Utils.getFloatAt(g, 124, this.littleEndian);
            this.cal_min = d.Utils.getFloatAt(g, 128, this.littleEndian);
            this.slice_duration = d.Utils.getFloatAt(g, 132, this.littleEndian);
            this.toffset = d.Utils.getFloatAt(g, 136, this.littleEndian);
            this.description = d.Utils.getStringAt(g, 148, 228);
            this.aux_file = d.Utils.getStringAt(g, 228, 252);
            this.qform_code = d.Utils.getShortAt(g, 252, this.littleEndian);
            this.sform_code = d.Utils.getShortAt(g, 254, this.littleEndian);
            this.quatern_b = d.Utils.getFloatAt(g, 256, this.littleEndian);
            this.quatern_c = d.Utils.getFloatAt(g, 260, this.littleEndian);
            this.quatern_d = d.Utils.getFloatAt(g, 264, this.littleEndian);
            this.qoffset_x = d.Utils.getFloatAt(g, 268, this.littleEndian);
            this.qoffset_y = d.Utils.getFloatAt(g, 272, this.littleEndian);
            this.qoffset_z = d.Utils.getFloatAt(g, 276, this.littleEndian);
            for (n = 0; 3 > n; n += 1)
              for (q = 0; 4 > q; q += 1)
                (h = 280 + 4 * (4 * n + q)),
                  (this.affine[n][q] = d.Utils.getFloatAt(
                    g,
                    h,
                    this.littleEndian
                  ));
            this.affine[3][0] = 0;
            this.affine[3][1] = 0;
            this.affine[3][2] = 0;
            this.affine[3][3] = 1;
            this.intent_name = d.Utils.getStringAt(g, 328, 344);
            this.magic = d.Utils.getStringAt(g, 344, 348);
            this.isHDR = this.magic === d.NIFTI1.MAGIC_NUMBER2;
            g.byteLength > d.NIFTI1.MAGIC_COOKIE &&
              ((this.extensionFlag[0] = d.Utils.getByteAt(g, 348)),
              (this.extensionFlag[1] = d.Utils.getByteAt(g, 349)),
              (this.extensionFlag[2] = d.Utils.getByteAt(g, 350)),
              (this.extensionFlag[3] = d.Utils.getByteAt(g, 351)),
              this.extensionFlag[0] &&
                ((this.extensionSize = this.getExtensionSize(g)),
                (this.extensionCode = this.getExtensionCode(g))));
          };
          d.NIFTI1.prototype.toFormattedString = function () {
            var g = d.Utils.formatNumber;
            var h = "Dim Info = " + this.dim_info + "\n";
            h +=
              "Image Dimensions (1-8): " +
              this.dims[0] +
              ", " +
              this.dims[1] +
              ", " +
              this.dims[2] +
              ", " +
              this.dims[3] +
              ", " +
              this.dims[4] +
              ", " +
              this.dims[5] +
              ", " +
              this.dims[6] +
              ", " +
              this.dims[7] +
              "\n";
            h +=
              "Intent Parameters (1-3): " +
              this.intent_p1 +
              ", " +
              this.intent_p2 +
              ", " +
              this.intent_p3 +
              "\n";
            h += "Intent Code = " + this.intent_code + "\n";
            h +=
              "Datatype = " +
              this.datatypeCode +
              " (" +
              this.getDatatypeCodeString(this.datatypeCode) +
              ")\n";
            h += "Bits Per Voxel = " + this.numBitsPerVoxel + "\n";
            h += "Slice Start = " + this.slice_start + "\n";
            h +=
              "Voxel Dimensions (1-8): " +
              g(this.pixDims[0]) +
              ", " +
              g(this.pixDims[1]) +
              ", " +
              g(this.pixDims[2]) +
              ", " +
              g(this.pixDims[3]) +
              ", " +
              g(this.pixDims[4]) +
              ", " +
              g(this.pixDims[5]) +
              ", " +
              g(this.pixDims[6]) +
              ", " +
              g(this.pixDims[7]) +
              "\n";
            h += "Image Offset = " + this.vox_offset + "\n";
            h +=
              "Data Scale:  Slope = " +
              g(this.scl_slope) +
              "  Intercept = " +
              g(this.scl_inter) +
              "\n";
            h += "Slice End = " + this.slice_end + "\n";
            h += "Slice Code = " + this.slice_code + "\n";
            h +=
              "Units Code = " +
              this.xyzt_units +
              " (" +
              this.getUnitsCodeString(
                d.NIFTI1.SPATIAL_UNITS_MASK & this.xyzt_units
              ) +
              ", " +
              this.getUnitsCodeString(
                d.NIFTI1.TEMPORAL_UNITS_MASK & this.xyzt_units
              ) +
              ")\n";
            h +=
              "Display Range:  Max = " +
              g(this.cal_max) +
              "  Min = " +
              g(this.cal_min) +
              "\n";
            h += "Slice Duration = " + this.slice_duration + "\n";
            h += "Time Axis Shift = " + this.toffset + "\n";
            h += 'Description: "' + this.description + '"\n';
            h += 'Auxiliary File: "' + this.aux_file + '"\n';
            h +=
              "Q-Form Code = " +
              this.qform_code +
              " (" +
              this.getTransformCodeString(this.qform_code) +
              ")\n";
            h +=
              "S-Form Code = " +
              this.sform_code +
              " (" +
              this.getTransformCodeString(this.sform_code) +
              ")\n";
            h +=
              "Quaternion Parameters:  b = " +
              g(this.quatern_b) +
              "  c = " +
              g(this.quatern_c) +
              "  d = " +
              g(this.quatern_d) +
              "\n";
            h +=
              "Quaternion Offsets:  x = " +
              this.qoffset_x +
              "  y = " +
              this.qoffset_y +
              "  z = " +
              this.qoffset_z +
              "\n";
            h +=
              "S-Form Parameters X: " +
              g(this.affine[0][0]) +
              ", " +
              g(this.affine[0][1]) +
              ", " +
              g(this.affine[0][2]) +
              ", " +
              g(this.affine[0][3]) +
              "\n";
            h +=
              "S-Form Parameters Y: " +
              g(this.affine[1][0]) +
              ", " +
              g(this.affine[1][1]) +
              ", " +
              g(this.affine[1][2]) +
              ", " +
              g(this.affine[1][3]) +
              "\n";
            h +=
              "S-Form Parameters Z: " +
              g(this.affine[2][0]) +
              ", " +
              g(this.affine[2][1]) +
              ", " +
              g(this.affine[2][2]) +
              ", " +
              g(this.affine[2][3]) +
              "\n";
            h += 'Intent Name: "' + this.intent_name + '"\n';
            this.extensionFlag[0] &&
              (h +=
                "Extension: Size = " +
                this.extensionSize +
                "  Code = " +
                this.extensionCode +
                "\n");
            return h;
          };
          d.NIFTI1.prototype.getDatatypeCodeString = function (g) {
            return g === d.NIFTI1.TYPE_UINT8
              ? "1-Byte Unsigned Integer"
              : g === d.NIFTI1.TYPE_INT16
              ? "2-Byte Signed Integer"
              : g === d.NIFTI1.TYPE_INT32
              ? "4-Byte Signed Integer"
              : g === d.NIFTI1.TYPE_FLOAT32
              ? "4-Byte Float"
              : g === d.NIFTI1.TYPE_FLOAT64
              ? "8-Byte Float"
              : g === d.NIFTI1.TYPE_RGB24
              ? "RGB"
              : g === d.NIFTI1.TYPE_INT8
              ? "1-Byte Signed Integer"
              : g === d.NIFTI1.TYPE_UINT16
              ? "2-Byte Unsigned Integer"
              : g === d.NIFTI1.TYPE_UINT32
              ? "4-Byte Unsigned Integer"
              : g === d.NIFTI1.TYPE_INT64
              ? "8-Byte Signed Integer"
              : g === d.NIFTI1.TYPE_UINT64
              ? "8-Byte Unsigned Integer"
              : "Unknown";
          };
          d.NIFTI1.prototype.getTransformCodeString = function (g) {
            return g === d.NIFTI1.XFORM_SCANNER_ANAT
              ? "Scanner"
              : g === d.NIFTI1.XFORM_ALIGNED_ANAT
              ? "Aligned"
              : g === d.NIFTI1.XFORM_TALAIRACH
              ? "Talairach"
              : g === d.NIFTI1.XFORM_MNI_152
              ? "MNI"
              : "Unknown";
          };
          d.NIFTI1.prototype.getUnitsCodeString = function (g) {
            return g === d.NIFTI1.UNITS_METER
              ? "Meters"
              : g === d.NIFTI1.UNITS_MM
              ? "Millimeters"
              : g === d.NIFTI1.UNITS_MICRON
              ? "Microns"
              : g === d.NIFTI1.UNITS_SEC
              ? "Seconds"
              : g === d.NIFTI1.UNITS_MSEC
              ? "Milliseconds"
              : g === d.NIFTI1.UNITS_USEC
              ? "Microseconds"
              : g === d.NIFTI1.UNITS_HZ
              ? "Hz"
              : g === d.NIFTI1.UNITS_PPM
              ? "PPM"
              : g === d.NIFTI1.UNITS_RADS
              ? "Rads"
              : "Unknown";
          };
          d.NIFTI1.prototype.getQformMat = function () {
            return this.convertNiftiQFormToNiftiSForm(
              this.quatern_b,
              this.quatern_c,
              this.quatern_d,
              this.qoffset_x,
              this.qoffset_y,
              this.qoffset_z,
              this.pixDims[1],
              this.pixDims[2],
              this.pixDims[3],
              this.pixDims[0]
            );
          };
          d.NIFTI1.prototype.convertNiftiQFormToNiftiSForm = function (
            g,
            h,
            n,
            q,
            t,
            u,
            A,
            G,
            O,
            H
          ) {
            var P = [
                [0, 0, 0, 0],
                [0, 0, 0, 0],
                [0, 0, 0, 0],
                [0, 0, 0, 0],
              ],
              U = n;
            P[3][0] = P[3][1] = P[3][2] = 0;
            P[3][3] = 1;
            n = 1 - (g * g + h * h + U * U);
            1e-7 > n
              ? ((n = 1 / Math.sqrt(g * g + h * h + U * U)),
                (g *= n),
                (h *= n),
                (U *= n),
                (n = 0))
              : (n = Math.sqrt(n));
            A = 0 < A ? A : 1;
            G = 0 < G ? G : 1;
            O = 0 < O ? O : 1;
            0 > H && (O = -O);
            P[0][0] = (n * n + g * g - h * h - U * U) * A;
            P[0][1] = 2 * (g * h - n * U) * G;
            P[0][2] = 2 * (g * U + n * h) * O;
            P[1][0] = 2 * (g * h + n * U) * A;
            P[1][1] = (n * n + h * h - g * g - U * U) * G;
            P[1][2] = 2 * (h * U - n * g) * O;
            P[2][0] = 2 * (g * U - n * h) * A;
            P[2][1] = 2 * (h * U + n * g) * G;
            P[2][2] = (n * n + U * U - h * h - g * g) * O;
            P[0][3] = q;
            P[1][3] = t;
            P[2][3] = u;
            return P;
          };
          d.NIFTI1.prototype.convertNiftiSFormToNEMA = function (g) {
            var h, n, q, t;
            var u = [
              [0, 0, 0],
              [0, 0, 0],
              [0, 0, 0],
            ];
            var A = [
              [0, 0, 0],
              [0, 0, 0],
              [0, 0, 0],
            ];
            var G = g[0][0];
            var O = g[0][1];
            var H = g[0][2];
            var P = g[1][0];
            var U = g[1][1];
            var ha = g[1][2];
            var w = g[2][0];
            var I = g[2][1];
            var aa = g[2][2];
            g = Math.sqrt(G * G + P * P + w * w);
            if (0 === g) return null;
            G /= g;
            P /= g;
            w /= g;
            g = Math.sqrt(O * O + U * U + I * I);
            if (0 === g) return null;
            O /= g;
            U /= g;
            I /= g;
            g = G * O + P * U + w * I;
            if (1e-4 < Math.abs(g)) {
              O -= g * G;
              U -= g * P;
              I -= g * w;
              g = Math.sqrt(O * O + U * U + I * I);
              if (0 === g) return null;
              O /= g;
              U /= g;
              I /= g;
            }
            g = Math.sqrt(H * H + ha * ha + aa * aa);
            0 === g
              ? ((H = P * I - w * U),
                (ha = w * O - I * G),
                (aa = G * U - P * O))
              : ((H /= g), (ha /= g), (aa /= g));
            g = G * H + P * ha + w * aa;
            if (1e-4 < Math.abs(g)) {
              H -= g * G;
              ha -= g * P;
              aa -= g * w;
              g = Math.sqrt(H * H + ha * ha + aa * aa);
              if (0 === g) return null;
              H /= g;
              ha /= g;
              aa /= g;
            }
            g = O * H + U * ha + I * aa;
            if (1e-4 < Math.abs(g)) {
              H -= g * O;
              ha -= g * U;
              aa -= g * I;
              g = Math.sqrt(H * H + ha * ha + aa * aa);
              if (0 === g) return null;
              H /= g;
              ha /= g;
              aa /= g;
            }
            u[0][0] = G;
            u[0][1] = O;
            u[0][2] = H;
            u[1][0] = P;
            u[1][1] = U;
            u[1][2] = ha;
            u[2][0] = w;
            u[2][1] = I;
            u[2][2] = aa;
            w = this.nifti_mat33_determ(u);
            if (0 === w) return null;
            var T = -666;
            G = P = U = ha = 1;
            O = 2;
            H = 3;
            for (I = 1; 3 >= I; I += 1)
              for (aa = 1; 3 >= aa; aa += 1)
                if (I !== aa)
                  for (h = 1; 3 >= h; h += 1)
                    if (I !== h && aa !== h)
                      for (
                        A[0][0] =
                          A[0][1] =
                          A[0][2] =
                          A[1][0] =
                          A[1][1] =
                          A[1][2] =
                          A[2][0] =
                          A[2][1] =
                          A[2][2] =
                            0,
                          n = -1;
                        1 >= n;
                        n += 2
                      )
                        for (q = -1; 1 >= q; q += 2)
                          for (t = -1; 1 >= t; t += 2)
                            (A[0][I - 1] = n),
                              (A[1][aa - 1] = q),
                              (A[2][h - 1] = t),
                              (g = this.nifti_mat33_determ(A)),
                              0 < g * w &&
                                ((g = this.nifti_mat33_mul(A, u)),
                                (g = g[0][0] + g[1][1] + g[2][2]),
                                g > T &&
                                  ((T = g),
                                  (G = I),
                                  (O = aa),
                                  (H = h),
                                  (P = n),
                                  (U = q),
                                  (ha = t)));
            u = A = g = w = I = aa = 0;
            switch (G * P) {
              case 1:
                u = "X";
                w = "+";
                break;
              case -1:
                u = "X";
                w = "-";
                break;
              case 2:
                u = "Y";
                w = "+";
                break;
              case -2:
                u = "Y";
                w = "-";
                break;
              case 3:
                u = "Z";
                w = "+";
                break;
              case -3:
                (u = "Z"), (w = "-");
            }
            switch (O * U) {
              case 1:
                A = "X";
                I = "+";
                break;
              case -1:
                A = "X";
                I = "-";
                break;
              case 2:
                A = "Y";
                I = "+";
                break;
              case -2:
                A = "Y";
                I = "-";
                break;
              case 3:
                A = "Z";
                I = "+";
                break;
              case -3:
                (A = "Z"), (I = "-");
            }
            switch (H * ha) {
              case 1:
                g = "X";
                aa = "+";
                break;
              case -1:
                g = "X";
                aa = "-";
                break;
              case 2:
                g = "Y";
                aa = "+";
                break;
              case -2:
                g = "Y";
                aa = "-";
                break;
              case 3:
                g = "Z";
                aa = "+";
                break;
              case -3:
                (g = "Z"), (aa = "-");
            }
            return u + A + g + w + I + aa;
          };
          d.NIFTI1.prototype.nifti_mat33_mul = function (g, h) {
            var n = [
                [0, 0, 0],
                [0, 0, 0],
                [0, 0, 0],
              ],
              q,
              t;
            for (q = 0; 3 > q; q += 1)
              for (t = 0; 3 > t; t += 1)
                n[q][t] =
                  g[q][0] * h[0][t] + g[q][1] * h[1][t] + g[q][2] * h[2][t];
            return n;
          };
          d.NIFTI1.prototype.nifti_mat33_determ = function (g) {
            var h = g[0][0];
            var n = g[0][1];
            var q = g[0][2];
            var t = g[1][0];
            var u = g[1][1];
            var A = g[1][2];
            var G = g[2][0];
            var O = g[2][1];
            g = g[2][2];
            return (
              h * u * g -
              h * O * A -
              t * n * g +
              t * O * q +
              G * n * A -
              G * u * q
            );
          };
          d.NIFTI1.prototype.getExtensionLocation = function () {
            return d.NIFTI1.MAGIC_COOKIE + 4;
          };
          d.NIFTI1.prototype.getExtensionSize = function (g) {
            return d.Utils.getIntAt(
              g,
              this.getExtensionLocation(),
              this.littleEndian
            );
          };
          d.NIFTI1.prototype.getExtensionCode = function (g) {
            return d.Utils.getIntAt(
              g,
              this.getExtensionLocation() + 4,
              this.littleEndian
            );
          };
          "undefined" !== typeof c && c.exports && (c.exports = d.NIFTI1);
        },
        { "./utilities.js": 20 },
      ],
      19: [
        function (b, c, e) {
          var d = d || {};
          d.Utils =
            d.Utils || ("undefined" !== typeof b ? b("./utilities.js") : null);
          d.NIFTI1 =
            d.NIFTI1 || ("undefined" !== typeof b ? b("./nifti1.js") : null);
          d.NIFTI2 =
            d.NIFTI2 ||
            function () {
              this.littleEndian = !1;
              this.dim_info = 0;
              this.dims = [];
              this.slice_code =
                this.slice_end =
                this.slice_start =
                this.numBitsPerVoxel =
                this.datatypeCode =
                this.intent_code =
                this.intent_p3 =
                this.intent_p2 =
                this.intent_p1 =
                  0;
              this.pixDims = [];
              this.vox_offset = 0;
              this.scl_slope = 1;
              this.toffset =
                this.slice_duration =
                this.cal_min =
                this.cal_max =
                this.xyzt_units =
                this.scl_inter =
                  0;
              this.intent_name = this.aux_file = this.description = "";
              this.qoffset_z =
                this.qoffset_y =
                this.qoffset_x =
                this.quatern_d =
                this.quatern_c =
                this.quatern_b =
                this.sform_code =
                this.qform_code =
                  0;
              this.affine = [
                [1, 0, 0, 0],
                [0, 1, 0, 0],
                [0, 0, 1, 0],
                [0, 0, 0, 1],
              ];
              this.magic = 0;
              this.extensionFlag = [0, 0, 0, 0];
            };
          d.NIFTI2.MAGIC_COOKIE = 540;
          d.NIFTI2.MAGIC_NUMBER_LOCATION = 4;
          d.NIFTI2.MAGIC_NUMBER = [110, 43, 50, 0, 13, 10, 26, 10];
          d.NIFTI2.prototype.readHeader = function (g) {
            g = new DataView(g);
            var h = d.Utils.getIntAt(g, 0, this.littleEndian),
              n,
              q;
            h !== d.NIFTI2.MAGIC_COOKIE &&
              ((this.littleEndian = !0),
              (h = d.Utils.getIntAt(g, 0, this.littleEndian)));
            if (h !== d.NIFTI2.MAGIC_COOKIE)
              throw Error("This does not appear to be a NIFTI file!");
            this.datatypeCode = d.Utils.getShortAt(g, 12, this.littleEndian);
            this.numBitsPerVoxel = d.Utils.getShortAt(g, 14, this.littleEndian);
            for (n = 0; 8 > n; n += 1)
              (h = 16 + 8 * n),
                (this.dims[n] = d.Utils.getLongAt(g, h, this.littleEndian));
            this.intent_p1 = d.Utils.getDoubleAt(g, 80, this.littleEndian);
            this.intent_p2 = d.Utils.getDoubleAt(g, 88, this.littleEndian);
            this.intent_p3 = d.Utils.getDoubleAt(g, 96, this.littleEndian);
            for (n = 0; 8 > n; n += 1)
              (h = 104 + 8 * n),
                (this.pixDims[n] = d.Utils.getDoubleAt(
                  g,
                  h,
                  this.littleEndian
                ));
            this.vox_offset = d.Utils.getLongAt(g, 168, this.littleEndian);
            this.scl_slope = d.Utils.getDoubleAt(g, 176, this.littleEndian);
            this.scl_inter = d.Utils.getDoubleAt(g, 184, this.littleEndian);
            this.cal_max = d.Utils.getDoubleAt(g, 192, this.littleEndian);
            this.cal_min = d.Utils.getDoubleAt(g, 200, this.littleEndian);
            this.slice_duration = d.Utils.getDoubleAt(
              g,
              208,
              this.littleEndian
            );
            this.toffset = d.Utils.getDoubleAt(g, 216, this.littleEndian);
            this.slice_start = d.Utils.getLongAt(g, 224, this.littleEndian);
            this.slice_end = d.Utils.getLongAt(g, 232, this.littleEndian);
            this.description = d.Utils.getStringAt(g, 240, 320);
            this.aux_file = d.Utils.getStringAt(g, 320, 344);
            this.qform_code = d.Utils.getIntAt(g, 344, this.littleEndian);
            this.sform_code = d.Utils.getIntAt(g, 348, this.littleEndian);
            this.quatern_b = d.Utils.getDoubleAt(g, 352, this.littleEndian);
            this.quatern_c = d.Utils.getDoubleAt(g, 360, this.littleEndian);
            this.quatern_d = d.Utils.getDoubleAt(g, 368, this.littleEndian);
            this.qoffset_x = d.Utils.getDoubleAt(g, 376, this.littleEndian);
            this.qoffset_y = d.Utils.getDoubleAt(g, 384, this.littleEndian);
            this.qoffset_z = d.Utils.getDoubleAt(g, 392, this.littleEndian);
            for (n = 0; 3 > n; n += 1)
              for (q = 0; 4 > q; q += 1)
                (h = 400 + 8 * (4 * n + q)),
                  (this.affine[n][q] = d.Utils.getDoubleAt(
                    g,
                    h,
                    this.littleEndian
                  ));
            this.affine[3][0] = 0;
            this.affine[3][1] = 0;
            this.affine[3][2] = 0;
            this.affine[3][3] = 1;
            this.slice_code = d.Utils.getIntAt(g, 496, this.littleEndian);
            this.xyzt_units = d.Utils.getIntAt(g, 500, this.littleEndian);
            this.intent_code = d.Utils.getIntAt(g, 504, this.littleEndian);
            this.intent_name = d.Utils.getStringAt(g, 508, 524);
            this.dim_info = d.Utils.getByteAt(g, 524);
            g.byteLength > d.NIFTI2.MAGIC_COOKIE &&
              ((this.extensionFlag[0] = d.Utils.getByteAt(g, 540)),
              (this.extensionFlag[1] = d.Utils.getByteAt(g, 541)),
              (this.extensionFlag[2] = d.Utils.getByteAt(g, 542)),
              (this.extensionFlag[3] = d.Utils.getByteAt(g, 543)),
              this.extensionFlag[0] &&
                ((this.extensionSize = this.getExtensionSize(g)),
                (this.extensionCode = this.getExtensionCode(g))));
          };
          d.NIFTI2.prototype.toFormattedString = function () {
            var g = d.Utils.formatNumber;
            var h =
              "Datatype = " +
              +this.datatypeCode +
              " (" +
              this.getDatatypeCodeString(this.datatypeCode) +
              ")\n";
            h += "Bits Per Voxel =  = " + this.numBitsPerVoxel + "\n";
            h +=
              "Image Dimensions (1-8): " +
              this.dims[0] +
              ", " +
              this.dims[1] +
              ", " +
              this.dims[2] +
              ", " +
              this.dims[3] +
              ", " +
              this.dims[4] +
              ", " +
              this.dims[5] +
              ", " +
              this.dims[6] +
              ", " +
              this.dims[7] +
              "\n";
            h +=
              "Intent Parameters (1-3): " +
              this.intent_p1 +
              ", " +
              this.intent_p2 +
              ", " +
              this.intent_p3 +
              "\n";
            h +=
              "Voxel Dimensions (1-8): " +
              g(this.pixDims[0]) +
              ", " +
              g(this.pixDims[1]) +
              ", " +
              g(this.pixDims[2]) +
              ", " +
              g(this.pixDims[3]) +
              ", " +
              g(this.pixDims[4]) +
              ", " +
              g(this.pixDims[5]) +
              ", " +
              g(this.pixDims[6]) +
              ", " +
              g(this.pixDims[7]) +
              "\n";
            h += "Image Offset = " + this.vox_offset + "\n";
            h +=
              "Data Scale:  Slope = " +
              g(this.scl_slope) +
              "  Intercept = " +
              g(this.scl_inter) +
              "\n";
            h +=
              "Display Range:  Max = " +
              g(this.cal_max) +
              "  Min = " +
              g(this.cal_min) +
              "\n";
            h += "Slice Duration = " + this.slice_duration + "\n";
            h += "Time Axis Shift = " + this.toffset + "\n";
            h += "Slice Start = " + this.slice_start + "\n";
            h += "Slice End = " + this.slice_end + "\n";
            h += 'Description: "' + this.description + '"\n';
            h += 'Auxiliary File: "' + this.aux_file + '"\n';
            h +=
              "Q-Form Code = " +
              this.qform_code +
              " (" +
              this.getTransformCodeString(this.qform_code) +
              ")\n";
            h +=
              "S-Form Code = " +
              this.sform_code +
              " (" +
              this.getTransformCodeString(this.sform_code) +
              ")\n";
            h +=
              "Quaternion Parameters:  b = " +
              g(this.quatern_b) +
              "  c = " +
              g(this.quatern_c) +
              "  d = " +
              g(this.quatern_d) +
              "\n";
            h +=
              "Quaternion Offsets:  x = " +
              this.qoffset_x +
              "  y = " +
              this.qoffset_y +
              "  z = " +
              this.qoffset_z +
              "\n";
            h +=
              "S-Form Parameters X: " +
              g(this.affine[0][0]) +
              ", " +
              g(this.affine[0][1]) +
              ", " +
              g(this.affine[0][2]) +
              ", " +
              g(this.affine[0][3]) +
              "\n";
            h +=
              "S-Form Parameters Y: " +
              g(this.affine[1][0]) +
              ", " +
              g(this.affine[1][1]) +
              ", " +
              g(this.affine[1][2]) +
              ", " +
              g(this.affine[1][3]) +
              "\n";
            h +=
              "S-Form Parameters Z: " +
              g(this.affine[2][0]) +
              ", " +
              g(this.affine[2][1]) +
              ", " +
              g(this.affine[2][2]) +
              ", " +
              g(this.affine[2][3]) +
              "\n";
            h += "Slice Code = " + this.slice_code + "\n";
            h +=
              "Units Code = " +
              this.xyzt_units +
              " (" +
              this.getUnitsCodeString(
                d.NIFTI1.SPATIAL_UNITS_MASK & this.xyzt_units
              ) +
              ", " +
              this.getUnitsCodeString(
                d.NIFTI1.TEMPORAL_UNITS_MASK & this.xyzt_units
              ) +
              ")\n";
            h += "Intent Code = " + this.intent_code + "\n";
            h += 'Intent Name: "' + this.intent_name + '"\n';
            return (h += "Dim Info = " + this.dim_info + "\n");
          };
          d.NIFTI2.prototype.getExtensionLocation = function () {
            return d.NIFTI2.MAGIC_COOKIE + 4;
          };
          d.NIFTI2.prototype.getExtensionSize =
            d.NIFTI1.prototype.getExtensionSize;
          d.NIFTI2.prototype.getExtensionCode =
            d.NIFTI1.prototype.getExtensionCode;
          d.NIFTI2.prototype.getDatatypeCodeString =
            d.NIFTI1.prototype.getDatatypeCodeString;
          d.NIFTI2.prototype.getTransformCodeString =
            d.NIFTI1.prototype.getTransformCodeString;
          d.NIFTI2.prototype.getUnitsCodeString =
            d.NIFTI1.prototype.getUnitsCodeString;
          d.NIFTI2.prototype.getQformMat = d.NIFTI1.prototype.getQformMat;
          d.NIFTI2.prototype.convertNiftiQFormToNiftiSForm =
            d.NIFTI1.prototype.convertNiftiQFormToNiftiSForm;
          d.NIFTI2.prototype.convertNiftiSFormToNEMA =
            d.NIFTI1.prototype.convertNiftiSFormToNEMA;
          d.NIFTI2.prototype.nifti_mat33_mul =
            d.NIFTI1.prototype.nifti_mat33_mul;
          d.NIFTI2.prototype.nifti_mat33_determ =
            d.NIFTI1.prototype.nifti_mat33_determ;
          "undefined" !== typeof c && c.exports && (c.exports = d.NIFTI2);
        },
        { "./nifti1.js": 18, "./utilities.js": 20 },
      ],
      20: [
        function (b, c, e) {
          var d = d || {};
          d.Utils = d.Utils || {};
          d.Utils.crcTable = null;
          d.Utils.GUNZIP_MAGIC_COOKIE1 = 31;
          d.Utils.GUNZIP_MAGIC_COOKIE2 = 139;
          d.Utils.getStringAt = function (g, h, n) {
            for (var q = "", t; h < n; h += 1)
              (t = g.getUint8(h)), 0 !== t && (q += String.fromCharCode(t));
            return q;
          };
          d.Utils.getByteAt = function (g, h) {
            return g.getInt8(h);
          };
          d.Utils.getShortAt = function (g, h, n) {
            return g.getInt16(h, n);
          };
          d.Utils.getIntAt = function (g, h, n) {
            return g.getInt32(h, n);
          };
          d.Utils.getFloatAt = function (g, h, n) {
            return g.getFloat32(h, n);
          };
          d.Utils.getDoubleAt = function (g, h, n) {
            return g.getFloat64(h, n);
          };
          d.Utils.getLongAt = function (g, h, n) {
            var q,
              t = [],
              u = 0;
            for (q = 0; 8 > q; q += 1) t[q] = d.Utils.getByteAt(g, h + q, n);
            for (q = t.length - 1; 0 <= q; q--) u = 256 * u + t[q];
            return u;
          };
          d.Utils.toArrayBuffer = function (g) {
            var h;
            var n = new ArrayBuffer(g.length);
            var q = new Uint8Array(n);
            for (h = 0; h < g.length; h += 1) q[h] = g[h];
            return n;
          };
          d.Utils.isString = function (g) {
            return "string" === typeof g || g instanceof String;
          };
          d.Utils.formatNumber = function (g, h) {
            g = d.Utils.isString(g) ? Number(g) : g;
            g = h ? g.toPrecision(5) : g.toPrecision(7);
            return parseFloat(g);
          };
          d.Utils.makeCRCTable = function () {
            for (var g, h = [], n = 0; 256 > n; n++) {
              g = n;
              for (var q = 0; 8 > q; q++)
                g = g & 1 ? 3988292384 ^ (g >>> 1) : g >>> 1;
              h[n] = g;
            }
            return h;
          };
          d.Utils.crc32 = function (g) {
            for (
              var h =
                  d.Utils.crcTable ||
                  (d.Utils.crcTable = d.Utils.makeCRCTable()),
                n = -1,
                q = 0;
              q < g.byteLength;
              q++
            )
              n = (n >>> 8) ^ h[(n ^ g.getUint8(q)) & 255];
            return (n ^ -1) >>> 0;
          };
          "undefined" !== typeof c && c.exports && (c.exports = d.Utils);
        },
        {},
      ],
    },
    {},
    [17]
  )(17);
});
(function (a) {
  "object" === typeof exports && "undefined" !== typeof module
    ? (module.exports = a())
    : "function" === typeof define && define.amd
    ? define([], a)
    : (("undefined" !== typeof window
        ? window
        : "undefined" !== typeof global
        ? global
        : "undefined" !== typeof self
        ? self
        : this
      ).gifti = a());
})(function () {
  return (function d(b, c, e) {
    function g(q, t) {
      if (!c[q]) {
        if (!b[q]) {
          var u = "function" == typeof require && require;
          if (!t && u) return u(q, !0);
          if (h) return h(q, !0);
          t = Error("Cannot find module '" + q + "'");
          throw ((t.code = "MODULE_NOT_FOUND"), t);
        }
        t = c[q] = { exports: {} };
        b[q][0].call(
          t.exports,
          function (A) {
            var G = b[q][1][A];
            return g(G ? G : A);
          },
          t,
          t.exports,
          d,
          b,
          c,
          e
        );
      }
      return c[q].exports;
    }
    for (
      var h = "function" == typeof require && require, n = 0;
      n < e.length;
      n++
    )
      g(e[n]);
    return g;
  })(
    {
      1: [
        function (b, c, e) {
          b = {
            _keyStr:
              "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
            decodeArrayBuffer: function (d) {
              var g = this._keyStr.indexOf(d.charAt(d.length - 1)),
                h = this._keyStr.indexOf(d.charAt(d.length - 2)),
                n = (d.length / 4) * 3;
              64 == g && n--;
              64 == h && n--;
              g = new ArrayBuffer(n);
              this.decode(d, g, n);
              return g;
            },
            decode: function (d, g, h) {
              var n,
                q = 0;
              g = g ? new Uint8Array(g) : new Uint8Array(h);
              d = d.replace(/[^A-Za-z0-9\+\/=]/g, "");
              for (n = 0; n < h; n += 3) {
                var t = this._keyStr.indexOf(d.charAt(q++));
                var u = this._keyStr.indexOf(d.charAt(q++));
                var A = this._keyStr.indexOf(d.charAt(q++));
                var G = this._keyStr.indexOf(d.charAt(q++));
                t = (t << 2) | (u >> 4);
                u = ((u & 15) << 4) | (A >> 2);
                var O = ((A & 3) << 6) | G;
                g[n] = t;
                64 != A && (g[n + 1] = u);
                64 != G && (g[n + 2] = O);
              }
              return g;
            },
          };
          "undefined" !== typeof c && c.exports && (c.exports = b);
        },
        {},
      ],
      2: [function (b, c, e) {}, {}],
      3: [
        function (b, c, e) {
          (function (d) {
            function g() {
              try {
                var B = new Uint8Array(1);
                B.foo = function () {
                  return 42;
                };
                return (
                  42 === B.foo() &&
                  "function" === typeof B.subarray &&
                  0 === B.subarray(1, 1).byteLength
                );
              } catch (C) {
                return !1;
              }
            }
            function h(B) {
              if (!(this instanceof h))
                return 1 < arguments.length ? new h(B, arguments[1]) : new h(B);
              h.TYPED_ARRAY_SUPPORT ||
                ((this.length = 0), (this.parent = void 0));
              if ("number" === typeof B) {
                var C = t(this, 0 > B ? 0 : u(B) | 0);
                if (!h.TYPED_ARRAY_SUPPORT)
                  for (var L = 0; L < B; L++) C[L] = 0;
                return C;
              }
              if ("string" === typeof B) {
                C = this;
                L = 1 < arguments.length ? arguments[1] : "utf8";
                if ("string" !== typeof L || "" === L) L = "utf8";
                var N = G(B, L) | 0;
                C = t(C, N);
                C.write(B, L);
                return C;
              }
              return n(this, B);
            }
            function n(B, C) {
              if (h.isBuffer(C)) {
                var L = B;
                B = u(C.length) | 0;
                L = t(L, B);
                C.copy(L, 0, 0, B);
                return L;
              }
              if (F(C)) {
                L = B;
                B = u(C.length) | 0;
                L = t(L, B);
                for (var N = 0; N < B; N += 1) L[N] = C[N] & 255;
                return L;
              }
              if (null == C)
                throw new TypeError(
                  "must start with number, buffer, array or string"
                );
              if ("undefined" !== typeof ArrayBuffer) {
                if (C.buffer instanceof ArrayBuffer) return q(B, C);
                if (C instanceof ArrayBuffer)
                  return (
                    (L = B),
                    C.byteLength,
                    h.TYPED_ARRAY_SUPPORT
                      ? ((L = new Uint8Array(C)), (L.__proto__ = h.prototype))
                      : (L = q(L, new Uint8Array(C))),
                    L
                  );
              }
              if (C.length) {
                L = B;
                B = u(C.length) | 0;
                L = t(L, B);
                for (N = 0; N < B; N += 1) L[N] = C[N] & 255;
                return L;
              }
              N = 0;
              "Buffer" === C.type &&
                F(C.data) &&
                ((L = C.data), (N = u(L.length) | 0));
              B = t(B, N);
              for (C = 0; C < N; C += 1) B[C] = L[C] & 255;
              return B;
            }
            function q(B, C) {
              var L = u(C.length) | 0;
              B = t(B, L);
              for (var N = 0; N < L; N += 1) B[N] = C[N] & 255;
              return B;
            }
            function t(B, C) {
              h.TYPED_ARRAY_SUPPORT
                ? ((B = new Uint8Array(C)), (B.__proto__ = h.prototype))
                : (B.length = C);
              0 !== C && C <= h.poolSize >>> 1 && (B.parent = r);
              return B;
            }
            function u(B) {
              if (B >= (h.TYPED_ARRAY_SUPPORT ? 2147483647 : 1073741823))
                throw new RangeError(
                  "Attempt to allocate Buffer larger than maximum size: 0x" +
                    (h.TYPED_ARRAY_SUPPORT ? 2147483647 : 1073741823).toString(
                      16
                    ) +
                    " bytes"
                );
              return B | 0;
            }
            function A(B, C) {
              if (!(this instanceof A)) return new A(B, C);
              B = new h(B, C);
              delete B.parent;
              return B;
            }
            function G(B, C) {
              "string" !== typeof B && (B = "" + B);
              var L = B.length;
              if (0 === L) return 0;
              for (var N = !1; ; )
                switch (C) {
                  case "ascii":
                  case "binary":
                  case "raw":
                  case "raws":
                    return L;
                  case "utf8":
                  case "utf-8":
                    return ka(B).length;
                  case "ucs2":
                  case "ucs-2":
                  case "utf16le":
                  case "utf-16le":
                    return 2 * L;
                  case "hex":
                    return L >>> 1;
                  case "base64":
                    return X(B).length;
                  default:
                    if (N) return ka(B).length;
                    C = ("" + C).toLowerCase();
                    N = !0;
                }
            }
            function O(B, C, L) {
              var N = !1;
              C |= 0;
              L = void 0 === L || Infinity === L ? this.length : L | 0;
              B || (B = "utf8");
              0 > C && (C = 0);
              L > this.length && (L = this.length);
              if (L <= C) return "";
              for (;;)
                switch (B) {
                  case "hex":
                    B = C;
                    C = L;
                    L = this.length;
                    if (!B || 0 > B) B = 0;
                    if (!C || 0 > C || C > L) C = L;
                    N = "";
                    for (L = B; L < C; L++)
                      (B = N),
                        (N = this[L]),
                        (N = 16 > N ? "0" + N.toString(16) : N.toString(16)),
                        (N = B + N);
                    return N;
                  case "utf8":
                  case "utf-8":
                    return H(this, C, L);
                  case "ascii":
                    B = "";
                    for (L = Math.min(this.length, L); C < L; C++)
                      B += String.fromCharCode(this[C] & 127);
                    return B;
                  case "binary":
                    B = "";
                    for (L = Math.min(this.length, L); C < L; C++)
                      B += String.fromCharCode(this[C]);
                    return B;
                  case "base64":
                    return (
                      (C =
                        0 === C && L === this.length
                          ? p.fromByteArray(this)
                          : p.fromByteArray(this.slice(C, L))),
                      C
                    );
                  case "ucs2":
                  case "ucs-2":
                  case "utf16le":
                  case "utf-16le":
                    C = this.slice(C, L);
                    L = "";
                    for (B = 0; B < C.length; B += 2)
                      L += String.fromCharCode(C[B] + 256 * C[B + 1]);
                    return L;
                  default:
                    if (N) throw new TypeError("Unknown encoding: " + B);
                    B = (B + "").toLowerCase();
                    N = !0;
                }
            }
            function H(B, C, L) {
              L = Math.min(B.length, L);
              for (var N = []; C < L; ) {
                var K = B[C],
                  z = null,
                  R = 239 < K ? 4 : 223 < K ? 3 : 191 < K ? 2 : 1;
                if (C + R <= L)
                  switch (R) {
                    case 1:
                      128 > K && (z = K);
                      break;
                    case 2:
                      var ba = B[C + 1];
                      128 === (ba & 192) &&
                        ((K = ((K & 31) << 6) | (ba & 63)), 127 < K && (z = K));
                      break;
                    case 3:
                      ba = B[C + 1];
                      var S = B[C + 2];
                      128 === (ba & 192) &&
                        128 === (S & 192) &&
                        ((K = ((K & 15) << 12) | ((ba & 63) << 6) | (S & 63)),
                        2047 < K && (55296 > K || 57343 < K) && (z = K));
                      break;
                    case 4:
                      ba = B[C + 1];
                      S = B[C + 2];
                      var ma = B[C + 3];
                      128 === (ba & 192) &&
                        128 === (S & 192) &&
                        128 === (ma & 192) &&
                        ((K =
                          ((K & 15) << 18) |
                          ((ba & 63) << 12) |
                          ((S & 63) << 6) |
                          (ma & 63)),
                        65535 < K && 1114112 > K && (z = K));
                  }
                null === z
                  ? ((z = 65533), (R = 1))
                  : 65535 < z &&
                    ((z -= 65536),
                    N.push(((z >>> 10) & 1023) | 55296),
                    (z = 56320 | (z & 1023)));
                N.push(z);
                C += R;
              }
              B = N.length;
              if (B <= y) N = String.fromCharCode.apply(String, N);
              else {
                L = "";
                for (C = 0; C < B; )
                  L += String.fromCharCode.apply(String, N.slice(C, (C += y)));
                N = L;
              }
              return N;
            }
            function P(B, C, L) {
              if (0 !== B % 1 || 0 > B)
                throw new RangeError("offset is not uint");
              if (B + C > L)
                throw new RangeError("Trying to access beyond buffer length");
            }
            function U(B, C, L, N, K, z) {
              if (!h.isBuffer(B))
                throw new TypeError("buffer must be a Buffer instance");
              if (C > K || C < z)
                throw new RangeError("value is out of bounds");
              if (L + N > B.length) throw new RangeError("index out of range");
            }
            function ha(B, C, L, N) {
              0 > C && (C = 65535 + C + 1);
              for (var K = 0, z = Math.min(B.length - L, 2); K < z; K++)
                B[L + K] =
                  (C & (255 << (8 * (N ? K : 1 - K)))) >>>
                  (8 * (N ? K : 1 - K));
            }
            function w(B, C, L, N) {
              0 > C && (C = 4294967295 + C + 1);
              for (var K = 0, z = Math.min(B.length - L, 4); K < z; K++)
                B[L + K] = (C >>> (8 * (N ? K : 3 - K))) & 255;
            }
            function I(B, C, L, N, K, z) {
              if (L + N > B.length) throw new RangeError("index out of range");
              if (0 > L) throw new RangeError("index out of range");
            }
            function aa(B, C, L, N, K) {
              K || I(B, C, L, 4, 3.4028234663852886e38, -3.4028234663852886e38);
              m.write(B, C, L, N, 23, 4);
              return L + 4;
            }
            function T(B, C, L, N, K) {
              K ||
                I(B, C, L, 8, 1.7976931348623157e308, -1.7976931348623157e308);
              m.write(B, C, L, N, 52, 8);
              return L + 8;
            }
            function ka(B, C) {
              C = C || Infinity;
              for (var L, N = B.length, K = null, z = [], R = 0; R < N; R++) {
                L = B.charCodeAt(R);
                if (55295 < L && 57344 > L) {
                  if (!K) {
                    if (56319 < L) {
                      -1 < (C -= 3) && z.push(239, 191, 189);
                      continue;
                    } else if (R + 1 === N) {
                      -1 < (C -= 3) && z.push(239, 191, 189);
                      continue;
                    }
                    K = L;
                    continue;
                  }
                  if (56320 > L) {
                    -1 < (C -= 3) && z.push(239, 191, 189);
                    K = L;
                    continue;
                  }
                  L = (((K - 55296) << 10) | (L - 56320)) + 65536;
                } else K && -1 < (C -= 3) && z.push(239, 191, 189);
                K = null;
                if (128 > L) {
                  if (0 > --C) break;
                  z.push(L);
                } else if (2048 > L) {
                  if (0 > (C -= 2)) break;
                  z.push((L >> 6) | 192, (L & 63) | 128);
                } else if (65536 > L) {
                  if (0 > (C -= 3)) break;
                  z.push(
                    (L >> 12) | 224,
                    ((L >> 6) & 63) | 128,
                    (L & 63) | 128
                  );
                } else if (1114112 > L) {
                  if (0 > (C -= 4)) break;
                  z.push(
                    (L >> 18) | 240,
                    ((L >> 12) & 63) | 128,
                    ((L >> 6) & 63) | 128,
                    (L & 63) | 128
                  );
                } else throw Error("Invalid code point");
              }
              return z;
            }
            function k(B) {
              for (var C = [], L = 0; L < B.length; L++)
                C.push(B.charCodeAt(L) & 255);
              return C;
            }
            function X(B) {
              var C = p,
                L = C.toByteArray;
              B = (B.trim ? B.trim() : B.replace(/^\s+|\s+$/g, "")).replace(
                D,
                ""
              );
              if (2 > B.length) B = "";
              else for (; 0 !== B.length % 4; ) B += "=";
              return L.call(C, B);
            }
            function V(B, C, L, N) {
              for (
                var K = 0;
                K < N && !(K + L >= C.length || K >= B.length);
                K++
              )
                C[K + L] = B[K];
              return K;
            }
            ("use strict");
            var p = b("base64-js"),
              m = b("ieee754"),
              F = b("isarray");
            e.Buffer = h;
            e.SlowBuffer = A;
            e.INSPECT_MAX_BYTES = 50;
            h.poolSize = 8192;
            var r = {};
            h.TYPED_ARRAY_SUPPORT =
              void 0 !== d.TYPED_ARRAY_SUPPORT ? d.TYPED_ARRAY_SUPPORT : g();
            h._augment = function (B) {
              B.__proto__ = h.prototype;
              return B;
            };
            h.TYPED_ARRAY_SUPPORT
              ? ((h.prototype.__proto__ = Uint8Array.prototype),
                (h.__proto__ = Uint8Array),
                "undefined" !== typeof Symbol &&
                  Symbol.species &&
                  h[Symbol.species] === h &&
                  Object.defineProperty(h, Symbol.species, {
                    value: null,
                    configurable: !0,
                  }))
              : ((h.prototype.length = void 0), (h.prototype.parent = void 0));
            h.isBuffer = function (B) {
              return !(null == B || !B._isBuffer);
            };
            h.compare = function (B, C) {
              if (!h.isBuffer(B) || !h.isBuffer(C))
                throw new TypeError("Arguments must be Buffers");
              if (B === C) return 0;
              for (
                var L = B.length, N = C.length, K = 0, z = Math.min(L, N);
                K < z && B[K] === C[K];

              )
                ++K;
              K !== z && ((L = B[K]), (N = C[K]));
              return L < N ? -1 : N < L ? 1 : 0;
            };
            h.isEncoding = function (B) {
              switch (String(B).toLowerCase()) {
                case "hex":
                case "utf8":
                case "utf-8":
                case "ascii":
                case "binary":
                case "base64":
                case "raw":
                case "ucs2":
                case "ucs-2":
                case "utf16le":
                case "utf-16le":
                  return !0;
                default:
                  return !1;
              }
            };
            h.concat = function (B, C) {
              if (!F(B))
                throw new TypeError(
                  "list argument must be an Array of Buffers."
                );
              if (0 === B.length) return new h(0);
              var L;
              if (void 0 === C)
                for (L = C = 0; L < B.length; L++) C += B[L].length;
              C = new h(C);
              var N = 0;
              for (L = 0; L < B.length; L++) {
                var K = B[L];
                K.copy(C, N);
                N += K.length;
              }
              return C;
            };
            h.byteLength = G;
            h.prototype._isBuffer = !0;
            h.prototype.toString = function () {
              var B = this.length | 0;
              return 0 === B
                ? ""
                : 0 === arguments.length
                ? H(this, 0, B)
                : O.apply(this, arguments);
            };
            h.prototype.equals = function (B) {
              if (!h.isBuffer(B))
                throw new TypeError("Argument must be a Buffer");
              return this === B ? !0 : 0 === h.compare(this, B);
            };
            h.prototype.inspect = function () {
              var B = "",
                C = e.INSPECT_MAX_BYTES;
              0 < this.length &&
                ((B = this.toString("hex", 0, C).match(/.{2}/g).join(" ")),
                this.length > C && (B += " ... "));
              return "<Buffer " + B + ">";
            };
            h.prototype.compare = function (B) {
              if (!h.isBuffer(B))
                throw new TypeError("Argument must be a Buffer");
              return this === B ? 0 : h.compare(this, B);
            };
            h.prototype.indexOf = function (B, C) {
              function L(N, K, z) {
                for (var R = -1, ba = 0; z + ba < N.length; ba++)
                  if (N[z + ba] === K[-1 === R ? 0 : ba - R]) {
                    if ((-1 === R && (R = ba), ba - R + 1 === K.length))
                      return z + R;
                  } else R = -1;
                return -1;
              }
              2147483647 < C
                ? (C = 2147483647)
                : -2147483648 > C && (C = -2147483648);
              C >>= 0;
              if (0 === this.length || C >= this.length) return -1;
              0 > C && (C = Math.max(this.length + C, 0));
              if ("string" === typeof B)
                return 0 === B.length
                  ? -1
                  : String.prototype.indexOf.call(this, B, C);
              if (h.isBuffer(B)) return L(this, B, C);
              if ("number" === typeof B)
                return h.TYPED_ARRAY_SUPPORT &&
                  "function" === Uint8Array.prototype.indexOf
                  ? Uint8Array.prototype.indexOf.call(this, B, C)
                  : L(this, [B], C);
              throw new TypeError("val must be string, number or Buffer");
            };
            h.prototype.write = function (B, C, L, N) {
              if (void 0 === C) (N = "utf8"), (L = this.length), (C = 0);
              else if (void 0 === L && "string" === typeof C)
                (N = C), (L = this.length), (C = 0);
              else if (isFinite(C))
                (C |= 0),
                  isFinite(L)
                    ? ((L |= 0), void 0 === N && (N = "utf8"))
                    : ((N = L), (L = void 0));
              else {
                var K = N;
                N = C;
                C = L | 0;
                L = K;
              }
              K = this.length - C;
              if (void 0 === L || L > K) L = K;
              if ((0 < B.length && (0 > L || 0 > C)) || C > this.length)
                throw new RangeError("attempt to write outside buffer bounds");
              N || (N = "utf8");
              for (K = !1; ; )
                switch (N) {
                  case "hex":
                    C = Number(C) || 0;
                    N = this.length - C;
                    L ? ((L = Number(L)), L > N && (L = N)) : (L = N);
                    N = B.length;
                    if (0 !== N % 2) throw Error("Invalid hex string");
                    L > N / 2 && (L = N / 2);
                    for (N = 0; N < L; N++) {
                      K = parseInt(B.substr(2 * N, 2), 16);
                      if (isNaN(K)) throw Error("Invalid hex string");
                      this[C + N] = K;
                    }
                    return N;
                  case "utf8":
                  case "utf-8":
                    return V(ka(B, this.length - C), this, C, L);
                  case "ascii":
                    return V(k(B), this, C, L);
                  case "binary":
                    return V(k(B), this, C, L);
                  case "base64":
                    return V(X(B), this, C, L);
                  case "ucs2":
                  case "ucs-2":
                  case "utf16le":
                  case "utf-16le":
                    N = B;
                    K = this.length - C;
                    for (
                      var z = [], R = 0;
                      R < N.length && !(0 > (K -= 2));
                      R++
                    ) {
                      var ba = N.charCodeAt(R);
                      B = ba >> 8;
                      ba %= 256;
                      z.push(ba);
                      z.push(B);
                    }
                    return V(z, this, C, L);
                  default:
                    if (K) throw new TypeError("Unknown encoding: " + N);
                    N = ("" + N).toLowerCase();
                    K = !0;
                }
            };
            h.prototype.toJSON = function () {
              return {
                type: "Buffer",
                data: Array.prototype.slice.call(this._arr || this, 0),
              };
            };
            var y = 4096;
            h.prototype.slice = function (B, C) {
              var L = this.length;
              B = ~~B;
              C = void 0 === C ? L : ~~C;
              0 > B ? ((B += L), 0 > B && (B = 0)) : B > L && (B = L);
              0 > C ? ((C += L), 0 > C && (C = 0)) : C > L && (C = L);
              C < B && (C = B);
              if (h.TYPED_ARRAY_SUPPORT)
                (C = this.subarray(B, C)), (C.__proto__ = h.prototype);
              else {
                L = C - B;
                C = new h(L, void 0);
                for (var N = 0; N < L; N++) C[N] = this[N + B];
              }
              C.length && (C.parent = this.parent || this);
              return C;
            };
            h.prototype.readUIntLE = function (B, C, L) {
              B |= 0;
              C |= 0;
              L || P(B, C, this.length);
              L = this[B];
              for (var N = 1, K = 0; ++K < C && (N *= 256); )
                L += this[B + K] * N;
              return L;
            };
            h.prototype.readUIntBE = function (B, C, L) {
              B |= 0;
              C |= 0;
              L || P(B, C, this.length);
              L = this[B + --C];
              for (var N = 1; 0 < C && (N *= 256); ) L += this[B + --C] * N;
              return L;
            };
            h.prototype.readUInt8 = function (B, C) {
              C || P(B, 1, this.length);
              return this[B];
            };
            h.prototype.readUInt16LE = function (B, C) {
              C || P(B, 2, this.length);
              return this[B] | (this[B + 1] << 8);
            };
            h.prototype.readUInt16BE = function (B, C) {
              C || P(B, 2, this.length);
              return (this[B] << 8) | this[B + 1];
            };
            h.prototype.readUInt32LE = function (B, C) {
              C || P(B, 4, this.length);
              return (
                (this[B] | (this[B + 1] << 8) | (this[B + 2] << 16)) +
                16777216 * this[B + 3]
              );
            };
            h.prototype.readUInt32BE = function (B, C) {
              C || P(B, 4, this.length);
              return (
                16777216 * this[B] +
                ((this[B + 1] << 16) | (this[B + 2] << 8) | this[B + 3])
              );
            };
            h.prototype.readIntLE = function (B, C, L) {
              B |= 0;
              C |= 0;
              L || P(B, C, this.length);
              L = this[B];
              for (var N = 1, K = 0; ++K < C && (N *= 256); )
                L += this[B + K] * N;
              L >= 128 * N && (L -= Math.pow(2, 8 * C));
              return L;
            };
            h.prototype.readIntBE = function (B, C, L) {
              B |= 0;
              C |= 0;
              L || P(B, C, this.length);
              L = C;
              for (var N = 1, K = this[B + --L]; 0 < L && (N *= 256); )
                K += this[B + --L] * N;
              K >= 128 * N && (K -= Math.pow(2, 8 * C));
              return K;
            };
            h.prototype.readInt8 = function (B, C) {
              C || P(B, 1, this.length);
              return this[B] & 128 ? -1 * (255 - this[B] + 1) : this[B];
            };
            h.prototype.readInt16LE = function (B, C) {
              C || P(B, 2, this.length);
              B = this[B] | (this[B + 1] << 8);
              return B & 32768 ? B | 4294901760 : B;
            };
            h.prototype.readInt16BE = function (B, C) {
              C || P(B, 2, this.length);
              B = this[B + 1] | (this[B] << 8);
              return B & 32768 ? B | 4294901760 : B;
            };
            h.prototype.readInt32LE = function (B, C) {
              C || P(B, 4, this.length);
              return (
                this[B] |
                (this[B + 1] << 8) |
                (this[B + 2] << 16) |
                (this[B + 3] << 24)
              );
            };
            h.prototype.readInt32BE = function (B, C) {
              C || P(B, 4, this.length);
              return (
                (this[B] << 24) |
                (this[B + 1] << 16) |
                (this[B + 2] << 8) |
                this[B + 3]
              );
            };
            h.prototype.readFloatLE = function (B, C) {
              C || P(B, 4, this.length);
              return m.read(this, B, !0, 23, 4);
            };
            h.prototype.readFloatBE = function (B, C) {
              C || P(B, 4, this.length);
              return m.read(this, B, !1, 23, 4);
            };
            h.prototype.readDoubleLE = function (B, C) {
              C || P(B, 8, this.length);
              return m.read(this, B, !0, 52, 8);
            };
            h.prototype.readDoubleBE = function (B, C) {
              C || P(B, 8, this.length);
              return m.read(this, B, !1, 52, 8);
            };
            h.prototype.writeUIntLE = function (B, C, L, N) {
              B = +B;
              C |= 0;
              L |= 0;
              N || U(this, B, C, L, Math.pow(2, 8 * L), 0);
              N = 1;
              var K = 0;
              for (this[C] = B & 255; ++K < L && (N *= 256); )
                this[C + K] = (B / N) & 255;
              return C + L;
            };
            h.prototype.writeUIntBE = function (B, C, L, N) {
              B = +B;
              C |= 0;
              L |= 0;
              N || U(this, B, C, L, Math.pow(2, 8 * L), 0);
              N = L - 1;
              var K = 1;
              for (this[C + N] = B & 255; 0 <= --N && (K *= 256); )
                this[C + N] = (B / K) & 255;
              return C + L;
            };
            h.prototype.writeUInt8 = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 1, 255, 0);
              h.TYPED_ARRAY_SUPPORT || (B = Math.floor(B));
              this[C] = B & 255;
              return C + 1;
            };
            h.prototype.writeUInt16LE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 2, 65535, 0);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C] = B & 255), (this[C + 1] = B >>> 8))
                : ha(this, B, C, !0);
              return C + 2;
            };
            h.prototype.writeUInt16BE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 2, 65535, 0);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C] = B >>> 8), (this[C + 1] = B & 255))
                : ha(this, B, C, !1);
              return C + 2;
            };
            h.prototype.writeUInt32LE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 4, 4294967295, 0);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C + 3] = B >>> 24),
                  (this[C + 2] = B >>> 16),
                  (this[C + 1] = B >>> 8),
                  (this[C] = B & 255))
                : w(this, B, C, !0);
              return C + 4;
            };
            h.prototype.writeUInt32BE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 4, 4294967295, 0);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C] = B >>> 24),
                  (this[C + 1] = B >>> 16),
                  (this[C + 2] = B >>> 8),
                  (this[C + 3] = B & 255))
                : w(this, B, C, !1);
              return C + 4;
            };
            h.prototype.writeIntLE = function (B, C, L, N) {
              B = +B;
              C |= 0;
              N || ((N = Math.pow(2, 8 * L - 1)), U(this, B, C, L, N - 1, -N));
              N = 0;
              var K = 1,
                z = 0 > B ? 1 : 0;
              for (this[C] = B & 255; ++N < L && (K *= 256); )
                this[C + N] = (((B / K) >> 0) - z) & 255;
              return C + L;
            };
            h.prototype.writeIntBE = function (B, C, L, N) {
              B = +B;
              C |= 0;
              N || ((N = Math.pow(2, 8 * L - 1)), U(this, B, C, L, N - 1, -N));
              N = L - 1;
              var K = 1,
                z = 0 > B ? 1 : 0;
              for (this[C + N] = B & 255; 0 <= --N && (K *= 256); )
                this[C + N] = (((B / K) >> 0) - z) & 255;
              return C + L;
            };
            h.prototype.writeInt8 = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 1, 127, -128);
              h.TYPED_ARRAY_SUPPORT || (B = Math.floor(B));
              0 > B && (B = 255 + B + 1);
              this[C] = B & 255;
              return C + 1;
            };
            h.prototype.writeInt16LE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 2, 32767, -32768);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C] = B & 255), (this[C + 1] = B >>> 8))
                : ha(this, B, C, !0);
              return C + 2;
            };
            h.prototype.writeInt16BE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 2, 32767, -32768);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C] = B >>> 8), (this[C + 1] = B & 255))
                : ha(this, B, C, !1);
              return C + 2;
            };
            h.prototype.writeInt32LE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 4, 2147483647, -2147483648);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C] = B & 255),
                  (this[C + 1] = B >>> 8),
                  (this[C + 2] = B >>> 16),
                  (this[C + 3] = B >>> 24))
                : w(this, B, C, !0);
              return C + 4;
            };
            h.prototype.writeInt32BE = function (B, C, L) {
              B = +B;
              C |= 0;
              L || U(this, B, C, 4, 2147483647, -2147483648);
              0 > B && (B = 4294967295 + B + 1);
              h.TYPED_ARRAY_SUPPORT
                ? ((this[C] = B >>> 24),
                  (this[C + 1] = B >>> 16),
                  (this[C + 2] = B >>> 8),
                  (this[C + 3] = B & 255))
                : w(this, B, C, !1);
              return C + 4;
            };
            h.prototype.writeFloatLE = function (B, C, L) {
              return aa(this, B, C, !0, L);
            };
            h.prototype.writeFloatBE = function (B, C, L) {
              return aa(this, B, C, !1, L);
            };
            h.prototype.writeDoubleLE = function (B, C, L) {
              return T(this, B, C, !0, L);
            };
            h.prototype.writeDoubleBE = function (B, C, L) {
              return T(this, B, C, !1, L);
            };
            h.prototype.copy = function (B, C, L, N) {
              L || (L = 0);
              N || 0 === N || (N = this.length);
              C >= B.length && (C = B.length);
              C || (C = 0);
              0 < N && N < L && (N = L);
              if (N === L || 0 === B.length || 0 === this.length) return 0;
              if (0 > C) throw new RangeError("targetStart out of bounds");
              if (0 > L || L >= this.length)
                throw new RangeError("sourceStart out of bounds");
              if (0 > N) throw new RangeError("sourceEnd out of bounds");
              N > this.length && (N = this.length);
              B.length - C < N - L && (N = B.length - C + L);
              var K = N - L;
              if (this === B && L < C && C < N)
                for (N = K - 1; 0 <= N; N--) B[N + C] = this[N + L];
              else if (1e3 > K || !h.TYPED_ARRAY_SUPPORT)
                for (N = 0; N < K; N++) B[N + C] = this[N + L];
              else Uint8Array.prototype.set.call(B, this.subarray(L, L + K), C);
              return K;
            };
            h.prototype.fill = function (B, C, L) {
              B || (B = 0);
              C || (C = 0);
              L || (L = this.length);
              if (L < C) throw new RangeError("end < start");
              if (L !== C && 0 !== this.length) {
                if (0 > C || C >= this.length)
                  throw new RangeError("start out of bounds");
                if (0 > L || L > this.length)
                  throw new RangeError("end out of bounds");
                if ("number" === typeof B) for (; C < L; C++) this[C] = B;
                else {
                  B = ka(B.toString());
                  for (var N = B.length; C < L; C++) this[C] = B[C % N];
                }
                return this;
              }
            };
            var D = /[^+\/0-9A-Za-z-_]/g;
          }.call(
            this,
            "undefined" !== typeof global
              ? global
              : "undefined" !== typeof self
              ? self
              : "undefined" !== typeof window
              ? window
              : {}
          ));
        },
        { "base64-js": 4, ieee754: 5, isarray: 6 },
      ],
      4: [
        function (b, c, e) {
          (function (d) {
            function g(u) {
              u = q[u.charCodeAt(0)];
              return void 0 !== u ? u : -1;
            }
            var h,
              n = [];
            for (h = 0; 64 > h; h++)
              n[h] =
                "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[
                  h
                ];
            var q = [];
            for (h = 0; 64 > h; ++h)
              q[
                "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(
                  h
                )
              ] = h;
            q[45] = 62;
            q[95] = 63;
            var t = "undefined" !== typeof Uint8Array ? Uint8Array : Array;
            d.toByteArray = function (u) {
              function A(w) {
                H[U++] = w;
              }
              if (0 < u.length % 4)
                throw Error("Invalid string. Length must be a multiple of 4");
              var G = u.length;
              var O =
                "=" === u.charAt(G - 2) ? 2 : "=" === u.charAt(G - 1) ? 1 : 0;
              var H = new t((3 * u.length) / 4 - O);
              var P = 0 < O ? u.length - 4 : u.length;
              var U = 0;
              for (G = 0; G < P; G += 4) {
                var ha =
                  (g(u.charAt(G)) << 18) |
                  (g(u.charAt(G + 1)) << 12) |
                  (g(u.charAt(G + 2)) << 6) |
                  g(u.charAt(G + 3));
                A((ha & 16711680) >> 16);
                A((ha & 65280) >> 8);
                A(ha & 255);
              }
              2 === O
                ? ((ha = (g(u.charAt(G)) << 2) | (g(u.charAt(G + 1)) >> 4)),
                  A(ha & 255))
                : 1 === O &&
                  ((ha =
                    (g(u.charAt(G)) << 10) |
                    (g(u.charAt(G + 1)) << 4) |
                    (g(u.charAt(G + 2)) >> 2)),
                  A((ha >> 8) & 255),
                  A(ha & 255));
              return H;
            };
            d.fromByteArray = function (u) {
              var A = u.length % 3,
                G = "",
                O = [],
                H;
              var P = 0;
              for (H = u.length - A; P < H; P += 16383) {
                for (
                  var U = O,
                    ha = U.push,
                    w,
                    I = u,
                    aa = P + 16383 > H ? H : P + 16383,
                    T = [],
                    ka = P;
                  ka < aa;
                  ka += 3
                )
                  (w = (I[ka] << 16) + (I[ka + 1] << 8) + I[ka + 2]),
                    T.push(
                      n[(w >> 18) & 63] +
                        n[(w >> 12) & 63] +
                        n[(w >> 6) & 63] +
                        n[w & 63]
                    );
                w = T.join("");
                ha.call(U, w);
              }
              switch (A) {
                case 1:
                  u = u[u.length - 1];
                  G += n[u >> 2];
                  G += n[(u << 4) & 63];
                  G += "==";
                  break;
                case 2:
                  (u = (u[u.length - 2] << 8) + u[u.length - 1]),
                    (G += n[u >> 10]),
                    (G += n[(u >> 4) & 63]),
                    (G += n[(u << 2) & 63]),
                    (G += "=");
              }
              O.push(G);
              return O.join("");
            };
          })("undefined" === typeof e ? (this.base64js = {}) : e);
        },
        {},
      ],
      5: [
        function (b, c, e) {
          e.read = function (d, g, h, n, q) {
            var t = 8 * q - n - 1;
            var u = (1 << t) - 1,
              A = u >> 1,
              G = -7;
            q = h ? q - 1 : 0;
            var O = h ? -1 : 1,
              H = d[g + q];
            q += O;
            h = H & ((1 << -G) - 1);
            H >>= -G;
            for (G += t; 0 < G; h = 256 * h + d[g + q], q += O, G -= 8);
            t = h & ((1 << -G) - 1);
            h >>= -G;
            for (G += n; 0 < G; t = 256 * t + d[g + q], q += O, G -= 8);
            if (0 === h) h = 1 - A;
            else {
              if (h === u) return t ? NaN : Infinity * (H ? -1 : 1);
              t += Math.pow(2, n);
              h -= A;
            }
            return (H ? -1 : 1) * t * Math.pow(2, h - n);
          };
          e.write = function (d, g, h, n, q, t) {
            var u,
              A = 8 * t - q - 1,
              G = (1 << A) - 1,
              O = G >> 1,
              H = 23 === q ? Math.pow(2, -24) - Math.pow(2, -77) : 0;
            t = n ? 0 : t - 1;
            var P = n ? 1 : -1,
              U = 0 > g || (0 === g && 0 > 1 / g) ? 1 : 0;
            g = Math.abs(g);
            isNaN(g) || Infinity === g
              ? ((g = isNaN(g) ? 1 : 0), (n = G))
              : ((n = Math.floor(Math.log(g) / Math.LN2)),
                1 > g * (u = Math.pow(2, -n)) && (n--, (u *= 2)),
                (g = 1 <= n + O ? g + H / u : g + H * Math.pow(2, 1 - O)),
                2 <= g * u && (n++, (u /= 2)),
                n + O >= G
                  ? ((g = 0), (n = G))
                  : 1 <= n + O
                  ? ((g = (g * u - 1) * Math.pow(2, q)), (n += O))
                  : ((g = g * Math.pow(2, O - 1) * Math.pow(2, q)), (n = 0)));
            for (; 8 <= q; d[h + t] = g & 255, t += P, g /= 256, q -= 8);
            n = (n << q) | g;
            for (A += q; 0 < A; d[h + t] = n & 255, t += P, n /= 256, A -= 8);
            d[h + t - P] |= 128 * U;
          };
        },
        {},
      ],
      6: [
        function (b, c, e) {
          var d = {}.toString;
          c.exports =
            Array.isArray ||
            function (g) {
              return "[object Array]" == d.call(g);
            };
        },
        {},
      ],
      7: [
        function (b, c, e) {
          function d() {
            this._events = this._events || {};
            this._maxListeners = this._maxListeners || void 0;
          }
          function g(n) {
            return "function" === typeof n;
          }
          function h(n) {
            return "object" === typeof n && null !== n;
          }
          c.exports = d;
          d.EventEmitter = d;
          d.prototype._events = void 0;
          d.prototype._maxListeners = void 0;
          d.defaultMaxListeners = 10;
          d.prototype.setMaxListeners = function (n) {
            if ("number" !== typeof n || 0 > n || isNaN(n))
              throw TypeError("n must be a positive number");
            this._maxListeners = n;
            return this;
          };
          d.prototype.emit = function (n) {
            var q;
            this._events || (this._events = {});
            if (
              "error" === n &&
              (!this._events.error ||
                (h(this._events.error) && !this._events.error.length))
            ) {
              var t = arguments[1];
              if (t instanceof Error) throw t;
              throw TypeError('Uncaught, unspecified "error" event.');
            }
            var u = this._events[n];
            if (void 0 === u) return !1;
            if (g(u))
              switch (arguments.length) {
                case 1:
                  u.call(this);
                  break;
                case 2:
                  u.call(this, arguments[1]);
                  break;
                case 3:
                  u.call(this, arguments[1], arguments[2]);
                  break;
                default:
                  (t = Array.prototype.slice.call(arguments, 1)),
                    u.apply(this, t);
              }
            else if (h(u)) {
              t = Array.prototype.slice.call(arguments, 1);
              var A = u.slice();
              u = A.length;
              for (q = 0; q < u; q++) A[q].apply(this, t);
            }
            return !0;
          };
          d.prototype.addListener = function (n, q) {
            if (!g(q)) throw TypeError("listener must be a function");
            this._events || (this._events = {});
            this._events.newListener &&
              this.emit("newListener", n, g(q.listener) ? q.listener : q);
            this._events[n]
              ? h(this._events[n])
                ? this._events[n].push(q)
                : (this._events[n] = [this._events[n], q])
              : (this._events[n] = q);
            h(this._events[n]) &&
              !this._events[n].warned &&
              (q =
                void 0 !== this._maxListeners
                  ? this._maxListeners
                  : d.defaultMaxListeners) &&
              0 < q &&
              this._events[n].length > q &&
              ((this._events[n].warned = !0),
              console.error(
                "(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
                this._events[n].length
              ),
              "function" === typeof console.trace && console.trace());
            return this;
          };
          d.prototype.on = d.prototype.addListener;
          d.prototype.once = function (n, q) {
            function t() {
              this.removeListener(n, t);
              u || ((u = !0), q.apply(this, arguments));
            }
            if (!g(q)) throw TypeError("listener must be a function");
            var u = !1;
            t.listener = q;
            this.on(n, t);
            return this;
          };
          d.prototype.removeListener = function (n, q) {
            if (!g(q)) throw TypeError("listener must be a function");
            if (!this._events || !this._events[n]) return this;
            var t = this._events[n];
            var u = t.length;
            var A = -1;
            if (t === q || (g(t.listener) && t.listener === q))
              delete this._events[n],
                this._events.removeListener &&
                  this.emit("removeListener", n, q);
            else if (h(t)) {
              for (; 0 < u--; )
                if (t[u] === q || (t[u].listener && t[u].listener === q)) {
                  A = u;
                  break;
                }
              if (0 > A) return this;
              1 === t.length
                ? ((t.length = 0), delete this._events[n])
                : t.splice(A, 1);
              this._events.removeListener && this.emit("removeListener", n, q);
            }
            return this;
          };
          d.prototype.removeAllListeners = function (n) {
            if (!this._events) return this;
            if (!this._events.removeListener)
              return (
                0 === arguments.length
                  ? (this._events = {})
                  : this._events[n] && delete this._events[n],
                this
              );
            if (0 === arguments.length) {
              for (q in this._events)
                "removeListener" !== q && this.removeAllListeners(q);
              this.removeAllListeners("removeListener");
              this._events = {};
              return this;
            }
            var q = this._events[n];
            if (g(q)) this.removeListener(n, q);
            else if (q)
              for (; q.length; ) this.removeListener(n, q[q.length - 1]);
            delete this._events[n];
            return this;
          };
          d.prototype.listeners = function (n) {
            return this._events && this._events[n]
              ? g(this._events[n])
                ? [this._events[n]]
                : this._events[n].slice()
              : [];
          };
          d.prototype.listenerCount = function (n) {
            if (this._events) {
              n = this._events[n];
              if (g(n)) return 1;
              if (n) return n.length;
            }
            return 0;
          };
          d.listenerCount = function (n, q) {
            return n.listenerCount(q);
          };
        },
        {},
      ],
      8: [
        function (b, c, e) {
          c.exports =
            "function" === typeof Object.create
              ? function (d, g) {
                  d.super_ = g;
                  d.prototype = Object.create(g.prototype, {
                    constructor: {
                      value: d,
                      enumerable: !1,
                      writable: !0,
                      configurable: !0,
                    },
                  });
                }
              : function (d, g) {
                  d.super_ = g;
                  var h = function () {};
                  h.prototype = g.prototype;
                  d.prototype = new h();
                  d.prototype.constructor = d;
                };
        },
        {},
      ],
      9: [
        function (b, c, e) {
          c.exports = function (d) {
            return !(
              null == d ||
              !(
                d._isBuffer ||
                (d.constructor &&
                  "function" === typeof d.constructor.isBuffer &&
                  d.constructor.isBuffer(d))
              )
            );
          };
        },
        {},
      ],
      10: [
        function (b, c, e) {
          c.exports =
            Array.isArray ||
            function (d) {
              return "[object Array]" == Object.prototype.toString.call(d);
            };
        },
        {},
      ],
      11: [
        function (b, c, e) {
          function d() {
            t = !1;
            u.length ? (q = u.concat(q)) : (A = -1);
            q.length && g();
          }
          function g() {
            if (!t) {
              var G = setTimeout(d);
              t = !0;
              for (var O = q.length; O; ) {
                u = q;
                for (q = []; ++A < O; ) u && u[A].run();
                A = -1;
                O = q.length;
              }
              u = null;
              t = !1;
              clearTimeout(G);
            }
          }
          function h(G, O) {
            this.fun = G;
            this.array = O;
          }
          function n() {}
          b = c.exports = {};
          var q = [],
            t = !1,
            u,
            A = -1;
          b.nextTick = function (G) {
            var O = Array(arguments.length - 1);
            if (1 < arguments.length)
              for (var H = 1; H < arguments.length; H++)
                O[H - 1] = arguments[H];
            q.push(new h(G, O));
            1 !== q.length || t || setTimeout(g, 0);
          };
          h.prototype.run = function () {
            this.fun.apply(null, this.array);
          };
          b.title = "browser";
          b.browser = !0;
          b.env = {};
          b.argv = [];
          b.version = "";
          b.versions = {};
          b.on = n;
          b.addListener = n;
          b.once = n;
          b.off = n;
          b.removeListener = n;
          b.removeAllListeners = n;
          b.emit = n;
          b.binding = function (G) {
            throw Error("process.binding is not supported");
          };
          b.cwd = function () {
            return "/";
          };
          b.chdir = function (G) {
            throw Error("process.chdir is not supported");
          };
          b.umask = function () {
            return 0;
          };
        },
        {},
      ],
      12: [
        function (b, c, e) {
          c.exports = b("./lib/_stream_duplex.js");
        },
        { "./lib/_stream_duplex.js": 13 },
      ],
      13: [
        function (b, c, e) {
          function d(u) {
            if (!(this instanceof d)) return new d(u);
            q.call(this, u);
            t.call(this, u);
            u && !1 === u.readable && (this.readable = !1);
            u && !1 === u.writable && (this.writable = !1);
            this.allowHalfOpen = !0;
            u && !1 === u.allowHalfOpen && (this.allowHalfOpen = !1);
            this.once("end", g);
          }
          function g() {
            this.allowHalfOpen || this._writableState.ended || n(h, this);
          }
          function h(u) {
            u.end();
          }
          e =
            Object.keys ||
            function (u) {
              var A = [],
                G;
              for (G in u) A.push(G);
              return A;
            };
          c.exports = d;
          var n = b("process-nextick-args");
          c = b("core-util-is");
          c.inherits = b("inherits");
          var q = b("./_stream_readable"),
            t = b("./_stream_writable");
          c.inherits(d, q);
          b = e(t.prototype);
          for (c = 0; c < b.length; c++)
            (e = b[c]), d.prototype[e] || (d.prototype[e] = t.prototype[e]);
        },
        {
          "./_stream_readable": 15,
          "./_stream_writable": 17,
          "core-util-is": 18,
          inherits: 8,
          "process-nextick-args": 19,
        },
      ],
      14: [
        function (b, c, e) {
          function d(h) {
            if (!(this instanceof d)) return new d(h);
            g.call(this, h);
          }
          c.exports = d;
          var g = b("./_stream_transform");
          c = b("core-util-is");
          c.inherits = b("inherits");
          c.inherits(d, g);
          d.prototype._transform = function (h, n, q) {
            q(null, h);
          };
        },
        { "./_stream_transform": 16, "core-util-is": 18, inherits: 8 },
      ],
      15: [
        function (b, c, e) {
          (function (d) {
            function g(r, y) {
              F = F || b("./_stream_duplex");
              r = r || {};
              this.objectMode = !!r.objectMode;
              y instanceof F &&
                (this.objectMode = this.objectMode || !!r.readableObjectMode);
              y = r.highWaterMark;
              var D = this.objectMode ? 16 : 16384;
              this.highWaterMark = y || 0 === y ? y : D;
              this.highWaterMark = ~~this.highWaterMark;
              this.buffer = [];
              this.length = 0;
              this.pipes = null;
              this.pipesCount = 0;
              this.flowing = null;
              this.reading = this.endEmitted = this.ended = !1;
              this.sync = !0;
              this.readableListening =
                this.emittedReadable =
                this.needReadable =
                  !1;
              this.defaultEncoding = r.defaultEncoding || "utf8";
              this.ranOut = !1;
              this.awaitDrain = 0;
              this.readingMore = !1;
              this.encoding = this.decoder = null;
              r.encoding &&
                (m || (m = b("string_decoder/").StringDecoder),
                (this.decoder = new m(r.encoding)),
                (this.encoding = r.encoding));
            }
            function h(r) {
              F = F || b("./_stream_duplex");
              if (!(this instanceof h)) return new h(r);
              this._readableState = new g(r, this);
              this.readable = !0;
              r && "function" === typeof r.read && (this._read = r.read);
              k.call(this);
            }
            function n(r, y, D, B, C) {
              var L = D;
              var N = null;
              ka.isBuffer(L) ||
                "string" === typeof L ||
                null === L ||
                void 0 === L ||
                y.objectMode ||
                (N = new TypeError("Invalid non-string/buffer chunk"));
              (L = N)
                ? r.emit("error", L)
                : null === D
                ? ((y.reading = !1),
                  y.ended ||
                    (y.decoder &&
                      (D = y.decoder.end()) &&
                      D.length &&
                      (y.buffer.push(D),
                      (y.length += y.objectMode ? 1 : D.length)),
                    (y.ended = !0),
                    t(r)))
                : y.objectMode || (D && 0 < D.length)
                ? y.ended && !C
                  ? ((D = Error("stream.push() after EOF")), r.emit("error", D))
                  : y.endEmitted && C
                  ? ((D = Error("stream.unshift() after end event")),
                    r.emit("error", D))
                  : (!y.decoder || C || B || (D = y.decoder.write(D)),
                    C || (y.reading = !1),
                    y.flowing && 0 === y.length && !y.sync
                      ? (r.emit("data", D), r.read(0))
                      : ((y.length += y.objectMode ? 1 : D.length),
                        C ? y.buffer.unshift(D) : y.buffer.push(D),
                        y.needReadable && t(r)),
                    y.readingMore || ((y.readingMore = !0), aa(A, r, y)))
                : C || (y.reading = !1);
              return (
                !y.ended &&
                (y.needReadable || y.length < y.highWaterMark || 0 === y.length)
              );
            }
            function q(r, y) {
              if (0 === y.length && y.ended) return 0;
              if (y.objectMode) return 0 === r ? 0 : 1;
              if (null === r || isNaN(r))
                return y.flowing && y.buffer.length
                  ? y.buffer[0].length
                  : y.length;
              if (0 >= r) return 0;
              if (r > y.highWaterMark) {
                var D = r;
                8388608 <= D
                  ? (D = 8388608)
                  : (D--,
                    (D |= D >>> 1),
                    (D |= D >>> 2),
                    (D |= D >>> 4),
                    (D |= D >>> 8),
                    (D |= D >>> 16),
                    D++);
                y.highWaterMark = D;
              }
              if (r > y.length) {
                if (y.ended) return y.length;
                y.needReadable = !0;
                return 0;
              }
              return r;
            }
            function t(r) {
              var y = r._readableState;
              y.needReadable = !1;
              y.emittedReadable ||
                (p("emitReadable", y.flowing),
                (y.emittedReadable = !0),
                y.sync ? aa(u, r) : u(r));
            }
            function u(r) {
              p("emit readable");
              r.emit("readable");
              P(r);
            }
            function A(r, y) {
              for (
                var D = y.length;
                !y.reading &&
                !y.flowing &&
                !y.ended &&
                y.length < y.highWaterMark &&
                (p("maybeReadMore read 0"), r.read(0), D !== y.length);

              )
                D = y.length;
              y.readingMore = !1;
            }
            function G(r) {
              return function () {
                var y = r._readableState;
                p("pipeOnDrain", y.awaitDrain);
                y.awaitDrain && y.awaitDrain--;
                0 === y.awaitDrain &&
                  r.listeners("data").length &&
                  ((y.flowing = !0), P(r));
              };
            }
            function O(r) {
              p("readable nexttick read 0");
              r.read(0);
            }
            function H(r, y) {
              y.reading || (p("resume read 0"), r.read(0));
              y.resumeScheduled = !1;
              r.emit("resume");
              P(r);
              y.flowing && !y.reading && r.read(0);
            }
            function P(r) {
              var y = r._readableState;
              p("flow", y.flowing);
              if (y.flowing) {
                do var D = r.read();
                while (null !== D && y.flowing);
              }
            }
            function U(r, y) {
              var D = y.buffer,
                B = y.length,
                C = !!y.decoder;
              y = !!y.objectMode;
              if (0 === D.length) return null;
              if (0 === B) B = null;
              else if (y) B = D.shift();
              else if (!r || r >= B)
                (B = C ? D.join("") : 1 === D.length ? D[0] : ka.concat(D, B)),
                  (D.length = 0);
              else if (r < D[0].length)
                (y = D[0]), (B = y.slice(0, r)), (D[0] = y.slice(r));
              else if (r === D[0].length) B = D.shift();
              else {
                B = C ? "" : new ka(r);
                for (var L = 0, N = 0, K = D.length; N < K && L < r; N++) {
                  y = D[0];
                  var z = Math.min(r - L, y.length);
                  C ? (B += y.slice(0, z)) : y.copy(B, L, 0, z);
                  z < y.length ? (D[0] = y.slice(z)) : D.shift();
                  L += z;
                }
              }
              return B;
            }
            function ha(r) {
              var y = r._readableState;
              if (0 < y.length)
                throw Error("endReadable called on non-empty stream");
              y.endEmitted || ((y.ended = !0), aa(w, y, r));
            }
            function w(r, y) {
              r.endEmitted ||
                0 !== r.length ||
                ((r.endEmitted = !0), (y.readable = !1), y.emit("end"));
            }
            function I(r, y) {
              for (var D = 0, B = r.length; D < B; D++) y(r[D], D);
            }
            c.exports = h;
            var aa = b("process-nextick-args"),
              T = b("isarray"),
              ka = b("buffer").Buffer;
            h.ReadableState = g;
            b("events");
            try {
              var k = b("stream");
            } catch (r) {
            } finally {
              k || (k = b("events").EventEmitter);
            }
            ka = b("buffer").Buffer;
            var X = b("core-util-is");
            X.inherits = b("inherits");
            var V = b("util");
            var p = V && V.debuglog ? V.debuglog("stream") : function () {};
            var m;
            X.inherits(h, k);
            var F;
            h.prototype.push = function (r, y) {
              var D = this._readableState;
              D.objectMode ||
                "string" !== typeof r ||
                ((y = y || D.defaultEncoding),
                y !== D.encoding && ((r = new ka(r, y)), (y = "")));
              return n(this, D, r, y, !1);
            };
            h.prototype.unshift = function (r) {
              return n(this, this._readableState, r, "", !0);
            };
            h.prototype.isPaused = function () {
              return !1 === this._readableState.flowing;
            };
            h.prototype.setEncoding = function (r) {
              m || (m = b("string_decoder/").StringDecoder);
              this._readableState.decoder = new m(r);
              this._readableState.encoding = r;
              return this;
            };
            h.prototype.read = function (r) {
              p("read", r);
              var y = this._readableState,
                D = r;
              if ("number" !== typeof r || 0 < r) y.emittedReadable = !1;
              if (
                0 === r &&
                y.needReadable &&
                (y.length >= y.highWaterMark || y.ended)
              )
                return (
                  p("read: emitReadable", y.length, y.ended),
                  0 === y.length && y.ended ? ha(this) : t(this),
                  null
                );
              r = q(r, y);
              if (0 === r && y.ended) return 0 === y.length && ha(this), null;
              var B = y.needReadable;
              p("need readable", B);
              if (0 === y.length || y.length - r < y.highWaterMark)
                (B = !0), p("length less than watermark", B);
              if (y.ended || y.reading) (B = !1), p("reading or ended", B);
              B &&
                (p("do read"),
                (y.reading = !0),
                (y.sync = !0),
                0 === y.length && (y.needReadable = !0),
                this._read(y.highWaterMark),
                (y.sync = !1));
              B && !y.reading && (r = q(D, y));
              B = 0 < r ? U(r, y) : null;
              null === B && ((y.needReadable = !0), (r = 0));
              y.length -= r;
              0 !== y.length || y.ended || (y.needReadable = !0);
              D !== r && y.ended && 0 === y.length && ha(this);
              null !== B && this.emit("data", B);
              return B;
            };
            h.prototype._read = function (r) {
              this.emit("error", Error("not implemented"));
            };
            h.prototype.pipe = function (r, y) {
              function D(ea) {
                p("onunpipe");
                ea === ba && C();
              }
              function B() {
                p("onend");
                r.end();
              }
              function C() {
                p("cleanup");
                r.removeListener("close", K);
                r.removeListener("finish", z);
                r.removeListener("drain", ma);
                r.removeListener("error", N);
                r.removeListener("unpipe", D);
                ba.removeListener("end", B);
                ba.removeListener("end", C);
                ba.removeListener("data", L);
                Q = !0;
                !S.awaitDrain ||
                  (r._writableState && !r._writableState.needDrain) ||
                  ma();
              }
              function L(ea) {
                p("ondata");
                !1 === r.write(ea) &&
                  (1 !== S.pipesCount ||
                    S.pipes[0] !== r ||
                    1 !== ba.listenerCount("data") ||
                    Q ||
                    (p(
                      "false write response, pause",
                      ba._readableState.awaitDrain
                    ),
                    ba._readableState.awaitDrain++),
                  ba.pause());
              }
              function N(ea) {
                p("onerror", ea);
                R();
                r.removeListener("error", N);
                0 === r.listeners("error").length && r.emit("error", ea);
              }
              function K() {
                r.removeListener("finish", z);
                R();
              }
              function z() {
                p("onfinish");
                r.removeListener("close", K);
                R();
              }
              function R() {
                p("unpipe");
                ba.unpipe(r);
              }
              var ba = this,
                S = this._readableState;
              switch (S.pipesCount) {
                case 0:
                  S.pipes = r;
                  break;
                case 1:
                  S.pipes = [S.pipes, r];
                  break;
                default:
                  S.pipes.push(r);
              }
              S.pipesCount += 1;
              p("pipe count=%d opts=%j", S.pipesCount, y);
              y =
                (y && !1 === y.end) || r === d.stdout || r === d.stderr ? C : B;
              if (S.endEmitted) aa(y);
              else ba.once("end", y);
              r.on("unpipe", D);
              var ma = G(ba);
              r.on("drain", ma);
              var Q = !1;
              ba.on("data", L);
              if (r._events && r._events.error)
                T(r._events.error)
                  ? r._events.error.unshift(N)
                  : (r._events.error = [N, r._events.error]);
              else r.on("error", N);
              r.once("close", K);
              r.once("finish", z);
              r.emit("pipe", ba);
              S.flowing || (p("pipe resume"), ba.resume());
              return r;
            };
            h.prototype.unpipe = function (r) {
              var y = this._readableState;
              if (0 === y.pipesCount) return this;
              if (1 === y.pipesCount) {
                if (r && r !== y.pipes) return this;
                r || (r = y.pipes);
                y.pipes = null;
                y.pipesCount = 0;
                y.flowing = !1;
                r && r.emit("unpipe", this);
                return this;
              }
              if (!r) {
                r = y.pipes;
                var D = y.pipesCount;
                y.pipes = null;
                y.pipesCount = 0;
                y.flowing = !1;
                for (var B = 0; B < D; B++) r[B].emit("unpipe", this);
                return this;
              }
              a: {
                B = y.pipes;
                D = 0;
                for (var C = B.length; D < C; D++)
                  if (B[D] === r) {
                    B = D;
                    break a;
                  }
                B = -1;
              }
              if (-1 === B) return this;
              y.pipes.splice(B, 1);
              --y.pipesCount;
              1 === y.pipesCount && (y.pipes = y.pipes[0]);
              r.emit("unpipe", this);
              return this;
            };
            h.prototype.on = function (r, y) {
              y = k.prototype.on.call(this, r, y);
              "data" === r &&
                !1 !== this._readableState.flowing &&
                this.resume();
              "readable" === r &&
                this.readable &&
                ((r = this._readableState),
                r.readableListening ||
                  ((r.readableListening = !0),
                  (r.emittedReadable = !1),
                  (r.needReadable = !0),
                  r.reading ? r.length && t(this, r) : aa(O, this)));
              return y;
            };
            h.prototype.addListener = h.prototype.on;
            h.prototype.resume = function () {
              var r = this._readableState;
              r.flowing ||
                (p("resume"),
                (r.flowing = !0),
                r.resumeScheduled ||
                  ((r.resumeScheduled = !0), aa(H, this, r)));
              return this;
            };
            h.prototype.pause = function () {
              p("call pause flowing=%j", this._readableState.flowing);
              !1 !== this._readableState.flowing &&
                (p("pause"),
                (this._readableState.flowing = !1),
                this.emit("pause"));
              return this;
            };
            h.prototype.wrap = function (r) {
              var y = this._readableState,
                D = !1,
                B = this;
              r.on("end", function () {
                p("wrapped end");
                if (y.decoder && !y.ended) {
                  var L = y.decoder.end();
                  L && L.length && B.push(L);
                }
                B.push(null);
              });
              r.on("data", function (L) {
                p("wrapped data");
                y.decoder && (L = y.decoder.write(L));
                (y.objectMode && (null === L || void 0 === L)) ||
                  !(y.objectMode || (L && L.length)) ||
                  B.push(L) ||
                  ((D = !0), r.pause());
              });
              for (var C in r)
                void 0 === this[C] &&
                  "function" === typeof r[C] &&
                  (this[C] = (function (L) {
                    return function () {
                      return r[L].apply(r, arguments);
                    };
                  })(C));
              I(["error", "close", "destroy", "pause", "resume"], function (L) {
                r.on(L, B.emit.bind(B, L));
              });
              B._read = function (L) {
                p("wrapped _read", L);
                D && ((D = !1), r.resume());
              };
              return B;
            };
            h._fromList = U;
          }.call(this, b("_process")));
        },
        {
          "./_stream_duplex": 13,
          _process: 11,
          buffer: 3,
          "core-util-is": 18,
          events: 7,
          inherits: 8,
          isarray: 10,
          "process-nextick-args": 19,
          "string_decoder/": 26,
          util: 2,
        },
      ],
      16: [
        function (b, c, e) {
          function d(q) {
            this.afterTransform = function (t, u) {
              var A = q._transformState;
              A.transforming = !1;
              var G = A.writecb;
              G
                ? ((A.writechunk = null),
                  (A.writecb = null),
                  null !== u && void 0 !== u && q.push(u),
                  G && G(t),
                  (t = q._readableState),
                  (t.reading = !1),
                  (t.needReadable || t.length < t.highWaterMark) &&
                    q._read(t.highWaterMark),
                  (t = void 0))
                : (t = q.emit("error", Error("no writecb in Transform class")));
              return t;
            };
            this.transforming = this.needTransform = !1;
            this.writechunk = this.writecb = null;
          }
          function g(q) {
            if (!(this instanceof g)) return new g(q);
            n.call(this, q);
            this._transformState = new d(this);
            var t = this;
            this._readableState.needReadable = !0;
            this._readableState.sync = !1;
            q &&
              ("function" === typeof q.transform &&
                (this._transform = q.transform),
              "function" === typeof q.flush && (this._flush = q.flush));
            this.once("prefinish", function () {
              "function" === typeof this._flush
                ? this._flush(function (u) {
                    h(t, u);
                  })
                : h(t);
            });
          }
          function h(q, t) {
            if (t) return q.emit("error", t);
            t = q._transformState;
            if (q._writableState.length)
              throw Error("calling transform done when ws.length != 0");
            if (t.transforming)
              throw Error("calling transform done when still transforming");
            return q.push(null);
          }
          c.exports = g;
          var n = b("./_stream_duplex");
          c = b("core-util-is");
          c.inherits = b("inherits");
          c.inherits(g, n);
          g.prototype.push = function (q, t) {
            this._transformState.needTransform = !1;
            return n.prototype.push.call(this, q, t);
          };
          g.prototype._transform = function (q, t, u) {
            throw Error("not implemented");
          };
          g.prototype._write = function (q, t, u) {
            var A = this._transformState;
            A.writecb = u;
            A.writechunk = q;
            A.writeencoding = t;
            A.transforming ||
              ((q = this._readableState),
              (A.needTransform ||
                q.needReadable ||
                q.length < q.highWaterMark) &&
                this._read(q.highWaterMark));
          };
          g.prototype._read = function (q) {
            q = this._transformState;
            null !== q.writechunk && q.writecb && !q.transforming
              ? ((q.transforming = !0),
                this._transform(
                  q.writechunk,
                  q.writeencoding,
                  q.afterTransform
                ))
              : (q.needTransform = !0);
          };
        },
        { "./_stream_duplex": 13, "core-util-is": 18, inherits: 8 },
      ],
      17: [
        function (b, c, e) {
          function d() {}
          function g(w, I, aa) {
            this.chunk = w;
            this.encoding = I;
            this.callback = aa;
            this.next = null;
          }
          function h(w, I) {
            ha = ha || b("./_stream_duplex");
            w = w || {};
            this.objectMode = !!w.objectMode;
            I instanceof ha &&
              (this.objectMode = this.objectMode || !!w.writableObjectMode);
            var aa = w.highWaterMark,
              T = this.objectMode ? 16 : 16384;
            this.highWaterMark = aa || 0 === aa ? aa : T;
            this.highWaterMark = ~~this.highWaterMark;
            this.finished = this.ended = this.ending = this.needDrain = !1;
            this.decodeStrings = !1 !== w.decodeStrings;
            this.defaultEncoding = w.defaultEncoding || "utf8";
            this.length = 0;
            this.writing = !1;
            this.corked = 0;
            this.sync = !0;
            this.bufferProcessing = !1;
            this.onwrite = function (ka) {
              var k = I._writableState,
                X = k.sync,
                V = k.writecb;
              k.writing = !1;
              k.writecb = null;
              k.length -= k.writelen;
              k.writelen = 0;
              ka
                ? (--k.pendingcb,
                  X ? O(V, ka) : V(ka),
                  (I._writableState.errorEmitted = !0),
                  I.emit("error", ka))
                : ((ka = A(k)) ||
                    k.corked ||
                    k.bufferProcessing ||
                    !k.bufferedRequest ||
                    u(I, k),
                  X ? O(t, I, k, ka, V) : t(I, k, ka, V));
            };
            this.writecb = null;
            this.writelen = 0;
            this.lastBufferedRequest = this.bufferedRequest = null;
            this.pendingcb = 0;
            this.errorEmitted = this.prefinished = !1;
          }
          function n(w) {
            ha = ha || b("./_stream_duplex");
            if (!(this instanceof n || this instanceof ha)) return new n(w);
            this._writableState = new h(w, this);
            this.writable = !0;
            w &&
              ("function" === typeof w.write && (this._write = w.write),
              "function" === typeof w.writev && (this._writev = w.writev));
            U.call(this);
          }
          function q(w, I, aa, T, ka, k, X) {
            I.writelen = T;
            I.writecb = X;
            I.writing = !0;
            I.sync = !0;
            aa ? w._writev(ka, I.onwrite) : w._write(ka, k, I.onwrite);
            I.sync = !1;
          }
          function t(w, I, aa, T) {
            !aa &&
              0 === I.length &&
              I.needDrain &&
              ((I.needDrain = !1), w.emit("drain"));
            I.pendingcb--;
            T();
            G(w, I);
          }
          function u(w, I) {
            I.bufferProcessing = !0;
            var aa = I.bufferedRequest;
            if (w._writev && aa && aa.next) {
              for (var T = [], ka = []; aa; )
                ka.push(aa.callback), T.push(aa), (aa = aa.next);
              I.pendingcb++;
              I.lastBufferedRequest = null;
              q(w, I, !0, I.length, T, "", function (k) {
                for (var X = 0; X < ka.length; X++) I.pendingcb--, ka[X](k);
              });
            } else {
              for (
                ;
                aa &&
                ((T = aa.chunk),
                q(
                  w,
                  I,
                  !1,
                  I.objectMode ? 1 : T.length,
                  T,
                  aa.encoding,
                  aa.callback
                ),
                (aa = aa.next),
                !I.writing);

              );
              null === aa && (I.lastBufferedRequest = null);
            }
            I.bufferedRequest = aa;
            I.bufferProcessing = !1;
          }
          function A(w) {
            return (
              w.ending &&
              0 === w.length &&
              null === w.bufferedRequest &&
              !w.finished &&
              !w.writing
            );
          }
          function G(w, I) {
            var aa = A(I);
            aa &&
              (0 === I.pendingcb
                ? (I.prefinished || ((I.prefinished = !0), w.emit("prefinish")),
                  (I.finished = !0),
                  w.emit("finish"))
                : I.prefinished || ((I.prefinished = !0), w.emit("prefinish")));
            return aa;
          }
          c.exports = n;
          var O = b("process-nextick-args"),
            H = b("buffer").Buffer;
          n.WritableState = h;
          c = b("core-util-is");
          c.inherits = b("inherits");
          var P = { deprecate: b("util-deprecate") };
          try {
            var U = b("stream");
          } catch (w) {
          } finally {
            U || (U = b("events").EventEmitter);
          }
          H = b("buffer").Buffer;
          c.inherits(n, U);
          var ha;
          h.prototype.getBuffer = function () {
            for (var w = this.bufferedRequest, I = []; w; )
              I.push(w), (w = w.next);
            return I;
          };
          (function () {
            try {
              Object.defineProperty(h.prototype, "buffer", {
                get: P.deprecate(function () {
                  return this.getBuffer();
                }, "_writableState.buffer is deprecated. Use _writableState.getBuffer instead."),
              });
            } catch (w) {}
          })();
          n.prototype.pipe = function () {
            this.emit("error", Error("Cannot pipe. Not readable."));
          };
          n.prototype.write = function (w, I, aa) {
            var T = this._writableState,
              ka = !1;
            "function" === typeof I && ((aa = I), (I = null));
            H.isBuffer(w) ? (I = "buffer") : I || (I = T.defaultEncoding);
            "function" !== typeof aa && (aa = d);
            if (T.ended)
              (T = aa),
                (w = Error("write after end")),
                this.emit("error", w),
                O(T, w);
            else {
              var k = aa,
                X = !0;
              H.isBuffer(w) ||
                "string" === typeof w ||
                null === w ||
                void 0 === w ||
                T.objectMode ||
                ((X = new TypeError("Invalid non-string/buffer chunk")),
                this.emit("error", X),
                O(k, X),
                (X = !1));
              X &&
                (T.pendingcb++,
                (ka = I),
                T.objectMode ||
                  !1 === T.decodeStrings ||
                  "string" !== typeof w ||
                  (w = new H(w, ka)),
                H.isBuffer(w) && (ka = "buffer"),
                (k = T.objectMode ? 1 : w.length),
                (T.length += k),
                (I = T.length < T.highWaterMark),
                I || (T.needDrain = !0),
                T.writing || T.corked
                  ? ((k = T.lastBufferedRequest),
                    (T.lastBufferedRequest = new g(w, ka, aa)),
                    k
                      ? (k.next = T.lastBufferedRequest)
                      : (T.bufferedRequest = T.lastBufferedRequest))
                  : q(this, T, !1, k, w, ka, aa),
                (ka = I));
            }
            return ka;
          };
          n.prototype.cork = function () {
            this._writableState.corked++;
          };
          n.prototype.uncork = function () {
            var w = this._writableState;
            w.corked &&
              (w.corked--,
              w.writing ||
                w.corked ||
                w.finished ||
                w.bufferProcessing ||
                !w.bufferedRequest ||
                u(this, w));
          };
          n.prototype.setDefaultEncoding = function (w) {
            "string" === typeof w && (w = w.toLowerCase());
            if (
              !(
                -1 <
                "hex utf8 utf-8 ascii binary base64 ucs2 ucs-2 utf16le utf-16le raw"
                  .split(" ")
                  .indexOf((w + "").toLowerCase())
              )
            )
              throw new TypeError("Unknown encoding: " + w);
            this._writableState.defaultEncoding = w;
          };
          n.prototype._write = function (w, I, aa) {
            aa(Error("not implemented"));
          };
          n.prototype._writev = null;
          n.prototype.end = function (w, I, aa) {
            var T = this._writableState;
            "function" === typeof w
              ? ((aa = w), (I = w = null))
              : "function" === typeof I && ((aa = I), (I = null));
            null !== w && void 0 !== w && this.write(w, I);
            T.corked && ((T.corked = 1), this.uncork());
            if (!T.ending && !T.finished) {
              w = aa;
              T.ending = !0;
              G(this, T);
              if (w)
                if (T.finished) O(w);
                else this.once("finish", w);
              T.ended = !0;
            }
          };
        },
        {
          "./_stream_duplex": 13,
          buffer: 3,
          "core-util-is": 18,
          events: 7,
          inherits: 8,
          "process-nextick-args": 19,
          "util-deprecate": 20,
        },
      ],
      18: [
        function (b, c, e) {
          (function (d) {
            e.isArray = function (g) {
              return Array.isArray
                ? Array.isArray(g)
                : "[object Array]" === Object.prototype.toString.call(g);
            };
            e.isBoolean = function (g) {
              return "boolean" === typeof g;
            };
            e.isNull = function (g) {
              return null === g;
            };
            e.isNullOrUndefined = function (g) {
              return null == g;
            };
            e.isNumber = function (g) {
              return "number" === typeof g;
            };
            e.isString = function (g) {
              return "string" === typeof g;
            };
            e.isSymbol = function (g) {
              return "symbol" === typeof g;
            };
            e.isUndefined = function (g) {
              return void 0 === g;
            };
            e.isRegExp = function (g) {
              return "[object RegExp]" === Object.prototype.toString.call(g);
            };
            e.isObject = function (g) {
              return "object" === typeof g && null !== g;
            };
            e.isDate = function (g) {
              return "[object Date]" === Object.prototype.toString.call(g);
            };
            e.isError = function (g) {
              return (
                "[object Error]" === Object.prototype.toString.call(g) ||
                g instanceof Error
              );
            };
            e.isFunction = function (g) {
              return "function" === typeof g;
            };
            e.isPrimitive = function (g) {
              return (
                null === g ||
                "boolean" === typeof g ||
                "number" === typeof g ||
                "string" === typeof g ||
                "symbol" === typeof g ||
                "undefined" === typeof g
              );
            };
            e.isBuffer = d.isBuffer;
          }.call(this, {
            isBuffer: b(
              "../../../../insert-module-globals/node_modules/is-buffer/index.js"
            ),
          }));
        },
        {
          "../../../../insert-module-globals/node_modules/is-buffer/index.js": 9,
        },
      ],
      19: [
        function (b, c, e) {
          (function (d) {
            function g(h) {
              for (var n = Array(arguments.length - 1), q = 0; q < n.length; )
                n[q++] = arguments[q];
              d.nextTick(function () {
                h.apply(null, n);
              });
            }
            !d.version ||
            0 === d.version.indexOf("v0.") ||
            (0 === d.version.indexOf("v1.") && 0 !== d.version.indexOf("v1.8."))
              ? (c.exports = g)
              : (c.exports = d.nextTick);
          }.call(this, b("_process")));
        },
        { _process: 11 },
      ],
      20: [
        function (b, c, e) {
          (function (d) {
            function g(h) {
              try {
                if (!d.localStorage) return !1;
              } catch (n) {
                return !1;
              }
              h = d.localStorage[h];
              return null == h ? !1 : "true" === String(h).toLowerCase();
            }
            c.exports = function (h, n) {
              if (g("noDeprecation")) return h;
              var q = !1;
              return function () {
                if (!q) {
                  if (g("throwDeprecation")) throw Error(n);
                  g("traceDeprecation") ? console.trace(n) : console.warn(n);
                  q = !0;
                }
                return h.apply(this, arguments);
              };
            };
          }.call(
            this,
            "undefined" !== typeof global
              ? global
              : "undefined" !== typeof self
              ? self
              : "undefined" !== typeof window
              ? window
              : {}
          ));
        },
        {},
      ],
      21: [
        function (b, c, e) {
          c.exports = b("./lib/_stream_passthrough.js");
        },
        { "./lib/_stream_passthrough.js": 14 },
      ],
      22: [
        function (b, c, e) {
          a: {
            try {
              var d = b("stream");
              break a;
            } catch (g) {}
            d = void 0;
          }
          e = c.exports = b("./lib/_stream_readable.js");
          e.Stream = d || e;
          e.Readable = e;
          e.Writable = b("./lib/_stream_writable.js");
          e.Duplex = b("./lib/_stream_duplex.js");
          e.Transform = b("./lib/_stream_transform.js");
          e.PassThrough = b("./lib/_stream_passthrough.js");
        },
        {
          "./lib/_stream_duplex.js": 13,
          "./lib/_stream_passthrough.js": 14,
          "./lib/_stream_readable.js": 15,
          "./lib/_stream_transform.js": 16,
          "./lib/_stream_writable.js": 17,
        },
      ],
      23: [
        function (b, c, e) {
          c.exports = b("./lib/_stream_transform.js");
        },
        { "./lib/_stream_transform.js": 16 },
      ],
      24: [
        function (b, c, e) {
          c.exports = b("./lib/_stream_writable.js");
        },
        { "./lib/_stream_writable.js": 17 },
      ],
      25: [
        function (b, c, e) {
          function d() {
            g.call(this);
          }
          c.exports = d;
          var g = b("events").EventEmitter;
          b("inherits")(d, g);
          d.Readable = b("readable-stream/readable.js");
          d.Writable = b("readable-stream/writable.js");
          d.Duplex = b("readable-stream/duplex.js");
          d.Transform = b("readable-stream/transform.js");
          d.PassThrough = b("readable-stream/passthrough.js");
          d.Stream = d;
          d.prototype.pipe = function (h, n) {
            function q(U) {
              h.writable && !1 === h.write(U) && H.pause && H.pause();
            }
            function t() {
              H.readable && H.resume && H.resume();
            }
            function u() {
              P || ((P = !0), h.end());
            }
            function A() {
              P || ((P = !0), "function" === typeof h.destroy && h.destroy());
            }
            function G(U) {
              O();
              if (0 === g.listenerCount(this, "error")) throw U;
            }
            function O() {
              H.removeListener("data", q);
              h.removeListener("drain", t);
              H.removeListener("end", u);
              H.removeListener("close", A);
              H.removeListener("error", G);
              h.removeListener("error", G);
              H.removeListener("end", O);
              H.removeListener("close", O);
              h.removeListener("close", O);
            }
            var H = this;
            H.on("data", q);
            h.on("drain", t);
            h._isStdio ||
              (n && !1 === n.end) ||
              (H.on("end", u), H.on("close", A));
            var P = !1;
            H.on("error", G);
            h.on("error", G);
            H.on("end", O);
            H.on("close", O);
            h.on("close", O);
            h.emit("pipe", H);
            return h;
          };
        },
        {
          events: 7,
          inherits: 8,
          "readable-stream/duplex.js": 12,
          "readable-stream/passthrough.js": 21,
          "readable-stream/readable.js": 22,
          "readable-stream/transform.js": 23,
          "readable-stream/writable.js": 24,
        },
      ],
      26: [
        function (b, c, e) {
          function d(t) {
            return t.toString(this.encoding);
          }
          function g(t) {
            this.charLength = (this.charReceived = t.length % 2) ? 2 : 0;
          }
          function h(t) {
            this.charLength = (this.charReceived = t.length % 3) ? 3 : 0;
          }
          var n = b("buffer").Buffer,
            q =
              n.isEncoding ||
              function (t) {
                switch (t && t.toLowerCase()) {
                  case "hex":
                  case "utf8":
                  case "utf-8":
                  case "ascii":
                  case "binary":
                  case "base64":
                  case "ucs2":
                  case "ucs-2":
                  case "utf16le":
                  case "utf-16le":
                  case "raw":
                    return !0;
                  default:
                    return !1;
                }
              };
          b = e.StringDecoder = function (t) {
            this.encoding = (t || "utf8").toLowerCase().replace(/[-_]/, "");
            if (t && !q(t)) throw Error("Unknown encoding: " + t);
            switch (this.encoding) {
              case "utf8":
                this.surrogateSize = 3;
                break;
              case "ucs2":
              case "utf16le":
                this.surrogateSize = 2;
                this.detectIncompleteChar = g;
                break;
              case "base64":
                this.surrogateSize = 3;
                this.detectIncompleteChar = h;
                break;
              default:
                this.write = d;
                return;
            }
            this.charBuffer = new n(6);
            this.charLength = this.charReceived = 0;
          };
          b.prototype.write = function (t) {
            for (var u = ""; this.charLength; ) {
              u =
                t.length >= this.charLength - this.charReceived
                  ? this.charLength - this.charReceived
                  : t.length;
              t.copy(this.charBuffer, this.charReceived, 0, u);
              this.charReceived += u;
              if (this.charReceived < this.charLength) return "";
              t = t.slice(u, t.length);
              u = this.charBuffer
                .slice(0, this.charLength)
                .toString(this.encoding);
              var A = u.charCodeAt(u.length - 1);
              if (55296 <= A && 56319 >= A)
                (this.charLength += this.surrogateSize), (u = "");
              else {
                this.charReceived = this.charLength = 0;
                if (0 === t.length) return u;
                break;
              }
            }
            this.detectIncompleteChar(t);
            var G = t.length;
            this.charLength &&
              (t.copy(this.charBuffer, 0, t.length - this.charReceived, G),
              (G -= this.charReceived));
            u += t.toString(this.encoding, 0, G);
            G = u.length - 1;
            A = u.charCodeAt(G);
            return 55296 <= A && 56319 >= A
              ? ((A = this.surrogateSize),
                (this.charLength += A),
                (this.charReceived += A),
                this.charBuffer.copy(this.charBuffer, A, 0, A),
                t.copy(this.charBuffer, 0, 0, A),
                u.substring(0, G))
              : u;
          };
          b.prototype.detectIncompleteChar = function (t) {
            for (var u = 3 <= t.length ? 3 : t.length; 0 < u; u--) {
              var A = t[t.length - u];
              if (1 == u && 6 == A >> 5) {
                this.charLength = 2;
                break;
              }
              if (2 >= u && 14 == A >> 4) {
                this.charLength = 3;
                break;
              }
              if (3 >= u && 30 == A >> 3) {
                this.charLength = 4;
                break;
              }
            }
            this.charReceived = u;
          };
          b.prototype.end = function (t) {
            var u = "";
            t && t.length && (u = this.write(t));
            this.charReceived &&
              ((t = this.encoding),
              (u += this.charBuffer.slice(0, this.charReceived).toString(t)));
            return u;
          };
        },
        { buffer: 3 },
      ],
      27: [
        function (b, c, e) {
          e = b("./lib/utils/common").assign;
          var d = b("./lib/deflate"),
            g = b("./lib/inflate");
          b = b("./lib/zlib/constants");
          var h = {};
          e(h, d, g, b);
          c.exports = h;
        },
        {
          "./lib/deflate": 28,
          "./lib/inflate": 29,
          "./lib/utils/common": 30,
          "./lib/zlib/constants": 33,
        },
      ],
      28: [
        function (b, c, e) {
          function d(G) {
            if (!(this instanceof d)) return new d(G);
            G = this.options = n.assign(
              {
                level: -1,
                method: 8,
                chunkSize: 16384,
                windowBits: 15,
                memLevel: 8,
                strategy: 0,
                to: "",
              },
              G || {}
            );
            G.raw && 0 < G.windowBits
              ? (G.windowBits = -G.windowBits)
              : G.gzip &&
                0 < G.windowBits &&
                16 > G.windowBits &&
                (G.windowBits += 16);
            this.err = 0;
            this.msg = "";
            this.ended = !1;
            this.chunks = [];
            this.strm = new u();
            this.strm.avail_out = 0;
            var O = h.deflateInit2(
              this.strm,
              G.level,
              G.method,
              G.windowBits,
              G.memLevel,
              G.strategy
            );
            if (0 !== O) throw Error(t[O]);
            G.header && h.deflateSetHeader(this.strm, G.header);
          }
          function g(G, O) {
            O = new d(O);
            O.push(G, !0);
            if (O.err) throw O.msg;
            return O.result;
          }
          var h = b("./zlib/deflate"),
            n = b("./utils/common"),
            q = b("./utils/strings"),
            t = b("./zlib/messages"),
            u = b("./zlib/zstream"),
            A = Object.prototype.toString;
          d.prototype.push = function (G, O) {
            var H = this.strm,
              P = this.options.chunkSize;
            if (this.ended) return !1;
            O = O === ~~O ? O : !0 === O ? 4 : 0;
            "string" === typeof G
              ? (H.input = q.string2buf(G))
              : "[object ArrayBuffer]" === A.call(G)
              ? (H.input = new Uint8Array(G))
              : (H.input = G);
            H.next_in = 0;
            H.avail_in = H.input.length;
            do {
              0 === H.avail_out &&
                ((H.output = new n.Buf8(P)),
                (H.next_out = 0),
                (H.avail_out = P));
              G = h.deflate(H, O);
              if (1 !== G && 0 !== G)
                return this.onEnd(G), (this.ended = !0), !1;
              if (
                0 === H.avail_out ||
                (0 === H.avail_in && (4 === O || 2 === O))
              )
                if ("string" === this.options.to)
                  this.onData(
                    q.buf2binstring(n.shrinkBuf(H.output, H.next_out))
                  );
                else this.onData(n.shrinkBuf(H.output, H.next_out));
            } while ((0 < H.avail_in || 0 === H.avail_out) && 1 !== G);
            if (4 === O)
              return (
                (G = h.deflateEnd(this.strm)),
                this.onEnd(G),
                (this.ended = !0),
                0 === G
              );
            2 === O && (this.onEnd(0), (H.avail_out = 0));
            return !0;
          };
          d.prototype.onData = function (G) {
            this.chunks.push(G);
          };
          d.prototype.onEnd = function (G) {
            0 === G &&
              (this.result =
                "string" === this.options.to
                  ? this.chunks.join("")
                  : n.flattenChunks(this.chunks));
            this.chunks = [];
            this.err = G;
            this.msg = this.strm.msg;
          };
          e.Deflate = d;
          e.deflate = g;
          e.deflateRaw = function (G, O) {
            O = O || {};
            O.raw = !0;
            return g(G, O);
          };
          e.gzip = function (G, O) {
            O = O || {};
            O.gzip = !0;
            return g(G, O);
          };
        },
        {
          "./utils/common": 30,
          "./utils/strings": 31,
          "./zlib/deflate": 35,
          "./zlib/messages": 40,
          "./zlib/zstream": 42,
        },
      ],
      29: [
        function (b, c, e) {
          function d(H) {
            if (!(this instanceof d)) return new d(H);
            var P = (this.options = n.assign(
              { chunkSize: 16384, windowBits: 0, to: "" },
              H || {}
            ));
            P.raw &&
              0 <= P.windowBits &&
              16 > P.windowBits &&
              ((P.windowBits = -P.windowBits),
              0 === P.windowBits && (P.windowBits = -15));
            !(0 <= P.windowBits && 16 > P.windowBits) ||
              (H && H.windowBits) ||
              (P.windowBits += 32);
            15 < P.windowBits &&
              48 > P.windowBits &&
              0 === (P.windowBits & 15) &&
              (P.windowBits |= 15);
            this.err = 0;
            this.msg = "";
            this.ended = !1;
            this.chunks = [];
            this.strm = new A();
            this.strm.avail_out = 0;
            H = h.inflateInit2(this.strm, P.windowBits);
            if (H !== t.Z_OK) throw Error(u[H]);
            this.header = new G();
            h.inflateGetHeader(this.strm, this.header);
          }
          function g(H, P) {
            P = new d(P);
            P.push(H, !0);
            if (P.err) throw P.msg;
            return P.result;
          }
          var h = b("./zlib/inflate"),
            n = b("./utils/common"),
            q = b("./utils/strings"),
            t = b("./zlib/constants"),
            u = b("./zlib/messages"),
            A = b("./zlib/zstream"),
            G = b("./zlib/gzheader"),
            O = Object.prototype.toString;
          d.prototype.push = function (H, P) {
            var U = this.strm,
              ha = this.options.chunkSize,
              w = !1;
            if (this.ended) return !1;
            P = P === ~~P ? P : !0 === P ? t.Z_FINISH : t.Z_NO_FLUSH;
            "string" === typeof H
              ? (U.input = q.binstring2buf(H))
              : "[object ArrayBuffer]" === O.call(H)
              ? (U.input = new Uint8Array(H))
              : (U.input = H);
            U.next_in = 0;
            U.avail_in = U.input.length;
            do {
              0 === U.avail_out &&
                ((U.output = new n.Buf8(ha)),
                (U.next_out = 0),
                (U.avail_out = ha));
              H = h.inflate(U, t.Z_NO_FLUSH);
              H === t.Z_BUF_ERROR && !0 === w && ((H = t.Z_OK), (w = !1));
              if (H !== t.Z_STREAM_END && H !== t.Z_OK)
                return this.onEnd(H), (this.ended = !0), !1;
              if (
                U.next_out &&
                (0 === U.avail_out ||
                  H === t.Z_STREAM_END ||
                  (0 === U.avail_in &&
                    (P === t.Z_FINISH || P === t.Z_SYNC_FLUSH)))
              )
                if ("string" === this.options.to) {
                  var I = q.utf8border(U.output, U.next_out);
                  var aa = U.next_out - I;
                  var T = q.buf2string(U.output, I);
                  U.next_out = aa;
                  U.avail_out = ha - aa;
                  aa && n.arraySet(U.output, U.output, I, aa, 0);
                  this.onData(T);
                } else this.onData(n.shrinkBuf(U.output, U.next_out));
              0 === U.avail_in && 0 === U.avail_out && (w = !0);
            } while (
              (0 < U.avail_in || 0 === U.avail_out) &&
              H !== t.Z_STREAM_END
            );
            H === t.Z_STREAM_END && (P = t.Z_FINISH);
            if (P === t.Z_FINISH)
              return (
                (H = h.inflateEnd(this.strm)),
                this.onEnd(H),
                (this.ended = !0),
                H === t.Z_OK
              );
            P === t.Z_SYNC_FLUSH && (this.onEnd(t.Z_OK), (U.avail_out = 0));
            return !0;
          };
          d.prototype.onData = function (H) {
            this.chunks.push(H);
          };
          d.prototype.onEnd = function (H) {
            H === t.Z_OK &&
              (this.result =
                "string" === this.options.to
                  ? this.chunks.join("")
                  : n.flattenChunks(this.chunks));
            this.chunks = [];
            this.err = H;
            this.msg = this.strm.msg;
          };
          e.Inflate = d;
          e.inflate = g;
          e.inflateRaw = function (H, P) {
            P = P || {};
            P.raw = !0;
            return g(H, P);
          };
          e.ungzip = g;
        },
        {
          "./utils/common": 30,
          "./utils/strings": 31,
          "./zlib/constants": 33,
          "./zlib/gzheader": 36,
          "./zlib/inflate": 38,
          "./zlib/messages": 40,
          "./zlib/zstream": 42,
        },
      ],
      30: [
        function (b, c, e) {
          b =
            "undefined" !== typeof Uint8Array &&
            "undefined" !== typeof Uint16Array &&
            "undefined" !== typeof Int32Array;
          e.assign = function (h) {
            for (var n = Array.prototype.slice.call(arguments, 1); n.length; ) {
              var q = n.shift();
              if (q) {
                if ("object" !== typeof q)
                  throw new TypeError(q + "must be non-object");
                for (var t in q) q.hasOwnProperty(t) && (h[t] = q[t]);
              }
            }
            return h;
          };
          e.shrinkBuf = function (h, n) {
            if (h.length === n) return h;
            if (h.subarray) return h.subarray(0, n);
            h.length = n;
            return h;
          };
          var d = {
              arraySet: function (h, n, q, t, u) {
                if (n.subarray && h.subarray) h.set(n.subarray(q, q + t), u);
                else for (var A = 0; A < t; A++) h[u + A] = n[q + A];
              },
              flattenChunks: function (h) {
                var n, q;
                var t = (q = 0);
                for (n = h.length; t < n; t++) q += h[t].length;
                var u = new Uint8Array(q);
                t = q = 0;
                for (n = h.length; t < n; t++) {
                  var A = h[t];
                  u.set(A, q);
                  q += A.length;
                }
                return u;
              },
            },
            g = {
              arraySet: function (h, n, q, t, u) {
                for (var A = 0; A < t; A++) h[u + A] = n[q + A];
              },
              flattenChunks: function (h) {
                return [].concat.apply([], h);
              },
            };
          e.setTyped = function (h) {
            h
              ? ((e.Buf8 = Uint8Array),
                (e.Buf16 = Uint16Array),
                (e.Buf32 = Int32Array),
                e.assign(e, d))
              : ((e.Buf8 = Array),
                (e.Buf16 = Array),
                (e.Buf32 = Array),
                e.assign(e, g));
          };
          e.setTyped(b);
        },
        {},
      ],
      31: [
        function (b, c, e) {
          function d(t, u) {
            if (65537 > u && ((t.subarray && n) || (!t.subarray && h)))
              return String.fromCharCode.apply(null, g.shrinkBuf(t, u));
            for (var A = "", G = 0; G < u; G++) A += String.fromCharCode(t[G]);
            return A;
          }
          var g = b("./common"),
            h = !0,
            n = !0;
          try {
            String.fromCharCode.apply(null, [0]);
          } catch (t) {
            h = !1;
          }
          try {
            String.fromCharCode.apply(null, new Uint8Array(1));
          } catch (t) {
            n = !1;
          }
          var q = new g.Buf8(256);
          for (b = 0; 256 > b; b++)
            q[b] =
              252 <= b
                ? 6
                : 248 <= b
                ? 5
                : 240 <= b
                ? 4
                : 224 <= b
                ? 3
                : 192 <= b
                ? 2
                : 1;
          q[254] = q[254] = 1;
          e.string2buf = function (t) {
            var u,
              A,
              G = t.length,
              O = 0;
            for (u = 0; u < G; u++) {
              var H = t.charCodeAt(u);
              if (55296 === (H & 64512) && u + 1 < G) {
                var P = t.charCodeAt(u + 1);
                56320 === (P & 64512) &&
                  ((H = 65536 + ((H - 55296) << 10) + (P - 56320)), u++);
              }
              O += 128 > H ? 1 : 2048 > H ? 2 : 65536 > H ? 3 : 4;
            }
            var U = new g.Buf8(O);
            for (u = A = 0; A < O; u++)
              (H = t.charCodeAt(u)),
                55296 === (H & 64512) &&
                  u + 1 < G &&
                  ((P = t.charCodeAt(u + 1)),
                  56320 === (P & 64512) &&
                    ((H = 65536 + ((H - 55296) << 10) + (P - 56320)), u++)),
                128 > H
                  ? (U[A++] = H)
                  : (2048 > H
                      ? (U[A++] = 192 | (H >>> 6))
                      : (65536 > H
                          ? (U[A++] = 224 | (H >>> 12))
                          : ((U[A++] = 240 | (H >>> 18)),
                            (U[A++] = 128 | ((H >>> 12) & 63))),
                        (U[A++] = 128 | ((H >>> 6) & 63))),
                    (U[A++] = 128 | (H & 63)));
            return U;
          };
          e.buf2binstring = function (t) {
            return d(t, t.length);
          };
          e.binstring2buf = function (t) {
            for (var u = new g.Buf8(t.length), A = 0, G = u.length; A < G; A++)
              u[A] = t.charCodeAt(A);
            return u;
          };
          e.buf2string = function (t, u) {
            var A,
              G = u || t.length,
              O = Array(2 * G);
            for (u = A = 0; u < G; ) {
              var H = t[u++];
              if (128 > H) O[A++] = H;
              else {
                var P = q[H];
                if (4 < P) (O[A++] = 65533), (u += P - 1);
                else {
                  for (H &= 2 === P ? 31 : 3 === P ? 15 : 7; 1 < P && u < G; )
                    (H = (H << 6) | (t[u++] & 63)), P--;
                  1 < P
                    ? (O[A++] = 65533)
                    : 65536 > H
                    ? (O[A++] = H)
                    : ((H -= 65536),
                      (O[A++] = 55296 | ((H >> 10) & 1023)),
                      (O[A++] = 56320 | (H & 1023)));
                }
              }
            }
            return d(O, A);
          };
          e.utf8border = function (t, u) {
            var A;
            u = u || t.length;
            u > t.length && (u = t.length);
            for (A = u - 1; 0 <= A && 128 === (t[A] & 192); ) A--;
            return 0 > A || 0 === A ? u : A + q[t[A]] > u ? A : u;
          };
        },
        { "./common": 30 },
      ],
      32: [
        function (b, c, e) {
          c.exports = function (d, g, h, n) {
            var q = (d & 65535) | 0;
            d = ((d >>> 16) & 65535) | 0;
            for (var t; 0 !== h; ) {
              t = 2e3 < h ? 2e3 : h;
              h -= t;
              do (q = (q + g[n++]) | 0), (d = (d + q) | 0);
              while (--t);
              q %= 65521;
              d %= 65521;
            }
            return q | (d << 16) | 0;
          };
        },
        {},
      ],
      33: [
        function (b, c, e) {
          c.exports = {
            Z_NO_FLUSH: 0,
            Z_PARTIAL_FLUSH: 1,
            Z_SYNC_FLUSH: 2,
            Z_FULL_FLUSH: 3,
            Z_FINISH: 4,
            Z_BLOCK: 5,
            Z_TREES: 6,
            Z_OK: 0,
            Z_STREAM_END: 1,
            Z_NEED_DICT: 2,
            Z_ERRNO: -1,
            Z_STREAM_ERROR: -2,
            Z_DATA_ERROR: -3,
            Z_BUF_ERROR: -5,
            Z_NO_COMPRESSION: 0,
            Z_BEST_SPEED: 1,
            Z_BEST_COMPRESSION: 9,
            Z_DEFAULT_COMPRESSION: -1,
            Z_FILTERED: 1,
            Z_HUFFMAN_ONLY: 2,
            Z_RLE: 3,
            Z_FIXED: 4,
            Z_DEFAULT_STRATEGY: 0,
            Z_BINARY: 0,
            Z_TEXT: 1,
            Z_UNKNOWN: 2,
            Z_DEFLATED: 8,
          };
        },
        {},
      ],
      34: [
        function (b, c, e) {
          var d = (function () {
            for (var g, h = [], n = 0; 256 > n; n++) {
              g = n;
              for (var q = 0; 8 > q; q++)
                g = g & 1 ? 3988292384 ^ (g >>> 1) : g >>> 1;
              h[n] = g;
            }
            return h;
          })();
          c.exports = function (g, h, n, q) {
            n = q + n;
            for (g ^= -1; q < n; q++) g = (g >>> 8) ^ d[(g ^ h[q]) & 255];
            return g ^ -1;
          };
        },
        {},
      ],
      35: [
        function (b, c, e) {
          function d(m, F) {
            m.msg = V[F];
            return F;
          }
          function g(m) {
            for (var F = m.length; 0 <= --F; ) m[F] = 0;
          }
          function h(m) {
            var F = m.state,
              r = F.pending;
            r > m.avail_out && (r = m.avail_out);
            0 !== r &&
              (T.arraySet(
                m.output,
                F.pending_buf,
                F.pending_out,
                r,
                m.next_out
              ),
              (m.next_out += r),
              (F.pending_out += r),
              (m.total_out += r),
              (m.avail_out -= r),
              (F.pending -= r),
              0 === F.pending && (F.pending_out = 0));
          }
          function n(m, F) {
            ka._tr_flush_block(
              m,
              0 <= m.block_start ? m.block_start : -1,
              m.strstart - m.block_start,
              F
            );
            m.block_start = m.strstart;
            h(m.strm);
          }
          function q(m, F) {
            m.pending_buf[m.pending++] = F;
          }
          function t(m, F) {
            m.pending_buf[m.pending++] = (F >>> 8) & 255;
            m.pending_buf[m.pending++] = F & 255;
          }
          function u(m, F) {
            var r = m.max_chain_length,
              y = m.strstart,
              D = m.prev_length,
              B = m.nice_match,
              C =
                m.strstart > m.w_size - 262 ? m.strstart - (m.w_size - 262) : 0,
              L = m.window,
              N = m.w_mask,
              K = m.prev,
              z = m.strstart + 258,
              R = L[y + D - 1],
              ba = L[y + D];
            m.prev_length >= m.good_match && (r >>= 2);
            B > m.lookahead && (B = m.lookahead);
            do {
              var S = F;
              if (
                L[S + D] === ba &&
                L[S + D - 1] === R &&
                L[S] === L[y] &&
                L[++S] === L[y + 1]
              ) {
                y += 2;
                for (
                  S++;
                  L[++y] === L[++S] &&
                  L[++y] === L[++S] &&
                  L[++y] === L[++S] &&
                  L[++y] === L[++S] &&
                  L[++y] === L[++S] &&
                  L[++y] === L[++S] &&
                  L[++y] === L[++S] &&
                  L[++y] === L[++S] &&
                  y < z;

                );
                S = 258 - (z - y);
                y = z - 258;
                if (S > D) {
                  m.match_start = F;
                  D = S;
                  if (S >= B) break;
                  R = L[y + D - 1];
                  ba = L[y + D];
                }
              }
            } while ((F = K[F & N]) > C && 0 !== --r);
            return D <= m.lookahead ? D : m.lookahead;
          }
          function A(m) {
            var F = m.w_size,
              r;
            do {
              var y = m.window_size - m.lookahead - m.strstart;
              if (m.strstart >= F + (F - 262)) {
                T.arraySet(m.window, m.window, F, F, 0);
                m.match_start -= F;
                m.strstart -= F;
                m.block_start -= F;
                var D = (r = m.hash_size);
                do {
                  var B = m.head[--D];
                  m.head[D] = B >= F ? B - F : 0;
                } while (--r);
                D = r = F;
                do (B = m.prev[--D]), (m.prev[D] = B >= F ? B - F : 0);
                while (--r);
                y += F;
              }
              if (0 === m.strm.avail_in) break;
              D = m.strm;
              r = m.window;
              B = m.strstart + m.lookahead;
              var C = D.avail_in;
              C > y && (C = y);
              0 === C
                ? (r = 0)
                : ((D.avail_in -= C),
                  T.arraySet(r, D.input, D.next_in, C, B),
                  1 === D.state.wrap
                    ? (D.adler = k(D.adler, r, C, B))
                    : 2 === D.state.wrap && (D.adler = X(D.adler, r, C, B)),
                  (D.next_in += C),
                  (D.total_in += C),
                  (r = C));
              m.lookahead += r;
              if (3 <= m.lookahead + m.insert)
                for (
                  y = m.strstart - m.insert,
                    m.ins_h = m.window[y],
                    m.ins_h =
                      ((m.ins_h << m.hash_shift) ^ m.window[y + 1]) &
                      m.hash_mask;
                  m.insert &&
                  !((m.ins_h =
                    ((m.ins_h << m.hash_shift) ^ m.window[y + 3 - 1]) &
                    m.hash_mask),
                  (m.prev[y & m.w_mask] = m.head[m.ins_h]),
                  (m.head[m.ins_h] = y),
                  y++,
                  m.insert--,
                  3 > m.lookahead + m.insert);

                );
            } while (262 > m.lookahead && 0 !== m.strm.avail_in);
          }
          function G(m, F) {
            for (var r; ; ) {
              if (262 > m.lookahead) {
                A(m);
                if (262 > m.lookahead && 0 === F) return 1;
                if (0 === m.lookahead) break;
              }
              r = 0;
              3 <= m.lookahead &&
                ((m.ins_h =
                  ((m.ins_h << m.hash_shift) ^ m.window[m.strstart + 3 - 1]) &
                  m.hash_mask),
                (r = m.prev[m.strstart & m.w_mask] = m.head[m.ins_h]),
                (m.head[m.ins_h] = m.strstart));
              0 !== r &&
                m.strstart - r <= m.w_size - 262 &&
                (m.match_length = u(m, r));
              if (3 <= m.match_length)
                if (
                  ((r = ka._tr_tally(
                    m,
                    m.strstart - m.match_start,
                    m.match_length - 3
                  )),
                  (m.lookahead -= m.match_length),
                  m.match_length <= m.max_lazy_match && 3 <= m.lookahead)
                ) {
                  m.match_length--;
                  do
                    m.strstart++,
                      (m.ins_h =
                        ((m.ins_h << m.hash_shift) ^
                          m.window[m.strstart + 3 - 1]) &
                        m.hash_mask),
                      (m.prev[m.strstart & m.w_mask] = m.head[m.ins_h]),
                      (m.head[m.ins_h] = m.strstart);
                  while (0 !== --m.match_length);
                  m.strstart++;
                } else
                  (m.strstart += m.match_length),
                    (m.match_length = 0),
                    (m.ins_h = m.window[m.strstart]),
                    (m.ins_h =
                      ((m.ins_h << m.hash_shift) ^ m.window[m.strstart + 1]) &
                      m.hash_mask);
              else
                (r = ka._tr_tally(m, 0, m.window[m.strstart])),
                  m.lookahead--,
                  m.strstart++;
              if (r && (n(m, !1), 0 === m.strm.avail_out)) return 1;
            }
            m.insert = 2 > m.strstart ? m.strstart : 2;
            return 4 === F
              ? (n(m, !0), 0 === m.strm.avail_out ? 3 : 4)
              : m.last_lit && (n(m, !1), 0 === m.strm.avail_out)
              ? 1
              : 2;
          }
          function O(m, F) {
            for (var r, y; ; ) {
              if (262 > m.lookahead) {
                A(m);
                if (262 > m.lookahead && 0 === F) return 1;
                if (0 === m.lookahead) break;
              }
              r = 0;
              3 <= m.lookahead &&
                ((m.ins_h =
                  ((m.ins_h << m.hash_shift) ^ m.window[m.strstart + 3 - 1]) &
                  m.hash_mask),
                (r = m.prev[m.strstart & m.w_mask] = m.head[m.ins_h]),
                (m.head[m.ins_h] = m.strstart));
              m.prev_length = m.match_length;
              m.prev_match = m.match_start;
              m.match_length = 2;
              0 !== r &&
                m.prev_length < m.max_lazy_match &&
                m.strstart - r <= m.w_size - 262 &&
                ((m.match_length = u(m, r)),
                5 >= m.match_length &&
                  (1 === m.strategy ||
                    (3 === m.match_length &&
                      4096 < m.strstart - m.match_start)) &&
                  (m.match_length = 2));
              if (3 <= m.prev_length && m.match_length <= m.prev_length) {
                y = m.strstart + m.lookahead - 3;
                r = ka._tr_tally(
                  m,
                  m.strstart - 1 - m.prev_match,
                  m.prev_length - 3
                );
                m.lookahead -= m.prev_length - 1;
                m.prev_length -= 2;
                do
                  ++m.strstart <= y &&
                    ((m.ins_h =
                      ((m.ins_h << m.hash_shift) ^
                        m.window[m.strstart + 3 - 1]) &
                      m.hash_mask),
                    (m.prev[m.strstart & m.w_mask] = m.head[m.ins_h]),
                    (m.head[m.ins_h] = m.strstart));
                while (0 !== --m.prev_length);
                m.match_available = 0;
                m.match_length = 2;
                m.strstart++;
                if (r && (n(m, !1), 0 === m.strm.avail_out)) return 1;
              } else if (m.match_available) {
                if (
                  ((r = ka._tr_tally(m, 0, m.window[m.strstart - 1])) &&
                    n(m, !1),
                  m.strstart++,
                  m.lookahead--,
                  0 === m.strm.avail_out)
                )
                  return 1;
              } else (m.match_available = 1), m.strstart++, m.lookahead--;
            }
            m.match_available &&
              (ka._tr_tally(m, 0, m.window[m.strstart - 1]),
              (m.match_available = 0));
            m.insert = 2 > m.strstart ? m.strstart : 2;
            return 4 === F
              ? (n(m, !0), 0 === m.strm.avail_out ? 3 : 4)
              : m.last_lit && (n(m, !1), 0 === m.strm.avail_out)
              ? 1
              : 2;
          }
          function H(m, F) {
            for (var r, y, D, B = m.window; ; ) {
              if (258 >= m.lookahead) {
                A(m);
                if (258 >= m.lookahead && 0 === F) return 1;
                if (0 === m.lookahead) break;
              }
              m.match_length = 0;
              if (
                3 <= m.lookahead &&
                0 < m.strstart &&
                ((y = m.strstart - 1),
                (r = B[y]),
                r === B[++y] && r === B[++y] && r === B[++y])
              ) {
                for (
                  D = m.strstart + 258;
                  r === B[++y] &&
                  r === B[++y] &&
                  r === B[++y] &&
                  r === B[++y] &&
                  r === B[++y] &&
                  r === B[++y] &&
                  r === B[++y] &&
                  r === B[++y] &&
                  y < D;

                );
                m.match_length = 258 - (D - y);
                m.match_length > m.lookahead && (m.match_length = m.lookahead);
              }
              3 <= m.match_length
                ? ((r = ka._tr_tally(m, 1, m.match_length - 3)),
                  (m.lookahead -= m.match_length),
                  (m.strstart += m.match_length),
                  (m.match_length = 0))
                : ((r = ka._tr_tally(m, 0, m.window[m.strstart])),
                  m.lookahead--,
                  m.strstart++);
              if (r && (n(m, !1), 0 === m.strm.avail_out)) return 1;
            }
            m.insert = 0;
            return 4 === F
              ? (n(m, !0), 0 === m.strm.avail_out ? 3 : 4)
              : m.last_lit && (n(m, !1), 0 === m.strm.avail_out)
              ? 1
              : 2;
          }
          function P(m, F) {
            for (var r; ; ) {
              if (0 === m.lookahead && (A(m), 0 === m.lookahead)) {
                if (0 === F) return 1;
                break;
              }
              m.match_length = 0;
              r = ka._tr_tally(m, 0, m.window[m.strstart]);
              m.lookahead--;
              m.strstart++;
              if (r && (n(m, !1), 0 === m.strm.avail_out)) return 1;
            }
            m.insert = 0;
            return 4 === F
              ? (n(m, !0), 0 === m.strm.avail_out ? 3 : 4)
              : m.last_lit && (n(m, !1), 0 === m.strm.avail_out)
              ? 1
              : 2;
          }
          function U(m, F, r, y, D) {
            this.good_length = m;
            this.max_lazy = F;
            this.nice_length = r;
            this.max_chain = y;
            this.func = D;
          }
          function ha() {
            this.strm = null;
            this.status = 0;
            this.pending_buf = null;
            this.wrap =
              this.pending =
              this.pending_out =
              this.pending_buf_size =
                0;
            this.gzhead = null;
            this.gzindex = 0;
            this.method = 8;
            this.last_flush = -1;
            this.w_mask = this.w_bits = this.w_size = 0;
            this.window = null;
            this.window_size = 0;
            this.head = this.prev = null;
            this.nice_match =
              this.good_match =
              this.strategy =
              this.level =
              this.max_lazy_match =
              this.max_chain_length =
              this.prev_length =
              this.lookahead =
              this.match_start =
              this.strstart =
              this.match_available =
              this.prev_match =
              this.match_length =
              this.block_start =
              this.hash_shift =
              this.hash_mask =
              this.hash_bits =
              this.hash_size =
              this.ins_h =
                0;
            this.dyn_ltree = new T.Buf16(1146);
            this.dyn_dtree = new T.Buf16(122);
            this.bl_tree = new T.Buf16(78);
            g(this.dyn_ltree);
            g(this.dyn_dtree);
            g(this.bl_tree);
            this.bl_desc = this.d_desc = this.l_desc = null;
            this.bl_count = new T.Buf16(16);
            this.heap = new T.Buf16(573);
            g(this.heap);
            this.heap_max = this.heap_len = 0;
            this.depth = new T.Buf16(573);
            g(this.depth);
            this.bi_valid =
              this.bi_buf =
              this.insert =
              this.matches =
              this.static_len =
              this.opt_len =
              this.d_buf =
              this.last_lit =
              this.lit_bufsize =
              this.l_buf =
                0;
          }
          function w(m) {
            if (!m || !m.state) return d(m, -2);
            m.total_in = m.total_out = 0;
            m.data_type = 2;
            var F = m.state;
            F.pending = 0;
            F.pending_out = 0;
            0 > F.wrap && (F.wrap = -F.wrap);
            F.status = F.wrap ? 42 : 113;
            m.adler = 2 === F.wrap ? 0 : 1;
            F.last_flush = 0;
            ka._tr_init(F);
            return 0;
          }
          function I(m) {
            var F = w(m);
            0 === F &&
              ((m = m.state),
              (m.window_size = 2 * m.w_size),
              g(m.head),
              (m.max_lazy_match = p[m.level].max_lazy),
              (m.good_match = p[m.level].good_length),
              (m.nice_match = p[m.level].nice_length),
              (m.max_chain_length = p[m.level].max_chain),
              (m.strstart = 0),
              (m.block_start = 0),
              (m.lookahead = 0),
              (m.insert = 0),
              (m.match_length = m.prev_length = 2),
              (m.match_available = 0),
              (m.ins_h = 0));
            return F;
          }
          function aa(m, F, r, y, D, B) {
            if (!m) return -2;
            var C = 1;
            -1 === F && (F = 6);
            0 > y ? ((C = 0), (y = -y)) : 15 < y && ((C = 2), (y -= 16));
            if (
              1 > D ||
              9 < D ||
              8 !== r ||
              8 > y ||
              15 < y ||
              0 > F ||
              9 < F ||
              0 > B ||
              4 < B
            )
              return d(m, -2);
            8 === y && (y = 9);
            var L = new ha();
            m.state = L;
            L.strm = m;
            L.wrap = C;
            L.gzhead = null;
            L.w_bits = y;
            L.w_size = 1 << L.w_bits;
            L.w_mask = L.w_size - 1;
            L.hash_bits = D + 7;
            L.hash_size = 1 << L.hash_bits;
            L.hash_mask = L.hash_size - 1;
            L.hash_shift = ~~((L.hash_bits + 3 - 1) / 3);
            L.window = new T.Buf8(2 * L.w_size);
            L.head = new T.Buf16(L.hash_size);
            L.prev = new T.Buf16(L.w_size);
            L.lit_bufsize = 1 << (D + 6);
            L.pending_buf_size = 4 * L.lit_bufsize;
            L.pending_buf = new T.Buf8(L.pending_buf_size);
            L.d_buf = L.lit_bufsize >> 1;
            L.l_buf = 3 * L.lit_bufsize;
            L.level = F;
            L.strategy = B;
            L.method = r;
            return I(m);
          }
          var T = b("../utils/common"),
            ka = b("./trees"),
            k = b("./adler32"),
            X = b("./crc32"),
            V = b("./messages");
          var p = [
            new U(0, 0, 0, 0, function (m, F) {
              var r = 65535;
              for (
                r > m.pending_buf_size - 5 && (r = m.pending_buf_size - 5);
                ;

              ) {
                if (1 >= m.lookahead) {
                  A(m);
                  if (0 === m.lookahead && 0 === F) return 1;
                  if (0 === m.lookahead) break;
                }
                m.strstart += m.lookahead;
                m.lookahead = 0;
                var y = m.block_start + r;
                if (0 === m.strstart || m.strstart >= y)
                  if (
                    ((m.lookahead = m.strstart - y),
                    (m.strstart = y),
                    n(m, !1),
                    0 === m.strm.avail_out)
                  )
                    return 1;
                if (
                  m.strstart - m.block_start >= m.w_size - 262 &&
                  (n(m, !1), 0 === m.strm.avail_out)
                )
                  return 1;
              }
              m.insert = 0;
              if (4 === F) return n(m, !0), 0 === m.strm.avail_out ? 3 : 4;
              m.strstart > m.block_start && n(m, !1);
              return 1;
            }),
            new U(4, 4, 8, 4, G),
            new U(4, 5, 16, 8, G),
            new U(4, 6, 32, 32, G),
            new U(4, 4, 16, 16, O),
            new U(8, 16, 32, 32, O),
            new U(8, 16, 128, 128, O),
            new U(8, 32, 128, 256, O),
            new U(32, 128, 258, 1024, O),
            new U(32, 258, 258, 4096, O),
          ];
          e.deflateInit = function (m, F) {
            return aa(m, F, 8, 15, 8, 0);
          };
          e.deflateInit2 = aa;
          e.deflateReset = I;
          e.deflateResetKeep = w;
          e.deflateSetHeader = function (m, F) {
            if (!m || !m.state || 2 !== m.state.wrap) return -2;
            m.state.gzhead = F;
            return 0;
          };
          e.deflate = function (m, F) {
            if (!m || !m.state || 5 < F || 0 > F) return m ? d(m, -2) : -2;
            var r = m.state;
            if (
              !m.output ||
              (!m.input && 0 !== m.avail_in) ||
              (666 === r.status && 4 !== F)
            )
              return d(m, 0 === m.avail_out ? -5 : -2);
            r.strm = m;
            var y = r.last_flush;
            r.last_flush = F;
            if (42 === r.status)
              if (2 === r.wrap)
                (m.adler = 0),
                  q(r, 31),
                  q(r, 139),
                  q(r, 8),
                  r.gzhead
                    ? (q(
                        r,
                        (r.gzhead.text ? 1 : 0) +
                          (r.gzhead.hcrc ? 2 : 0) +
                          (r.gzhead.extra ? 4 : 0) +
                          (r.gzhead.name ? 8 : 0) +
                          (r.gzhead.comment ? 16 : 0)
                      ),
                      q(r, r.gzhead.time & 255),
                      q(r, (r.gzhead.time >> 8) & 255),
                      q(r, (r.gzhead.time >> 16) & 255),
                      q(r, (r.gzhead.time >> 24) & 255),
                      q(
                        r,
                        9 === r.level
                          ? 2
                          : 2 <= r.strategy || 2 > r.level
                          ? 4
                          : 0
                      ),
                      q(r, r.gzhead.os & 255),
                      r.gzhead.extra &&
                        r.gzhead.extra.length &&
                        (q(r, r.gzhead.extra.length & 255),
                        q(r, (r.gzhead.extra.length >> 8) & 255)),
                      r.gzhead.hcrc &&
                        (m.adler = X(m.adler, r.pending_buf, r.pending, 0)),
                      (r.gzindex = 0),
                      (r.status = 69))
                    : (q(r, 0),
                      q(r, 0),
                      q(r, 0),
                      q(r, 0),
                      q(r, 0),
                      q(
                        r,
                        9 === r.level
                          ? 2
                          : 2 <= r.strategy || 2 > r.level
                          ? 4
                          : 0
                      ),
                      q(r, 3),
                      (r.status = 113));
              else {
                var D = (8 + ((r.w_bits - 8) << 4)) << 8;
                D |=
                  (2 <= r.strategy || 2 > r.level
                    ? 0
                    : 6 > r.level
                    ? 1
                    : 6 === r.level
                    ? 2
                    : 3) << 6;
                0 !== r.strstart && (D |= 32);
                r.status = 113;
                t(r, D + (31 - (D % 31)));
                0 !== r.strstart &&
                  (t(r, m.adler >>> 16), t(r, m.adler & 65535));
                m.adler = 1;
              }
            if (69 === r.status)
              if (r.gzhead.extra) {
                for (
                  D = r.pending;
                  r.gzindex < (r.gzhead.extra.length & 65535) &&
                  (r.pending !== r.pending_buf_size ||
                    (r.gzhead.hcrc &&
                      r.pending > D &&
                      (m.adler = X(m.adler, r.pending_buf, r.pending - D, D)),
                    h(m),
                    (D = r.pending),
                    r.pending !== r.pending_buf_size));

                )
                  q(r, r.gzhead.extra[r.gzindex] & 255), r.gzindex++;
                r.gzhead.hcrc &&
                  r.pending > D &&
                  (m.adler = X(m.adler, r.pending_buf, r.pending - D, D));
                r.gzindex === r.gzhead.extra.length &&
                  ((r.gzindex = 0), (r.status = 73));
              } else r.status = 73;
            if (73 === r.status)
              if (r.gzhead.name) {
                D = r.pending;
                do {
                  if (
                    r.pending === r.pending_buf_size &&
                    (r.gzhead.hcrc &&
                      r.pending > D &&
                      (m.adler = X(m.adler, r.pending_buf, r.pending - D, D)),
                    h(m),
                    (D = r.pending),
                    r.pending === r.pending_buf_size)
                  ) {
                    var B = 1;
                    break;
                  }
                  B =
                    r.gzindex < r.gzhead.name.length
                      ? r.gzhead.name.charCodeAt(r.gzindex++) & 255
                      : 0;
                  q(r, B);
                } while (0 !== B);
                r.gzhead.hcrc &&
                  r.pending > D &&
                  (m.adler = X(m.adler, r.pending_buf, r.pending - D, D));
                0 === B && ((r.gzindex = 0), (r.status = 91));
              } else r.status = 91;
            if (91 === r.status)
              if (r.gzhead.comment) {
                D = r.pending;
                do {
                  if (
                    r.pending === r.pending_buf_size &&
                    (r.gzhead.hcrc &&
                      r.pending > D &&
                      (m.adler = X(m.adler, r.pending_buf, r.pending - D, D)),
                    h(m),
                    (D = r.pending),
                    r.pending === r.pending_buf_size)
                  ) {
                    B = 1;
                    break;
                  }
                  B =
                    r.gzindex < r.gzhead.comment.length
                      ? r.gzhead.comment.charCodeAt(r.gzindex++) & 255
                      : 0;
                  q(r, B);
                } while (0 !== B);
                r.gzhead.hcrc &&
                  r.pending > D &&
                  (m.adler = X(m.adler, r.pending_buf, r.pending - D, D));
                0 === B && (r.status = 103);
              } else r.status = 103;
            103 === r.status &&
              (r.gzhead.hcrc
                ? (r.pending + 2 > r.pending_buf_size && h(m),
                  r.pending + 2 <= r.pending_buf_size &&
                    (q(r, m.adler & 255),
                    q(r, (m.adler >> 8) & 255),
                    (m.adler = 0),
                    (r.status = 113)))
                : (r.status = 113));
            if (0 !== r.pending) {
              if ((h(m), 0 === m.avail_out)) return (r.last_flush = -1), 0;
            } else if (
              0 === m.avail_in &&
              (F << 1) - (4 < F ? 9 : 0) <= (y << 1) - (4 < y ? 9 : 0) &&
              4 !== F
            )
              return d(m, -5);
            if (666 === r.status && 0 !== m.avail_in) return d(m, -5);
            if (
              0 !== m.avail_in ||
              0 !== r.lookahead ||
              (0 !== F && 666 !== r.status)
            ) {
              y =
                2 === r.strategy
                  ? P(r, F)
                  : 3 === r.strategy
                  ? H(r, F)
                  : p[r.level].func(r, F);
              if (3 === y || 4 === y) r.status = 666;
              if (1 === y || 3 === y)
                return 0 === m.avail_out && (r.last_flush = -1), 0;
              if (
                2 === y &&
                (1 === F
                  ? ka._tr_align(r)
                  : 5 !== F &&
                    (ka._tr_stored_block(r, 0, 0, !1),
                    3 === F &&
                      (g(r.head),
                      0 === r.lookahead &&
                        ((r.strstart = 0),
                        (r.block_start = 0),
                        (r.insert = 0)))),
                h(m),
                0 === m.avail_out)
              )
                return (r.last_flush = -1), 0;
            }
            if (4 !== F) return 0;
            if (0 >= r.wrap) return 1;
            2 === r.wrap
              ? (q(r, m.adler & 255),
                q(r, (m.adler >> 8) & 255),
                q(r, (m.adler >> 16) & 255),
                q(r, (m.adler >> 24) & 255),
                q(r, m.total_in & 255),
                q(r, (m.total_in >> 8) & 255),
                q(r, (m.total_in >> 16) & 255),
                q(r, (m.total_in >> 24) & 255))
              : (t(r, m.adler >>> 16), t(r, m.adler & 65535));
            h(m);
            0 < r.wrap && (r.wrap = -r.wrap);
            return 0 !== r.pending ? 0 : 1;
          };
          e.deflateEnd = function (m) {
            if (!m || !m.state) return -2;
            var F = m.state.status;
            if (
              42 !== F &&
              69 !== F &&
              73 !== F &&
              91 !== F &&
              103 !== F &&
              113 !== F &&
              666 !== F
            )
              return d(m, -2);
            m.state = null;
            return 113 === F ? d(m, -3) : 0;
          };
          e.deflateInfo = "pako deflate (from Nodeca project)";
        },
        {
          "../utils/common": 30,
          "./adler32": 32,
          "./crc32": 34,
          "./messages": 40,
          "./trees": 41,
        },
      ],
      36: [
        function (b, c, e) {
          c.exports = function () {
            this.os = this.xflags = this.time = this.text = 0;
            this.extra = null;
            this.extra_len = 0;
            this.comment = this.name = "";
            this.hcrc = 0;
            this.done = !1;
          };
        },
        {},
      ],
      37: [
        function (b, c, e) {
          c.exports = function (d, g) {
            var h = d.state;
            var n = d.next_in;
            var q = d.input;
            var t = n + (d.avail_in - 5);
            var u = d.next_out;
            var A = d.output;
            g = u - (g - d.avail_out);
            var G = u + (d.avail_out - 257);
            var O = h.dmax;
            var H = h.wsize;
            var P = h.whave;
            var U = h.wnext;
            var ha = h.window;
            var w = h.hold;
            var I = h.bits;
            var aa = h.lencode;
            var T = h.distcode;
            var ka = (1 << h.lenbits) - 1;
            var k = (1 << h.distbits) - 1;
            a: do {
              15 > I &&
                ((w += q[n++] << I), (I += 8), (w += q[n++] << I), (I += 8));
              var X = aa[w & ka];
              b: for (;;) {
                var V = X >>> 24;
                w >>>= V;
                I -= V;
                V = (X >>> 16) & 255;
                if (0 === V) A[u++] = X & 65535;
                else if (V & 16) {
                  var p = X & 65535;
                  if ((V &= 15))
                    I < V && ((w += q[n++] << I), (I += 8)),
                      (p += w & ((1 << V) - 1)),
                      (w >>>= V),
                      (I -= V);
                  15 > I &&
                    ((w += q[n++] << I),
                    (I += 8),
                    (w += q[n++] << I),
                    (I += 8));
                  X = T[w & k];
                  c: for (;;) {
                    V = X >>> 24;
                    w >>>= V;
                    I -= V;
                    V = (X >>> 16) & 255;
                    if (V & 16) {
                      X &= 65535;
                      V &= 15;
                      I < V &&
                        ((w += q[n++] << I),
                        (I += 8),
                        I < V && ((w += q[n++] << I), (I += 8)));
                      X += w & ((1 << V) - 1);
                      if (X > O) {
                        d.msg = "invalid distance too far back";
                        h.mode = 30;
                        break a;
                      }
                      w >>>= V;
                      I -= V;
                      V = u - g;
                      if (X > V) {
                        V = X - V;
                        if (V > P && h.sane) {
                          d.msg = "invalid distance too far back";
                          h.mode = 30;
                          break a;
                        }
                        var m = 0;
                        var F = ha;
                        if (0 === U) {
                          if (((m += H - V), V < p)) {
                            p -= V;
                            do A[u++] = ha[m++];
                            while (--V);
                            m = u - X;
                            F = A;
                          }
                        } else if (U < V) {
                          if (((m += H + U - V), (V -= U), V < p)) {
                            p -= V;
                            do A[u++] = ha[m++];
                            while (--V);
                            m = 0;
                            if (U < p) {
                              V = U;
                              p -= V;
                              do A[u++] = ha[m++];
                              while (--V);
                              m = u - X;
                              F = A;
                            }
                          }
                        } else if (((m += U - V), V < p)) {
                          p -= V;
                          do A[u++] = ha[m++];
                          while (--V);
                          m = u - X;
                          F = A;
                        }
                        for (; 2 < p; )
                          (A[u++] = F[m++]),
                            (A[u++] = F[m++]),
                            (A[u++] = F[m++]),
                            (p -= 3);
                        p && ((A[u++] = F[m++]), 1 < p && (A[u++] = F[m++]));
                      } else {
                        m = u - X;
                        do
                          (A[u++] = A[m++]),
                            (A[u++] = A[m++]),
                            (A[u++] = A[m++]),
                            (p -= 3);
                        while (2 < p);
                        p && ((A[u++] = A[m++]), 1 < p && (A[u++] = A[m++]));
                      }
                    } else if (0 === (V & 64)) {
                      X = T[(X & 65535) + (w & ((1 << V) - 1))];
                      continue c;
                    } else {
                      d.msg = "invalid distance code";
                      h.mode = 30;
                      break a;
                    }
                    break;
                  }
                } else if (0 === (V & 64)) {
                  X = aa[(X & 65535) + (w & ((1 << V) - 1))];
                  continue b;
                } else {
                  V & 32
                    ? (h.mode = 12)
                    : ((d.msg = "invalid literal/length code"), (h.mode = 30));
                  break a;
                }
                break;
              }
            } while (n < t && u < G);
            p = I >> 3;
            n -= p;
            I -= p << 3;
            d.next_in = n;
            d.next_out = u;
            d.avail_in = n < t ? 5 + (t - n) : 5 - (n - t);
            d.avail_out = u < G ? 257 + (G - u) : 257 - (u - G);
            h.hold = w & ((1 << I) - 1);
            h.bits = I;
          };
        },
        {},
      ],
      38: [
        function (b, c, e) {
          function d(w) {
            return (
              ((w >>> 24) & 255) +
              ((w >>> 8) & 65280) +
              ((w & 65280) << 8) +
              ((w & 255) << 24)
            );
          }
          function g() {
            this.mode = 0;
            this.last = !1;
            this.wrap = 0;
            this.havedict = !1;
            this.total = this.check = this.dmax = this.flags = 0;
            this.head = null;
            this.wnext = this.whave = this.wsize = this.wbits = 0;
            this.window = null;
            this.extra = this.offset = this.length = this.bits = this.hold = 0;
            this.distcode = this.lencode = null;
            this.have =
              this.ndist =
              this.nlen =
              this.ncode =
              this.distbits =
              this.lenbits =
                0;
            this.next = null;
            this.lens = new u.Buf16(320);
            this.work = new u.Buf16(288);
            this.distdyn = this.lendyn = null;
            this.was = this.back = this.sane = 0;
          }
          function h(w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            w.total_in = w.total_out = I.total = 0;
            w.msg = "";
            I.wrap && (w.adler = I.wrap & 1);
            I.mode = 1;
            I.last = 0;
            I.havedict = 0;
            I.dmax = 32768;
            I.head = null;
            I.hold = 0;
            I.bits = 0;
            I.lencode = I.lendyn = new u.Buf32(852);
            I.distcode = I.distdyn = new u.Buf32(592);
            I.sane = 1;
            I.back = -1;
            return 0;
          }
          function n(w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            I.wsize = 0;
            I.whave = 0;
            I.wnext = 0;
            return h(w);
          }
          function q(w, I) {
            if (!w || !w.state) return -2;
            var aa = w.state;
            if (0 > I) {
              var T = 0;
              I = -I;
            } else (T = (I >> 4) + 1), 48 > I && (I &= 15);
            if (I && (8 > I || 15 < I)) return -2;
            null !== aa.window && aa.wbits !== I && (aa.window = null);
            aa.wrap = T;
            aa.wbits = I;
            return n(w);
          }
          function t(w, I) {
            if (!w) return -2;
            var aa = new g();
            w.state = aa;
            aa.window = null;
            I = q(w, I);
            0 !== I && (w.state = null);
            return I;
          }
          var u = b("../utils/common"),
            A = b("./adler32"),
            G = b("./crc32"),
            O = b("./inffast"),
            H = b("./inftrees"),
            P = !0,
            U,
            ha;
          e.inflateReset = n;
          e.inflateReset2 = q;
          e.inflateResetKeep = h;
          e.inflateInit = function (w) {
            return t(w, 15);
          };
          e.inflateInit2 = t;
          e.inflate = function (w, I) {
            var aa,
              T = new u.Buf8(4),
              ka = [
                16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1,
                15,
              ];
            if (!w || !w.state || !w.output || (!w.input && 0 !== w.avail_in))
              return -2;
            var k = w.state;
            12 === k.mode && (k.mode = 13);
            var X = w.next_out;
            var V = w.output;
            var p = w.avail_out;
            var m = w.next_in;
            var F = w.input;
            var r = w.avail_in;
            var y = k.hold;
            var D = k.bits;
            var B = r;
            var C = p;
            var L = 0;
            a: for (;;)
              switch (k.mode) {
                case 1:
                  if (0 === k.wrap) {
                    k.mode = 13;
                    break;
                  }
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (k.wrap & 2 && 35615 === y) {
                    k.check = 0;
                    T[0] = y & 255;
                    T[1] = (y >>> 8) & 255;
                    k.check = G(k.check, T, 2, 0);
                    D = y = 0;
                    k.mode = 2;
                    break;
                  }
                  k.flags = 0;
                  k.head && (k.head.done = !1);
                  if (!(k.wrap & 1) || (((y & 255) << 8) + (y >> 8)) % 31) {
                    w.msg = "incorrect header check";
                    k.mode = 30;
                    break;
                  }
                  if (8 !== (y & 15)) {
                    w.msg = "unknown compression method";
                    k.mode = 30;
                    break;
                  }
                  y >>>= 4;
                  D -= 4;
                  var N = (y & 15) + 8;
                  if (0 === k.wbits) k.wbits = N;
                  else if (N > k.wbits) {
                    w.msg = "invalid window size";
                    k.mode = 30;
                    break;
                  }
                  k.dmax = 1 << N;
                  w.adler = k.check = 1;
                  k.mode = y & 512 ? 10 : 12;
                  D = y = 0;
                  break;
                case 2:
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.flags = y;
                  if (8 !== (k.flags & 255)) {
                    w.msg = "unknown compression method";
                    k.mode = 30;
                    break;
                  }
                  if (k.flags & 57344) {
                    w.msg = "unknown header flags set";
                    k.mode = 30;
                    break;
                  }
                  k.head && (k.head.text = (y >> 8) & 1);
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (k.check = G(k.check, T, 2, 0)));
                  D = y = 0;
                  k.mode = 3;
                case 3:
                  for (; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.head && (k.head.time = y);
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (T[2] = (y >>> 16) & 255),
                    (T[3] = (y >>> 24) & 255),
                    (k.check = G(k.check, T, 4, 0)));
                  D = y = 0;
                  k.mode = 4;
                case 4:
                  for (; 16 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.head && ((k.head.xflags = y & 255), (k.head.os = y >> 8));
                  k.flags & 512 &&
                    ((T[0] = y & 255),
                    (T[1] = (y >>> 8) & 255),
                    (k.check = G(k.check, T, 2, 0)));
                  D = y = 0;
                  k.mode = 5;
                case 5:
                  if (k.flags & 1024) {
                    for (; 16 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.length = y;
                    k.head && (k.head.extra_len = y);
                    k.flags & 512 &&
                      ((T[0] = y & 255),
                      (T[1] = (y >>> 8) & 255),
                      (k.check = G(k.check, T, 2, 0)));
                    D = y = 0;
                  } else k.head && (k.head.extra = null);
                  k.mode = 6;
                case 6:
                  if (k.flags & 1024) {
                    var K = k.length;
                    K > r && (K = r);
                    K &&
                      (k.head &&
                        ((N = k.head.extra_len - k.length),
                        k.head.extra ||
                          (k.head.extra = Array(k.head.extra_len)),
                        u.arraySet(k.head.extra, F, m, K, N)),
                      k.flags & 512 && (k.check = G(k.check, F, K, m)),
                      (r -= K),
                      (m += K),
                      (k.length -= K));
                    if (k.length) break a;
                  }
                  k.length = 0;
                  k.mode = 7;
                case 7:
                  if (k.flags & 2048) {
                    if (0 === r) break a;
                    K = 0;
                    do
                      (N = F[m + K++]),
                        k.head &&
                          N &&
                          65536 > k.length &&
                          (k.head.name += String.fromCharCode(N));
                    while (N && K < r);
                    k.flags & 512 && (k.check = G(k.check, F, K, m));
                    r -= K;
                    m += K;
                    if (N) break a;
                  } else k.head && (k.head.name = null);
                  k.length = 0;
                  k.mode = 8;
                case 8:
                  if (k.flags & 4096) {
                    if (0 === r) break a;
                    K = 0;
                    do
                      (N = F[m + K++]),
                        k.head &&
                          N &&
                          65536 > k.length &&
                          (k.head.comment += String.fromCharCode(N));
                    while (N && K < r);
                    k.flags & 512 && (k.check = G(k.check, F, K, m));
                    r -= K;
                    m += K;
                    if (N) break a;
                  } else k.head && (k.head.comment = null);
                  k.mode = 9;
                case 9:
                  if (k.flags & 512) {
                    for (; 16 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (y !== (k.check & 65535)) {
                      w.msg = "header crc mismatch";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.head &&
                    ((k.head.hcrc = (k.flags >> 9) & 1), (k.head.done = !0));
                  w.adler = k.check = 0;
                  k.mode = 12;
                  break;
                case 10:
                  for (; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  w.adler = k.check = d(y);
                  D = y = 0;
                  k.mode = 11;
                case 11:
                  if (0 === k.havedict)
                    return (
                      (w.next_out = X),
                      (w.avail_out = p),
                      (w.next_in = m),
                      (w.avail_in = r),
                      (k.hold = y),
                      (k.bits = D),
                      2
                    );
                  w.adler = k.check = 1;
                  k.mode = 12;
                case 12:
                  if (5 === I || 6 === I) break a;
                case 13:
                  if (k.last) {
                    y >>>= D & 7;
                    D -= D & 7;
                    k.mode = 27;
                    break;
                  }
                  for (; 3 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.last = y & 1;
                  y >>>= 1;
                  --D;
                  switch (y & 3) {
                    case 0:
                      k.mode = 14;
                      break;
                    case 1:
                      N = k;
                      if (P) {
                        U = new u.Buf32(512);
                        ha = new u.Buf32(32);
                        for (K = 0; 144 > K; ) N.lens[K++] = 8;
                        for (; 256 > K; ) N.lens[K++] = 9;
                        for (; 280 > K; ) N.lens[K++] = 7;
                        for (; 288 > K; ) N.lens[K++] = 8;
                        H(1, N.lens, 0, 288, U, 0, N.work, { bits: 9 });
                        for (K = 0; 32 > K; ) N.lens[K++] = 5;
                        H(2, N.lens, 0, 32, ha, 0, N.work, { bits: 5 });
                        P = !1;
                      }
                      N.lencode = U;
                      N.lenbits = 9;
                      N.distcode = ha;
                      N.distbits = 5;
                      k.mode = 20;
                      if (6 === I) {
                        y >>>= 2;
                        D -= 2;
                        break a;
                      }
                      break;
                    case 2:
                      k.mode = 17;
                      break;
                    case 3:
                      (w.msg = "invalid block type"), (k.mode = 30);
                  }
                  y >>>= 2;
                  D -= 2;
                  break;
                case 14:
                  y >>>= D & 7;
                  for (D -= D & 7; 32 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if ((y & 65535) !== ((y >>> 16) ^ 65535)) {
                    w.msg = "invalid stored block lengths";
                    k.mode = 30;
                    break;
                  }
                  k.length = y & 65535;
                  D = y = 0;
                  k.mode = 15;
                  if (6 === I) break a;
                case 15:
                  k.mode = 16;
                case 16:
                  if ((K = k.length)) {
                    K > r && (K = r);
                    K > p && (K = p);
                    if (0 === K) break a;
                    u.arraySet(V, F, m, K, X);
                    r -= K;
                    m += K;
                    p -= K;
                    X += K;
                    k.length -= K;
                    break;
                  }
                  k.mode = 12;
                  break;
                case 17:
                  for (; 14 > D; ) {
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  k.nlen = (y & 31) + 257;
                  y >>>= 5;
                  D -= 5;
                  k.ndist = (y & 31) + 1;
                  y >>>= 5;
                  D -= 5;
                  k.ncode = (y & 15) + 4;
                  y >>>= 4;
                  D -= 4;
                  if (286 < k.nlen || 30 < k.ndist) {
                    w.msg = "too many length or distance symbols";
                    k.mode = 30;
                    break;
                  }
                  k.have = 0;
                  k.mode = 18;
                case 18:
                  for (; k.have < k.ncode; ) {
                    for (; 3 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.lens[ka[k.have++]] = y & 7;
                    y >>>= 3;
                    D -= 3;
                  }
                  for (; 19 > k.have; ) k.lens[ka[k.have++]] = 0;
                  k.lencode = k.lendyn;
                  k.lenbits = 7;
                  K = { bits: k.lenbits };
                  L = H(0, k.lens, 0, 19, k.lencode, 0, k.work, K);
                  k.lenbits = K.bits;
                  if (L) {
                    w.msg = "invalid code lengths set";
                    k.mode = 30;
                    break;
                  }
                  k.have = 0;
                  k.mode = 19;
                case 19:
                  for (; k.have < k.nlen + k.ndist; ) {
                    for (;;) {
                      var z = k.lencode[y & ((1 << k.lenbits) - 1)];
                      K = z >>> 24;
                      z &= 65535;
                      if (K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (16 > z) (y >>>= K), (D -= K), (k.lens[k.have++] = z);
                    else {
                      if (16 === z) {
                        for (N = K + 2; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        if (0 === k.have) {
                          w.msg = "invalid bit length repeat";
                          k.mode = 30;
                          break;
                        }
                        N = k.lens[k.have - 1];
                        K = 3 + (y & 3);
                        y >>>= 2;
                        D -= 2;
                      } else if (17 === z) {
                        for (N = K + 3; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        N = 0;
                        K = 3 + (y & 7);
                        y >>>= 3;
                        D -= 3;
                      } else {
                        for (N = K + 7; D < N; ) {
                          if (0 === r) break a;
                          r--;
                          y += F[m++] << D;
                          D += 8;
                        }
                        y >>>= K;
                        D -= K;
                        N = 0;
                        K = 11 + (y & 127);
                        y >>>= 7;
                        D -= 7;
                      }
                      if (k.have + K > k.nlen + k.ndist) {
                        w.msg = "invalid bit length repeat";
                        k.mode = 30;
                        break;
                      }
                      for (; K--; ) k.lens[k.have++] = N;
                    }
                  }
                  if (30 === k.mode) break;
                  if (0 === k.lens[256]) {
                    w.msg = "invalid code -- missing end-of-block";
                    k.mode = 30;
                    break;
                  }
                  k.lenbits = 9;
                  K = { bits: k.lenbits };
                  L = H(1, k.lens, 0, k.nlen, k.lencode, 0, k.work, K);
                  k.lenbits = K.bits;
                  if (L) {
                    w.msg = "invalid literal/lengths set";
                    k.mode = 30;
                    break;
                  }
                  k.distbits = 6;
                  k.distcode = k.distdyn;
                  K = { bits: k.distbits };
                  L = H(2, k.lens, k.nlen, k.ndist, k.distcode, 0, k.work, K);
                  k.distbits = K.bits;
                  if (L) {
                    w.msg = "invalid distances set";
                    k.mode = 30;
                    break;
                  }
                  k.mode = 20;
                  if (6 === I) break a;
                case 20:
                  k.mode = 21;
                case 21:
                  if (6 <= r && 258 <= p) {
                    w.next_out = X;
                    w.avail_out = p;
                    w.next_in = m;
                    w.avail_in = r;
                    k.hold = y;
                    k.bits = D;
                    O(w, C);
                    X = w.next_out;
                    V = w.output;
                    p = w.avail_out;
                    m = w.next_in;
                    F = w.input;
                    r = w.avail_in;
                    y = k.hold;
                    D = k.bits;
                    12 === k.mode && (k.back = -1);
                    break;
                  }
                  for (k.back = 0; ; ) {
                    z = k.lencode[y & ((1 << k.lenbits) - 1)];
                    K = z >>> 24;
                    N = (z >>> 16) & 255;
                    z &= 65535;
                    if (K <= D) break;
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (N && 0 === (N & 240)) {
                    var R = K;
                    var ba = N;
                    for (aa = z; ; ) {
                      z = k.lencode[aa + ((y & ((1 << (R + ba)) - 1)) >> R)];
                      K = z >>> 24;
                      N = (z >>> 16) & 255;
                      z &= 65535;
                      if (R + K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    y >>>= R;
                    D -= R;
                    k.back += R;
                  }
                  y >>>= K;
                  D -= K;
                  k.back += K;
                  k.length = z;
                  if (0 === N) {
                    k.mode = 26;
                    break;
                  }
                  if (N & 32) {
                    k.back = -1;
                    k.mode = 12;
                    break;
                  }
                  if (N & 64) {
                    w.msg = "invalid literal/length code";
                    k.mode = 30;
                    break;
                  }
                  k.extra = N & 15;
                  k.mode = 22;
                case 22:
                  if (k.extra) {
                    for (N = k.extra; D < N; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.length += y & ((1 << k.extra) - 1);
                    y >>>= k.extra;
                    D -= k.extra;
                    k.back += k.extra;
                  }
                  k.was = k.length;
                  k.mode = 23;
                case 23:
                  for (;;) {
                    z = k.distcode[y & ((1 << k.distbits) - 1)];
                    K = z >>> 24;
                    N = (z >>> 16) & 255;
                    z &= 65535;
                    if (K <= D) break;
                    if (0 === r) break a;
                    r--;
                    y += F[m++] << D;
                    D += 8;
                  }
                  if (0 === (N & 240)) {
                    R = K;
                    ba = N;
                    for (aa = z; ; ) {
                      z = k.distcode[aa + ((y & ((1 << (R + ba)) - 1)) >> R)];
                      K = z >>> 24;
                      N = (z >>> 16) & 255;
                      z &= 65535;
                      if (R + K <= D) break;
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    y >>>= R;
                    D -= R;
                    k.back += R;
                  }
                  y >>>= K;
                  D -= K;
                  k.back += K;
                  if (N & 64) {
                    w.msg = "invalid distance code";
                    k.mode = 30;
                    break;
                  }
                  k.offset = z;
                  k.extra = N & 15;
                  k.mode = 24;
                case 24:
                  if (k.extra) {
                    for (N = k.extra; D < N; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    k.offset += y & ((1 << k.extra) - 1);
                    y >>>= k.extra;
                    D -= k.extra;
                    k.back += k.extra;
                  }
                  if (k.offset > k.dmax) {
                    w.msg = "invalid distance too far back";
                    k.mode = 30;
                    break;
                  }
                  k.mode = 25;
                case 25:
                  if (0 === p) break a;
                  K = C - p;
                  if (k.offset > K) {
                    K = k.offset - K;
                    if (K > k.whave && k.sane) {
                      w.msg = "invalid distance too far back";
                      k.mode = 30;
                      break;
                    }
                    K > k.wnext
                      ? ((K -= k.wnext), (N = k.wsize - K))
                      : (N = k.wnext - K);
                    K > k.length && (K = k.length);
                    R = k.window;
                  } else (R = V), (N = X - k.offset), (K = k.length);
                  K > p && (K = p);
                  p -= K;
                  k.length -= K;
                  do V[X++] = R[N++];
                  while (--K);
                  0 === k.length && (k.mode = 21);
                  break;
                case 26:
                  if (0 === p) break a;
                  V[X++] = k.length;
                  p--;
                  k.mode = 21;
                  break;
                case 27:
                  if (k.wrap) {
                    for (; 32 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y |= F[m++] << D;
                      D += 8;
                    }
                    C -= p;
                    w.total_out += C;
                    k.total += C;
                    C &&
                      (w.adler = k.check =
                        k.flags
                          ? G(k.check, V, C, X - C)
                          : A(k.check, V, C, X - C));
                    C = p;
                    if ((k.flags ? y : d(y)) !== k.check) {
                      w.msg = "incorrect data check";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.mode = 28;
                case 28:
                  if (k.wrap && k.flags) {
                    for (; 32 > D; ) {
                      if (0 === r) break a;
                      r--;
                      y += F[m++] << D;
                      D += 8;
                    }
                    if (y !== (k.total & 4294967295)) {
                      w.msg = "incorrect length check";
                      k.mode = 30;
                      break;
                    }
                    D = y = 0;
                  }
                  k.mode = 29;
                case 29:
                  L = 1;
                  break a;
                case 30:
                  L = -3;
                  break a;
                case 31:
                  return -4;
                default:
                  return -2;
              }
            w.next_out = X;
            w.avail_out = p;
            w.next_in = m;
            w.avail_in = r;
            k.hold = y;
            k.bits = D;
            if (
              k.wsize ||
              (C !== w.avail_out && 30 > k.mode && (27 > k.mode || 4 !== I))
            )
              (F = w.output),
                (m = w.next_out),
                (X = C - w.avail_out),
                (p = w.state),
                null === p.window &&
                  ((p.wsize = 1 << p.wbits),
                  (p.wnext = 0),
                  (p.whave = 0),
                  (p.window = new u.Buf8(p.wsize))),
                X >= p.wsize
                  ? (u.arraySet(p.window, F, m - p.wsize, p.wsize, 0),
                    (p.wnext = 0),
                    (p.whave = p.wsize))
                  : ((r = p.wsize - p.wnext),
                    r > X && (r = X),
                    u.arraySet(p.window, F, m - X, r, p.wnext),
                    (X -= r)
                      ? (u.arraySet(p.window, F, m - X, X, 0),
                        (p.wnext = X),
                        (p.whave = p.wsize))
                      : ((p.wnext += r),
                        p.wnext === p.wsize && (p.wnext = 0),
                        p.whave < p.wsize && (p.whave += r)));
            B -= w.avail_in;
            C -= w.avail_out;
            w.total_in += B;
            w.total_out += C;
            k.total += C;
            k.wrap &&
              C &&
              (w.adler = k.check =
                k.flags
                  ? G(k.check, V, C, w.next_out - C)
                  : A(k.check, V, C, w.next_out - C));
            w.data_type =
              k.bits +
              (k.last ? 64 : 0) +
              (12 === k.mode ? 128 : 0) +
              (20 === k.mode || 15 === k.mode ? 256 : 0);
            ((0 === B && 0 === C) || 4 === I) && 0 === L && (L = -5);
            return L;
          };
          e.inflateEnd = function (w) {
            if (!w || !w.state) return -2;
            var I = w.state;
            I.window && (I.window = null);
            w.state = null;
            return 0;
          };
          e.inflateGetHeader = function (w, I) {
            if (!w || !w.state) return -2;
            w = w.state;
            if (0 === (w.wrap & 2)) return -2;
            w.head = I;
            I.done = !1;
            return 0;
          };
          e.inflateInfo = "pako inflate (from Nodeca project)";
        },
        {
          "../utils/common": 30,
          "./adler32": 32,
          "./crc32": 34,
          "./inffast": 37,
          "./inftrees": 39,
        },
      ],
      39: [
        function (b, c, e) {
          var d = b("../utils/common"),
            g = [
              3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43,
              51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0,
            ],
            h = [
              16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18,
              19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78,
            ],
            n = [
              1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257,
              385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289,
              16385, 24577, 0, 0,
            ],
            q = [
              16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22,
              23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64,
            ];
          c.exports = function (t, u, A, G, O, H, P, U) {
            var ha = U.bits,
              w,
              I,
              aa,
              T,
              ka,
              k,
              X = 0,
              V = new d.Buf16(16);
            var p = new d.Buf16(16);
            var m,
              F = 0;
            for (w = 0; 15 >= w; w++) V[w] = 0;
            for (I = 0; I < G; I++) V[u[A + I]]++;
            var r = ha;
            for (aa = 15; 1 <= aa && 0 === V[aa]; aa--);
            r > aa && (r = aa);
            if (0 === aa)
              return (O[H++] = 20971520), (O[H++] = 20971520), (U.bits = 1), 0;
            for (ha = 1; ha < aa && 0 === V[ha]; ha++);
            r < ha && (r = ha);
            for (w = T = 1; 15 >= w; w++)
              if (((T <<= 1), (T -= V[w]), 0 > T)) return -1;
            if (0 < T && (0 === t || 1 !== aa)) return -1;
            p[1] = 0;
            for (w = 1; 15 > w; w++) p[w + 1] = p[w] + V[w];
            for (I = 0; I < G; I++) 0 !== u[A + I] && (P[p[u[A + I]]++] = I);
            if (0 === t) {
              var y = (m = P);
              var D = 19;
            } else
              1 === t
                ? ((y = g), (X -= 257), (m = h), (F -= 257), (D = 256))
                : ((y = n), (m = q), (D = -1));
            I = ka = 0;
            w = ha;
            var B = H;
            G = r;
            p = 0;
            var C = -1;
            var L = 1 << r;
            var N = L - 1;
            if ((1 === t && 852 < L) || (2 === t && 592 < L)) return 1;
            for (var K = 0; ; ) {
              K++;
              var z = w - p;
              if (P[I] < D) {
                var R = 0;
                var ba = P[I];
              } else
                P[I] > D
                  ? ((R = m[F + P[I]]), (ba = y[X + P[I]]))
                  : ((R = 96), (ba = 0));
              T = 1 << (w - p);
              ha = k = 1 << G;
              do
                (k -= T),
                  (O[B + (ka >> p) + k] = (z << 24) | (R << 16) | ba | 0);
              while (0 !== k);
              for (T = 1 << (w - 1); ka & T; ) T >>= 1;
              0 !== T ? ((ka &= T - 1), (ka += T)) : (ka = 0);
              I++;
              if (0 === --V[w]) {
                if (w === aa) break;
                w = u[A + P[I]];
              }
              if (w > r && (ka & N) !== C) {
                0 === p && (p = r);
                B += ha;
                G = w - p;
                for (T = 1 << G; G + p < aa; ) {
                  T -= V[G + p];
                  if (0 >= T) break;
                  G++;
                  T <<= 1;
                }
                L += 1 << G;
                if ((1 === t && 852 < L) || (2 === t && 592 < L)) return 1;
                C = ka & N;
                O[C] = (r << 24) | (G << 16) | (B - H) | 0;
              }
            }
            0 !== ka && (O[B + ka] = ((w - p) << 24) | 4194304);
            U.bits = r;
            return 0;
          };
        },
        { "../utils/common": 30 },
      ],
      40: [
        function (b, c, e) {
          c.exports = {
            2: "need dictionary",
            1: "stream end",
            0: "",
            "-1": "file error",
            "-2": "stream error",
            "-3": "data error",
            "-4": "insufficient memory",
            "-5": "buffer error",
            "-6": "incompatible version",
          };
        },
        {},
      ],
      41: [
        function (b, c, e) {
          function d(z) {
            for (var R = z.length; 0 <= --R; ) z[R] = 0;
          }
          function g(z, R, ba, S, ma) {
            this.static_tree = z;
            this.extra_bits = R;
            this.extra_base = ba;
            this.elems = S;
            this.max_length = ma;
            this.has_stree = z && z.length;
          }
          function h(z, R) {
            this.dyn_tree = z;
            this.max_code = 0;
            this.stat_desc = R;
          }
          function n(z, R) {
            z.pending_buf[z.pending++] = R & 255;
            z.pending_buf[z.pending++] = (R >>> 8) & 255;
          }
          function q(z, R, ba) {
            z.bi_valid > 16 - ba
              ? ((z.bi_buf |= (R << z.bi_valid) & 65535),
                n(z, z.bi_buf),
                (z.bi_buf = R >> (16 - z.bi_valid)),
                (z.bi_valid += ba - 16))
              : ((z.bi_buf |= (R << z.bi_valid) & 65535), (z.bi_valid += ba));
          }
          function t(z, R, ba) {
            q(z, ba[2 * R], ba[2 * R + 1]);
          }
          function u(z, R) {
            var ba = 0;
            do (ba |= z & 1), (z >>>= 1), (ba <<= 1);
            while (0 < --R);
            return ba >>> 1;
          }
          function A(z, R, ba) {
            var S = Array(16),
              ma = 0,
              Q;
            for (Q = 1; 15 >= Q; Q++) S[Q] = ma = (ma + ba[Q - 1]) << 1;
            for (ba = 0; ba <= R; ba++)
              (ma = z[2 * ba + 1]), 0 !== ma && (z[2 * ba] = u(S[ma]++, ma));
          }
          function G(z) {
            var R;
            for (R = 0; 286 > R; R++) z.dyn_ltree[2 * R] = 0;
            for (R = 0; 30 > R; R++) z.dyn_dtree[2 * R] = 0;
            for (R = 0; 19 > R; R++) z.bl_tree[2 * R] = 0;
            z.dyn_ltree[512] = 1;
            z.opt_len = z.static_len = 0;
            z.last_lit = z.matches = 0;
          }
          function O(z) {
            8 < z.bi_valid
              ? n(z, z.bi_buf)
              : 0 < z.bi_valid && (z.pending_buf[z.pending++] = z.bi_buf);
            z.bi_buf = 0;
            z.bi_valid = 0;
          }
          function H(z, R, ba, S) {
            var ma = 2 * R,
              Q = 2 * ba;
            return z[ma] < z[Q] || (z[ma] === z[Q] && S[R] <= S[ba]);
          }
          function P(z, R, ba) {
            for (var S = z.heap[ba], ma = ba << 1; ma <= z.heap_len; ) {
              ma < z.heap_len &&
                H(R, z.heap[ma + 1], z.heap[ma], z.depth) &&
                ma++;
              if (H(R, S, z.heap[ma], z.depth)) break;
              z.heap[ba] = z.heap[ma];
              ba = ma;
              ma <<= 1;
            }
            z.heap[ba] = S;
          }
          function U(z, R, ba) {
            var S = 0;
            if (0 !== z.last_lit) {
              do {
                var ma =
                  (z.pending_buf[z.d_buf + 2 * S] << 8) |
                  z.pending_buf[z.d_buf + 2 * S + 1];
                var Q = z.pending_buf[z.l_buf + S];
                S++;
                if (0 === ma) t(z, Q, R);
                else {
                  var ea = y[Q];
                  t(z, ea + 256 + 1, R);
                  var ca = k[ea];
                  0 !== ca && ((Q -= D[ea]), q(z, Q, ca));
                  ma--;
                  ea = 256 > ma ? r[ma] : r[256 + (ma >>> 7)];
                  t(z, ea, ba);
                  ca = X[ea];
                  0 !== ca && ((ma -= B[ea]), q(z, ma, ca));
                }
              } while (S < z.last_lit);
            }
            t(z, 256, R);
          }
          function ha(z, R) {
            var ba = R.dyn_tree,
              S = R.stat_desc.static_tree,
              ma = R.stat_desc.has_stree,
              Q = R.stat_desc.elems,
              ea,
              ca = -1;
            z.heap_len = 0;
            z.heap_max = 573;
            for (ea = 0; ea < Q; ea++)
              0 !== ba[2 * ea]
                ? ((z.heap[++z.heap_len] = ca = ea), (z.depth[ea] = 0))
                : (ba[2 * ea + 1] = 0);
            for (; 2 > z.heap_len; ) {
              var qa = (z.heap[++z.heap_len] = 2 > ca ? ++ca : 0);
              ba[2 * qa] = 1;
              z.depth[qa] = 0;
              z.opt_len--;
              ma && (z.static_len -= S[2 * qa + 1]);
            }
            R.max_code = ca;
            for (ea = z.heap_len >> 1; 1 <= ea; ea--) P(z, ba, ea);
            qa = Q;
            do
              (ea = z.heap[1]),
                (z.heap[1] = z.heap[z.heap_len--]),
                P(z, ba, 1),
                (S = z.heap[1]),
                (z.heap[--z.heap_max] = ea),
                (z.heap[--z.heap_max] = S),
                (ba[2 * qa] = ba[2 * ea] + ba[2 * S]),
                (z.depth[qa] =
                  (z.depth[ea] >= z.depth[S] ? z.depth[ea] : z.depth[S]) + 1),
                (ba[2 * ea + 1] = ba[2 * S + 1] = qa),
                (z.heap[1] = qa++),
                P(z, ba, 1);
            while (2 <= z.heap_len);
            z.heap[--z.heap_max] = z.heap[1];
            ea = R.dyn_tree;
            qa = R.max_code;
            S = R.stat_desc.static_tree;
            ma = R.stat_desc.has_stree;
            Q = R.stat_desc.extra_bits;
            var wa = R.stat_desc.extra_base,
              ya = R.stat_desc.max_length,
              ua,
              Ja = 0;
            for (ua = 0; 15 >= ua; ua++) z.bl_count[ua] = 0;
            ea[2 * z.heap[z.heap_max] + 1] = 0;
            for (R = z.heap_max + 1; 573 > R; R++) {
              var Ha = z.heap[R];
              ua = ea[2 * ea[2 * Ha + 1] + 1] + 1;
              ua > ya && ((ua = ya), Ja++);
              ea[2 * Ha + 1] = ua;
              if (!(Ha > qa)) {
                z.bl_count[ua]++;
                var cb = 0;
                Ha >= wa && (cb = Q[Ha - wa]);
                var kb = ea[2 * Ha];
                z.opt_len += kb * (ua + cb);
                ma && (z.static_len += kb * (S[2 * Ha + 1] + cb));
              }
            }
            if (0 !== Ja) {
              do {
                for (ua = ya - 1; 0 === z.bl_count[ua]; ) ua--;
                z.bl_count[ua]--;
                z.bl_count[ua + 1] += 2;
                z.bl_count[ya]--;
                Ja -= 2;
              } while (0 < Ja);
              for (ua = ya; 0 !== ua; ua--)
                for (Ha = z.bl_count[ua]; 0 !== Ha; )
                  (S = z.heap[--R]),
                    S > qa ||
                      (ea[2 * S + 1] !== ua &&
                        ((z.opt_len += (ua - ea[2 * S + 1]) * ea[2 * S]),
                        (ea[2 * S + 1] = ua)),
                      Ha--);
            }
            A(ba, ca, z.bl_count);
          }
          function w(z, R, ba) {
            var S,
              ma = -1,
              Q = R[1],
              ea = 0,
              ca = 7,
              qa = 4;
            0 === Q && ((ca = 138), (qa = 3));
            R[2 * (ba + 1) + 1] = 65535;
            for (S = 0; S <= ba; S++) {
              var wa = Q;
              Q = R[2 * (S + 1) + 1];
              (++ea < ca && wa === Q) ||
                (ea < qa
                  ? (z.bl_tree[2 * wa] += ea)
                  : 0 !== wa
                  ? (wa !== ma && z.bl_tree[2 * wa]++, z.bl_tree[32]++)
                  : 10 >= ea
                  ? z.bl_tree[34]++
                  : z.bl_tree[36]++,
                (ea = 0),
                (ma = wa),
                0 === Q
                  ? ((ca = 138), (qa = 3))
                  : wa === Q
                  ? ((ca = 6), (qa = 3))
                  : ((ca = 7), (qa = 4)));
            }
          }
          function I(z, R, ba) {
            var S,
              ma = -1,
              Q = R[1],
              ea = 0,
              ca = 7,
              qa = 4;
            0 === Q && ((ca = 138), (qa = 3));
            for (S = 0; S <= ba; S++) {
              var wa = Q;
              Q = R[2 * (S + 1) + 1];
              if (!(++ea < ca && wa === Q)) {
                if (ea < qa) {
                  do t(z, wa, z.bl_tree);
                  while (0 !== --ea);
                } else
                  0 !== wa
                    ? (wa !== ma && (t(z, wa, z.bl_tree), ea--),
                      t(z, 16, z.bl_tree),
                      q(z, ea - 3, 2))
                    : 10 >= ea
                    ? (t(z, 17, z.bl_tree), q(z, ea - 3, 3))
                    : (t(z, 18, z.bl_tree), q(z, ea - 11, 7));
                ea = 0;
                ma = wa;
                0 === Q
                  ? ((ca = 138), (qa = 3))
                  : wa === Q
                  ? ((ca = 6), (qa = 3))
                  : ((ca = 7), (qa = 4));
              }
            }
          }
          function aa(z) {
            var R = 4093624447,
              ba;
            for (ba = 0; 31 >= ba; ba++, R >>>= 1)
              if (R & 1 && 0 !== z.dyn_ltree[2 * ba]) return 0;
            if (
              0 !== z.dyn_ltree[18] ||
              0 !== z.dyn_ltree[20] ||
              0 !== z.dyn_ltree[26]
            )
              return 1;
            for (ba = 32; 256 > ba; ba++)
              if (0 !== z.dyn_ltree[2 * ba]) return 1;
            return 0;
          }
          function T(z, R, ba, S) {
            q(z, S ? 1 : 0, 3);
            O(z);
            n(z, ba);
            n(z, ~ba);
            ka.arraySet(z.pending_buf, z.window, R, ba, z.pending);
            z.pending += ba;
          }
          var ka = b("../utils/common"),
            k = [
              0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4,
              4, 4, 5, 5, 5, 5, 0,
            ],
            X = [
              0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9,
              10, 10, 11, 11, 12, 12, 13, 13,
            ],
            V = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7],
            p = [
              16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15,
            ],
            m = Array(576);
          d(m);
          var F = Array(60);
          d(F);
          var r = Array(512);
          d(r);
          var y = Array(256);
          d(y);
          var D = Array(29);
          d(D);
          var B = Array(30);
          d(B);
          var C,
            L,
            N,
            K = !1;
          e._tr_init = function (z) {
            if (!K) {
              var R,
                ba,
                S,
                ma = Array(16);
              for (S = ba = 0; 28 > S; S++)
                for (D[S] = ba, R = 0; R < 1 << k[S]; R++) y[ba++] = S;
              y[ba - 1] = S;
              for (S = ba = 0; 16 > S; S++)
                for (B[S] = ba, R = 0; R < 1 << X[S]; R++) r[ba++] = S;
              for (ba >>= 7; 30 > S; S++)
                for (B[S] = ba << 7, R = 0; R < 1 << (X[S] - 7); R++)
                  r[256 + ba++] = S;
              for (R = 0; 15 >= R; R++) ma[R] = 0;
              for (R = 0; 143 >= R; ) (m[2 * R + 1] = 8), R++, ma[8]++;
              for (; 255 >= R; ) (m[2 * R + 1] = 9), R++, ma[9]++;
              for (; 279 >= R; ) (m[2 * R + 1] = 7), R++, ma[7]++;
              for (; 287 >= R; ) (m[2 * R + 1] = 8), R++, ma[8]++;
              A(m, 287, ma);
              for (R = 0; 30 > R; R++) (F[2 * R + 1] = 5), (F[2 * R] = u(R, 5));
              C = new g(m, k, 257, 286, 15);
              L = new g(F, X, 0, 30, 15);
              N = new g([], V, 0, 19, 7);
              K = !0;
            }
            z.l_desc = new h(z.dyn_ltree, C);
            z.d_desc = new h(z.dyn_dtree, L);
            z.bl_desc = new h(z.bl_tree, N);
            z.bi_buf = 0;
            z.bi_valid = 0;
            G(z);
          };
          e._tr_stored_block = T;
          e._tr_flush_block = function (z, R, ba, S) {
            var ma = 0;
            if (0 < z.level) {
              2 === z.strm.data_type && (z.strm.data_type = aa(z));
              ha(z, z.l_desc);
              ha(z, z.d_desc);
              w(z, z.dyn_ltree, z.l_desc.max_code);
              w(z, z.dyn_dtree, z.d_desc.max_code);
              ha(z, z.bl_desc);
              for (ma = 18; 3 <= ma && 0 === z.bl_tree[2 * p[ma] + 1]; ma--);
              z.opt_len += 3 * (ma + 1) + 14;
              var Q = (z.opt_len + 3 + 7) >>> 3;
              var ea = (z.static_len + 3 + 7) >>> 3;
              ea <= Q && (Q = ea);
            } else Q = ea = ba + 5;
            if (ba + 4 <= Q && -1 !== R) T(z, R, ba, S);
            else if (4 === z.strategy || ea === Q)
              q(z, 2 + (S ? 1 : 0), 3), U(z, m, F);
            else {
              q(z, 4 + (S ? 1 : 0), 3);
              R = z.l_desc.max_code + 1;
              ba = z.d_desc.max_code + 1;
              ma += 1;
              q(z, R - 257, 5);
              q(z, ba - 1, 5);
              q(z, ma - 4, 4);
              for (Q = 0; Q < ma; Q++) q(z, z.bl_tree[2 * p[Q] + 1], 3);
              I(z, z.dyn_ltree, R - 1);
              I(z, z.dyn_dtree, ba - 1);
              U(z, z.dyn_ltree, z.dyn_dtree);
            }
            G(z);
            S && O(z);
          };
          e._tr_tally = function (z, R, ba) {
            z.pending_buf[z.d_buf + 2 * z.last_lit] = (R >>> 8) & 255;
            z.pending_buf[z.d_buf + 2 * z.last_lit + 1] = R & 255;
            z.pending_buf[z.l_buf + z.last_lit] = ba & 255;
            z.last_lit++;
            0 === R
              ? z.dyn_ltree[2 * ba]++
              : (z.matches++,
                R--,
                z.dyn_ltree[2 * (y[ba] + 256 + 1)]++,
                z.dyn_dtree[2 * (256 > R ? r[R] : r[256 + (R >>> 7)])]++);
            return z.last_lit === z.lit_bufsize - 1;
          };
          e._tr_align = function (z) {
            q(z, 2, 3);
            t(z, 256, m);
            16 === z.bi_valid
              ? (n(z, z.bi_buf), (z.bi_buf = 0), (z.bi_valid = 0))
              : 8 <= z.bi_valid &&
                ((z.pending_buf[z.pending++] = z.bi_buf & 255),
                (z.bi_buf >>= 8),
                (z.bi_valid -= 8));
          };
        },
        { "../utils/common": 30 },
      ],
      42: [
        function (b, c, e) {
          c.exports = function () {
            this.input = null;
            this.total_in = this.avail_in = this.next_in = 0;
            this.output = null;
            this.total_out = this.avail_out = this.next_out = 0;
            this.msg = "";
            this.state = null;
            this.data_type = 2;
            this.adler = 0;
          };
        },
        {},
      ],
      43: [
        function (b, c, e) {
          (function (d) {
            (function (g) {
              function h(Q, ea) {
                if (!(this instanceof h)) return new h(Q, ea);
                for (var ca = 0, qa = k.length; ca < qa; ca++) this[k[ca]] = "";
                this.q = this.c = "";
                this.bufferCheckPosition = g.MAX_BUFFER_LENGTH;
                this.opt = ea || {};
                this.opt.lowercase =
                  this.opt.lowercase || this.opt.lowercasetags;
                this.looseCase = this.opt.lowercase
                  ? "toLowerCase"
                  : "toUpperCase";
                this.tags = [];
                this.closed = this.closedRoot = this.sawRoot = !1;
                this.tag = this.error = null;
                this.strict = !!Q;
                this.noscript = !(!Q && !this.opt.noscript);
                this.state = S.BEGIN;
                this.ENTITIES = (this.strictEntities = this.opt.strictEntities)
                  ? Object.create(g.XML_ENTITIES)
                  : Object.create(g.ENTITIES);
                this.attribList = [];
                this.opt.xmlns && (this.ns = Object.create(N));
                if ((this.trackPosition = !1 !== this.opt.position))
                  this.position = this.line = this.column = 0;
                this.onready && this.onready(void 0);
              }
              function n(Q, ea) {
                if (!(this instanceof n)) return new n(Q, ea);
                X.apply(this);
                this._parser = new h(Q, ea);
                this.readable = this.writable = !0;
                var ca = this;
                this._parser.onend = function () {
                  ca.emit("end");
                };
                this._parser.onerror = function (qa) {
                  ca.emit("error", qa);
                  ca._parser.error = null;
                };
                this._decoder = null;
                V.forEach(function (qa) {
                  Object.defineProperty(ca, "on" + qa, {
                    get: function () {
                      return ca._parser["on" + qa];
                    },
                    set: function (wa) {
                      if (!wa)
                        return (
                          ca.removeAllListeners(qa),
                          (ca._parser["on" + qa] = wa)
                        );
                      ca.on(qa, wa);
                    },
                    enumerable: !0,
                    configurable: !1,
                  });
                });
              }
              function q(Q) {
                return Q.split("").reduce(function (ea, ca) {
                  ea[ca] = !0;
                  return ea;
                }, {});
              }
              function t(Q, ea) {
                return "[object RegExp]" === Object.prototype.toString.call(Q)
                  ? !!ea.match(Q)
                  : Q[ea];
              }
              function u(Q, ea, ca) {
                Q.textNode && A(Q);
                Q[ea] && Q[ea](ca);
              }
              function A(Q) {
                Q.textNode = G(Q.opt, Q.textNode);
                Q.textNode && Q.ontext && Q.ontext(Q.textNode);
                Q.textNode = "";
              }
              function G(Q, ea) {
                Q.trim && (ea = ea.trim());
                Q.normalize && (ea = ea.replace(/\s+/g, " "));
                return ea;
              }
              function O(Q, ea) {
                A(Q);
                Q.trackPosition &&
                  (ea +=
                    "\nLine: " +
                    Q.line +
                    "\nColumn: " +
                    Q.column +
                    "\nChar: " +
                    Q.c);
                ea = Error(ea);
                Q.error = ea;
                Q.onerror && Q.onerror(ea);
                return Q;
              }
              function H(Q) {
                Q.sawRoot && !Q.closedRoot && P(Q, "Unclosed root tag");
                Q.state !== S.BEGIN &&
                  Q.state !== S.BEGIN_WHITESPACE &&
                  Q.state !== S.TEXT &&
                  O(Q, "Unexpected end");
                A(Q);
                Q.c = "";
                Q.closed = !0;
                Q.onend && Q.onend(void 0);
                h.call(Q, Q.strict, Q.opt);
                return Q;
              }
              function P(Q, ea) {
                if ("object" !== typeof Q || !(Q instanceof h))
                  throw Error("bad call to strictFail");
                Q.strict && O(Q, ea);
              }
              function U(Q, ea) {
                var ca = 0 > Q.indexOf(":") ? ["", Q] : Q.split(":"),
                  qa = ca[0];
                ca = ca[1];
                ea && "xmlns" === Q && ((qa = "xmlns"), (ca = ""));
                return { prefix: qa, local: ca };
              }
              function ha(Q) {
                Q.strict || (Q.attribName = Q.attribName[Q.looseCase]());
                if (
                  -1 === Q.attribList.indexOf(Q.attribName) &&
                  !Q.tag.attributes.hasOwnProperty(Q.attribName)
                )
                  if (Q.opt.xmlns) {
                    var ea = U(Q.attribName, !0),
                      ca = ea.local;
                    if ("xmlns" === ea.prefix)
                      if ("xml" === ca && Q.attribValue !== C)
                        P(
                          Q,
                          "xml: prefix must be bound to " +
                            C +
                            "\nActual: " +
                            Q.attribValue
                        );
                      else if ("xmlns" === ca && Q.attribValue !== L)
                        P(
                          Q,
                          "xmlns: prefix must be bound to " +
                            L +
                            "\nActual: " +
                            Q.attribValue
                        );
                      else {
                        ea = Q.tag;
                        var qa = Q.tags[Q.tags.length - 1] || Q;
                        ea.ns === qa.ns && (ea.ns = Object.create(qa.ns));
                        ea.ns[ca] = Q.attribValue;
                      }
                    Q.attribList.push([Q.attribName, Q.attribValue]);
                  } else
                    (Q.tag.attributes[Q.attribName] = Q.attribValue),
                      u(Q, "onattribute", {
                        name: Q.attribName,
                        value: Q.attribValue,
                      });
                Q.attribName = Q.attribValue = "";
              }
              function w(Q, ea) {
                if (Q.opt.xmlns) {
                  var ca = Q.tag,
                    qa = U(Q.tagName);
                  ca.prefix = qa.prefix;
                  ca.local = qa.local;
                  ca.uri = ca.ns[qa.prefix] || "";
                  ca.prefix &&
                    !ca.uri &&
                    (P(
                      Q,
                      "Unbound namespace prefix: " + JSON.stringify(Q.tagName)
                    ),
                    (ca.uri = qa.prefix));
                  qa = Q.tags[Q.tags.length - 1] || Q;
                  ca.ns &&
                    qa.ns !== ca.ns &&
                    Object.keys(ca.ns).forEach(function (kb) {
                      u(Q, "onopennamespace", { prefix: kb, uri: ca.ns[kb] });
                    });
                  qa = 0;
                  for (var wa = Q.attribList.length; qa < wa; qa++) {
                    var ya = Q.attribList[qa],
                      ua = ya[0],
                      Ja = ya[1],
                      Ha = U(ua, !0);
                    ya = Ha.prefix;
                    var cb = "" === ya ? "" : ca.ns[ya] || "";
                    Ja = {
                      name: ua,
                      value: Ja,
                      prefix: ya,
                      local: Ha.local,
                      uri: cb,
                    };
                    ya &&
                      "xmlns" !== ya &&
                      !cb &&
                      (P(Q, "Unbound namespace prefix: " + JSON.stringify(ya)),
                      (Ja.uri = ya));
                    Q.tag.attributes[ua] = Ja;
                    u(Q, "onattribute", Ja);
                  }
                  Q.attribList.length = 0;
                }
                Q.tag.isSelfClosing = !!ea;
                Q.sawRoot = !0;
                Q.tags.push(Q.tag);
                u(Q, "onopentag", Q.tag);
                ea ||
                  (Q.noscript || "script" !== Q.tagName.toLowerCase()
                    ? (Q.state = S.TEXT)
                    : (Q.state = S.SCRIPT),
                  (Q.tag = null),
                  (Q.tagName = ""));
                Q.attribName = Q.attribValue = "";
                Q.attribList.length = 0;
              }
              function I(Q) {
                if (Q.tagName) {
                  if (Q.script) {
                    if ("script" !== Q.tagName) {
                      Q.script += "</" + Q.tagName + ">";
                      Q.tagName = "";
                      Q.state = S.SCRIPT;
                      return;
                    }
                    u(Q, "onscript", Q.script);
                    Q.script = "";
                  }
                  var ea = Q.tags.length,
                    ca = Q.tagName;
                  Q.strict || (ca = ca[Q.looseCase]());
                  for (var qa = ca; ea--; )
                    if (Q.tags[ea].name !== qa) P(Q, "Unexpected close tag");
                    else break;
                  if (0 > ea)
                    P(Q, "Unmatched closing tag: " + Q.tagName),
                      (Q.textNode += "</" + Q.tagName + ">");
                  else {
                    Q.tagName = ca;
                    for (ca = Q.tags.length; ca-- > ea; ) {
                      var wa = (Q.tag = Q.tags.pop());
                      Q.tagName = Q.tag.name;
                      u(Q, "onclosetag", Q.tagName);
                      for (var ya in wa.ns);
                      qa = Q.tags[Q.tags.length - 1] || Q;
                      Q.opt.xmlns &&
                        wa.ns !== qa.ns &&
                        Object.keys(wa.ns).forEach(function (ua) {
                          u(Q, "onclosenamespace", {
                            prefix: ua,
                            uri: wa.ns[ua],
                          });
                        });
                    }
                    0 === ea && (Q.closedRoot = !0);
                    Q.tagName = Q.attribValue = Q.attribName = "";
                    Q.attribList.length = 0;
                  }
                } else P(Q, "Weird empty close tag."), (Q.textNode += "</>");
                Q.state = S.TEXT;
              }
              function aa(Q) {
                var ea = Q.entity,
                  ca = ea.toLowerCase(),
                  qa = "";
                if (Q.ENTITIES[ea]) return Q.ENTITIES[ea];
                if (Q.ENTITIES[ca]) return Q.ENTITIES[ca];
                ea = ca;
                if ("#" === ea.charAt(0))
                  if ("x" === ea.charAt(1)) {
                    ea = ea.slice(2);
                    var wa = parseInt(ea, 16);
                    qa = wa.toString(16);
                  } else
                    (ea = ea.slice(1)),
                      (wa = parseInt(ea, 10)),
                      (qa = wa.toString(10));
                ea = ea.replace(/^0+/, "");
                return qa.toLowerCase() !== ea
                  ? (P(Q, "Invalid character entity"), "&" + Q.entity + ";")
                  : String.fromCodePoint(wa);
              }
              function T(Q, ea) {
                "<" === ea
                  ? ((Q.state = S.OPEN_WAKA), (Q.startTagPosition = Q.position))
                  : t(p, ea) ||
                    (P(Q, "Non-whitespace before first tag."),
                    (Q.textNode = ea),
                    (Q.state = S.TEXT));
              }
              function ka(Q, ea) {
                var ca = "";
                ea < Q.length && (ca = Q.charAt(ea));
                return ca;
              }
              g.parser = function (Q, ea) {
                return new h(Q, ea);
              };
              g.SAXParser = h;
              g.SAXStream = n;
              g.createStream = function (Q, ea) {
                return new n(Q, ea);
              };
              g.MAX_BUFFER_LENGTH = 65536;
              var k =
                "comment sgmlDecl textNode tagName doctype procInstName procInstBody entity attribName attribValue cdata script".split(
                  " "
                );
              g.EVENTS =
                "text processinginstruction sgmldeclaration doctype comment attribute opentag closetag opencdata cdata closecdata error end ready script opennamespace closenamespace".split(
                  " "
                );
              Object.create ||
                (Object.create = function (Q) {
                  function ea() {}
                  ea.prototype = Q;
                  return new ea();
                });
              Object.keys ||
                (Object.keys = function (Q) {
                  var ea = [],
                    ca;
                  for (ca in Q) Q.hasOwnProperty(ca) && ea.push(ca);
                  return ea;
                });
              h.prototype = {
                end: function () {
                  H(this);
                },
                write: function (Q) {
                  if (this.error) throw this.error;
                  if (this.closed)
                    return O(
                      this,
                      "Cannot write after close. Assign an onready handler."
                    );
                  if (null === Q) return H(this);
                  for (var ea = 0, ca; ; ) {
                    this.c = ca = ka(Q, ea++);
                    if (!ca) break;
                    this.trackPosition &&
                      (this.position++,
                      "\n" === ca
                        ? (this.line++, (this.column = 0))
                        : this.column++);
                    switch (this.state) {
                      case S.BEGIN:
                        this.state = S.BEGIN_WHITESPACE;
                        if ("\ufeff" === ca) continue;
                        T(this, ca);
                        continue;
                      case S.BEGIN_WHITESPACE:
                        T(this, ca);
                        continue;
                      case S.TEXT:
                        if (this.sawRoot && !this.closedRoot) {
                          for (
                            var qa = ea - 1;
                            ca && "<" !== ca && "&" !== ca;

                          )
                            (ca = ka(Q, ea++)) &&
                              this.trackPosition &&
                              (this.position++,
                              "\n" === ca
                                ? (this.line++, (this.column = 0))
                                : this.column++);
                          this.textNode += Q.substring(qa, ea - 1);
                        }
                        "<" !== ca ||
                        (this.sawRoot && this.closedRoot && !this.strict)
                          ? (t(p, ca) ||
                              (this.sawRoot && !this.closedRoot) ||
                              P(this, "Text data outside of root node."),
                            "&" === ca
                              ? (this.state = S.TEXT_ENTITY)
                              : (this.textNode += ca))
                          : ((this.state = S.OPEN_WAKA),
                            (this.startTagPosition = this.position));
                        continue;
                      case S.SCRIPT:
                        "<" === ca
                          ? (this.state = S.SCRIPT_ENDING)
                          : (this.script += ca);
                        continue;
                      case S.SCRIPT_ENDING:
                        "/" === ca
                          ? (this.state = S.CLOSE_TAG)
                          : ((this.script += "<" + ca),
                            (this.state = S.SCRIPT));
                        continue;
                      case S.OPEN_WAKA:
                        "!" === ca
                          ? ((this.state = S.SGML_DECL), (this.sgmlDecl = ""))
                          : t(p, ca) ||
                            (t(K, ca)
                              ? ((this.state = S.OPEN_TAG), (this.tagName = ca))
                              : "/" === ca
                              ? ((this.state = S.CLOSE_TAG),
                                (this.tagName = ""))
                              : "?" === ca
                              ? ((this.state = S.PROC_INST),
                                (this.procInstName = this.procInstBody = ""))
                              : (P(this, "Unencoded <"),
                                this.startTagPosition + 1 < this.position &&
                                  (ca =
                                    Array(
                                      this.position - this.startTagPosition
                                    ).join(" ") + ca),
                                (this.textNode += "<" + ca),
                                (this.state = S.TEXT)));
                        continue;
                      case S.SGML_DECL:
                        (this.sgmlDecl + ca).toUpperCase() === D
                          ? (u(this, "onopencdata"),
                            (this.state = S.CDATA),
                            (this.cdata = this.sgmlDecl = ""))
                          : "--" === this.sgmlDecl + ca
                          ? ((this.state = S.COMMENT),
                            (this.sgmlDecl = this.comment = ""))
                          : (this.sgmlDecl + ca).toUpperCase() === B
                          ? ((this.state = S.DOCTYPE),
                            (this.doctype || this.sawRoot) &&
                              P(
                                this,
                                "Inappropriately located doctype declaration"
                              ),
                            (this.sgmlDecl = this.doctype = ""))
                          : ">" === ca
                          ? (u(this, "onsgmldeclaration", this.sgmlDecl),
                            (this.sgmlDecl = ""),
                            (this.state = S.TEXT))
                          : (t(r, ca) && (this.state = S.SGML_DECL_QUOTED),
                            (this.sgmlDecl += ca));
                        continue;
                      case S.SGML_DECL_QUOTED:
                        ca === this.q &&
                          ((this.state = S.SGML_DECL), (this.q = ""));
                        this.sgmlDecl += ca;
                        continue;
                      case S.DOCTYPE:
                        ">" === ca
                          ? ((this.state = S.TEXT),
                            u(this, "ondoctype", this.doctype),
                            (this.doctype = !0))
                          : ((this.doctype += ca),
                            "[" === ca
                              ? (this.state = S.DOCTYPE_DTD)
                              : t(r, ca) &&
                                ((this.state = S.DOCTYPE_QUOTED),
                                (this.q = ca)));
                        continue;
                      case S.DOCTYPE_QUOTED:
                        this.doctype += ca;
                        ca === this.q &&
                          ((this.q = ""), (this.state = S.DOCTYPE));
                        continue;
                      case S.DOCTYPE_DTD:
                        this.doctype += ca;
                        "]" === ca
                          ? (this.state = S.DOCTYPE)
                          : t(r, ca) &&
                            ((this.state = S.DOCTYPE_DTD_QUOTED),
                            (this.q = ca));
                        continue;
                      case S.DOCTYPE_DTD_QUOTED:
                        this.doctype += ca;
                        ca === this.q &&
                          ((this.state = S.DOCTYPE_DTD), (this.q = ""));
                        continue;
                      case S.COMMENT:
                        "-" === ca
                          ? (this.state = S.COMMENT_ENDING)
                          : (this.comment += ca);
                        continue;
                      case S.COMMENT_ENDING:
                        "-" === ca
                          ? ((this.state = S.COMMENT_ENDED),
                            (this.comment = G(this.opt, this.comment)) &&
                              u(this, "oncomment", this.comment),
                            (this.comment = ""))
                          : ((this.comment += "-" + ca),
                            (this.state = S.COMMENT));
                        continue;
                      case S.COMMENT_ENDED:
                        ">" !== ca
                          ? (P(this, "Malformed comment"),
                            (this.comment += "--" + ca),
                            (this.state = S.COMMENT))
                          : (this.state = S.TEXT);
                        continue;
                      case S.CDATA:
                        "]" === ca
                          ? (this.state = S.CDATA_ENDING)
                          : (this.cdata += ca);
                        continue;
                      case S.CDATA_ENDING:
                        "]" === ca
                          ? (this.state = S.CDATA_ENDING_2)
                          : ((this.cdata += "]" + ca), (this.state = S.CDATA));
                        continue;
                      case S.CDATA_ENDING_2:
                        ">" === ca
                          ? (this.cdata && u(this, "oncdata", this.cdata),
                            u(this, "onclosecdata"),
                            (this.cdata = ""),
                            (this.state = S.TEXT))
                          : "]" === ca
                          ? (this.cdata += "]")
                          : ((this.cdata += "]]" + ca), (this.state = S.CDATA));
                        continue;
                      case S.PROC_INST:
                        "?" === ca
                          ? (this.state = S.PROC_INST_ENDING)
                          : t(p, ca)
                          ? (this.state = S.PROC_INST_BODY)
                          : (this.procInstName += ca);
                        continue;
                      case S.PROC_INST_BODY:
                        if (!this.procInstBody && t(p, ca)) continue;
                        else
                          "?" === ca
                            ? (this.state = S.PROC_INST_ENDING)
                            : (this.procInstBody += ca);
                        continue;
                      case S.PROC_INST_ENDING:
                        ">" === ca
                          ? (u(this, "onprocessinginstruction", {
                              name: this.procInstName,
                              body: this.procInstBody,
                            }),
                            (this.procInstName = this.procInstBody = ""),
                            (this.state = S.TEXT))
                          : ((this.procInstBody += "?" + ca),
                            (this.state = S.PROC_INST_BODY));
                        continue;
                      case S.OPEN_TAG:
                        if (t(z, ca)) this.tagName += ca;
                        else {
                          this.strict ||
                            (this.tagName = this.tagName[this.looseCase]());
                          qa = this.tags[this.tags.length - 1] || this;
                          var wa = (this.tag = {
                            name: this.tagName,
                            attributes: {},
                          });
                          this.opt.xmlns && (wa.ns = qa.ns);
                          this.attribList.length = 0;
                          ">" === ca
                            ? w(this)
                            : "/" === ca
                            ? (this.state = S.OPEN_TAG_SLASH)
                            : (t(p, ca) ||
                                P(this, "Invalid character in tag name"),
                              (this.state = S.ATTRIB));
                        }
                        continue;
                      case S.OPEN_TAG_SLASH:
                        ">" === ca
                          ? (w(this, !0), I(this))
                          : (P(
                              this,
                              "Forward-slash in opening tag not followed by >"
                            ),
                            (this.state = S.ATTRIB));
                        continue;
                      case S.ATTRIB:
                        if (t(p, ca)) continue;
                        else
                          ">" === ca
                            ? w(this)
                            : "/" === ca
                            ? (this.state = S.OPEN_TAG_SLASH)
                            : t(K, ca)
                            ? ((this.attribName = ca),
                              (this.attribValue = ""),
                              (this.state = S.ATTRIB_NAME))
                            : P(this, "Invalid attribute name");
                        continue;
                      case S.ATTRIB_NAME:
                        "=" === ca
                          ? (this.state = S.ATTRIB_VALUE)
                          : ">" === ca
                          ? (P(this, "Attribute without value"),
                            (this.attribValue = this.attribName),
                            ha(this),
                            w(this))
                          : t(p, ca)
                          ? (this.state = S.ATTRIB_NAME_SAW_WHITE)
                          : t(z, ca)
                          ? (this.attribName += ca)
                          : P(this, "Invalid attribute name");
                        continue;
                      case S.ATTRIB_NAME_SAW_WHITE:
                        if ("=" === ca) this.state = S.ATTRIB_VALUE;
                        else if (t(p, ca)) continue;
                        else
                          P(this, "Attribute without value"),
                            (this.attribValue = this.tag.attributes[
                              this.attribName
                            ] =
                              ""),
                            u(this, "onattribute", {
                              name: this.attribName,
                              value: "",
                            }),
                            (this.attribName = ""),
                            ">" === ca
                              ? w(this)
                              : t(K, ca)
                              ? ((this.attribName = ca),
                                (this.state = S.ATTRIB_NAME))
                              : (P(this, "Invalid attribute name"),
                                (this.state = S.ATTRIB));
                        continue;
                      case S.ATTRIB_VALUE:
                        if (t(p, ca)) continue;
                        else
                          t(r, ca)
                            ? ((this.q = ca),
                              (this.state = S.ATTRIB_VALUE_QUOTED))
                            : (P(this, "Unquoted attribute value"),
                              (this.state = S.ATTRIB_VALUE_UNQUOTED),
                              (this.attribValue = ca));
                        continue;
                      case S.ATTRIB_VALUE_QUOTED:
                        if (ca !== this.q) {
                          "&" === ca
                            ? (this.state = S.ATTRIB_VALUE_ENTITY_Q)
                            : (this.attribValue += ca);
                          continue;
                        }
                        ha(this);
                        this.q = "";
                        this.state = S.ATTRIB_VALUE_CLOSED;
                        continue;
                      case S.ATTRIB_VALUE_CLOSED:
                        t(p, ca)
                          ? (this.state = S.ATTRIB)
                          : ">" === ca
                          ? w(this)
                          : "/" === ca
                          ? (this.state = S.OPEN_TAG_SLASH)
                          : t(K, ca)
                          ? (P(this, "No whitespace between attributes"),
                            (this.attribName = ca),
                            (this.attribValue = ""),
                            (this.state = S.ATTRIB_NAME))
                          : P(this, "Invalid attribute name");
                        continue;
                      case S.ATTRIB_VALUE_UNQUOTED:
                        if (!t(y, ca)) {
                          "&" === ca
                            ? (this.state = S.ATTRIB_VALUE_ENTITY_U)
                            : (this.attribValue += ca);
                          continue;
                        }
                        ha(this);
                        ">" === ca ? w(this) : (this.state = S.ATTRIB);
                        continue;
                      case S.CLOSE_TAG:
                        if (this.tagName)
                          ">" === ca
                            ? I(this)
                            : t(z, ca)
                            ? (this.tagName += ca)
                            : this.script
                            ? ((this.script += "</" + this.tagName),
                              (this.tagName = ""),
                              (this.state = S.SCRIPT))
                            : (t(p, ca) ||
                                P(this, "Invalid tagname in closing tag"),
                              (this.state = S.CLOSE_TAG_SAW_WHITE));
                        else if (t(p, ca)) continue;
                        else
                          t(K, ca)
                            ? (this.tagName = ca)
                            : this.script
                            ? ((this.script += "</" + ca),
                              (this.state = S.SCRIPT))
                            : P(this, "Invalid tagname in closing tag.");
                        continue;
                      case S.CLOSE_TAG_SAW_WHITE:
                        if (t(p, ca)) continue;
                        ">" === ca
                          ? I(this)
                          : P(this, "Invalid characters in closing tag");
                        continue;
                      case S.TEXT_ENTITY:
                      case S.ATTRIB_VALUE_ENTITY_Q:
                      case S.ATTRIB_VALUE_ENTITY_U:
                        switch (this.state) {
                          case S.TEXT_ENTITY:
                            var ya = S.TEXT;
                            var ua = "textNode";
                            break;
                          case S.ATTRIB_VALUE_ENTITY_Q:
                            ya = S.ATTRIB_VALUE_QUOTED;
                            ua = "attribValue";
                            break;
                          case S.ATTRIB_VALUE_ENTITY_U:
                            (ya = S.ATTRIB_VALUE_UNQUOTED),
                              (ua = "attribValue");
                        }
                        ";" === ca
                          ? ((this[ua] += aa(this)),
                            (this.entity = ""),
                            (this.state = ya))
                          : t(this.entity.length ? ba : R, ca)
                          ? (this.entity += ca)
                          : (P(this, "Invalid character in entity name"),
                            (this[ua] += "&" + this.entity + ca),
                            (this.entity = ""),
                            (this.state = ya));
                        continue;
                      default:
                        throw Error(this, "Unknown state: " + this.state);
                    }
                  }
                  if (this.position >= this.bufferCheckPosition) {
                    Q = Math.max(g.MAX_BUFFER_LENGTH, 10);
                    ca = ea = 0;
                    for (ya = k.length; ca < ya; ca++) {
                      ua = this[k[ca]].length;
                      if (ua > Q)
                        switch (k[ca]) {
                          case "textNode":
                            A(this);
                            break;
                          case "cdata":
                            u(this, "oncdata", this.cdata);
                            this.cdata = "";
                            break;
                          case "script":
                            u(this, "onscript", this.script);
                            this.script = "";
                            break;
                          default:
                            O(this, "Max buffer length exceeded: " + k[ca]);
                        }
                      ea = Math.max(ea, ua);
                    }
                    this.bufferCheckPosition =
                      g.MAX_BUFFER_LENGTH - ea + this.position;
                  }
                  return this;
                },
                resume: function () {
                  this.error = null;
                  return this;
                },
                close: function () {
                  return this.write(null);
                },
                flush: function () {
                  A(this);
                  "" !== this.cdata &&
                    (u(this, "oncdata", this.cdata), (this.cdata = ""));
                  "" !== this.script &&
                    (u(this, "onscript", this.script), (this.script = ""));
                },
              };
              try {
                var X = b("stream").Stream;
              } catch (Q) {
                X = function () {};
              }
              var V = g.EVENTS.filter(function (Q) {
                return "error" !== Q && "end" !== Q;
              });
              n.prototype = Object.create(X.prototype, {
                constructor: { value: n },
              });
              n.prototype.write = function (Q) {
                "function" === typeof d &&
                  "function" === typeof d.isBuffer &&
                  d.isBuffer(Q) &&
                  (this._decoder ||
                    (this._decoder = new (b("string_decoder").StringDecoder)(
                      "utf8"
                    )),
                  (Q = this._decoder.write(Q)));
                this._parser.write(Q.toString());
                this.emit("data", Q);
                return !0;
              };
              n.prototype.end = function (Q) {
                Q && Q.length && this.write(Q);
                this._parser.end();
                return !0;
              };
              n.prototype.on = function (Q, ea) {
                var ca = this;
                ca._parser["on" + Q] ||
                  -1 === V.indexOf(Q) ||
                  (ca._parser["on" + Q] = function () {
                    var qa =
                      1 === arguments.length
                        ? [arguments[0]]
                        : Array.apply(null, arguments);
                    qa.splice(0, 0, Q);
                    ca.emit.apply(ca, qa);
                  });
                return X.prototype.on.call(ca, Q, ea);
              };
              var p = "\r\n\t ",
                m = "0124356789",
                F = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",
                r = "'\"",
                y = p + ">",
                D = "[CDATA[",
                B = "DOCTYPE",
                C = "http://www.w3.org/XML/1998/namespace",
                L = "http://www.w3.org/2000/xmlns/",
                N = { xml: C, xmlns: L };
              p = q(p);
              m = q(m);
              F = q(F);
              var K =
                  /[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,
                z =
                  /[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,
                R =
                  /[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,
                ba =
                  /[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;
              r = q(r);
              y = q(y);
              var S = 0;
              g.STATE = {
                BEGIN: S++,
                BEGIN_WHITESPACE: S++,
                TEXT: S++,
                TEXT_ENTITY: S++,
                OPEN_WAKA: S++,
                SGML_DECL: S++,
                SGML_DECL_QUOTED: S++,
                DOCTYPE: S++,
                DOCTYPE_QUOTED: S++,
                DOCTYPE_DTD: S++,
                DOCTYPE_DTD_QUOTED: S++,
                COMMENT_STARTING: S++,
                COMMENT: S++,
                COMMENT_ENDING: S++,
                COMMENT_ENDED: S++,
                CDATA: S++,
                CDATA_ENDING: S++,
                CDATA_ENDING_2: S++,
                PROC_INST: S++,
                PROC_INST_BODY: S++,
                PROC_INST_ENDING: S++,
                OPEN_TAG: S++,
                OPEN_TAG_SLASH: S++,
                ATTRIB: S++,
                ATTRIB_NAME: S++,
                ATTRIB_NAME_SAW_WHITE: S++,
                ATTRIB_VALUE: S++,
                ATTRIB_VALUE_QUOTED: S++,
                ATTRIB_VALUE_CLOSED: S++,
                ATTRIB_VALUE_UNQUOTED: S++,
                ATTRIB_VALUE_ENTITY_Q: S++,
                ATTRIB_VALUE_ENTITY_U: S++,
                CLOSE_TAG: S++,
                CLOSE_TAG_SAW_WHITE: S++,
                SCRIPT: S++,
                SCRIPT_ENDING: S++,
              };
              g.XML_ENTITIES = {
                amp: "&",
                gt: ">",
                lt: "<",
                quot: '"',
                apos: "'",
              };
              g.ENTITIES = {
                amp: "&",
                gt: ">",
                lt: "<",
                quot: '"',
                apos: "'",
                AElig: 198,
                Aacute: 193,
                Acirc: 194,
                Agrave: 192,
                Aring: 197,
                Atilde: 195,
                Auml: 196,
                Ccedil: 199,
                ETH: 208,
                Eacute: 201,
                Ecirc: 202,
                Egrave: 200,
                Euml: 203,
                Iacute: 205,
                Icirc: 206,
                Igrave: 204,
                Iuml: 207,
                Ntilde: 209,
                Oacute: 211,
                Ocirc: 212,
                Ograve: 210,
                Oslash: 216,
                Otilde: 213,
                Ouml: 214,
                THORN: 222,
                Uacute: 218,
                Ucirc: 219,
                Ugrave: 217,
                Uuml: 220,
                Yacute: 221,
                aacute: 225,
                acirc: 226,
                aelig: 230,
                agrave: 224,
                aring: 229,
                atilde: 227,
                auml: 228,
                ccedil: 231,
                eacute: 233,
                ecirc: 234,
                egrave: 232,
                eth: 240,
                euml: 235,
                iacute: 237,
                icirc: 238,
                igrave: 236,
                iuml: 239,
                ntilde: 241,
                oacute: 243,
                ocirc: 244,
                ograve: 242,
                oslash: 248,
                otilde: 245,
                ouml: 246,
                szlig: 223,
                thorn: 254,
                uacute: 250,
                ucirc: 251,
                ugrave: 249,
                uuml: 252,
                yacute: 253,
                yuml: 255,
                copy: 169,
                reg: 174,
                nbsp: 160,
                iexcl: 161,
                cent: 162,
                pound: 163,
                curren: 164,
                yen: 165,
                brvbar: 166,
                sect: 167,
                uml: 168,
                ordf: 170,
                laquo: 171,
                not: 172,
                shy: 173,
                macr: 175,
                deg: 176,
                plusmn: 177,
                sup1: 185,
                sup2: 178,
                sup3: 179,
                acute: 180,
                micro: 181,
                para: 182,
                middot: 183,
                cedil: 184,
                ordm: 186,
                raquo: 187,
                frac14: 188,
                frac12: 189,
                frac34: 190,
                iquest: 191,
                times: 215,
                divide: 247,
                OElig: 338,
                oelig: 339,
                Scaron: 352,
                scaron: 353,
                Yuml: 376,
                fnof: 402,
                circ: 710,
                tilde: 732,
                Alpha: 913,
                Beta: 914,
                Gamma: 915,
                Delta: 916,
                Epsilon: 917,
                Zeta: 918,
                Eta: 919,
                Theta: 920,
                Iota: 921,
                Kappa: 922,
                Lambda: 923,
                Mu: 924,
                Nu: 925,
                Xi: 926,
                Omicron: 927,
                Pi: 928,
                Rho: 929,
                Sigma: 931,
                Tau: 932,
                Upsilon: 933,
                Phi: 934,
                Chi: 935,
                Psi: 936,
                Omega: 937,
                alpha: 945,
                beta: 946,
                gamma: 947,
                delta: 948,
                epsilon: 949,
                zeta: 950,
                eta: 951,
                theta: 952,
                iota: 953,
                kappa: 954,
                lambda: 955,
                mu: 956,
                nu: 957,
                xi: 958,
                omicron: 959,
                pi: 960,
                rho: 961,
                sigmaf: 962,
                sigma: 963,
                tau: 964,
                upsilon: 965,
                phi: 966,
                chi: 967,
                psi: 968,
                omega: 969,
                thetasym: 977,
                upsih: 978,
                piv: 982,
                ensp: 8194,
                emsp: 8195,
                thinsp: 8201,
                zwnj: 8204,
                zwj: 8205,
                lrm: 8206,
                rlm: 8207,
                ndash: 8211,
                mdash: 8212,
                lsquo: 8216,
                rsquo: 8217,
                sbquo: 8218,
                ldquo: 8220,
                rdquo: 8221,
                bdquo: 8222,
                dagger: 8224,
                Dagger: 8225,
                bull: 8226,
                hellip: 8230,
                permil: 8240,
                prime: 8242,
                Prime: 8243,
                lsaquo: 8249,
                rsaquo: 8250,
                oline: 8254,
                frasl: 8260,
                euro: 8364,
                image: 8465,
                weierp: 8472,
                real: 8476,
                trade: 8482,
                alefsym: 8501,
                larr: 8592,
                uarr: 8593,
                rarr: 8594,
                darr: 8595,
                harr: 8596,
                crarr: 8629,
                lArr: 8656,
                uArr: 8657,
                rArr: 8658,
                dArr: 8659,
                hArr: 8660,
                forall: 8704,
                part: 8706,
                exist: 8707,
                empty: 8709,
                nabla: 8711,
                isin: 8712,
                notin: 8713,
                ni: 8715,
                prod: 8719,
                sum: 8721,
                minus: 8722,
                lowast: 8727,
                radic: 8730,
                prop: 8733,
                infin: 8734,
                ang: 8736,
                and: 8743,
                or: 8744,
                cap: 8745,
                cup: 8746,
                int: 8747,
                there4: 8756,
                sim: 8764,
                cong: 8773,
                asymp: 8776,
                ne: 8800,
                equiv: 8801,
                le: 8804,
                ge: 8805,
                sub: 8834,
                sup: 8835,
                nsub: 8836,
                sube: 8838,
                supe: 8839,
                oplus: 8853,
                otimes: 8855,
                perp: 8869,
                sdot: 8901,
                lceil: 8968,
                rceil: 8969,
                lfloor: 8970,
                rfloor: 8971,
                lang: 9001,
                rang: 9002,
                loz: 9674,
                spades: 9824,
                clubs: 9827,
                hearts: 9829,
                diams: 9830,
              };
              Object.keys(g.ENTITIES).forEach(function (Q) {
                var ea = g.ENTITIES[Q];
                ea = "number" === typeof ea ? String.fromCharCode(ea) : ea;
                g.ENTITIES[Q] = ea;
              });
              for (var ma in g.STATE) g.STATE[g.STATE[ma]] = ma;
              S = g.STATE;
              String.fromCodePoint ||
                (function () {
                  var Q = String.fromCharCode,
                    ea = Math.floor,
                    ca = function () {
                      var qa = [],
                        wa = -1,
                        ya = arguments.length;
                      if (!ya) return "";
                      for (var ua = ""; ++wa < ya; ) {
                        var Ja = Number(arguments[wa]);
                        if (
                          !isFinite(Ja) ||
                          0 > Ja ||
                          1114111 < Ja ||
                          ea(Ja) !== Ja
                        )
                          throw RangeError("Invalid code point: " + Ja);
                        if (65535 >= Ja) qa.push(Ja);
                        else {
                          Ja -= 65536;
                          var Ha = (Ja >> 10) + 55296;
                          Ja = (Ja % 1024) + 56320;
                          qa.push(Ha, Ja);
                        }
                        if (wa + 1 === ya || 16384 < qa.length)
                          (ua += Q.apply(null, qa)), (qa.length = 0);
                      }
                      return ua;
                    };
                  Object.defineProperty
                    ? Object.defineProperty(String, "fromCodePoint", {
                        value: ca,
                        configurable: !0,
                        writable: !0,
                      })
                    : (String.fromCodePoint = ca);
                })();
            })("undefined" === typeof e ? (this.sax = {}) : e);
          }.call(this, b("buffer").Buffer));
        },
        { buffer: 3, stream: 25, string_decoder: 26 },
      ],
      44: [
        function (b, c, e) {
          var d = d || {};
          d.Transform =
            d.Transform ||
            ("undefined" !== typeof b ? b("./transform.js") : null);
          var g =
              g ||
              ("undefined" !== typeof b ? b("../lib/base64-binary.js") : null),
            h = h || ("undefined" !== typeof b ? b("pako") : null);
          d.NIFTI_INTENT_GENMATRIX = "NIFTI_INTENT_GENMATRIX";
          d.NIFTI_INTENT_LABEL = "NIFTI_INTENT_LABEL";
          d.NIFTI_INTENT_NODE_INDEX = "NIFTI_INTENT_NODE_INDEX";
          d.NIFTI_INTENT_POINTSET = "NIFTI_INTENT_POINTSET";
          d.NIFTI_INTENT_RGB_VECTOR = "NIFTI_INTENT_RGB_VECTOR";
          d.NIFTI_INTENT_RGBA_VECTOR = "NIFTI_INTENT_RGBA_VECTOR";
          d.NIFTI_INTENT_SHAPE = "NIFTI_INTENT_SHAPE";
          d.NIFTI_INTENT_TIME_SERIES = "NIFTI_INTENT_TIME_SERIES";
          d.NIFTI_INTENT_TRIANGLE = "NIFTI_INTENT_TRIANGLE";
          d.NIFTI_INTENT_NONE = "NIFTI_INTENT_NONE";
          d.NIFTI_INTENT_VECTOR = "NIFTI_INTENT_VECTOR";
          d.NIFTI_INTENT_ZSCORE = "NIFTI_INTENT_ZSCORE";
          d.ATT_ARRAYINDEXINGORDER = "ArrayIndexingOrder";
          d.ATT_DATATYPE = "DataType";
          d.ATT_DIMENSIONALITY = "Dimensionality";
          d.ATT_DIMN = "Dim";
          d.ATT_ENCODING = "Encoding";
          d.ATT_ENDIAN = "Endian";
          d.ATT_EXTERNALFILENAME = "ExternalFileName";
          d.ATT_EXTERNALFILEOFFSET = "ExternalFileOffset";
          d.ATT_INTENT = "Intent";
          d.ENCODING_ASCII = "ASCII";
          d.ENCODING_BASE64BINARY = "Base64Binary";
          d.ENCODING_GZIPBASE64BINARY = "GZipBase64Binary";
          d.ENCODING_EXTERNALFILEBINARY = "ExternalFileBinary";
          d.TYPE_NIFTI_TYPE_UINT8 = "NIFTI_TYPE_UINT8";
          d.TYPE_NIFTI_TYPE_INT32 = "NIFTI_TYPE_INT32";
          d.TYPE_NIFTI_TYPE_FLOAT32 = "NIFTI_TYPE_FLOAT32";
          d.DataArray =
            d.DataArray ||
            function () {
              this.attributes = null;
              this.metadata = {};
              this.transforms = [];
              this.data = null;
              this.dataConverted = !1;
            };
          d.DataArray.prototype.isPointSet = function () {
            return this.attributes[d.ATT_INTENT] === d.NIFTI_INTENT_POINTSET;
          };
          d.DataArray.prototype.isTriangles = function () {
            return this.attributes[d.ATT_INTENT] === d.NIFTI_INTENT_TRIANGLE;
          };
          d.DataArray.prototype.isNormals = function () {
            return this.attributes[d.ATT_INTENT] === d.NIFTI_INTENT_VECTOR;
          };
          d.DataArray.prototype.isColors = function () {
            return (
              this.attributes[d.ATT_INTENT] === d.NIFTI_INTENT_RGB_VECTOR ||
              this.attributes[d.ATT_INTENT] === d.NIFTI_INTENT_RGBA_VECTOR
            );
          };
          d.DataArray.prototype.isZScore = function () {
            return this.attributes[d.ATT_INTENT] === d.NIFTI_INTENT_ZSCORE;
          };
          d.DataArray.prototype.getDimensions = function () {
            return parseInt(this.attributes[d.ATT_DIMENSIONALITY]);
          };
          d.DataArray.prototype.getNumElements = function (n) {
            void 0 === n && (n = 0);
            return parseInt(this.attributes[d.ATT_DIMN + n]);
          };
          d.DataArray.prototype.isScalar = function () {
            return 1 == this.getDimensions();
          };
          d.DataArray.prototype.isTriple = function () {
            return 2 == this.getDimensions() && 3 == this.getNumElements(1);
          };
          d.DataArray.prototype.isQuad = function () {
            return 2 == this.getDimensions() && 4 == this.getNumElements(1);
          };
          d.DataArray.prototype.isAscii = function () {
            return d.ENCODING_ASCII === this.attributes[d.ATT_ENCODING];
          };
          d.DataArray.prototype.isBase64Binary = function () {
            return d.ENCODING_BASE64BINARY === this.attributes[d.ATT_ENCODING];
          };
          d.DataArray.prototype.isGzipBase64Binary = function () {
            return (
              d.ENCODING_GZIPBASE64BINARY === this.attributes[d.ATT_ENCODING]
            );
          };
          d.DataArray.prototype.isBase64Encoded = function () {
            return this.isBase64Binary() || this.isGzipBase64Binary();
          };
          d.DataArray.prototype.isFloat32 = function () {
            return (
              d.TYPE_NIFTI_TYPE_FLOAT32 === this.attributes[d.ATT_DATATYPE]
            );
          };
          d.DataArray.prototype.isInt32 = function () {
            return d.TYPE_NIFTI_TYPE_INT32 === this.attributes[d.ATT_DATATYPE];
          };
          d.DataArray.prototype.isUnsignedInt8 = function () {
            return d.TYPE_NIFTI_TYPE_UINT8 === this.attributes[d.ATT_DATATYPE];
          };
          d.DataArray.prototype.getData = function () {
            this.dataConverted ||
              ((this.dataConverted = !0),
              this.isAscii()
                ? this.isUnsignedInt8()
                  ? d.DataArray.readUnsignedInt8ASCII(this)
                  : this.isInt32()
                  ? d.DataArray.readSignedInt32ASCII(this)
                  : d.DataArray.readFloat32ASCII(this)
                : this.isBase64Binary()
                ? this.isUnsignedInt8()
                  ? d.DataArray.readUnsignedInt8Base64(this)
                  : this.isInt32()
                  ? d.DataArray.readSignedInt32Base64(this)
                  : d.DataArray.readFloat32Base64(this)
                : this.isGzipBase64Binary() &&
                  (this.isUnsignedInt8()
                    ? d.DataArray.readUnsignedInt8GZIPBase64(this)
                    : this.isInt32()
                    ? d.DataArray.readSignedInt32GZIPBase64(this)
                    : d.DataArray.readFloat32GZIPBase64(this)));
            return this.data;
          };
          d.DataArray.prototype.getDataAsync = function (n, q) {
            this.dataConverted ||
              ((this.dataConverted = !0),
              this.isAscii()
                ? (this.isUnsignedInt8()
                    ? d.DataArray.readUnsignedInt8ASCII(this)
                    : this.isInt32()
                    ? d.DataArray.readSignedInt32ASCII(this)
                    : d.DataArray.readFloat32ASCII(this),
                  q())
                : this.isBase64Binary()
                ? (this.isUnsignedInt8()
                    ? d.DataArray.readUnsignedInt8Base64(this)
                    : this.isInt32()
                    ? d.DataArray.readSignedInt32Base64(this)
                    : d.DataArray.readFloat32Base64(this),
                  q())
                : this.isGzipBase64Binary() &&
                  (this.isUnsignedInt8()
                    ? d.DataArray.readUnsignedInt8GZIPBase64Async(this, n, q)
                    : this.isInt32()
                    ? d.DataArray.readSignedInt32GZIPBase64Async(this, n, q)
                    : d.DataArray.readFloat32GZIPBase64Async(this, n, q)));
          };
          d.DataArray.readFloat32ASCII = function (n) {
            n.data = new Float32Array(
              n.data.match(/[+-]?\d+(\.\d+)?/g).map(function (q) {
                return parseFloat(q);
              })
            );
          };
          d.DataArray.readSignedInt32ASCII = function (n) {
            n.data = new Int32Array(
              n.data.match(/[+-]?\d+(\.\d+)?/g).map(function (q) {
                return parseInt(q);
              })
            );
          };
          d.DataArray.readUnsignedInt8ASCII = function (n) {
            n.data = new Uint8Array(
              n.data.match(/[+-]?\d+(\.\d+)?/g).map(function (q) {
                return parseInt(q);
              })
            );
          };
          d.DataArray.readUnsignedInt8Base64 = function (n) {
            var q = g.decodeArrayBuffer(n.data);
            n.data = new Uint8Array(q, 0, q.byteLength);
          };
          d.DataArray.readSignedInt32Base64 = function (n) {
            var q = g.decodeArrayBuffer(n.data);
            n.data = new Int32Array(q, 0, q.byteLength / 4);
          };
          d.DataArray.readFloat32Base64 = function (n) {
            var q = g.decodeArrayBuffer(n.data);
            n.data = new Float32Array(q, 0, q.byteLength / 4);
          };
          d.DataArray.readUnsignedInt8GZIPBase64 = function (n) {
            var q = g.decodeArrayBuffer(n.data);
            q = h.inflate(q).buffer;
            n.data = new Uint8Array(q, 0, q.byteLength);
          };
          d.DataArray.readUnsignedInt8GZIPBase64Async = function (n, q, t) {
            var u = g.decodeArrayBuffer(n.data),
              A = new h.Inflate(),
              G = function () {
                n.data = new Uint8Array(
                  A.result.buffer,
                  0,
                  A.result.buffer.byteLength
                );
                t(n.data);
              };
            setTimeout(function () {
              d.DataArray.readNext(A, u, 0, q, G);
            }, 0);
          };
          d.DataArray.readSignedInt32GZIPBase64 = function (n) {
            var q = g.decodeArrayBuffer(n.data);
            q = h.inflate(q).buffer;
            n.data = new Int32Array(q, 0, q.byteLength / 4);
          };
          d.DataArray.readSignedInt32GZIPBase64Async = function (n, q, t) {
            var u = g.decodeArrayBuffer(n.data),
              A = new h.Inflate(),
              G = function () {
                n.data = new Int32Array(
                  A.result.buffer,
                  0,
                  A.result.buffer.byteLength / 4
                );
                t(n.data);
              };
            setTimeout(function () {
              d.DataArray.readNext(A, u, 0, q, G);
            }, 0);
          };
          d.DataArray.readFloat32GZIPBase64 = function (n) {
            var q = g.decodeArrayBuffer(n.data);
            q = h.inflate(q).buffer;
            n.data = new Float32Array(q, 0, q.byteLength / 4);
          };
          d.DataArray.readFloat32GZIPBase64Async = function (n, q, t) {
            var u = g.decodeArrayBuffer(n.data),
              A = new h.Inflate(),
              G = function () {
                n.data = new Float32Array(
                  A.result.buffer,
                  0,
                  A.result.buffer.byteLength / 4
                );
                t(n.data);
              };
            setTimeout(function () {
              d.DataArray.readNext(A, u, 0, q, G);
            }, 0);
          };
          d.DataArray.readNext = function (n, q, t, u, A) {
            var G = t + 32768,
              O = G >= q.byteLength;
            n.push(q.slice(t, t + 32768), O);
            O
              ? A()
              : (u(G / q.byteLength),
                setTimeout(function () {
                  d.DataArray.readNext(n, q, G, u, A);
                }, 0));
          };
          "undefined" !== typeof c && c.exports && (c.exports = d.DataArray);
        },
        { "../lib/base64-binary.js": 1, "./transform.js": 46, pako: 27 },
      ],
      45: [
        function (b, c, e) {
          var d = d || {};
          d.Utils =
            d.Utils || ("undefined" !== typeof b ? b("./utilities.js") : null);
          d.DataArray =
            d.DataArray ||
            ("undefined" !== typeof b ? b("./dataArray.js") : null);
          d.Transform =
            d.Transform ||
            ("undefined" !== typeof b ? b("./transform.js") : null);
          var g = g || ("undefined" !== typeof b ? b("sax") : null);
          d.TAG_TRANSFORM = "CoordinateSystemTransformMatrix";
          d.TAG_DATA = "Data";
          d.TAG_DATAARRAY = "DataArray";
          d.TAG_DATASPACE = "DataSpace";
          d.TAG_GIFTI = "GIFTI";
          d.TAG_LABEL = "Label";
          d.TAG_LABELTABLE = "LabelTable";
          d.TAG_MATRIXDATA = "MatrixData";
          d.TAG_METADATA = "MetaData";
          d.TAG_MD = "MD";
          d.TAG_NAME = "Name";
          d.TAG_TRANSFORMEDSPACE = "TransformedSpace";
          d.TAG_VALUE = "Value";
          d.GIFTI =
            d.GIFTI ||
            function () {
              this.attributes = null;
              this.metadata = {};
              this.dataArrays = [];
            };
          d.GIFTI.prototype.getPointsDataArray = function () {
            var h;
            for (h = 0; h < this.dataArrays.length; h += 1)
              if (this.dataArrays[h].isPointSet()) return this.dataArrays[h];
            return null;
          };
          d.GIFTI.prototype.getTrianglesDataArray = function () {
            var h;
            for (h = 0; h < this.dataArrays.length; h += 1)
              if (this.dataArrays[h].isTriangles()) return this.dataArrays[h];
            return null;
          };
          d.GIFTI.prototype.getNormalsDataArray = function () {
            var h;
            for (h = 0; h < this.dataArrays.length; h += 1)
              if (this.dataArrays[h].isNormals()) return this.dataArrays[h];
            return null;
          };
          d.GIFTI.prototype.getColorsDataArray = function () {
            var h;
            for (h = 0; h < this.dataArrays.length; h += 1)
              if (this.dataArrays[h].isColors()) return this.dataArrays[h];
            return null;
          };
          d.GIFTI.prototype.getZScoresDataArray = function () {
            var h;
            for (h = 0; h < this.dataArrays.length; h += 1)
              if (this.dataArrays[h].isZScore()) return this.dataArrays[h];
            return null;
          };
          d.GIFTI.prototype.getNumPoints = function () {
            var h;
            for (h = 0; h < this.dataArrays.length; h += 1)
              if (this.dataArrays[h].isPointSet())
                return this.dataArrays[h].getNumElements();
            return 0;
          };
          d.GIFTI.prototype.getNumTriangles = function () {
            var h;
            for (h = 0; h < this.dataArrays.length; h += 1)
              if (this.dataArrays[h].isTriangles())
                return this.dataArrays[h].getNumElements();
            return 0;
          };
          d.isThisFormat = function (h) {
            return -1 !== h.indexOf(".gii");
          };
          d.parse = function (h) {
            var n = g.parser(!0),
              q = null,
              t = null,
              u = null,
              A = null,
              G = null,
              O = null,
              H = "",
              P = !1,
              U = !1,
              ha = !1,
              w = !1,
              I = !1,
              aa = !1;
            n.onopentag = function (T) {
              T.name === d.TAG_GIFTI
                ? ((u = q = new d.GIFTI()), (q.attributes = T.attributes))
                : T.name !== d.TAG_METADATA &&
                  T.name !== d.TAG_MD &&
                  (T.name === d.TAG_NAME
                    ? (P = !0)
                    : T.name === d.TAG_VALUE
                    ? (U = !0)
                    : T.name === d.TAG_DATAARRAY
                    ? ((u = t = new d.DataArray()),
                      q.dataArrays.push(t),
                      (t.attributes = T.attributes))
                    : T.name === d.TAG_TRANSFORM
                    ? ((O = new d.Transform()), t.transforms.push(O))
                    : T.name === d.TAG_DATASPACE
                    ? (ha = !0)
                    : T.name === d.TAG_TRANSFORMEDSPACE
                    ? (w = !0)
                    : T.name === d.TAG_MATRIXDATA
                    ? (I = !0)
                    : T.name === d.TAG_DATA && (aa = !0));
            };
            n.ontext = n.oncdata = function (T) {
              P
                ? (H += T)
                : U
                ? (H += T)
                : ha
                ? (H += T)
                : w
                ? (H += T)
                : I
                ? (H += T)
                : aa && (H += T);
            };
            n.onclosetag = function (T) {
              T !== d.TAG_GIFTI &&
                T !== d.TAG_METADATA &&
                (T === d.TAG_MD
                  ? u && (u.metadata[A] = G)
                  : T === d.TAG_NAME
                  ? ((P = !1), (A = H), (H = ""))
                  : T === d.TAG_VALUE
                  ? ((U = !1), (G = H), (H = ""))
                  : T !== d.TAG_DATAARRAY &&
                    T !== d.TAG_TRANSFORM &&
                    (T === d.TAG_DATASPACE
                      ? ((ha = !1), (O.dataSpace = H), (H = ""))
                      : T === d.TAG_TRANSFORMEDSPACE
                      ? ((w = !1), (O.transformedSpace = H), (H = ""))
                      : T === d.TAG_MATRIXDATA
                      ? ((I = !1), (O.matrixData = H), (H = ""))
                      : T === d.TAG_DATA &&
                        ((aa = !1), (t.data = H), (H = ""))));
            };
            n.onerror = function (T) {
              console.log(T);
            };
            n.write(h).close();
            return q;
          };
          "undefined" !== typeof c && c.exports && (c.exports = d);
        },
        {
          "./dataArray.js": 44,
          "./transform.js": 46,
          "./utilities.js": 47,
          sax: 43,
        },
      ],
      46: [
        function (b, c, e) {
          var d = d || {};
          d.Transform =
            d.Transform ||
            function () {
              this.matrixData = this.transformedSpace = this.dataSpace = null;
            };
          "undefined" !== typeof c && c.exports && (c.exports = d.Transform);
        },
        {},
      ],
      47: [
        function (b, c, e) {
          var d = d || {};
          d.Utils = d.Utils || {};
          d.Utils.crcTable = null;
          d.Utils.makeCRCTable = function () {
            for (var g, h = [], n = 0; 256 > n; n++) {
              g = n;
              for (var q = 0; 8 > q; q++)
                g = g & 1 ? 3988292384 ^ (g >>> 1) : g >>> 1;
              h[n] = g;
            }
            return h;
          };
          d.Utils.crc32 = function (g) {
            for (
              var h =
                  d.Utils.crcTable ||
                  (d.Utils.crcTable = d.Utils.makeCRCTable()),
                n = -1,
                q = 0;
              q < g.byteLength;
              q++
            )
              n = (n >>> 8) ^ h[(n ^ g.getUint8(q)) & 255];
            return (n ^ -1) >>> 0;
          };
          "undefined" !== typeof c && c.exports && (c.exports = d.Utils);
        },
        {},
      ],
    },
    {},
    [45]
  )(45);
});
glMatrixArrayType =
  "undefined" != typeof Float32Array
    ? Float32Array
    : "undefined" != typeof WebGLFloatArray
    ? WebGLFloatArray
    : Array;
var vec3 = {
    create: function (a) {
      var b = new glMatrixArrayType(3);
      a && ((b[0] = a[0]), (b[1] = a[1]), (b[2] = a[2]));
      return b;
    },
    set: function (a, b) {
      b[0] = a[0];
      b[1] = a[1];
      b[2] = a[2];
      return b;
    },
    add: function (a, b, c) {
      if (!c || a == c)
        return (a[0] += b[0]), (a[1] += b[1]), (a[2] += b[2]), a;
      c[0] = a[0] + b[0];
      c[1] = a[1] + b[1];
      c[2] = a[2] + b[2];
      return c;
    },
    subtract: function (a, b, c) {
      if (!c || a == c)
        return (a[0] -= b[0]), (a[1] -= b[1]), (a[2] -= b[2]), a;
      c[0] = a[0] - b[0];
      c[1] = a[1] - b[1];
      c[2] = a[2] - b[2];
      return c;
    },
    negate: function (a, b) {
      b || (b = a);
      b[0] = -a[0];
      b[1] = -a[1];
      b[2] = -a[2];
      return b;
    },
    scale: function (a, b, c) {
      if (!c || a == c) return (a[0] *= b), (a[1] *= b), (a[2] *= b), a;
      c[0] = a[0] * b;
      c[1] = a[1] * b;
      c[2] = a[2] * b;
      return c;
    },
    normalize: function (a, b) {
      b || (b = a);
      var c = a[0],
        e = a[1];
      a = a[2];
      var d = Math.sqrt(c * c + e * e + a * a);
      if (d) {
        if (1 == d) return (b[0] = c), (b[1] = e), (b[2] = a), b;
      } else return (b[0] = 0), (b[1] = 0), (b[2] = 0), b;
      d = 1 / d;
      b[0] = c * d;
      b[1] = e * d;
      b[2] = a * d;
      return b;
    },
    cross: function (a, b, c) {
      c || (c = a);
      var e = a[0],
        d = a[1];
      a = a[2];
      var g = b[0],
        h = b[1];
      b = b[2];
      c[0] = d * b - a * h;
      c[1] = a * g - e * b;
      c[2] = e * h - d * g;
      return c;
    },
    length: function (a) {
      var b = a[0],
        c = a[1];
      a = a[2];
      return Math.sqrt(b * b + c * c + a * a);
    },
    dot: function (a, b) {
      return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
    },
    direction: function (a, b, c) {
      c || (c = a);
      var e = a[0] - b[0],
        d = a[1] - b[1];
      a = a[2] - b[2];
      b = Math.sqrt(e * e + d * d + a * a);
      if (!b) return (c[0] = 0), (c[1] = 0), (c[2] = 0), c;
      b = 1 / b;
      c[0] = e * b;
      c[1] = d * b;
      c[2] = a * b;
      return c;
    },
    lerp: function (a, b, c, e) {
      e || (e = a);
      e[0] = a[0] + c * (b[0] - a[0]);
      e[1] = a[1] + c * (b[1] - a[1]);
      e[2] = a[2] + c * (b[2] - a[2]);
      return e;
    },
    str: function (a) {
      return "[" + a[0] + ", " + a[1] + ", " + a[2] + "]";
    },
  },
  mat3 = {
    create: function (a) {
      var b = new glMatrixArrayType(9);
      a &&
        ((b[0] = a[0]),
        (b[1] = a[1]),
        (b[2] = a[2]),
        (b[3] = a[3]),
        (b[4] = a[4]),
        (b[5] = a[5]),
        (b[6] = a[6]),
        (b[7] = a[7]),
        (b[8] = a[8]),
        (b[9] = a[9]));
      return b;
    },
    set: function (a, b) {
      b[0] = a[0];
      b[1] = a[1];
      b[2] = a[2];
      b[3] = a[3];
      b[4] = a[4];
      b[5] = a[5];
      b[6] = a[6];
      b[7] = a[7];
      b[8] = a[8];
      return b;
    },
    identity: function (a) {
      a[0] = 1;
      a[1] = 0;
      a[2] = 0;
      a[3] = 0;
      a[4] = 1;
      a[5] = 0;
      a[6] = 0;
      a[7] = 0;
      a[8] = 1;
      return a;
    },
    transpose: function (a, b) {
      if (!b || a == b) {
        b = a[1];
        var c = a[2],
          e = a[5];
        a[1] = a[3];
        a[2] = a[6];
        a[3] = b;
        a[5] = a[7];
        a[6] = c;
        a[7] = e;
        return a;
      }
      b[0] = a[0];
      b[1] = a[3];
      b[2] = a[6];
      b[3] = a[1];
      b[4] = a[4];
      b[5] = a[7];
      b[6] = a[2];
      b[7] = a[5];
      b[8] = a[8];
      return b;
    },
    toMat4: function (a, b) {
      b || (b = mat4.create());
      b[0] = a[0];
      b[1] = a[1];
      b[2] = a[2];
      b[3] = 0;
      b[4] = a[3];
      b[5] = a[4];
      b[6] = a[5];
      b[7] = 0;
      b[8] = a[6];
      b[9] = a[7];
      b[10] = a[8];
      b[11] = 0;
      b[12] = 0;
      b[13] = 0;
      b[14] = 0;
      b[15] = 1;
      return b;
    },
    str: function (a) {
      return (
        "[" +
        a[0] +
        ", " +
        a[1] +
        ", " +
        a[2] +
        ", " +
        a[3] +
        ", " +
        a[4] +
        ", " +
        a[5] +
        ", " +
        a[6] +
        ", " +
        a[7] +
        ", " +
        a[8] +
        "]"
      );
    },
  },
  mat4 = {
    create: function (a) {
      var b = new glMatrixArrayType(16);
      a &&
        ((b[0] = a[0]),
        (b[1] = a[1]),
        (b[2] = a[2]),
        (b[3] = a[3]),
        (b[4] = a[4]),
        (b[5] = a[5]),
        (b[6] = a[6]),
        (b[7] = a[7]),
        (b[8] = a[8]),
        (b[9] = a[9]),
        (b[10] = a[10]),
        (b[11] = a[11]),
        (b[12] = a[12]),
        (b[13] = a[13]),
        (b[14] = a[14]),
        (b[15] = a[15]));
      return b;
    },
    set: function (a, b) {
      b[0] = a[0];
      b[1] = a[1];
      b[2] = a[2];
      b[3] = a[3];
      b[4] = a[4];
      b[5] = a[5];
      b[6] = a[6];
      b[7] = a[7];
      b[8] = a[8];
      b[9] = a[9];
      b[10] = a[10];
      b[11] = a[11];
      b[12] = a[12];
      b[13] = a[13];
      b[14] = a[14];
      b[15] = a[15];
      return b;
    },
    identity: function (a) {
      a[0] = 1;
      a[1] = 0;
      a[2] = 0;
      a[3] = 0;
      a[4] = 0;
      a[5] = 1;
      a[6] = 0;
      a[7] = 0;
      a[8] = 0;
      a[9] = 0;
      a[10] = 1;
      a[11] = 0;
      a[12] = 0;
      a[13] = 0;
      a[14] = 0;
      a[15] = 1;
      return a;
    },
    transpose: function (a, b) {
      if (!b || a == b) {
        b = a[1];
        var c = a[2],
          e = a[3],
          d = a[6],
          g = a[7],
          h = a[11];
        a[1] = a[4];
        a[2] = a[8];
        a[3] = a[12];
        a[4] = b;
        a[6] = a[9];
        a[7] = a[13];
        a[8] = c;
        a[9] = d;
        a[11] = a[14];
        a[12] = e;
        a[13] = g;
        a[14] = h;
        return a;
      }
      b[0] = a[0];
      b[1] = a[4];
      b[2] = a[8];
      b[3] = a[12];
      b[4] = a[1];
      b[5] = a[5];
      b[6] = a[9];
      b[7] = a[13];
      b[8] = a[2];
      b[9] = a[6];
      b[10] = a[10];
      b[11] = a[14];
      b[12] = a[3];
      b[13] = a[7];
      b[14] = a[11];
      b[15] = a[15];
      return b;
    },
    determinant: function (a) {
      var b = a[0],
        c = a[1],
        e = a[2],
        d = a[3],
        g = a[4],
        h = a[5],
        n = a[6],
        q = a[7],
        t = a[8],
        u = a[9],
        A = a[10],
        G = a[11],
        O = a[12],
        H = a[13],
        P = a[14];
      a = a[15];
      return (
        O * u * n * d -
        t * H * n * d -
        O * h * A * d +
        g * H * A * d +
        t * h * P * d -
        g * u * P * d -
        O * u * e * q +
        t * H * e * q +
        O * c * A * q -
        b * H * A * q -
        t * c * P * q +
        b * u * P * q +
        O * h * e * G -
        g * H * e * G -
        O * c * n * G +
        b * H * n * G +
        g * c * P * G -
        b * h * P * G -
        t * h * e * a +
        g * u * e * a +
        t * c * n * a -
        b * u * n * a -
        g * c * A * a +
        b * h * A * a
      );
    },
    inverse: function (a, b) {
      b || (b = a);
      var c = a[0],
        e = a[1],
        d = a[2],
        g = a[3],
        h = a[4],
        n = a[5],
        q = a[6],
        t = a[7],
        u = a[8],
        A = a[9],
        G = a[10],
        O = a[11],
        H = a[12],
        P = a[13],
        U = a[14];
      a = a[15];
      var ha = c * n - e * h,
        w = c * q - d * h,
        I = c * t - g * h,
        aa = e * q - d * n,
        T = e * t - g * n,
        ka = d * t - g * q,
        k = u * P - A * H,
        X = u * U - G * H,
        V = u * a - O * H,
        p = A * U - G * P,
        m = A * a - O * P,
        F = G * a - O * U,
        r = 1 / (ha * F - w * m + I * p + aa * V - T * X + ka * k);
      b[0] = (n * F - q * m + t * p) * r;
      b[1] = (-e * F + d * m - g * p) * r;
      b[2] = (P * ka - U * T + a * aa) * r;
      b[3] = (-A * ka + G * T - O * aa) * r;
      b[4] = (-h * F + q * V - t * X) * r;
      b[5] = (c * F - d * V + g * X) * r;
      b[6] = (-H * ka + U * I - a * w) * r;
      b[7] = (u * ka - G * I + O * w) * r;
      b[8] = (h * m - n * V + t * k) * r;
      b[9] = (-c * m + e * V - g * k) * r;
      b[10] = (H * T - P * I + a * ha) * r;
      b[11] = (-u * T + A * I - O * ha) * r;
      b[12] = (-h * p + n * X - q * k) * r;
      b[13] = (c * p - e * X + d * k) * r;
      b[14] = (-H * aa + P * w - U * ha) * r;
      b[15] = (u * aa - A * w + G * ha) * r;
      return b;
    },
    toRotationMat: function (a, b) {
      b || (b = mat4.create());
      b[0] = a[0];
      b[1] = a[1];
      b[2] = a[2];
      b[3] = a[3];
      b[4] = a[4];
      b[5] = a[5];
      b[6] = a[6];
      b[7] = a[7];
      b[8] = a[8];
      b[9] = a[9];
      b[10] = a[10];
      b[11] = a[11];
      b[12] = 0;
      b[13] = 0;
      b[14] = 0;
      b[15] = 1;
      return b;
    },
    toMat3: function (a, b) {
      b || (b = mat3.create());
      b[0] = a[0];
      b[1] = a[1];
      b[2] = a[2];
      b[3] = a[4];
      b[4] = a[5];
      b[5] = a[6];
      b[6] = a[8];
      b[7] = a[9];
      b[8] = a[10];
      return b;
    },
    toInverseMat3: function (a, b) {
      var c = a[0],
        e = a[1],
        d = a[2],
        g = a[4],
        h = a[5],
        n = a[6],
        q = a[8],
        t = a[9];
      a = a[10];
      var u = a * h - n * t,
        A = -a * g + n * q,
        G = t * g - h * q,
        O = c * u + e * A + d * G;
      if (!O) return null;
      O = 1 / O;
      b || (b = mat3.create());
      b[0] = u * O;
      b[1] = (-a * e + d * t) * O;
      b[2] = (n * e - d * h) * O;
      b[3] = A * O;
      b[4] = (a * c - d * q) * O;
      b[5] = (-n * c + d * g) * O;
      b[6] = G * O;
      b[7] = (-t * c + e * q) * O;
      b[8] = (h * c - e * g) * O;
      return b;
    },
    multiply: function (a, b, c) {
      c || (c = a);
      var e = a[0],
        d = a[1],
        g = a[2],
        h = a[3],
        n = a[4],
        q = a[5],
        t = a[6],
        u = a[7],
        A = a[8],
        G = a[9],
        O = a[10],
        H = a[11],
        P = a[12],
        U = a[13],
        ha = a[14];
      a = a[15];
      var w = b[0],
        I = b[1],
        aa = b[2],
        T = b[3],
        ka = b[4],
        k = b[5],
        X = b[6],
        V = b[7],
        p = b[8],
        m = b[9],
        F = b[10],
        r = b[11],
        y = b[12],
        D = b[13],
        B = b[14];
      b = b[15];
      c[0] = w * e + I * n + aa * A + T * P;
      c[1] = w * d + I * q + aa * G + T * U;
      c[2] = w * g + I * t + aa * O + T * ha;
      c[3] = w * h + I * u + aa * H + T * a;
      c[4] = ka * e + k * n + X * A + V * P;
      c[5] = ka * d + k * q + X * G + V * U;
      c[6] = ka * g + k * t + X * O + V * ha;
      c[7] = ka * h + k * u + X * H + V * a;
      c[8] = p * e + m * n + F * A + r * P;
      c[9] = p * d + m * q + F * G + r * U;
      c[10] = p * g + m * t + F * O + r * ha;
      c[11] = p * h + m * u + F * H + r * a;
      c[12] = y * e + D * n + B * A + b * P;
      c[13] = y * d + D * q + B * G + b * U;
      c[14] = y * g + D * t + B * O + b * ha;
      c[15] = y * h + D * u + B * H + b * a;
      return c;
    },
    multiplyVec3: function (a, b, c) {
      c || (c = b);
      var e = b[0],
        d = b[1];
      b = b[2];
      c[0] = a[0] * e + a[4] * d + a[8] * b + a[12];
      c[1] = a[1] * e + a[5] * d + a[9] * b + a[13];
      c[2] = a[2] * e + a[6] * d + a[10] * b + a[14];
      return c;
    },
    multiplyVec4: function (a, b, c) {
      c || (c = b);
      var e = b[0],
        d = b[1],
        g = b[2];
      b = b[3];
      c[0] = a[0] * e + a[4] * d + a[8] * g + a[12] * b;
      c[1] = a[1] * e + a[5] * d + a[9] * g + a[13] * b;
      c[2] = a[2] * e + a[6] * d + a[10] * g + a[14] * b;
      c[3] = a[3] * e + a[7] * d + a[11] * g + a[15] * b;
      return c;
    },
    translate: function (a, b, c) {
      var e = b[0],
        d = b[1];
      b = b[2];
      if (!c || a == c)
        return (
          (a[12] = a[0] * e + a[4] * d + a[8] * b + a[12]),
          (a[13] = a[1] * e + a[5] * d + a[9] * b + a[13]),
          (a[14] = a[2] * e + a[6] * d + a[10] * b + a[14]),
          (a[15] = a[3] * e + a[7] * d + a[11] * b + a[15]),
          a
        );
      var g = a[0],
        h = a[1],
        n = a[2],
        q = a[3],
        t = a[4],
        u = a[5],
        A = a[6],
        G = a[7],
        O = a[8],
        H = a[9],
        P = a[10],
        U = a[11];
      c[0] = g;
      c[1] = h;
      c[2] = n;
      c[3] = q;
      c[4] = t;
      c[5] = u;
      c[6] = A;
      c[7] = G;
      c[8] = O;
      c[9] = H;
      c[10] = P;
      c[11] = U;
      c[12] = g * e + t * d + O * b + a[12];
      c[13] = h * e + u * d + H * b + a[13];
      c[14] = n * e + A * d + P * b + a[14];
      c[15] = q * e + G * d + U * b + a[15];
      return c;
    },
    scale: function (a, b, c) {
      var e = b[0],
        d = b[1];
      b = b[2];
      if (!c || a == c)
        return (
          (a[0] *= e),
          (a[1] *= e),
          (a[2] *= e),
          (a[3] *= e),
          (a[4] *= d),
          (a[5] *= d),
          (a[6] *= d),
          (a[7] *= d),
          (a[8] *= b),
          (a[9] *= b),
          (a[10] *= b),
          (a[11] *= b),
          a
        );
      c[0] = a[0] * e;
      c[1] = a[1] * e;
      c[2] = a[2] * e;
      c[3] = a[3] * e;
      c[4] = a[4] * d;
      c[5] = a[5] * d;
      c[6] = a[6] * d;
      c[7] = a[7] * d;
      c[8] = a[8] * b;
      c[9] = a[9] * b;
      c[10] = a[10] * b;
      c[11] = a[11] * b;
      c[12] = a[12];
      c[13] = a[13];
      c[14] = a[14];
      c[15] = a[15];
      return c;
    },
    rotate: function (a, b, c, e) {
      var d = c[0],
        g = c[1];
      c = c[2];
      var h = Math.sqrt(d * d + g * g + c * c);
      if (!h) return null;
      1 != h && ((h = 1 / h), (d *= h), (g *= h), (c *= h));
      var n = Math.sin(b),
        q = Math.cos(b),
        t = 1 - q;
      b = a[0];
      h = a[1];
      var u = a[2],
        A = a[3],
        G = a[4],
        O = a[5],
        H = a[6],
        P = a[7],
        U = a[8],
        ha = a[9],
        w = a[10],
        I = a[11],
        aa = d * d * t + q,
        T = g * d * t + c * n,
        ka = c * d * t - g * n,
        k = d * g * t - c * n,
        X = g * g * t + q,
        V = c * g * t + d * n,
        p = d * c * t + g * n;
      d = g * c * t - d * n;
      g = c * c * t + q;
      e
        ? a != e &&
          ((e[12] = a[12]), (e[13] = a[13]), (e[14] = a[14]), (e[15] = a[15]))
        : (e = a);
      e[0] = b * aa + G * T + U * ka;
      e[1] = h * aa + O * T + ha * ka;
      e[2] = u * aa + H * T + w * ka;
      e[3] = A * aa + P * T + I * ka;
      e[4] = b * k + G * X + U * V;
      e[5] = h * k + O * X + ha * V;
      e[6] = u * k + H * X + w * V;
      e[7] = A * k + P * X + I * V;
      e[8] = b * p + G * d + U * g;
      e[9] = h * p + O * d + ha * g;
      e[10] = u * p + H * d + w * g;
      e[11] = A * p + P * d + I * g;
      return e;
    },
    rotateX: function (a, b, c) {
      var e = Math.sin(b);
      b = Math.cos(b);
      var d = a[4],
        g = a[5],
        h = a[6],
        n = a[7],
        q = a[8],
        t = a[9],
        u = a[10],
        A = a[11];
      c
        ? a != c &&
          ((c[0] = a[0]),
          (c[1] = a[1]),
          (c[2] = a[2]),
          (c[3] = a[3]),
          (c[12] = a[12]),
          (c[13] = a[13]),
          (c[14] = a[14]),
          (c[15] = a[15]))
        : (c = a);
      c[4] = d * b + q * e;
      c[5] = g * b + t * e;
      c[6] = h * b + u * e;
      c[7] = n * b + A * e;
      c[8] = d * -e + q * b;
      c[9] = g * -e + t * b;
      c[10] = h * -e + u * b;
      c[11] = n * -e + A * b;
      return c;
    },
    rotateY: function (a, b, c) {
      var e = Math.sin(b);
      b = Math.cos(b);
      var d = a[0],
        g = a[1],
        h = a[2],
        n = a[3],
        q = a[8],
        t = a[9],
        u = a[10],
        A = a[11];
      c
        ? a != c &&
          ((c[4] = a[4]),
          (c[5] = a[5]),
          (c[6] = a[6]),
          (c[7] = a[7]),
          (c[12] = a[12]),
          (c[13] = a[13]),
          (c[14] = a[14]),
          (c[15] = a[15]))
        : (c = a);
      c[0] = d * b + q * -e;
      c[1] = g * b + t * -e;
      c[2] = h * b + u * -e;
      c[3] = n * b + A * -e;
      c[8] = d * e + q * b;
      c[9] = g * e + t * b;
      c[10] = h * e + u * b;
      c[11] = n * e + A * b;
      return c;
    },
    rotateZ: function (a, b, c) {
      var e = Math.sin(b);
      b = Math.cos(b);
      var d = a[0],
        g = a[1],
        h = a[2],
        n = a[3],
        q = a[4],
        t = a[5],
        u = a[6],
        A = a[7];
      c
        ? a != c &&
          ((c[8] = a[8]),
          (c[9] = a[9]),
          (c[10] = a[10]),
          (c[11] = a[11]),
          (c[12] = a[12]),
          (c[13] = a[13]),
          (c[14] = a[14]),
          (c[15] = a[15]))
        : (c = a);
      c[0] = d * b + q * e;
      c[1] = g * b + t * e;
      c[2] = h * b + u * e;
      c[3] = n * b + A * e;
      c[4] = d * -e + q * b;
      c[5] = g * -e + t * b;
      c[6] = h * -e + u * b;
      c[7] = n * -e + A * b;
      return c;
    },
    frustum: function (a, b, c, e, d, g, h) {
      h || (h = mat4.create());
      var n = b - a,
        q = e - c,
        t = g - d;
      h[0] = (2 * d) / n;
      h[1] = 0;
      h[2] = 0;
      h[3] = 0;
      h[4] = 0;
      h[5] = (2 * d) / q;
      h[6] = 0;
      h[7] = 0;
      h[8] = (b + a) / n;
      h[9] = (e + c) / q;
      h[10] = -(g + d) / t;
      h[11] = -1;
      h[12] = 0;
      h[13] = 0;
      h[14] = -(g * d * 2) / t;
      h[15] = 0;
      return h;
    },
    perspective: function (a, b, c, e, d) {
      a = c * Math.tan((a * Math.PI) / 360);
      b *= a;
      return mat4.frustum(-b, b, -a, a, c, e, d);
    },
    ortho: function (a, b, c, e, d, g, h) {
      h || (h = mat4.create());
      var n = b - a,
        q = e - c,
        t = g - d;
      h[0] = 2 / n;
      h[1] = 0;
      h[2] = 0;
      h[3] = 0;
      h[4] = 0;
      h[5] = 2 / q;
      h[6] = 0;
      h[7] = 0;
      h[8] = 0;
      h[9] = 0;
      h[10] = -2 / t;
      h[11] = 0;
      h[12] = -(a + b) / n;
      h[13] = -(e + c) / q;
      h[14] = -(g + d) / t;
      h[15] = 1;
      return h;
    },
    lookAt: function (a, b, c, e) {
      e || (e = mat4.create());
      var d = a[0],
        g = a[1];
      a = a[2];
      var h = c[0],
        n = c[1],
        q = c[2];
      c = b[1];
      var t = b[2];
      if (d == b[0] && g == c && a == t) return mat4.identity(e);
      c = d - b[0];
      t = g - b[1];
      b = a - b[2];
      var u = 1 / Math.sqrt(c * c + t * t + b * b);
      c *= u;
      t *= u;
      b *= u;
      var A = n * b - q * t;
      q = q * c - h * b;
      h = h * t - n * c;
      (u = Math.sqrt(A * A + q * q + h * h))
        ? ((u = 1 / u), (A *= u), (q *= u), (h *= u))
        : (h = q = A = 0);
      n = t * h - b * q;
      var G = b * A - c * h;
      var O = c * q - t * A;
      (u = Math.sqrt(n * n + G * G + O * O))
        ? ((u = 1 / u), (n *= u), (G *= u), (O *= u))
        : (O = G = n = 0);
      e[0] = A;
      e[1] = n;
      e[2] = c;
      e[3] = 0;
      e[4] = q;
      e[5] = G;
      e[6] = t;
      e[7] = 0;
      e[8] = h;
      e[9] = O;
      e[10] = b;
      e[11] = 0;
      e[12] = -(A * d + q * g + h * a);
      e[13] = -(n * d + G * g + O * a);
      e[14] = -(c * d + t * g + b * a);
      e[15] = 1;
      return e;
    },
    str: function (a) {
      return (
        "[" +
        a[0] +
        ", " +
        a[1] +
        ", " +
        a[2] +
        ", " +
        a[3] +
        ", " +
        a[4] +
        ", " +
        a[5] +
        ", " +
        a[6] +
        ", " +
        a[7] +
        ", " +
        a[8] +
        ", " +
        a[9] +
        ", " +
        a[10] +
        ", " +
        a[11] +
        ", " +
        a[12] +
        ", " +
        a[13] +
        ", " +
        a[14] +
        ", " +
        a[15] +
        "]"
      );
    },
  };
quat4 = {
  create: function (a) {
    var b = new glMatrixArrayType(4);
    a && ((b[0] = a[0]), (b[1] = a[1]), (b[2] = a[2]), (b[3] = a[3]));
    return b;
  },
  set: function (a, b) {
    b[0] = a[0];
    b[1] = a[1];
    b[2] = a[2];
    b[3] = a[3];
    return b;
  },
  calculateW: function (a, b) {
    var c = a[0],
      e = a[1],
      d = a[2];
    if (!b || a == b)
      return (a[3] = -Math.sqrt(Math.abs(1 - c * c - e * e - d * d))), a;
    b[0] = c;
    b[1] = e;
    b[2] = d;
    b[3] = -Math.sqrt(Math.abs(1 - c * c - e * e - d * d));
    return b;
  },
  inverse: function (a, b) {
    if (!b || a == b) return (a[0] *= 1), (a[1] *= 1), (a[2] *= 1), a;
    b[0] = -a[0];
    b[1] = -a[1];
    b[2] = -a[2];
    b[3] = a[3];
    return b;
  },
  length: function (a) {
    var b = a[0],
      c = a[1],
      e = a[2];
    a = a[3];
    return Math.sqrt(b * b + c * c + e * e + a * a);
  },
  normalize: function (a, b) {
    b || (b = a);
    var c = a[0],
      e = a[1],
      d = a[2];
    a = a[3];
    var g = Math.sqrt(c * c + e * e + d * d + a * a);
    if (0 == g) return (b[0] = 0), (b[1] = 0), (b[2] = 0), (b[3] = 0), b;
    g = 1 / g;
    b[0] = c * g;
    b[1] = e * g;
    b[2] = d * g;
    b[3] = a * g;
    return b;
  },
  multiply: function (a, b, c) {
    c || (c = a);
    var e = a[0],
      d = a[1],
      g = a[2];
    a = a[3];
    var h = b[0],
      n = b[1],
      q = b[2];
    b = b[3];
    c[0] = e * b + a * h + d * q - g * n;
    c[1] = d * b + a * n + g * h - e * q;
    c[2] = g * b + a * q + e * n - d * h;
    c[3] = a * b - e * h - d * n - g * q;
    return c;
  },
  multiplyVec3: function (a, b, c) {
    c || (c = b);
    var e = b[0],
      d = b[1],
      g = b[2];
    b = a[0];
    var h = a[1],
      n = a[2];
    a = a[3];
    var q = a * e + h * g - n * d,
      t = a * d + n * e - b * g,
      u = a * g + b * d - h * e;
    e = -b * e - h * d - n * g;
    c[0] = q * a + e * -b + t * -n - u * -h;
    c[1] = t * a + e * -h + u * -b - q * -n;
    c[2] = u * a + e * -n + q * -h - t * -b;
    return c;
  },
  toMat3: function (a, b) {
    b || (b = mat3.create());
    var c = a[0],
      e = a[1],
      d = a[2];
    a = a[3];
    var g = c + c,
      h = e + e,
      n = d + d,
      q = c * g,
      t = c * h;
    c *= n;
    var u = e * h;
    e *= n;
    d *= n;
    g *= a;
    h *= a;
    a *= n;
    b[0] = 1 - (u + d);
    b[1] = t - a;
    b[2] = c + h;
    b[3] = t + a;
    b[4] = 1 - (q + d);
    b[5] = e - g;
    b[6] = c - h;
    b[7] = e + g;
    b[8] = 1 - (q + u);
    return b;
  },
  toMat4: function (a, b) {
    b || (b = mat4.create());
    var c = a[0],
      e = a[1],
      d = a[2];
    a = a[3];
    var g = c + c,
      h = e + e,
      n = d + d,
      q = c * g,
      t = c * h;
    c *= n;
    var u = e * h;
    e *= n;
    d *= n;
    g *= a;
    h *= a;
    a *= n;
    b[0] = 1 - (u + d);
    b[1] = t - a;
    b[2] = c + h;
    b[3] = 0;
    b[4] = t + a;
    b[5] = 1 - (q + d);
    b[6] = e - g;
    b[7] = 0;
    b[8] = c - h;
    b[9] = e + g;
    b[10] = 1 - (q + u);
    b[11] = 0;
    b[12] = 0;
    b[13] = 0;
    b[14] = 0;
    b[15] = 1;
    return b;
  },
  slerp: function (a, b, c, e) {
    e || (e = a);
    var d = c;
    0 > a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3] && (d = -1 * c);
    e[0] = 1 - c * a[0] + d * b[0];
    e[1] = 1 - c * a[1] + d * b[1];
    e[2] = 1 - c * a[2] + d * b[2];
    e[3] = 1 - c * a[3] + d * b[3];
    return e;
  },
  str: function (a) {
    return "[" + a[0] + ", " + a[1] + ", " + a[2] + ", " + a[3] + "]";
  },
};
var GLU = {};
(function (a) {
  a.unProject = function (b, c, e, d, g, h, n) {
    b = [b, c, e, 1];
    c = [];
    a.multMatrices(d, g, c);
    if (!a.invertMatrix(c, c)) return !1;
    b[0] = (b[0] - h[0]) / h[2];
    b[1] = (b[1] - h[1]) / h[3];
    b[0] = 2 * b[0] - 1;
    b[1] = 2 * b[1] - 1;
    b[2] = 2 * b[2] - 1;
    d = [];
    a.multMatrixVec(c, b, d);
    if (0 === d[3]) return !1;
    d[0] /= d[3];
    d[1] /= d[3];
    d[2] /= d[3];
    n[0] = d[0];
    n[1] = d[1];
    n[2] = d[2];
    return !0;
  };
  a.multMatrixVec = function (b, c, e) {
    for (var d = 0; 4 > d; d += 1)
      e[d] =
        c[0] * b[0 + d] + c[1] * b[4 + d] + c[2] * b[8 + d] + c[3] * b[12 + d];
  };
  a.multMatrices = function (b, c, e) {
    for (var d = 0; 4 > d; d += 1)
      for (var g = 0; 4 > g; g += 1)
        e[4 * d + g] =
          b[4 * d] * c[0 + g] +
          b[4 * d + 1] * c[4 + g] +
          b[4 * d + 2] * c[8 + g] +
          b[4 * d + 3] * c[12 + g];
  };
  a.invertMatrix = function (b, c) {
    var e = [];
    e[0] =
      b[5] * b[10] * b[15] -
      b[5] * b[11] * b[14] -
      b[9] * b[6] * b[15] +
      b[9] * b[7] * b[14] +
      b[13] * b[6] * b[11] -
      b[13] * b[7] * b[10];
    e[4] =
      -b[4] * b[10] * b[15] +
      b[4] * b[11] * b[14] +
      b[8] * b[6] * b[15] -
      b[8] * b[7] * b[14] -
      b[12] * b[6] * b[11] +
      b[12] * b[7] * b[10];
    e[8] =
      b[4] * b[9] * b[15] -
      b[4] * b[11] * b[13] -
      b[8] * b[5] * b[15] +
      b[8] * b[7] * b[13] +
      b[12] * b[5] * b[11] -
      b[12] * b[7] * b[9];
    e[12] =
      -b[4] * b[9] * b[14] +
      b[4] * b[10] * b[13] +
      b[8] * b[5] * b[14] -
      b[8] * b[6] * b[13] -
      b[12] * b[5] * b[10] +
      b[12] * b[6] * b[9];
    e[1] =
      -b[1] * b[10] * b[15] +
      b[1] * b[11] * b[14] +
      b[9] * b[2] * b[15] -
      b[9] * b[3] * b[14] -
      b[13] * b[2] * b[11] +
      b[13] * b[3] * b[10];
    e[5] =
      b[0] * b[10] * b[15] -
      b[0] * b[11] * b[14] -
      b[8] * b[2] * b[15] +
      b[8] * b[3] * b[14] +
      b[12] * b[2] * b[11] -
      b[12] * b[3] * b[10];
    e[9] =
      -b[0] * b[9] * b[15] +
      b[0] * b[11] * b[13] +
      b[8] * b[1] * b[15] -
      b[8] * b[3] * b[13] -
      b[12] * b[1] * b[11] +
      b[12] * b[3] * b[9];
    e[13] =
      b[0] * b[9] * b[14] -
      b[0] * b[10] * b[13] -
      b[8] * b[1] * b[14] +
      b[8] * b[2] * b[13] +
      b[12] * b[1] * b[10] -
      b[12] * b[2] * b[9];
    e[2] =
      b[1] * b[6] * b[15] -
      b[1] * b[7] * b[14] -
      b[5] * b[2] * b[15] +
      b[5] * b[3] * b[14] +
      b[13] * b[2] * b[7] -
      b[13] * b[3] * b[6];
    e[6] =
      -b[0] * b[6] * b[15] +
      b[0] * b[7] * b[14] +
      b[4] * b[2] * b[15] -
      b[4] * b[3] * b[14] -
      b[12] * b[2] * b[7] +
      b[12] * b[3] * b[6];
    e[10] =
      b[0] * b[5] * b[15] -
      b[0] * b[7] * b[13] -
      b[4] * b[1] * b[15] +
      b[4] * b[3] * b[13] +
      b[12] * b[1] * b[7] -
      b[12] * b[3] * b[5];
    e[14] =
      -b[0] * b[5] * b[14] +
      b[0] * b[6] * b[13] +
      b[4] * b[1] * b[14] -
      b[4] * b[2] * b[13] -
      b[12] * b[1] * b[6] +
      b[12] * b[2] * b[5];
    e[3] =
      -b[1] * b[6] * b[11] +
      b[1] * b[7] * b[10] +
      b[5] * b[2] * b[11] -
      b[5] * b[3] * b[10] -
      b[9] * b[2] * b[7] +
      b[9] * b[3] * b[6];
    e[7] =
      b[0] * b[6] * b[11] -
      b[0] * b[7] * b[10] -
      b[4] * b[2] * b[11] +
      b[4] * b[3] * b[10] +
      b[8] * b[2] * b[7] -
      b[8] * b[3] * b[6];
    e[11] =
      -b[0] * b[5] * b[11] +
      b[0] * b[7] * b[9] +
      b[4] * b[1] * b[11] -
      b[4] * b[3] * b[9] -
      b[8] * b[1] * b[7] +
      b[8] * b[3] * b[5];
    e[15] =
      b[0] * b[5] * b[10] -
      b[0] * b[6] * b[9] -
      b[4] * b[1] * b[10] +
      b[4] * b[2] * b[9] +
      b[8] * b[1] * b[6] -
      b[8] * b[2] * b[5];
    b = b[0] * e[0] + b[1] * e[4] + b[2] * e[8] + b[3] * e[12];
    if (0 === b) return !1;
    b = 1 / b;
    for (var d = 0; 16 > d; d += 1) c[d] = e[d] * b;
    return !0;
  };
})(GLU);
var PAPAYA_BROWSER_MIN_FIREFOX = 7,
  PAPAYA_BROWSER_MIN_CHROME = 7,
  PAPAYA_BROWSER_MIN_SAFARI = 6,
  PAPAYA_BROWSER_MIN_IE = 10,
  PAPAYA_BROWSER_MIN_OPERA = 12,
  PAPAYA_SURFACE_BROWSER_MIN_FIREFOX = 7,
  PAPAYA_SURFACE_BROWSER_MIN_CHROME = 8,
  PAPAYA_SURFACE_BROWSER_MIN_SAFARI = 6,
  PAPAYA_SURFACE_BROWSER_MIN_IE = 11,
  PAPAYA_SURFACE_BROWSER_MIN_OPERA = 12,
  PAPAYA_CONTAINER_CLASS_NAME = "papaya",
  PAPAYA_CONTAINER_COLLAPSABLE = "papaya-collapsable",
  PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT = "papaya-collapsable-exempt",
  PAPAYA_CONTAINER_FULLSCREEN = "papaya-fullscreen",
  PAPAYA_VIEWER_CSS = "papaya-viewer",
  PAPAYA_TOOLBAR_CSS = "papaya-toolbar",
  PAPAYA_TITLEBAR_CSS = "papaya-titlebar",
  PAPAYA_SLIDER_CSS = "papaya-slider-slice",
  PAPAYA_KIOSK_CONTROLS_CSS = "papaya-kiosk-controls",
  PAPAYA_DISPLAY_CSS = "papaya-display",
  PAPAYA_DIALOG_CSS = "papaya-dialog",
  PAPAYA_DIALOG_CONTENT_CSS = "papaya-dialog-content",
  PAPAYA_DIALOG_CONTENT_NOWRAP_CSS = "papaya-dialog-content-nowrap",
  PAPAYA_DIALOG_CONTENT_LABEL_CSS = "papaya-dialog-content-label",
  PAPAYA_DIALOG_CONTENT_CONTROL_CSS = "papaya-dialog-content-control",
  PAPAYA_DIALOG_TITLE_CSS = "papaya-dialog-title",
  PAPAYA_DIALOG_BUTTON_CSS = "papaya-dialog-button",
  PAPAYA_DIALOG_BACKGROUND = "papaya-dialog-background",
  PAPAYA_DIALOG_STOPSCROLL = "papaya-dialog-stopscroll",
  PAPAYA_DIALOG_CONTENT_HELP = "papaya-dialog-content-help",
  PAPAYA_MENU_CSS = "papaya-menu",
  PAPAYA_MENU_LABEL_CSS = "papaya-menu-label",
  PAPAYA_MENU_TITLEBAR_CSS = "papaya-menu-titlebar",
  PAPAYA_MENU_ICON_CSS = "papaya-menu-icon",
  PAPAYA_MENU_HOVERING_CSS = "papaya-menu-hovering",
  PAPAYA_MENU_SPACER_CSS = "papaya-menu-spacer",
  PAPAYA_MENU_UNSELECTABLE = "papaya-menu-unselectable",
  PAPAYA_MENU_FILECHOOSER = "papaya-menu-filechooser",
  PAPAYA_MENU_BUTTON_CSS = "papaya-menu-button",
  PAPAYA_MENU_BUTTON_HOVERING_CSS = "papaya-menu-button-hovering",
  PAPAYA_MENU_COLORTABLE_CSS = "papaya-menu-colortable",
  PAPAYA_MENU_INPUT_FIELD = "papaya-menu-input",
  PAPAYA_MENU_SLIDER = "papaya-menu-slider",
  PAPAYA_CONTROL_INCREMENT_BUTTON_CSS = "papaya-control-increment",
  PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS = "papaya-control-goto-center",
  PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS = "papaya-control-goto-origin",
  PAPAYA_CONTROL_SWAP_BUTTON_CSS = "papaya-control-swap",
  PAPAYA_CONTROL_DIRECTION_SLIDER = "papaya-direction-slider",
  PAPAYA_CONTROL_MAIN_SLIDER = "papaya-main-slider",
  PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS = "papaya-main-increment",
  PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS = "papaya-main-decrement",
  PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS = "papaya-main-swap",
  PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS = "papaya-main-goto-center",
  PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS = "papaya-main-goto-origin",
  PAPAYA_CONTROL_BAR_LABELS_CSS = "papaya-controlbar-label",
  PAPAYA_UTILS_CHECKFORJS_CSS = "checkForJS",
  PAPAYA_UTILS_UNSUPPORTED_CSS = "papaya-utils-unsupported",
  PAPAYA_UTILS_UNSUPPORTED_MESSAGE_CSS = "papaya-utils-unsupported-message",
  PAPAYA_DEFAULT_VIEWER_ID = "papayaViewer",
  PAPAYA_DEFAULT_DISPLAY_ID = "papayaDisplay",
  PAPAYA_DEFAULT_TOOLBAR_ID = "papayaToolbar",
  PAPAYA_DEFAULT_CONTAINER_ID = "papayaContainer",
  PAPAYA_DEFAULT_SLIDER_ID = "papayaSliceSlider",
  PAPAYA_SPACING = 3,
  PAPAYA_PADDING = 8,
  PAPAYA_CONTAINER_PADDING = 20,
  PAPAYA_CONTAINER_PADDING_TOP = PAPAYA_CONTAINER_PADDING,
  PAPAYA_MANGO_INSTALLED = "mangoinstalled",
  PAPAYA_CUSTOM_PROTOCOL = "mango",
  GUNZIP_MAGIC_COOKIE1 = 31,
  GUNZIP_MAGIC_COOKIE2 = 139;
("use strict");
var papaya = papaya || {};
papaya.utilities = papaya.utilities || {};
papaya.utilities.ArrayUtils = papaya.utilities.ArrayUtils || {};
papaya.utilities.ArrayUtils.createArray = function (a) {
  var b = Array(a || 0),
    c;
  if (1 < arguments.length) {
    var e = Array.prototype.slice.call(arguments, 1);
    for (c = 0; c < a; c += 1)
      b[c] = papaya.utilities.ArrayUtils.createArray.apply(this, e);
  }
  return b;
};
papaya.utilities.ArrayUtils.contains = function (a, b) {
  for (var c = a.length; c--; ) if (a[c] === b) return !0;
  return !1;
};
papaya.utilities.ArrayUtils.cleanArray = function (a) {
  for (var b = [], c = 0; c < a.length; c++) a[c] && b.push(a[c]);
  return b;
};
Array.prototype.clone = function () {
  var a;
  var b = this.slice(0);
  for (a = 0; a < this.length; a += 1)
    this[a].clone && (b[a] = this[a].clone());
  return b;
};
("use strict");
papaya = papaya || {};
papaya.utilities = papaya.utilities || {};
papaya.utilities.MathUtils = papaya.utilities.MathUtils || {};
papaya.utilities.MathUtils.EPSILON = 1e-8;
papaya.utilities.MathUtils.signum = function (a) {
  return a ? (0 > a ? -1 : 1) : 0;
};
papaya.utilities.MathUtils.lineDistance = function (a, b, c, e) {
  a = c - a;
  b = e - b;
  return Math.sqrt(a * a + b * b);
};
papaya.utilities.MathUtils.lineDistance3d = function (a, b, c, e, d, g) {
  a = e - a;
  b = d - b;
  c = g - c;
  return Math.sqrt(a * a + b * b + c * c);
};
papaya.utilities.MathUtils.essentiallyEqual = function (a, b) {
  return (
    a === b ||
    Math.abs(a - b) <=
      (Math.abs(a) > Math.abs(b) ? Math.abs(b) : Math.abs(a)) *
        papaya.utilities.MathUtils.EPSILON
  );
};
papaya.utilities.MathUtils.getPowerOfTwo = function (a, b) {
  for (b = b || 1; b < a; ) b *= 2;
  return b;
};
function papayaRoundFast(a) {
  return 0 < a ? (a + 0.5) | 0 : (a - 0.5) | 0;
}
function papayaFloorFast(a) {
  return a | 0;
}
("use strict");
papaya = papaya || {};
papaya.utilities = papaya.utilities || {};
papaya.utilities.ObjectUtils = papaya.utilities.ObjectUtils || {};
papaya.utilities.ObjectUtils.bind = function (a, b, c, e) {
  if (2 === arguments.length)
    return function () {
      return b.apply(a, arguments);
    };
  var d = Array.prototype.slice;
  return function () {
    var g = c || arguments;
    !0 === e
      ? ((g = d.call(arguments, 0)), (g = g.concat(c)))
      : "number" === typeof e &&
        ((g = d.call(arguments, 0)), Ext.Array.insert(g, e, c));
    return b.apply(a || window, g);
  };
};
papaya.utilities.ObjectUtils.isString = function (a) {
  return "string" === typeof a || a instanceof String;
};
papaya.utilities.ObjectUtils.dereference = function (a) {
  return papaya.utilities.ObjectUtils.dereferenceIn(window, a);
};
papaya.utilities.ObjectUtils.dereferenceIn = function (a, b) {
  var c;
  if (!papaya.utilities.ObjectUtils.isString(b)) return null;
  if ((b = b.replace(/(^[' "]+|[" ']+$)/g, "").match(/(^[\w\$]+(\.[\w\$]+)*)/)))
    for (b = b[1].split("."), c = a[b.shift()]; c && b.length; )
      c = c[b.shift()];
  return c || null;
};
("use strict");
papaya = papaya || {};
papaya.utilities = papaya.utilities || {};
papaya.utilities.PlatformUtils = papaya.utilities.PlatformUtils || {};
var console = console || {};
console.log = console.log || function () {};
console.warn = console.warn || function () {};
console.error = console.error || function () {};
console.info = console.info || function () {};
papaya.utilities.PlatformUtils.os = null;
papaya.utilities.PlatformUtils.browser = bowser.name;
papaya.utilities.PlatformUtils.browserVersion = bowser.version;
papaya.utilities.PlatformUtils.ios = bowser.ios;
papaya.utilities.PlatformUtils.mobile = bowser.mobile;
papaya.utilities.PlatformUtils.lastScrollEventTimestamp = 0;
papaya.utilities.PlatformUtils.smallScreen =
  window.matchMedia &&
  window.matchMedia("only screen and (max-width: 760px)").matches;
papaya.utilities.PlatformUtils.detectOs = function () {
  return -1 !== navigator.appVersion.indexOf("Win")
    ? "Windows"
    : -1 !== navigator.appVersion.indexOf("Mac")
    ? "MacOS"
    : -1 !== navigator.appVersion.indexOf("X11") ||
      -1 !== navigator.appVersion.indexOf("Linux")
    ? "Linux"
    : "Unknown";
};
papaya.utilities.PlatformUtils.os = papaya.utilities.PlatformUtils.detectOs();
papaya.utilities.PlatformUtils.checkForBrowserCompatibility = function () {
  if ("Firefox" === papaya.utilities.PlatformUtils.browser) {
    if (
      papaya.utilities.PlatformUtils.browserVersion < PAPAYA_BROWSER_MIN_FIREFOX
    )
      return (
        "Papaya requires Firefox version " +
        PAPAYA_BROWSER_MIN_FIREFOX +
        " or higher."
      );
  } else if ("Chrome" === papaya.utilities.PlatformUtils.browser) {
    if (
      papaya.utilities.PlatformUtils.browserVersion < PAPAYA_BROWSER_MIN_CHROME
    )
      return (
        "Papaya requires Chrome version " +
        PAPAYA_BROWSER_MIN_CHROME +
        " or higher."
      );
  } else if ("Internet Explorer" === papaya.utilities.PlatformUtils.browser) {
    if (papaya.utilities.PlatformUtils.browserVersion < PAPAYA_BROWSER_MIN_IE)
      return (
        "Papaya requires Internet Explorer version " +
        PAPAYA_BROWSER_MIN_IE +
        " or higher."
      );
  } else if ("Safari" === papaya.utilities.PlatformUtils.browser) {
    if (
      papaya.utilities.PlatformUtils.browserVersion < PAPAYA_BROWSER_MIN_SAFARI
    )
      return (
        "Papaya requires Safari version " +
        PAPAYA_BROWSER_MIN_SAFARI +
        " or higher."
      );
  } else if (
    "Opera" === papaya.utilities.PlatformUtils.browser &&
    papaya.utilities.PlatformUtils.browserVersion < PAPAYA_BROWSER_MIN_OPERA
  )
    return (
      "Papaya requires Opera version " +
      PAPAYA_BROWSER_MIN_OPERA +
      " or higher."
    );
  return null;
};
papaya.utilities.PlatformUtils.isWebGLSupported = function () {
  try {
    var a = document.createElement("canvas");
    var b = a.getContext("webgl") || a.getContext("experimental-webgl");
    var c = b.getExtension("OES_element_index_uint");
    if (!c) return !1;
  } catch (e) {
    return console.log("There was a problem detecting WebGL! " + e), !1;
  }
  return !0;
};
papaya.utilities.PlatformUtils.getMousePositionX = function (a) {
  var b;
  a.originalEvent && (a = a.originalEvent);
  if (a.targetTouches) {
    if (1 === a.targetTouches.length && (b = a.targetTouches[0]))
      return b.pageX;
  } else if (
    a.changedTouches &&
    1 === a.changedTouches.length &&
    (b = a.changedTouches[0])
  )
    return b.pageX;
  return a.pageX;
};
papaya.utilities.PlatformUtils.getMousePositionY = function (a) {
  var b;
  if (a.targetTouches) {
    if (1 === a.targetTouches.length && (b = a.targetTouches[0]))
      return b.pageY;
  } else if (
    a.changedTouches &&
    1 === a.changedTouches.length &&
    (b = a.changedTouches[0])
  )
    return b.pageY;
  return a.pageY;
};
papaya.utilities.PlatformUtils.getScrollSign = function (a, b) {
  b = b
    ? 75
    : "Firefox" === papaya.utilities.PlatformUtils.browser
    ? 10
    : "Chrome" === papaya.utilities.PlatformUtils.browser
    ? 50
    : "Internet Explorer" === papaya.utilities.PlatformUtils.browser
    ? 0
    : "Safari" === papaya.utilities.PlatformUtils.browser
    ? 50
    : 10;
  var c = Date.now();
  return c - papaya.utilities.PlatformUtils.lastScrollEventTimestamp > b
    ? ((papaya.utilities.PlatformUtils.lastScrollEventTimestamp = c),
      (b = papaya.utilities.PlatformUtils.normalizeWheel(a).spinY),
      (a =
        0 < -1 * papaya.utilities.PlatformUtils.normalizeWheel(a).spinY
          ? 1
          : -1),
      (a *= Math.ceil(Math.abs(b / 10))))
    : 0;
};
papaya.utilities.PlatformUtils.makeSlice = function (a, b, c) {
  return "undefined" === typeof File
    ? function () {}
    : File.prototype.slice
    ? a.slice(b, b + c)
    : File.prototype.mozSlice
    ? a.mozSlice(b, c)
    : File.prototype.webkitSlice
    ? a.webkitSlice(b, c)
    : null;
};
papaya.utilities.PlatformUtils.isPlatformLittleEndian = function () {
  var a = new ArrayBuffer(2);
  new DataView(a).setInt16(0, 256, !0);
  return 256 === new Int16Array(a)[0];
};
papaya.utilities.PlatformUtils.isInputRangeSupported = function () {
  var a = document.createElement("input");
  a.setAttribute("type", "range");
  return "range" === a.type;
};
papaya.utilities.PlatformUtils.launchCustomProtocol = function (a, b, c) {
  var e = !1;
  if ("Internet Explorer" === papaya.utilities.PlatformUtils.browser) {
    var d = window.open("", "", "width=0,height=0");
    d.document.write("<iframe src='" + b + "'></iframe>");
    setTimeout(function () {
      try {
        d.location.href, (e = !0);
      } catch (h) {
        console.log(h);
      }
      e ? d.setTimeout("window.close()", 100) : d.close();
      c(e);
    }, 100);
  } else if ("Firefox" === papaya.utilities.PlatformUtils.browser) {
    try {
      var g = $("<iframe />");
      g.css({ display: "none" });
      g.appendTo("body");
      g[0].contentWindow.location.href = b;
      e = !0;
    } catch (h) {
      e = !1;
    }
    g.remove();
    c(e);
  } else
    "Chrome" === papaya.utilities.PlatformUtils.browser
      ? (a.viewerHtml.css({ outline: 0 }),
        a.viewerHtml.attr("tabindex", "1"),
        a.viewerHtml.focus(),
        a.viewerHtml.blur(function () {
          e = !0;
          c(!0);
        }),
        (location.href = b),
        setTimeout(function () {
          a.viewerHtml.off("blur");
          a.viewerHtml.removeAttr("tabindex");
          e || c(!1);
        }, 2e3))
      : ((g = papaya.utilities.UrlUtils.readCookie(
          papaya.viewer.Preferences.COOKIE_PREFIX + PAPAYA_MANGO_INSTALLED
        )) || papaya.mangoinstalled
          ? (e = !0)
          : confirm(
              "This feature requires that " +
                (papaya.utilities.PlatformUtils.ios ? "iMango" : "Mango") +
                " is installed.  Continue?"
            ) &&
            (papaya.utilities.UrlUtils.createCookie(
              papaya.viewer.Preferences.COOKIE_PREFIX + PAPAYA_MANGO_INSTALLED,
              !0,
              papaya.viewer.Preferences.COOKIE_EXPIRY_DAYS
            ),
            (e = !0)),
        e && (location.href = b),
        c(e));
};
papaya.utilities.PlatformUtils.getSupportedScrollEvent = function () {
  return "Firefox" === papaya.utilities.PlatformUtils.browser
    ? "DOMMouseScroll"
    : "onwheel" in document.createElement("div")
    ? "wheel"
    : void 0 !== document.onmousewheel
    ? "mousewheel"
    : "DOMMouseScroll";
};
var PIXEL_STEP = 10,
  LINE_HEIGHT = 40,
  PAGE_HEIGHT = 800;
papaya.utilities.PlatformUtils.normalizeWheel = function (a) {
  var b = 0,
    c = 0;
  "detail" in a && (c = a.detail);
  "wheelDelta" in a && (c = -a.wheelDelta / 120);
  "wheelDeltaY" in a && (c = -a.wheelDeltaY / 120);
  "wheelDeltaX" in a && (b = -a.wheelDeltaX / 120);
  "axis" in a && a.axis === a.HORIZONTAL_AXIS && ((b = c), (c = 0));
  var e = b * PIXEL_STEP;
  var d = c * PIXEL_STEP;
  "deltaY" in a && (d = a.deltaY);
  "deltaX" in a && (e = a.deltaX);
  (e || d) &&
    a.deltaMode &&
    (1 == a.deltaMode
      ? ((e *= LINE_HEIGHT), (d *= LINE_HEIGHT))
      : ((e *= PAGE_HEIGHT), (d *= PAGE_HEIGHT)));
  e && !b && (b = 1 > e ? -1 : 1);
  d && !c && (c = 1 > d ? -1 : 1);
  return { spinX: b, spinY: c, pixelX: e, pixelY: d };
};
("use strict");
papaya = papaya || {};
papaya.utilities = papaya.utilities || {};
papaya.utilities.StringUtils = papaya.utilities.StringUtils || {};
papaya.utilities.StringUtils.isStringBlank = function (a) {
  return a && "string" == (typeof a).toLowerCase() ? 0 === a.trim().length : !0;
};
papaya.utilities.StringUtils.formatNumber = function (a, b) {
  a = papaya.utilities.ObjectUtils.isString(a) ? Number(a) : a;
  a = b ? a.toPrecision(5) : a.toPrecision(7);
  return parseFloat(a);
};
papaya.utilities.StringUtils.getSizeString = function (a) {
  return 1048576 < a
    ? papaya.utilities.StringUtils.formatNumber(a / 1048576, !0) + " Mb"
    : 1024 < a
    ? papaya.utilities.StringUtils.formatNumber(a / 1024, !0) + " Kb"
    : a + " Bytes";
};
papaya.utilities.StringUtils.wordwrap = function (a, b, c, e) {
  c = c || "\n";
  b = b || 75;
  return a
    ? a
        .match(
          new RegExp(
            ".{1," +
              b +
              "}(\\s|$)" +
              (e ? "|.{" + b + "}|.+$" : "|\\S+?(\\s|$)"),
            "g"
          )
        )
        .join(c)
    : a;
};
papaya.utilities.StringUtils.truncateMiddleString = function (a, b) {
  if (a.length <= b) return a;
  b -= 3;
  var c = Math.floor(b / 2);
  return a.substr(0, Math.ceil(b / 2)) + "..." + a.substr(a.length - c);
};
papaya.utilities.StringUtils.pad = function (a, b) {
  return ("000000000" + a).substr(-b);
};
papaya.utilities.StringUtils.arrayBufferToString = function (a) {
  a = new Uint8Array(a);
  a = String.fromCharCode.apply(String, a);
  if (/[\u0080-\uffff]/.test(a))
    throw Error("this string seems to contain (still encoded) multibytes");
  return a;
};
"function" !== typeof String.prototype.startsWith &&
  (String.prototype.startsWith = function (a) {
    return 0 === this.indexOf(a);
  });
"function" !== typeof String.prototype.endsWith &&
  (String.prototype.endsWith = function (a) {
    return -1 !== this.indexOf(a, this.length - a.length);
  });
"function" !== typeof String.prototype.trim &&
  (String.prototype.trim = function () {
    return this.replace(/^\s+|\s+$/g, "");
  });
("use strict");
papaya = papaya || {};
papaya.utilities = papaya.utilities || {};
papaya.utilities.UrlUtils = papaya.utilities.UrlUtils || {};
papaya.utilities.UrlUtils.createCookie = function (a, b, c) {
  if (c) {
    var e = new Date();
    e.setTime(e.getTime() + 864e5 * c);
    c = "; expires=" + e.toGMTString();
  } else c = "";
  document.cookie = a + "=" + b + c + "; path=/";
};
papaya.utilities.UrlUtils.readCookie = function (a) {
  var b, c;
  a += "=";
  var e = document.cookie.split(";");
  for (b = 0; b < e.length; b += 1) {
    for (c = e[b]; " " === c.charAt(0); ) c = c.substring(1, c.length);
    if (0 === c.indexOf(a)) return c.substring(a.length, c.length);
  }
  return null;
};
papaya.utilities.UrlUtils.eraseCookie = function (a) {
  papaya.utilities.UrlUtils.createCookie(a, "", -1);
};
papaya.utilities.UrlUtils.getQueryParams = function (a) {
  var b,
    c = /[?&]?([^=]+)=([^&]*)/g;
  if (-1 !== document.location.href.indexOf("?")) {
    var e = document.location.href.substring(
      document.location.href.indexOf("?") + 1
    );
    e = e.split("+").join(" ");
    for (b = c.exec(e); b; )
      (a[decodeURIComponent(b[1])] = decodeURIComponent(b[2])), (b = c.exec(e));
  }
};
papaya.utilities.UrlUtils.getAbsoluteUrl = function (a, b) {
  var c = window.location.href;
  c = c.substring(0, c.lastIndexOf("/"));
  var e = document.createElement("a");
  e.href = c + "/" + b;
  b = e.host;
  e = e.pathname;
  "/" !== e.charAt(0) && (e = "/" + e);
  return a + "://" + b + e;
};
("use strict");
papaya = papaya || {};
papaya.core = papaya.core || {};
papaya.core.Coordinate =
  papaya.core.Coordinate ||
  function (a, b, c) {
    this.x = a;
    this.y = b;
    this.z = c;
  };
papaya.core.Coordinate.prototype.setCoordinate = function (a, b, c, e) {
  e
    ? ((this.x = Math.round(a)),
      (this.y = Math.round(b)),
      (this.z = Math.round(c)))
    : ((this.x = a), (this.y = b), (this.z = c));
};
papaya.core.Coordinate.prototype.toString = function () {
  return "(" + this.x + "," + this.y + "," + this.z + ")";
};
papaya.core.Coordinate.prototype.isAllZeros = function () {
  return 0 === this.x && 0 === this.y && 0 === this.z;
};
("use strict");
papaya = papaya || {};
papaya.core = papaya.core || {};
papaya.core.Point =
  papaya.core.Point ||
  function (a, b) {
    this.x = a;
    this.y = b;
  };
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.Header =
  papaya.volume.Header ||
  function (a) {
    this.origin =
      this.error =
      this.imageRange =
      this.orientation =
      this.imageType =
      this.imageDescription =
      this.voxelDimensions =
      this.imageDimensions =
      this.fileFormat =
        null;
    this.pad = a;
    this.orientationCertainty =
      papaya.volume.Header.ORIENTATION_CERTAINTY_UNKNOWN;
    this.onFinishedFileFormatRead = null;
  };
papaya.volume.Header.HEADER_TYPE_UNKNOWN = 0;
papaya.volume.Header.HEADER_TYPE_NIFTI = 1;
papaya.volume.Header.HEADER_TYPE_DICOM = 2;
papaya.volume.Header.ERROR_UNRECOGNIZED_FORMAT =
  "This format is not recognized!";
papaya.volume.Header.INVALID_IMAGE_DIMENSIONS =
  "Image dimensions are not valid!";
papaya.volume.Header.INVALID_VOXEL_DIMENSIONS =
  "Voxel dimensions are not valid!";
papaya.volume.Header.INVALID_DATATYPE =
  "Datatype is not valid or not supported!";
papaya.volume.Header.INVALID_IMAGE_RANGE = "Image range is not valid!";
papaya.volume.Header.ORIENTATION_CERTAINTY_UNKNOWN = 0;
papaya.volume.Header.ORIENTATION_CERTAINTY_LOW = 1;
papaya.volume.Header.ORIENTATION_CERTAINTY_HIGH = 2;
papaya.volume.Header.prototype.findHeaderType = function (a, b) {
  return papaya.volume.nifti.HeaderNIFTI.isThisFormat(a, b)
    ? papaya.volume.Header.HEADER_TYPE_NIFTI
    : papaya.Container.DICOM_SUPPORT &&
      papaya.volume.dicom.HeaderDICOM.isThisFormat(a, b)
    ? papaya.volume.Header.HEADER_TYPE_DICOM
    : papaya.volume.Header.HEADER_TYPE_UNKNOWN;
};
papaya.volume.Header.prototype.readHeaderData = function (a, b, c, e, d) {
  a = this.findHeaderType(a, b);
  this.onFinishedFileFormatRead = d;
  a === papaya.volume.Header.HEADER_TYPE_NIFTI
    ? ((this.fileFormat = new papaya.volume.nifti.HeaderNIFTI()),
      this.fileFormat.readHeaderData(
        b,
        c,
        e,
        papaya.utilities.ObjectUtils.bind(this, this.onFinishedHeaderRead)
      ))
    : a === papaya.volume.Header.HEADER_TYPE_DICOM
    ? ((this.fileFormat = new papaya.volume.dicom.HeaderDICOM()),
      this.fileFormat.readHeaderData(
        b,
        c,
        e,
        papaya.utilities.ObjectUtils.bind(this, this.onFinishedHeaderRead)
      ))
    : ((this.error = Error(papaya.volume.Header.ERROR_UNRECOGNIZED_FORMAT)),
      this.onFinishedFileFormatRead());
};
papaya.volume.Header.prototype.onFinishedHeaderRead = function () {
  this.fileFormat.hasError()
    ? (this.error = this.fileFormat.error)
    : ((this.imageType = this.fileFormat.getImageType()),
      this.imageType.isValid() ||
        (this.error = Error(papaya.volume.Header.INVALID_DATATYPE)),
      (this.imageDimensions = this.fileFormat.getImageDimensions()),
      this.imageDimensions.isValid() ||
        (this.error = Error(papaya.volume.Header.INVALID_IMAGE_DIMENSIONS)),
      (this.voxelDimensions = this.fileFormat.getVoxelDimensions()),
      this.voxelDimensions.isValid() ||
        (this.error = Error(papaya.volume.Header.INVALID_VOXEL_DIMENSIONS)),
      this.pad && this.imageDimensions.padIsometric(this.voxelDimensions),
      (this.orientation = this.fileFormat.getOrientation()),
      this.orientation.isValid()
        ? (this.orientationCertainty =
            this.fileFormat.getOrientationCertainty())
        : ((this.orientation = new papaya.volume.Orientation(
            papaya.volume.Orientation.DEFAULT
          )),
          (this.orientationCertainty =
            papaya.volume.Header.ORIENTATION_CERTAINTY_UNKNOWN)),
      this.orientation.createInfo(this.imageDimensions, this.voxelDimensions),
      (this.origin = this.orientation.convertCoordinate(
        this.fileFormat.getOrigin(),
        new papaya.core.Coordinate(0, 0, 0)
      )),
      (this.imageRange = this.fileFormat.getImageRange()),
      this.imageRange.isValid() ||
        (this.error = Error(papaya.volume.Header.INVALID_IMAGE_RANGE)),
      (this.imageDescription = this.fileFormat.getImageDescription()));
  this.onFinishedFileFormatRead();
};
papaya.volume.Header.prototype.getName = function () {
  return this.fileFormat.getName();
};
papaya.volume.Header.prototype.getSeriesLabels = function () {
  return this.fileFormat.getSeriesLabels();
};
papaya.volume.Header.prototype.readImageData = function (a, b) {
  this.fileFormat.readImageData(a, b);
};
papaya.volume.Header.prototype.hasError = function () {
  return null !== this.error;
};
papaya.volume.Header.prototype.getBestTransform = function () {
  return this.fileFormat.getBestTransform();
};
papaya.volume.Header.prototype.getBestTransformOrigin = function () {
  return this.fileFormat.getBestTransformOrigin();
};
papaya.volume.Header.prototype.toString = function () {
  return this.fileFormat.toString();
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.ImageData =
  papaya.volume.ImageData ||
  function (a) {
    this.data = null;
    this.pad = a;
  };
papaya.volume.ImageData.prototype.readFileData = function (a, b, c) {
  this.pad && (b = this.padIsometric(a, b));
  if (a.imageType.datatype === papaya.volume.ImageType.DATATYPE_RGB) {
    var e = b.byteLength / 3;
    var d = 2 * e;
    a = a.imageType.rgbBySample;
    b = new DataView(b, 0);
    this.data = new Uint32Array(e);
    if (a) {
      for (a = 0; a < e; a += 1) this.data[a] |= b.getUint8(a) << 16;
      for (a = 0; a < e; a += 1) this.data[a] |= b.getUint8(a + e) << 8;
      for (a = 0; a < e; a += 1) this.data[a] |= b.getUint8(a + d);
    } else
      for (a = 0; a < e; a += 1)
        this.data[a] =
          (b.getUint8(3 * a) << 16) |
          (b.getUint8(3 * a + 1) << 8) |
          b.getUint8(3 * a + 2);
  } else if (
    a.imageType.datatype === papaya.volume.ImageType.DATATYPE_INTEGER_SIGNED &&
    1 === a.imageType.numBytes
  )
    this.data = new Int8Array(b, 0, b.byteLength);
  else if (
    a.imageType.datatype ===
      papaya.volume.ImageType.DATATYPE_INTEGER_UNSIGNED &&
    1 === a.imageType.numBytes
  )
    this.data = new Uint8Array(b, 0, b.byteLength);
  else if (
    a.imageType.datatype === papaya.volume.ImageType.DATATYPE_INTEGER_SIGNED &&
    2 === a.imageType.numBytes
  )
    this.data = new Int16Array(b, 0, b.byteLength / 2);
  else if (
    a.imageType.datatype ===
      papaya.volume.ImageType.DATATYPE_INTEGER_UNSIGNED &&
    2 === a.imageType.numBytes
  )
    this.data = new Uint16Array(b, 0, b.byteLength / 2);
  else if (
    a.imageType.datatype === papaya.volume.ImageType.DATATYPE_INTEGER_SIGNED &&
    4 === a.imageType.numBytes
  )
    this.data = new Int32Array(b, 0, b.byteLength / 4);
  else if (
    a.imageType.datatype ===
      papaya.volume.ImageType.DATATYPE_INTEGER_UNSIGNED &&
    4 === a.imageType.numBytes
  )
    this.data = new Uint32Array(b, 0, b.byteLength / 4);
  else if (
    a.imageType.datatype === papaya.volume.ImageType.DATATYPE_FLOAT &&
    4 === a.imageType.numBytes
  )
    if (a.imageType.swapped)
      for (
        e = b.byteLength / Float32Array.BYTES_PER_ELEMENT,
          b = new DataView(b, 0),
          this.data = new Float32Array(e),
          a = 0;
        a < e;
        a += 1
      )
        this.data[a] = b.getFloat32(a * Float32Array.BYTES_PER_ELEMENT);
    else this.data = new Float32Array(b, 0, b.byteLength / 4);
  else if (
    a.imageType.datatype === papaya.volume.ImageType.DATATYPE_FLOAT &&
    8 === a.imageType.numBytes
  )
    if (a.imageType.swapped)
      for (
        e = b.byteLength / Float64Array.BYTES_PER_ELEMENT,
          b = new DataView(b, 0),
          this.data = new Float64Array(e),
          a = 0;
        a < e;
        a += 1
      )
        this.data[a] = b.getFloat64(a * Float64Array.BYTES_PER_ELEMENT);
    else this.data = new Float64Array(b, 0, b.byteLength / 8);
  c();
};
papaya.volume.ImageData.prototype.padIsometric = function (a, b) {
  var c = a.imageDimensions,
    e = a.voxelDimensions,
    d = a.imageType.numBytes;
  b = new Uint8Array(b, 0, b.byteLength);
  var g = c.colsOrig;
  a = c.rowsOrig;
  c = c.slicesOrig;
  var h = g * e.colSize,
    n = a * e.rowSize,
    q = c * e.sliceSize,
    t = Math.max(Math.max(h, n), q);
  h = parseInt((t - h) / e.colSize / 2, 10);
  n = parseInt((t - n) / e.rowSize / 2, 10);
  t = parseInt((t - q) / e.sliceSize / 2, 10);
  var u = g + 2 * h,
    A = a + 2 * n;
  g *= d;
  e = h * d;
  h = n * u * d;
  var G = t * u * A * d;
  q = n = 0;
  d = new ArrayBuffer(u * A * (c + 2 * t) * d);
  t = new Uint8Array(d, 0, d.byteLength);
  n += G;
  for (u = 0; u < c; u += 1) {
    n += h;
    for (A = 0; A < a; A += 1) {
      n += e;
      for (G = 0; G < g; G += 1, q++, n++) t[n] = b[q];
      n += e;
    }
    n += h;
  }
  return d;
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.ImageDescription =
  papaya.volume.ImageDescription ||
  function (a) {
    this.notes = "(none)";
    papaya.utilities.StringUtils.isStringBlank(a) || (this.notes = a);
  };
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.ImageDimensions =
  papaya.volume.ImageDimensions ||
  function (a, b, c, e) {
    this.cols = a;
    this.rows = b;
    this.slices = c;
    this.colsOrig = a;
    this.rowsOrig = b;
    this.slicesOrig = c;
    this.zDim = this.yDim = this.xDim = -1;
    this.timepoints = e || 1;
    this.dataOffsets = [];
    this.dataLengths = [];
  };
papaya.volume.ImageDimensions.prototype.padIsometric = function (a) {
  var b = this.cols,
    c = this.rows,
    e = this.slices,
    d = b * a.colSize,
    g = c * a.rowSize,
    h = e * a.sliceSize,
    n = Math.max(Math.max(d, g), h);
  d = parseInt((n - d) / a.colSize / 2, 10);
  g = parseInt((n - g) / a.rowSize / 2, 10);
  a = parseInt((n - h) / a.sliceSize / 2, 10);
  this.cols = b + 2 * d;
  this.rows = c + 2 * g;
  this.slices = e + 2 * a;
};
papaya.volume.ImageDimensions.prototype.getNumVoxelsSeries = function () {
  return this.cols * this.rows * this.slices * this.timepoints;
};
papaya.volume.ImageDimensions.prototype.getNumVoxelsSlice = function () {
  return this.rows * this.cols;
};
papaya.volume.ImageDimensions.prototype.getNumVoxelsVolume = function () {
  return this.rows * this.cols * this.slices;
};
papaya.volume.ImageDimensions.prototype.isValid = function () {
  return (
    0 < this.cols &&
    0 < this.rows &&
    0 < this.slices &&
    0 < this.timepoints &&
    0 <= this.dataOffsets[0] &&
    0 <= this.dataLengths[0]
  );
};
var moduleType = typeof module;
"undefined" !== moduleType &&
  module.exports &&
  (module.exports.ImageDimensions = papaya.volume.ImageDimensions);
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.ImageRange =
  papaya.volume.ImageRange ||
  function (a, b) {
    this.displayMin = a;
    this.displayMax = b;
    this.imageMax = this.imageMin = 0;
    this.dataScaleSlopes = [];
    this.dataScaleIntercepts = [];
    this.globalDataScaleSlope = 1;
    this.globalDataScaleIntercept = 0;
    this.usesGlobalDataScale = !1;
  };
papaya.volume.ImageRange.DEFAULT_SCALE = 1;
papaya.volume.ImageRange.DEFAULT_INTERCEPT = 0;
papaya.volume.ImageRange.prototype.isValid = function () {
  return !0;
};
papaya.volume.ImageRange.prototype.setGlobalDataScale = function (a, b) {
  this.globalDataScaleSlope = a;
  this.globalDataScaleIntercept = b;
  this.usesGlobalDataScale = !0;
  this.dataScaleSlopes = [];
  this.dataScaleIntercepts = [];
};
papaya.volume.ImageRange.prototype.validateDataScale = function () {
  var a,
    b = !1;
  if (1 !== this.globalDataScaleSlope || 0 !== this.globalDataScaleIntercept)
    (this.dataScaleSlopes = []),
      (this.dataScaleIntercepts = []),
      (this.usesGlobalDataScale = !0);
  else if (
    0 < this.dataScaleSlopes.length &&
    0 < this.dataScaleIntercepts.length
  ) {
    var c = this.dataScaleSlopes[0];
    for (a = 1; a < this.dataScaleSlopes.length; a += 1)
      if (c !== this.dataScaleSlopes[a]) {
        b = !0;
        break;
      }
    c = this.dataScaleIntercepts[0];
    for (a = 1; a < this.dataScaleIntercepts.length; a += 1)
      if (c !== this.dataScaleIntercepts[a]) {
        b = !0;
        break;
      }
    b
      ? (this.usesGlobalDataScale = !1)
      : this.setGlobalDataScale(
          this.dataScaleSlopes[0],
          this.dataScaleIntercepts[0]
        );
  } else this.setGlobalDataScale(1, 0);
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.ImageType =
  papaya.volume.ImageType ||
  function (a, b, c, e) {
    this.datatype = a;
    this.numBytes = b;
    this.littleEndian = c;
    this.swapped = !1;
    this.compressed = e;
    this.rgbBySample = !1;
  };
papaya.volume.ImageType.DATATYPE_UNKNOWN = 0;
papaya.volume.ImageType.DATATYPE_INTEGER_SIGNED = 1;
papaya.volume.ImageType.DATATYPE_INTEGER_UNSIGNED = 2;
papaya.volume.ImageType.DATATYPE_FLOAT = 3;
papaya.volume.ImageType.DATATYPE_RGB = 4;
papaya.volume.ImageType.MAX_SUPPORTED_BYTES_FLOAT = 8;
papaya.volume.ImageType.MAX_SUPPORTED_BYTES_INTEGER = 4;
papaya.volume.ImageType.prototype.isValid = function () {
  return (
    this.datatype <= papaya.volume.ImageType.DATATYPE_RGB &&
    this.datatype > papaya.volume.ImageType.DATATYPE_UNKNOWN &&
    0 < this.numBytes &&
    ((this.datatype === papaya.volume.ImageType.DATATYPE_FLOAT &&
      this.numBytes <= papaya.volume.ImageType.MAX_SUPPORTED_BYTES_FLOAT) ||
      (this.datatype !== papaya.volume.ImageType.DATATYPE_FLOAT &&
        this.numBytes <= papaya.volume.ImageType.MAX_SUPPORTED_BYTES_INTEGER))
  );
};
papaya.volume.ImageType.prototype.getTypeDescription = function () {
  return this.datatype === papaya.volume.ImageType.DATATYPE_INTEGER_SIGNED
    ? "Signed Integer"
    : this.datatype === papaya.volume.ImageType.DATATYPE_INTEGER_UNSIGNED
    ? "Unsigned Integer"
    : this.datatype === papaya.volume.ImageType.DATATYPE_FLOAT
    ? "Float"
    : this.datatype === papaya.volume.ImageType.DATATYPE_RGB
    ? "RGB"
    : "Unknown";
};
papaya.volume.ImageType.prototype.getOrderDescription = function () {
  return 1 < this.numBytes
    ? this.littleEndian
      ? "Little Endian"
      : "Big Endian"
    : null;
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.nifti = papaya.volume.nifti || {};
papaya.volume.nifti.HeaderNIFTI =
  papaya.volume.nifti.HeaderNIFTI ||
  function () {
    this.nifti = null;
    this.compressed = this.isNIFTI2 = !1;
    this.imageData = this.ext = null;
  };
papaya.volume.nifti.HeaderNIFTI.ORIENTATION_DEFAULT = "XYZ-++";
papaya.volume.nifti.HeaderNIFTI.SPATIAL_UNITS_MASK = 7;
papaya.volume.nifti.HeaderNIFTI.TEMPORAL_UNITS_MASK = 56;
papaya.volume.nifti.HeaderNIFTI.isThisFormat = function (a, b) {
  return -1 !== a.indexOf(".nii") ? !0 : nifti.isNIFTI(b[0]);
};
papaya.volume.nifti.HeaderNIFTI.prototype.readHeaderData = function (
  a,
  b,
  c,
  e
) {
  this.nifti = nifti.readHeader(a[0]);
  this.isNIFTI2 = nifti.isNIFTI2(a[0]);
  try {
    nifti.hasExtension(this.nifti) &&
      (this.ext = nifti.readExtensionData(this.nifti, a[0]));
  } catch (d) {
    console.log("Problem reading NIFTI extension.");
  }
  this.imageData = nifti.readImage(this.nifti, a[0]);
  e();
};
papaya.volume.nifti.HeaderNIFTI.prototype.readImageData = function (a, b) {
  b(this.imageData);
  this.imageData = null;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getImageDimensions = function () {
  var a = new papaya.volume.ImageDimensions(
    this.nifti.dims[1],
    this.nifti.dims[2],
    this.nifti.dims[3],
    this.nifti.dims[4]
  );
  a.dataOffsets[0] = this.nifti.vox_offset;
  a.dataLengths[0] = a.getNumVoxelsSeries() * (this.nifti.numBitsPerVoxel / 8);
  return a;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getName = function () {
  return null;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getSeriesLabels = function () {
  var a = null;
  if (this.ext)
    try {
      var b = papaya.utilities.StringUtils.arrayBufferToString(this.ext)
          .replace(/[^\x20-\x7F]/g, "")
          .trim(),
        c = $.parseXML(b),
        e = $(c).find("MangoVolume");
      if (e.length) {
        var d = e.find("Series");
        if (d.length) {
          var g = d.find("Point"),
            h = d.attr("length");
          a = Array(h);
          g.each(function () {
            var n = $(this).attr("index"),
              q = $(this).attr("name");
            a[parseInt(n)] = q;
          });
        }
      }
    } catch (n) {
      console.log("Unrecognized NIFTI extension found.");
    }
  return a;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getVoxelDimensions = function () {
  var a = new papaya.volume.VoxelDimensions(
    this.nifti.pixDims[1],
    this.nifti.pixDims[2],
    this.nifti.pixDims[3],
    this.nifti.pixDims[4]
  );
  a.spatialUnit =
    this.nifti.xyzt_units & papaya.volume.nifti.HeaderNIFTI.SPATIAL_UNITS_MASK;
  a.temporalUnit =
    this.nifti.xyzt_units & papaya.volume.nifti.HeaderNIFTI.TEMPORAL_UNITS_MASK;
  a.flip = -1 === this.nifti.pixDims[0];
  return a;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getImageType = function () {
  var a = papaya.volume.ImageType.DATATYPE_UNKNOWN;
  this.nifti.datatypeCode === nifti.NIFTI1.TYPE_UINT8 ||
  this.nifti.datatypeCode === nifti.NIFTI1.TYPE_UINT16 ||
  this.nifti.datatypeCode === nifti.NIFTI1.TYPE_UINT32 ||
  this.nifti.datatypeCode === nifti.NIFTI1.TYPE_UINT64
    ? (a = papaya.volume.ImageType.DATATYPE_INTEGER_UNSIGNED)
    : this.nifti.datatypeCode === nifti.NIFTI1.TYPE_INT8 ||
      this.nifti.datatypeCode === nifti.NIFTI1.TYPE_INT16 ||
      this.nifti.datatypeCode === nifti.NIFTI1.TYPE_INT32 ||
      this.nifti.datatypeCode === nifti.NIFTI1.TYPE_INT64
    ? (a = papaya.volume.ImageType.DATATYPE_INTEGER_SIGNED)
    : this.nifti.datatypeCode === nifti.NIFTI1.TYPE_FLOAT32 ||
      this.nifti.datatypeCode === nifti.NIFTI1.TYPE_FLOAT64
    ? (a = papaya.volume.ImageType.DATATYPE_FLOAT)
    : this.nifti.datatypeCode === nifti.NIFTI1.TYPE_RGB24 &&
      (a = papaya.volume.ImageType.DATATYPE_RGB);
  return new papaya.volume.ImageType(
    a,
    this.nifti.numBitsPerVoxel / 8,
    this.nifti.littleEndian,
    this.compressed
  );
};
papaya.volume.nifti.HeaderNIFTI.prototype.getOrientation = function () {
  var a = null;
  0 < this.nifti.qform_code &&
    !this.qFormHasRotations() &&
    (a = this.getOrientationQform());
  this.nifti.sform_code > this.nifti.qform_code &&
    !this.sFormHasRotations() &&
    (a = this.getOrientationSform());
  null === a && (a = papaya.volume.nifti.HeaderNIFTI.ORIENTATION_DEFAULT);
  return new papaya.volume.Orientation(a);
};
papaya.volume.nifti.HeaderNIFTI.prototype.getOrientationQform = function () {
  var a = this.nifti.convertNiftiQFormToNiftiSForm(
    this.nifti.quatern_b,
    this.nifti.quatern_c,
    this.nifti.quatern_d,
    this.nifti.qoffset_x,
    this.nifti.qoffset_y,
    this.nifti.qoffset_z,
    this.nifti.pixDims[1],
    this.nifti.pixDims[2],
    this.nifti.pixDims[3],
    this.nifti.pixDims[0]
  );
  0 < this.nifti.qform_code
    ? ((a = this.nifti.convertNiftiSFormToNEMA(a)),
      papaya.volume.Orientation.isValidOrientationString(a) ||
        (a = papaya.volume.nifti.HeaderNIFTI.ORIENTATION_DEFAULT))
    : (a = papaya.volume.nifti.HeaderNIFTI.ORIENTATION_DEFAULT);
  return a;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getOrientationSform = function () {
  var a = this.nifti.convertNiftiSFormToNEMA(this.nifti.affine);
  papaya.volume.Orientation.isValidOrientationString(a) ||
    (a = papaya.volume.nifti.HeaderNIFTI.ORIENTATION_DEFAULT);
  return a;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getQformMatCopy = function () {
  return this.nifti.getQformMat().clone();
};
papaya.volume.nifti.HeaderNIFTI.prototype.getSformMatCopy = function () {
  return this.nifti.affine.clone();
};
papaya.volume.nifti.HeaderNIFTI.prototype.getOrigin = function (a, b) {
  var c = new papaya.core.Coordinate(0, 0, 0);
  if (0 < this.nifti.qform_code && !b)
    if (this.qFormHasRotations())
      (a = this.nifti.getQformMat()),
        (a = numeric.inv(a)),
        c.setCoordinate(a[0][3], a[1][3], a[2][3]);
    else {
      a = this.nifti.convertNiftiQFormToNiftiSForm(
        this.nifti.quatern_b,
        this.nifti.quatern_c,
        this.nifti.quatern_d,
        this.nifti.qoffset_x,
        this.nifti.qoffset_y,
        this.nifti.qoffset_z,
        this.nifti.pixDims[1],
        this.nifti.pixDims[2],
        this.nifti.pixDims[3],
        this.nifti.pixDims[0]
      );
      a = this.nifti.convertNiftiSFormToNEMA(a);
      papaya.volume.Orientation.isValidOrientationString(a) ||
        (a = papaya.volume.nifti.HeaderNIFTI.ORIENTATION_DEFAULT);
      var e = a.substring(0, 3).toUpperCase();
      var d = a.substring(3);
      a = e.indexOf("X");
      b = e.indexOf("Y");
      e = e.indexOf("Z");
      var g = "+" === d.charAt(a);
      var h = "+" === d.charAt(b);
      var n = "+" === d.charAt(e);
      d = Array(3);
      d[0] = (this.nifti.qoffset_x / this.nifti.pixDims[a + 1]) * (g ? -1 : 1);
      d[1] = (this.nifti.qoffset_y / this.nifti.pixDims[b + 1]) * (h ? -1 : 1);
      d[2] = (this.nifti.qoffset_z / this.nifti.pixDims[e + 1]) * (n ? -1 : 1);
      c.setCoordinate(d[0], d[1], d[2], !1);
    }
  else
    0 < this.nifti.sform_code &&
      !a &&
      (this.sFormHasRotations()
        ? ((a = numeric.inv(this.nifti.affine)),
          c.setCoordinate(a[0][3], a[1][3], a[2][3]))
        : ((a = this.nifti.convertNiftiSFormToNEMA(this.nifti.affine)),
          papaya.volume.Orientation.isValidOrientationString(a) ||
            (a = papaya.volume.nifti.HeaderNIFTI.ORIENTATION_DEFAULT),
          (e = a.substring(0, 3).toUpperCase()),
          (d = a.substring(3)),
          (a = e.indexOf("X")),
          (b = e.indexOf("Y")),
          (e = e.indexOf("Z")),
          (g = "+" === d.charAt(a)),
          (h = "+" === d.charAt(b)),
          (n = "+" === d.charAt(e)),
          (d = Array(3)),
          (d[0] =
            (this.nifti.affine[0][3] / this.nifti.pixDims[a + 1]) *
            (g ? -1 : 1)),
          (d[1] =
            (this.nifti.affine[1][3] / this.nifti.pixDims[b + 1]) *
            (h ? -1 : 1)),
          (d[2] =
            (this.nifti.affine[2][3] / this.nifti.pixDims[e + 1]) *
            (n ? -1 : 1)),
          c.setCoordinate(d[0], d[1], d[2], !0)));
  c.isAllZeros() &&
    c.setCoordinate(
      this.nifti.dims[1] / 2,
      this.nifti.dims[2] / 2,
      this.nifti.dims[3] / 2
    );
  return c;
};
papaya.volume.nifti.HeaderNIFTI.prototype.qFormHasRotations = function () {
  return papaya.volume.Transform.hasRotations(this.getQformMatCopy());
};
papaya.volume.nifti.HeaderNIFTI.prototype.sFormHasRotations = function () {
  return papaya.volume.Transform.hasRotations(this.getSformMatCopy());
};
papaya.volume.nifti.HeaderNIFTI.prototype.getImageRange = function () {
  var a = new papaya.volume.ImageRange(this.nifti.cal_min, this.nifti.cal_max),
    b = this.nifti.scl_slope,
    c = this.getImageDimensions();
  0 === b && (b = 1);
  a.setGlobalDataScale(b, this.nifti.scl_inter, c.slices * c.timepoints);
  a.validateDataScale();
  return a;
};
papaya.volume.nifti.HeaderNIFTI.prototype.hasError = function () {
  return !1;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getImageDescription = function () {
  return new papaya.volume.ImageDescription(this.nifti.description);
};
papaya.volume.nifti.HeaderNIFTI.prototype.getOrientationCertainty =
  function () {
    var a = papaya.volume.Header.ORIENTATION_CERTAINTY_UNKNOWN;
    if (0 < this.nifti.qform_code || 0 < this.nifti.sform_code) {
      a = papaya.volume.Header.ORIENTATION_CERTAINTY_LOW;
      var b = this.getOrigin();
      null === b ||
        b.isAllZeros() ||
        (a = papaya.volume.Header.ORIENTATION_CERTAINTY_HIGH);
    }
    return a;
  };
papaya.volume.nifti.HeaderNIFTI.prototype.getBestTransform = function () {
  return 0 < this.nifti.qform_code &&
    this.nifti.qform_code > this.nifti.sform_code &&
    this.qFormHasRotations()
    ? this.getQformMatCopy()
    : 0 < this.nifti.sform_code &&
      this.nifti.sform_code >= this.nifti.qform_code &&
      this.sFormHasRotations()
    ? this.getSformMatCopy()
    : null;
};
papaya.volume.nifti.HeaderNIFTI.prototype.getBestTransformOrigin = function () {
  return 0 < this.nifti.qform_code &&
    this.nifti.qform_code > this.nifti.sform_code &&
    this.qFormHasRotations()
    ? this.getOrigin(!0, !1)
    : 0 < this.nifti.sform_code &&
      this.nifti.sform_code >= this.nifti.qform_code &&
      this.sFormHasRotations()
    ? this.getOrigin(!1, !0)
    : null;
};
papaya.volume.nifti.HeaderNIFTI.prototype.toString = function () {
  var a = papaya.utilities.StringUtils.formatNumber,
    b = "";
  this.isNIFTI2
    ? ((b +=
        "<span style='color:#B5CBD3'>Datatype</span><span style='color:gray'> = </span>" +
        this.nifti.datatypeCode +
        " (" +
        this.nifti.getDatatypeCodeString(this.nifti.datatypeCode) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Bits Per Voxel</span><span style='color:gray'> = </span>" +
        this.nifti.numBitsPerVoxel +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Image Dimensions</span> (1-8): " +
        this.nifti.dims[0] +
        ", " +
        this.nifti.dims[1] +
        ", " +
        this.nifti.dims[2] +
        ", " +
        this.nifti.dims[3] +
        ", " +
        this.nifti.dims[4] +
        ", " +
        this.nifti.dims[5] +
        ", " +
        this.nifti.dims[6] +
        ", " +
        this.nifti.dims[7] +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Intent Parameters</span> (1-3): " +
        this.nifti.intent_p1 +
        ", " +
        this.nifti.intent_p2 +
        ", " +
        this.nifti.intent_p3 +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Voxel Dimensions</span> (1-8): " +
        a(this.nifti.pixDims[0]) +
        ", " +
        a(this.nifti.pixDims[1]) +
        ", " +
        a(this.nifti.pixDims[2]) +
        ", " +
        a(this.nifti.pixDims[3]) +
        ", " +
        a(this.nifti.pixDims[4]) +
        ", " +
        a(this.nifti.pixDims[5]) +
        ", " +
        a(this.nifti.pixDims[6]) +
        ", " +
        a(this.nifti.pixDims[7]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Image Offset</span><span style='color:gray'> = </span>" +
        this.nifti.vox_offset +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Data Scale:  Slope</span><span style='color:gray'> = </span>" +
        this.nifti.scl_slope +
        "  <span style='color:#B5CBD3'>Intercept</span><span style='color:gray'> = </span>" +
        this.nifti.scl_inter +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Display Range:  Max</span><span style='color:gray'> = </span>" +
        this.nifti.cal_max +
        "  <span style='color:#B5CBD3'>Min</span><span style='color:gray'> = </span>" +
        this.nifti.cal_min +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice Duration</span><span style='color:gray'> = </span>" +
        this.nifti.slice_duration +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Time Axis Shift</span><span style='color:gray'> = </span>" +
        this.nifti.toffset +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice Start</span><span style='color:gray'> = </span>" +
        this.nifti.slice_start +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice End</span><span style='color:gray'> = </span>" +
        this.nifti.slice_end +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Description</span>: \"" +
        this.nifti.description +
        '"<br />'),
      (b +=
        "<span style='color:#B5CBD3'>Auxiliary File</span>: \"" +
        this.nifti.aux_file +
        '"<br />'),
      (b +=
        "<span style='color:#B5CBD3'>Q-Form Code</span><span style='color:gray'> = </span>" +
        this.nifti.qform_code +
        " (" +
        this.nifti.getTransformCodeString(this.nifti.qform_code) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Code</span><span style='color:gray'> = </span>" +
        this.nifti.sform_code +
        " (" +
        this.nifti.getTransformCodeString(this.nifti.sform_code) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Quaternion Parameters</span>:  <span style='color:#B5CBD3'>b</span> <span style='color:gray'>=</span> " +
        a(this.nifti.quatern_b) +
        "  <span style='color:#B5CBD3'>c</span> <span style='color:gray'>=</span> " +
        a(this.nifti.quatern_c) +
        "  <span style='color:#B5CBD3'>d</span> <span style='color:gray'>=</span> " +
        a(this.nifti.quatern_d) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Quaternion Offsets</span>:  <span style='color:#B5CBD3'>x</span> <span style='color:gray'>=</span> " +
        this.nifti.qoffset_x +
        "  <span style='color:#B5CBD3'>y</span> <span style='color:gray'>=</span> " +
        this.nifti.qoffset_y +
        "  <span style='color:#B5CBD3'>z</span> <span style='color:gray'>=</span> " +
        this.nifti.qoffset_z +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Parameters X</span>: " +
        a(this.nifti.affine[0][0]) +
        ", " +
        a(this.nifti.affine[0][1]) +
        ", " +
        a(this.nifti.affine[0][2]) +
        ", " +
        a(this.nifti.affine[0][3]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Parameters Y</span>: " +
        a(this.nifti.affine[1][0]) +
        ", " +
        a(this.nifti.affine[1][1]) +
        ", " +
        a(this.nifti.affine[1][2]) +
        ", " +
        a(this.nifti.affine[1][3]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Parameters Z</span>: " +
        a(this.nifti.affine[2][0]) +
        ", " +
        a(this.nifti.affine[2][1]) +
        ", " +
        a(this.nifti.affine[2][2]) +
        ", " +
        a(this.nifti.affine[2][3]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice Code</span><span style='color:gray'> = </span>" +
        this.nifti.slice_code +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Units Code</span><span style='color:gray'> = </span>" +
        this.nifti.xyzt_units +
        " (" +
        this.nifti.getUnitsCodeString(
          nifti.NIFTI1.SPATIAL_UNITS_MASK & this.nifti.xyzt_units
        ) +
        ", " +
        this.nifti.getUnitsCodeString(
          nifti.NIFTI1.TEMPORAL_UNITS_MASK & this.nifti.xyzt_units
        ) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Intent Code </span><span style='color:gray'> = </span>" +
        this.nifti.intent_code +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Intent Name</span>: \"" +
        this.nifti.intent_name +
        '"<br />'),
      (b +=
        "<span style='color:#B5CBD3'>Dim Info </span><span style='color:gray'> = </span>" +
        this.nifti.dim_info +
        "<br />"))
    : ((b +=
        "<span style='color:#B5CBD3'>Dim Info</span><span style='color:gray'> = </span>" +
        this.nifti.dim_info +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Image Dimensions</span> (1-8): " +
        this.nifti.dims[0] +
        ", " +
        this.nifti.dims[1] +
        ", " +
        this.nifti.dims[2] +
        ", " +
        this.nifti.dims[3] +
        ", " +
        this.nifti.dims[4] +
        ", " +
        this.nifti.dims[5] +
        ", " +
        this.nifti.dims[6] +
        ", " +
        this.nifti.dims[7] +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Intent Parameters</span> (1-3): " +
        this.nifti.intent_p1 +
        ", " +
        this.nifti.intent_p2 +
        ", " +
        this.nifti.intent_p3 +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Intent Code</span><span style='color:gray'> = </span>" +
        this.nifti.intent_code +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Datatype</span><span style='color:gray'> = </span>" +
        this.nifti.datatypeCode +
        " (" +
        this.nifti.getDatatypeCodeString(this.nifti.datatypeCode) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Bits Per Voxel</span><span style='color:gray'> = </span>" +
        this.nifti.numBitsPerVoxel +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice Start</span><span style='color:gray'> = </span>" +
        this.nifti.slice_start +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Voxel Dimensions</span> (1-8): " +
        a(this.nifti.pixDims[0]) +
        ", " +
        a(this.nifti.pixDims[1]) +
        ", " +
        a(this.nifti.pixDims[2]) +
        ", " +
        a(this.nifti.pixDims[3]) +
        ", " +
        a(this.nifti.pixDims[4]) +
        ", " +
        a(this.nifti.pixDims[5]) +
        ", " +
        a(this.nifti.pixDims[6]) +
        ", " +
        a(this.nifti.pixDims[7]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Image Offset</span><span style='color:gray'> = </span>" +
        this.nifti.vox_offset +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Data Scale</span>:  <span style='color:#B5CBD3'>Slope</span> = " +
        this.nifti.scl_slope +
        "  <span style='color:#B5CBD3'>Intercept</span> = " +
        this.nifti.scl_inter +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice End</span><span style='color:gray'> = </span>" +
        this.nifti.slice_end +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice Code</span><span style='color:gray'> = </span>" +
        this.nifti.slice_code +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Units Code</span><span style='color:gray'> = </span>" +
        this.nifti.xyzt_units +
        " (" +
        this.nifti.getUnitsCodeString(
          nifti.NIFTI1.SPATIAL_UNITS_MASK & this.nifti.xyzt_units
        ) +
        ", " +
        this.nifti.getUnitsCodeString(
          nifti.NIFTI1.TEMPORAL_UNITS_MASK & this.nifti.xyzt_units
        ) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Display Range</span>:  <span style='color:#B5CBD3'>Max</span><span style='color:gray'> = </span>" +
        this.nifti.cal_max +
        "  <span style='color:#B5CBD3'>Min</span><span style='color:gray'> = </span>" +
        this.nifti.cal_min +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Slice Duration</span><span style='color:gray'> = </span>" +
        this.nifti.slice_duration +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Time Axis Shift</span><span style='color:gray'> = </span>" +
        this.nifti.toffset +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Description</span>: \"" +
        this.nifti.description +
        '"<br />'),
      (b +=
        "<span style='color:#B5CBD3'>Auxiliary File</span>: \"" +
        this.nifti.aux_file +
        '"<br />'),
      (b +=
        "<span style='color:#B5CBD3'>Q-Form Code</span><span style='color:gray'> = </span>" +
        this.nifti.qform_code +
        " (" +
        this.nifti.getTransformCodeString(this.nifti.qform_code) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Code</span><span style='color:gray'> = </span>" +
        this.nifti.sform_code +
        " (" +
        this.nifti.getTransformCodeString(this.nifti.sform_code) +
        ")<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Quaternion Parameters</span>:  <span style='color:#B5CBD3'>b</span><span style='color:gray'> = </span>" +
        a(this.nifti.quatern_b) +
        "  <span style='color:#B5CBD3'>c</span><span style='color:gray'> = </span>" +
        a(this.nifti.quatern_c) +
        "  <span style='color:#B5CBD3'>d</span><span style='color:gray'> = </span>" +
        a(this.nifti.quatern_d) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Quaternion Offsets</span>:  <span style='color:#B5CBD3'>x</span><span style='color:gray'> = </span>" +
        this.nifti.qoffset_x +
        "  <span style='color:#B5CBD3'>y</span><span style='color:gray'> = </span>" +
        this.nifti.qoffset_y +
        "  <span style='color:#B5CBD3'>z</span><span style='color:gray'> = </span>" +
        this.nifti.qoffset_z +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Parameters X</span>: " +
        a(this.nifti.affine[0][0]) +
        ", " +
        a(this.nifti.affine[0][1]) +
        ", " +
        a(this.nifti.affine[0][2]) +
        ", " +
        a(this.nifti.affine[0][3]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Parameters Y</span>: " +
        a(this.nifti.affine[1][0]) +
        ", " +
        a(this.nifti.affine[1][1]) +
        ", " +
        a(this.nifti.affine[1][2]) +
        ", " +
        a(this.nifti.affine[1][3]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>S-Form Parameters Z</span>: " +
        a(this.nifti.affine[2][0]) +
        ", " +
        a(this.nifti.affine[2][1]) +
        ", " +
        a(this.nifti.affine[2][2]) +
        ", " +
        a(this.nifti.affine[2][3]) +
        "<br />"),
      (b +=
        "<span style='color:#B5CBD3'>Intent Name</span>: \"" +
        this.nifti.intent_name +
        '"<br />'));
  return b;
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.dicom = papaya.volume.dicom || {};
papaya.volume.dicom.HeaderDICOM =
  papaya.volume.dicom.HeaderDICOM ||
  function () {
    this.series = null;
    this.seriesMap = [];
    this.dialogHandler = this.onFinishedHeaderRead = this.error = null;
  };
papaya.volume.dicom.HeaderDICOM.ORIENTATION_DEFAULT = "XYZ+--";
papaya.volume.dicom.HeaderDICOM.SUPPORTED_TRANSFER_SYNTAXES =
  "1.2.840.10008.1.2 1.2.840.10008.1.2.1 1.2.840.10008.1.2.2 1.2.840.10008.1.2.1.99 1.2.840.10008.1.2.4.50 1.2.840.10008.1.2.4.51 1.2.840.10008.1.2.4.57 1.2.840.10008.1.2.4.70 1.2.840.10008.1.2.4.80 1.2.840.10008.1.2.4.81 1.2.840.10008.1.2.4.90 1.2.840.10008.1.2.4.91 1.2.840.10008.1.2.5".split(
    " "
  );
papaya.volume.dicom.HeaderDICOM.isThisFormat = function (a, b) {
  var c,
    e = 0;
  if (-1 !== a.indexOf(".dcm")) return !0;
  a = new DataView(b[0]);
  b = daikon.Parser.MAGIC_COOKIE_OFFSET;
  var d = daikon.Parser.MAGIC_COOKIE.length;
  for (c = 0; c < d; c += 1)
    a.getUint8(b + c) === daikon.Parser.MAGIC_COOKIE[c] && (e += 1);
  if (4 === e) return !0;
  e = new daikon.Parser();
  a = e.testForValidTag(a);
  return null !== a && 8 >= a.group && !e.hasError();
};
papaya.volume.dicom.HeaderDICOM.prototype.setSeries = function (a, b) {
  for (a = 0; a < Object.keys(this.seriesMap).length; a += 1)
    if (-1 !== Object.keys(this.seriesMap)[a].indexOf(b)) {
      this.series = this.seriesMap[Object.keys(this.seriesMap)[a]];
      break;
    }
};
papaya.volume.dicom.HeaderDICOM.prototype.getDataScaleSlope = function (a, b) {
  return a ? b.getDataScaleElscint() || 1 : b.getDataScaleSlope() || 1;
};
papaya.volume.dicom.HeaderDICOM.prototype.getDataScaleIntercept = function (
  a,
  b
) {
  return a ? 0 : b.getDataScaleIntercept() || 0;
};
papaya.volume.dicom.HeaderDICOM.prototype.finishedHeaderRead = function () {
  var a;
  if (this.error) this.onFinishedHeaderRead();
  else if (1 < Object.keys(this.seriesMap).length) {
    this.series = this.seriesMap[Object.keys(this.seriesMap)[0]];
    var b = [];
    for (a = 0; a < Object.keys(this.seriesMap).length; a += 1)
      b.push(this.seriesMap[Object.keys(this.seriesMap)[a]]);
    b = { items: [{ label: "Select:", field: "series", options: b }] };
    this.dialogHandler.showDialog(
      "Select DICOM Series",
      b,
      this,
      papaya.utilities.ObjectUtils.bind(this, this.setSeries),
      papaya.utilities.ObjectUtils.bind(this, this.finishedSeriesSelection)
    );
  } else
    (this.series = this.seriesMap[Object.keys(this.seriesMap)[0]]),
      0 < this.series.images.length
        ? (this.series.buildSeries(),
          this.isTransferSyntaxSupported() ||
            (this.error = Error(
              "This transfer syntax is currently not supported!"
            )))
        : (this.error = Error("No images found!")),
      this.onFinishedHeaderRead();
};
papaya.volume.dicom.HeaderDICOM.prototype.isTransferSyntaxSupported =
  function () {
    var a = this.series.images[0].getTransferSyntax();
    return (
      papaya.utilities.StringUtils.isStringBlank(a) ||
      papaya.utilities.ArrayUtils.contains(
        papaya.volume.dicom.HeaderDICOM.SUPPORTED_TRANSFER_SYNTAXES,
        a
      )
    );
  };
papaya.volume.dicom.HeaderDICOM.prototype.finishedSeriesSelection =
  function () {
    0 < this.series.images.length
      ? (this.series.buildSeries(),
        this.isTransferSyntaxSupported() ||
          (this.error = Error(
            "This transfer syntax is currently not supported!"
          )))
      : (this.error = Error("No images found!"));
    this.seriesMap = null;
    this.onFinishedHeaderRead();
  };
papaya.volume.dicom.HeaderDICOM.prototype.readHeaderData = function (
  a,
  b,
  c,
  e
) {
  this.onFinishedHeaderRead = e;
  this.dialogHandler = c;
  this.readNextHeaderData(
    a,
    0,
    b,
    papaya.utilities.ObjectUtils.bind(this, this.finishedHeaderRead)
  );
};
papaya.volume.dicom.HeaderDICOM.prototype.readNextHeaderData = function (
  a,
  b,
  c,
  e
) {
  if (b >= a.length) c.drawProgress(1, "Reading DICOM Headers"), e();
  else {
    var d = daikon.Series.parseImage(new DataView(a[b]));
    if (null === d) this.error = daikon.Series.parserError;
    else if (d.hasPixelData()) {
      var g = this.findSeries(d.getSeriesId());
      g || ((g = new daikon.Series()), (this.seriesMap[d.getSeriesId()] = g));
      g.addImage(d);
    } else this.error = Error("No pixel data found!");
    this.error
      ? e()
      : (c.drawProgress(b / a.length, "Reading DICOM Headers"),
        setTimeout(
          function () {
            this.readNextHeaderData(a, b + 1, c, e);
          }.bind(this),
          0
        ));
  }
};
papaya.volume.dicom.HeaderDICOM.prototype.getName = function () {
  var a = this.series.getName();
  return a ? a : null;
};
papaya.volume.dicom.HeaderDICOM.prototype.getSeriesLabels = function () {
  return null;
};
papaya.volume.dicom.HeaderDICOM.prototype.findSeries = function (a) {
  return 0 === Object.keys(this.seriesMap).length ? null : this.seriesMap[a];
};
papaya.volume.dicom.HeaderDICOM.prototype.readImageData = function (a, b) {
  this.series.concatenateImageData(a, b);
};
papaya.volume.dicom.HeaderDICOM.prototype.getImageDimensions = function () {
  var a;
  if (this.series.isMosaic) {
    var b =
      this.series.images[0].getMosaicCols() *
      this.series.images[0].getMosaicRows();
    b = new papaya.volume.ImageDimensions(
      parseInt(
        this.series.images[0].getCols() / this.series.images[0].getMosaicCols()
      ),
      parseInt(
        this.series.images[0].getRows() / this.series.images[0].getMosaicRows()
      ),
      b,
      this.series.images.length
    );
  } else
    b = this.series.isMultiFrameVolume
      ? new papaya.volume.ImageDimensions(
          this.series.images[0].getCols(),
          this.series.images[0].getRows(),
          this.series.numberOfFrames,
          1
        )
      : this.series.isMultiFrameTimeseries
      ? new papaya.volume.ImageDimensions(
          this.series.images[0].getCols(),
          this.series.images[0].getRows(),
          this.series.numberOfFramesInFile,
          this.series.numberOfFrames
        )
      : this.series.isImplicitTimeseries
      ? new papaya.volume.ImageDimensions(
          this.series.images[0].getCols(),
          this.series.images[0].getRows(),
          parseInt(this.series.images.length / this.series.numberOfFrames),
          this.series.numberOfFrames
        )
      : new papaya.volume.ImageDimensions(
          this.series.images[0].getCols(),
          this.series.images[0].getRows(),
          this.series.images.length,
          1
        );
  var c = parseInt(
    (b.getNumVoxelsSeries() *
      parseInt(this.series.images[0].getBitsAllocated() / 8)) /
      this.series.images.length
  );
  for (a = 0; a < this.series.images.length; a += 1)
    (b.dataOffsets[a] = this.series.images[a].getPixelData().offsetValue),
      (b.dataLengths[a] = c);
  return b;
};
papaya.volume.dicom.HeaderDICOM.prototype.getVoxelDimensions = function () {
  var a = this.series.images[0].getPixelSpacing() || [0, 0];
  var b = Math.max(
    this.series.images[0].getSliceGap(),
    this.series.images[0].getSliceThickness()
  );
  daikon.Series.useExplicitSpacing && (b = daikon.Series.useExplicitSpacing);
  this.series.isMosaic || this.series.isMultiFrame
    ? (a = new papaya.volume.VoxelDimensions(
        a[1],
        a[0],
        b,
        this.series.images[0].getTR() / 1e3
      ))
    : 1 === this.series.images.length || daikon.Series.useExplicitOrdering
    ? (a = new papaya.volume.VoxelDimensions(
        a[1],
        a[0],
        b,
        this.series.images[0].getTR() / 1e3
      ))
    : ((b = Math.abs(
        this.series.images[0].getSliceLocation() -
          this.series.images[1].getSliceLocation()
      )),
      0 === b &&
        (b = Math.max(
          this.series.images[0].getSliceGap(),
          this.series.images[0].getSliceThickness()
        )),
      (a = new papaya.volume.VoxelDimensions(
        a[1],
        a[0],
        b,
        this.series.images[0].getTR() / 1e3
      )));
  a.isValid() ||
    (0 === a.rowSize && (a.rowSize = 1),
    0 === a.colSize && (a.colSize = 1),
    0 === a.sliceSize && (a.sliceSize = 1));
  a.spatialUnit = papaya.volume.VoxelDimensions.UNITS_MM;
  a.temporalUnit = papaya.volume.VoxelDimensions.UNITS_SEC;
  return a;
};
papaya.volume.dicom.HeaderDICOM.prototype.getImageType = function () {
  var a = this.series.images[0].getDataType();
  a = new papaya.volume.ImageType(
    a === daikon.Image.BYTE_TYPE_INTEGER
      ? papaya.volume.ImageType.DATATYPE_INTEGER_SIGNED
      : a === daikon.Image.BYTE_TYPE_INTEGER_UNSIGNED
      ? papaya.volume.ImageType.DATATYPE_INTEGER_UNSIGNED
      : a === daikon.Image.BYTE_TYPE_FLOAT
      ? papaya.volume.ImageType.DATATYPE_FLOAT
      : a === daikon.Image.BYTE_TYPE_RGB
      ? papaya.volume.ImageType.DATATYPE_RGB
      : papaya.volume.ImageType.DATATYPE_UNKNOWN,
    parseInt(this.series.images[0].getBitsAllocated() / 8),
    this.series.images[0].littleEndian,
    !1
  );
  a.rgbBySample = 1 === this.series.images[0].getPlanarConfig();
  return a;
};
papaya.volume.dicom.HeaderDICOM.prototype.getImageRange = function () {
  var a,
    b,
    c,
    e = [],
    d = [];
  var g = [];
  var h = [];
  for (c = b = a = 0; c < this.series.images.length; c += 1) {
    var n = this.series.images[c];
    var q =
      n.getImageMax() * this.getDataScaleSlope(this.series.isElscint, n) +
      (n.getDataScaleIntercept() || 0);
    n =
      n.getImageMin() * this.getDataScaleSlope(this.series.isElscint, n) +
      (n.getDataScaleIntercept() || 0);
    0 === c ? ((a = q), (b = n)) : (q > a && (a = q), n < b && (b = n));
  }
  var t = (q = 0);
  if (this.series.isElscint)
    for (c = 0; c < this.series.images.length; c += 1) {
      n = this.series.images[c];
      var u = n.getWindowWidth() * n.getDataScaleElscint();
      n = n.getWindowCenter() * n.getDataScaleElscint();
      0 === c ? ((q = u), (t = n)) : t < n && ((q = u), (t = n));
    }
  else
    for (c = 0; c < this.series.images.length; c += 1)
      (n = this.series.images[c]),
        (u = n.getWindowWidth()),
        (n = n.getWindowCenter()),
        0 === c ? ((q = u), (t = n)) : t < n && ((q = u), (t = n));
  a = new papaya.volume.ImageRange(b, a);
  a.displayMin = t - q / 2;
  a.displayMax = t + q / 2;
  c = this.getImageDimensions();
  if (this.series.isMosaic) {
    g = c.slices;
    h = g * this.series.images.length;
    for (c = 0; c < h; c += 1)
      (n = this.series.images[parseInt(c / g)]),
        (e[c] = this.getDataScaleSlope(this.series.isElscint, n)),
        (d[c] = this.getDataScaleIntercept(this.series.isElscint, n));
    a.dataScaleSlopes = e;
    a.dataScaleIntercepts = d;
  } else if (this.series.isMultiFrame) {
    c = c.slices * c.timepoints;
    e = [];
    d = [];
    h = parseInt(c / this.series.images.length);
    for (c = 0; c < this.series.images.length; c += 1)
      for (g = 0; g < h; g += 1)
        (n = this.series.images[c]),
          (e[c * h + g] = this.getDataScaleSlope(this.series.isElscint, n)),
          (d[c * h + g] = this.getDataScaleIntercept(this.series.isElscint, n));
    a.dataScaleSlopes = e;
    a.dataScaleIntercepts = d;
  } else if (this.series.isImplicitTimeseries)
    if (((c = c.slices * c.timepoints), this.series.images.length !== c))
      a.setGlobalDataScale(
        this.getDataScaleSlope(this.series.isElscint, this.series.images[0]),
        this.getDataScaleIntercept(
          this.series.isElscint,
          this.series.images[0]
        ),
        this.series.numberOfFrames
      );
    else {
      for (c = 0; c < this.series.images.length; c += 1)
        (n = this.series.images[c]),
          (g[c] = this.getDataScaleSlope(this.series.isElscint, n)),
          (h[c] = this.getDataScaleIntercept(this.series.isElscint, n));
      a.dataScaleSlopes = g;
      a.dataScaleIntercepts = h;
    }
  else {
    for (c = 0; c < this.series.images.length; c += 1)
      (n = this.series.images[c]),
        (g[c] = this.getDataScaleSlope(this.series.isElscint, n)),
        (h[c] = this.getDataScaleIntercept(this.series.isElscint, n));
    a.dataScaleSlopes = g;
    a.dataScaleIntercepts = h;
  }
  a.validateDataScale();
  return a;
};
papaya.volume.dicom.HeaderDICOM.prototype.getOrientation = function () {
  var a = this.series.images[0].getOrientation();
  null === a && (a = papaya.volume.dicom.HeaderDICOM.ORIENTATION_DEFAULT);
  a = a.substring(0, 5) + (this.series.sliceSense ? "+" : "-");
  return new papaya.volume.Orientation(a);
};
papaya.volume.dicom.HeaderDICOM.prototype.getOrientationCertainty =
  function () {
    return null === this.series.images[0].getOrientation()
      ? papaya.volume.Header.ORIENTATION_CERTAINTY_UNKNOWN
      : this.series.isMosaic || this.series.isMultiFrameVolume
      ? papaya.volume.Header.ORIENTATION_CERTAINTY_LOW
      : papaya.volume.Header.ORIENTATION_CERTAINTY_HIGH;
  };
papaya.volume.dicom.HeaderDICOM.prototype.getOrigin = function () {
  var a = this.getBestTransform();
  return a
    ? ((a = numeric.inv(a)),
      new papaya.core.Coordinate(a[0][3], a[1][3], a[2][3]))
    : new papaya.core.Coordinate(0, 0, 0);
};
papaya.volume.dicom.HeaderDICOM.prototype.hasError = function () {
  return null !== this.error;
};
papaya.volume.dicom.HeaderDICOM.prototype.getImageDescription = function () {
  var a = "";
  var b = this.series.images[0].getPatientName();
  var c = this.series.images[0].getPatientID();
  var e = this.series.images[0].getStudyTime();
  var d = this.series.images[0].getStudyDate();
  var g = this.series.images[0].getImageDescription();
  b && (a += " " + b);
  c && (a += " " + c);
  e && (a += " " + e);
  d && (a += " " + d);
  g && (a += " " + g);
  return new papaya.volume.ImageDescription(a.trim());
};
papaya.volume.dicom.HeaderDICOM.prototype.getBestTransform = function () {
  var a = this.series.images[0].getImageDirections(),
    b = null;
  if (a) {
    b = this.getVoxelDimensions();
    var c = this.series.images[0].getImagePosition(),
      e = [a[0], a[1], a[2]];
    a = [a[3], a[4], a[5]];
    var d = [
      e[1] * a[2] - e[2] * a[1],
      e[2] * a[0] - e[0] * a[2],
      e[0] * a[1] - e[1] * a[0],
    ];
    b = [
      [e[0] * b.colSize * -1, a[0] * b.rowSize, d[0] * b.sliceSize, -1 * c[0]],
      [e[1] * b.colSize, a[1] * b.rowSize * -1, d[1] * b.sliceSize, -1 * c[1]],
      [e[2] * b.colSize, a[2] * b.rowSize, d[2] * b.sliceSize, c[2]],
      [0, 0, 0, 1],
    ];
  }
  return b;
};
papaya.volume.dicom.HeaderDICOM.prototype.getBestTransformOrigin = function () {
  return this.getOrigin();
};
papaya.volume.dicom.HeaderDICOM.prototype.toString = function () {
  return this.series.images[0].toString();
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.Orientation =
  papaya.volume.Orientation ||
  function (a) {
    this.orientation = a;
    this.orientMat = null;
    this.zIncrement = this.yIncrement = this.xIncrement = -1;
  };
papaya.volume.Orientation.DEFAULT = "XYZ+--";
papaya.volume.Orientation.isValidOrientationString = function (a) {
  var b = !0;
  if (null === a || 6 !== a.length) b = !1;
  var c = a.toUpperCase().indexOf("X");
  if (-1 === c || 2 < c || a.toUpperCase().lastIndexOf("X") !== c) b = !1;
  c = a.toUpperCase().indexOf("Y");
  if (-1 === c || 2 < c || a.toUpperCase().lastIndexOf("Y") !== c) b = !1;
  c = a.toUpperCase().indexOf("Z");
  if (-1 === c || 2 < c || a.toUpperCase().lastIndexOf("Z") !== c) b = !1;
  "+" !== a.charAt(3) && "-" !== a.charAt(3) && (b = !1);
  "+" !== a.charAt(4) && "-" !== a.charAt(4) && (b = !1);
  "+" !== a.charAt(5) && "-" !== a.charAt(5) && (b = !1);
  return b;
};
papaya.volume.Orientation.prototype.convertIndexToOffsetNative = function (
  a,
  b,
  c
) {
  return a * this.xIncrement + b * this.yIncrement + c * this.zIncrement;
};
papaya.volume.Orientation.prototype.convertIndexToOffset = function (a, b, c) {
  var e = papayaFloorFast(
    a * this.orientMat[0][0] +
      b * this.orientMat[0][1] +
      c * this.orientMat[0][2] +
      this.orientMat[0][3]
  );
  var d = papayaFloorFast(
    a * this.orientMat[1][0] +
      b * this.orientMat[1][1] +
      c * this.orientMat[1][2] +
      this.orientMat[1][3]
  );
  a = papayaFloorFast(
    a * this.orientMat[2][0] +
      b * this.orientMat[2][1] +
      c * this.orientMat[2][2] +
      this.orientMat[2][3]
  );
  return e * this.xIncrement + d * this.yIncrement + a * this.zIncrement;
};
papaya.volume.Orientation.prototype.convertCoordinate = function (a, b) {
  b.x =
    a.x * this.orientMat[0][0] +
    a.y * this.orientMat[0][1] +
    a.z * this.orientMat[0][2] +
    this.orientMat[0][3];
  b.y =
    a.x * this.orientMat[1][0] +
    a.y * this.orientMat[1][1] +
    a.z * this.orientMat[1][2] +
    this.orientMat[1][3];
  b.z =
    a.x * this.orientMat[2][0] +
    a.y * this.orientMat[2][1] +
    a.z * this.orientMat[2][2] +
    this.orientMat[2][3];
  return b;
};
papaya.volume.Orientation.prototype.createInfo = function (a, b) {
  var c = a.cols;
  var e = a.rows;
  var d = a.slices;
  var g = a.getNumVoxelsSlice();
  var h = b.colSize;
  var n = b.rowSize;
  var q = b.sliceSize;
  var t = "+" === this.orientation.charAt(3);
  var u = "+" === this.orientation.charAt(4);
  var A = "+" === this.orientation.charAt(5);
  if (-1 !== this.orientation.toUpperCase().indexOf("XYZ")) {
    a.xDim = c;
    a.yDim = e;
    a.zDim = d;
    b.xSize = h;
    b.ySize = n;
    b.zSize = q;
    this.xIncrement = 1;
    this.yIncrement = c;
    this.zIncrement = g;
    if (t) {
      var G = 1;
      var O = 0;
    } else (G = -1), (O = c - 1);
    if (u) {
      var H = -1;
      var P = e - 1;
    } else (H = 1), (P = 0);
    if (A) {
      var U = -1;
      var ha = d - 1;
    } else (U = 1), (ha = 0);
  } else
    -1 !== this.orientation.toUpperCase().indexOf("XZY")
      ? ((a.xDim = c),
        (a.yDim = d),
        (a.zDim = e),
        (b.xSize = h),
        (b.ySize = q),
        (b.zSize = n),
        (this.xIncrement = 1),
        (this.yIncrement = g),
        (this.zIncrement = c),
        t ? ((G = 1), (O = 0)) : ((G = -1), (O = c - 1)),
        u ? ((U = -1), (ha = e - 1)) : ((U = 1), (ha = 0)),
        A ? ((H = -1), (P = d - 1)) : ((H = 1), (P = 0)))
      : -1 !== this.orientation.toUpperCase().indexOf("YXZ")
      ? ((a.xDim = e),
        (a.yDim = c),
        (a.zDim = d),
        (b.xSize = n),
        (b.ySize = h),
        (b.zSize = q),
        (this.xIncrement = c),
        (this.yIncrement = 1),
        (this.zIncrement = g),
        t ? ((H = -1), (P = c - 1)) : ((H = 1), (P = 0)),
        u ? ((G = 1), (O = 0)) : ((G = -1), (O = e - 1)),
        A ? ((U = -1), (ha = d - 1)) : ((U = 1), (ha = 0)))
      : -1 !== this.orientation.toUpperCase().indexOf("YZX")
      ? ((a.xDim = d),
        (a.yDim = c),
        (a.zDim = e),
        (b.xSize = q),
        (b.ySize = h),
        (b.zSize = n),
        (this.xIncrement = g),
        (this.yIncrement = 1),
        (this.zIncrement = c),
        t ? ((H = -1), (P = c - 1)) : ((H = 1), (P = 0)),
        u ? ((U = -1), (ha = e - 1)) : ((U = 1), (ha = 0)),
        A ? ((G = 1), (O = 0)) : ((G = -1), (O = d - 1)))
      : -1 !== this.orientation.toUpperCase().indexOf("ZXY")
      ? ((a.xDim = e),
        (a.yDim = d),
        (a.zDim = c),
        (b.xSize = n),
        (b.ySize = q),
        (b.zSize = h),
        (this.xIncrement = c),
        (this.yIncrement = g),
        (this.zIncrement = 1),
        t ? ((U = -1), (ha = c - 1)) : ((U = 1), (ha = 0)),
        u ? ((G = 1), (O = 0)) : ((G = -1), (O = e - 1)),
        A ? ((H = -1), (P = d - 1)) : ((H = 1), (P = 0)))
      : -1 !== this.orientation.toUpperCase().indexOf("ZYX") &&
        ((a.xDim = d),
        (a.yDim = e),
        (a.zDim = c),
        (b.xSize = q),
        (b.ySize = n),
        (b.zSize = h),
        (this.xIncrement = g),
        (this.yIncrement = c),
        (this.zIncrement = 1),
        t ? ((U = -1), (ha = c - 1)) : ((U = 1), (ha = 0)),
        u ? ((H = -1), (P = e - 1)) : ((H = 1), (P = 0)),
        A ? ((G = 1), (O = 0)) : ((G = -1), (O = d - 1)));
  this.orientMat = [
    [1, 0, 0, 0],
    [0, 1, 0, 0],
    [0, 0, 1, 0],
    [0, 0, 0, 1],
  ];
  this.orientMat[0][0] = G;
  this.orientMat[0][1] = 0;
  this.orientMat[0][2] = 0;
  this.orientMat[0][3] = O;
  this.orientMat[1][0] = 0;
  this.orientMat[1][1] = H;
  this.orientMat[1][2] = 0;
  this.orientMat[1][3] = P;
  this.orientMat[2][0] = 0;
  this.orientMat[2][1] = 0;
  this.orientMat[2][2] = U;
  this.orientMat[2][3] = ha;
  this.orientMat[3][0] = 0;
  this.orientMat[3][1] = 0;
  this.orientMat[3][2] = 0;
  this.orientMat[3][3] = 1;
};
papaya.volume.Orientation.prototype.isValid = function () {
  return papaya.volume.Orientation.isValidOrientationString(this.orientation);
};
papaya.volume.Orientation.prototype.getOrientationDescription = function () {
  var a = this.orientation;
  return (
    "Cols (" +
    a.charAt(0) +
    a.charAt(3) +
    "), Rows (" +
    a.charAt(1) +
    a.charAt(4) +
    "), Slices (" +
    a.charAt(2) +
    a.charAt(5) +
    ")"
  );
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.Transform =
  papaya.volume.Transform ||
  function (a, b) {
    this.voxelValue = new papaya.volume.VoxelValue(
      b.imageData,
      b.header.imageType,
      b.header.imageDimensions,
      b.header.imageRange,
      b.header.orientation
    );
    this.voxelDimensions = b.header.voxelDimensions;
    this.imageDimensions = b.header.imageDimensions;
    this.volume = b;
    this.mat = papaya.volume.Transform.IDENTITY.clone();
    this.indexMat = papaya.volume.Transform.IDENTITY.clone();
    this.sizeMat = papaya.volume.Transform.IDENTITY.clone();
    this.sizeMatInverse = papaya.volume.Transform.IDENTITY.clone();
    this.mmMat = papaya.volume.Transform.IDENTITY.clone();
    this.worldMat = papaya.volume.Transform.IDENTITY.clone();
    this.worldMatNifti = null;
    this.matInverse = papaya.volume.Transform.IDENTITY.clone();
    this.originMat = papaya.volume.Transform.IDENTITY.clone();
    this.tempMat = papaya.volume.Transform.IDENTITY.clone();
    this.tempMat2 = papaya.volume.Transform.IDENTITY.clone();
    this.orientMat = papaya.volume.Transform.IDENTITY.clone();
    this.centerMat = papaya.volume.Transform.IDENTITY.clone();
    this.centerMatInverse = papaya.volume.Transform.IDENTITY.clone();
    this.rotMatX = papaya.volume.Transform.IDENTITY.clone();
    this.rotMatY = papaya.volume.Transform.IDENTITY.clone();
    this.rotMatZ = papaya.volume.Transform.IDENTITY.clone();
    this.rotMat = papaya.volume.Transform.IDENTITY.clone();
    this.updateTransforms(a);
  };
papaya.volume.Transform.IDENTITY = [
  [1, 0, 0, 0],
  [0, 1, 0, 0],
  [0, 0, 1, 0],
  [0, 0, 0, 1],
];
papaya.volume.Transform.EPSILON = 1e-5;
papaya.volume.Transform.printTransform = function (a) {
  console.log(a[0][0] + " " + a[0][1] + " " + a[0][2] + " " + a[0][3]);
  console.log(a[1][0] + " " + a[1][1] + " " + a[1][2] + " " + a[1][3]);
  console.log(a[2][0] + " " + a[2][1] + " " + a[2][2] + " " + a[2][3]);
  console.log(a[3][0] + " " + a[3][1] + " " + a[3][2] + " " + a[3][3]);
};
papaya.volume.Transform.decompose = function (a) {
  var b = [];
  var c = papaya.volume.Transform.validateNum(a[0][3]);
  var e = papaya.volume.Transform.validateNum(a[1][3]);
  var d = papaya.volume.Transform.validateNum(a[2][3]);
  var g = papaya.volume.Transform.validateNum(Math.atan(a[2][1] / a[2][2]));
  var h =
    0 === g
      ? papaya.volume.Transform.validateNum(
          Math.atan((a[2][0] / a[2][2]) * Math.cos(g) * -1)
        )
      : papaya.volume.Transform.validateNum(
          Math.atan((a[2][0] / a[2][1]) * Math.sin(g) * -1)
        );
  0 === h && (h = papaya.volume.Transform.EPSILON);
  var n = papaya.volume.Transform.validateScale(
    a[2][2] / (Math.cos(h) * Math.cos(g))
  );
  var q = Math.cos(g);
  var t = Math.sin(g) * Math.sin(h) + (Math.cos(h) / Math.tan(h)) * Math.sin(g);
  var u = (Math.sin(g) / Math.tan(h)) * a[1][0] + a[1][1];
  var A = -1 * Math.sin(g);
  var G = Math.cos(g) * Math.sin(h) + (Math.cos(h) / Math.tan(h)) * Math.cos(g);
  var O = (Math.cos(g) / Math.tan(h)) * a[1][0] + a[1][2];
  A = papaya.volume.Transform.validateNum(
    Math.atan((q * O - u * A) / (u * G - t * O))
  );
  q = papaya.volume.Transform.validateScale(
    u / (Math.cos(A) * q + Math.sin(A) * t)
  );
  t = papaya.volume.Transform.validateNum(
    (q * Math.sin(A) * Math.cos(h) - a[1][0]) / (n * Math.sin(h))
  );
  u = Math.cos(h) * Math.cos(A);
  G = q * Math.cos(h) * Math.sin(A);
  O = -1 * n * Math.sin(h);
  var H = Math.sin(g) * Math.sin(h) * Math.cos(A) - Math.cos(g) * Math.sin(A);
  var P = Math.sin(g) * Math.sin(h) * Math.sin(A) + Math.cos(g) * Math.cos(A);
  var U = n * Math.sin(g) * Math.cos(h);
  var ha = Math.cos(g) * Math.sin(h) * Math.cos(A) + Math.sin(g) * Math.sin(A);
  var w = Math.cos(g) * Math.sin(h) * Math.sin(A) - Math.sin(g) * Math.cos(A);
  var I = n * Math.cos(g) * Math.cos(h);
  P = G * H - u * P;
  U = O * H - u * U;
  H = H * a[0][0] - u * a[0][1];
  w = G * ha - u * w;
  I = O * ha - u * I;
  var aa = ha * a[0][0] - u * a[0][2];
  ha = papaya.volume.Transform.validateNum((w * H - aa * P) / (U * w - P * I));
  P = papaya.volume.Transform.validateNum((H * I - U * aa) / (P * I - U * w));
  a = papaya.volume.Transform.validateScale((a[0][0] - P * G - ha * O) / u);
  h === papaya.volume.Transform.EPSILON && (h = 0);
  g *= 180 / Math.PI;
  h *= 180 / Math.PI;
  A *= 180 / Math.PI;
  b[0] = papaya.volume.Transform.validateZero(c);
  b[1] = papaya.volume.Transform.validateZero(e);
  b[2] = papaya.volume.Transform.validateZero(d);
  b[3] = papaya.volume.Transform.validateZero(g);
  b[4] = papaya.volume.Transform.validateZero(h);
  b[5] = papaya.volume.Transform.validateZero(A);
  b[6] = a;
  b[7] = q;
  b[8] = n;
  b[9] = papaya.volume.Transform.validateZero(t);
  b[10] = papaya.volume.Transform.validateZero(ha);
  b[11] = papaya.volume.Transform.validateZero(P);
  return b;
};
papaya.volume.Transform.hasRotations = function (a) {
  if (null !== a) {
    var b = papaya.volume.Transform.decompose(a);
    a = Math.abs(1 - Math.abs(b[3]) / 90) % 1;
    var c = Math.abs(1 - Math.abs(b[4]) / 90) % 1;
    b = Math.abs(1 - Math.abs(b[5]) / 90) % 1;
    return 0.01 < a || 0.01 < c || 0.01 < b;
  }
  return !1;
};
papaya.volume.Transform.validateNum = function (a) {
  return a === Number.POSITIVE_INFINITY ||
    a === Number.NEGATIVE_INFINITY ||
    isNaN(a) ||
    0 === a
    ? 0
    : a;
};
papaya.volume.Transform.validateScale = function (a) {
  return a === Number.POSITIVE_INFINITY ||
    a === Number.NEGATIVE_INFINITY ||
    isNaN(a)
    ? 1
    : a;
};
papaya.volume.Transform.validateZero = function (a) {
  return Math.abs(a) < papaya.volume.Transform.EPSILON ? 0 : a;
};
papaya.volume.Transform.prototype.updateSizeMat = function () {
  this.sizeMat[0][0] = this.voxelDimensions.xSize;
  this.sizeMat[1][1] = this.voxelDimensions.ySize;
  this.sizeMat[2][2] = this.voxelDimensions.zSize;
  this.sizeMat[3][3] = 1;
  this.sizeMatInverse[0][0] = 1 / this.voxelDimensions.xSize;
  this.sizeMatInverse[1][1] = 1 / this.voxelDimensions.ySize;
  this.sizeMatInverse[2][2] = 1 / this.voxelDimensions.zSize;
  this.sizeMatInverse[3][3] = 1;
};
papaya.volume.Transform.prototype.updateOrientMat = function () {
  this.orientMat = this.volume.header.orientation.orientMat;
};
papaya.volume.Transform.prototype.updateIndexTransform = function () {
  var a, b;
  for (a = 0; 4 > a; a += 1)
    for (b = 0; 4 > b; b += 1)
      this.indexMat[a][b] =
        this.orientMat[a][0] * this.mat[0][b] +
        this.orientMat[a][1] * this.mat[1][b] +
        this.orientMat[a][2] * this.mat[2][b] +
        this.orientMat[a][3] * this.mat[3][b];
};
papaya.volume.Transform.prototype.updateMmTransform = function () {
  var a, b;
  for (a = 0; 4 > a; a += 1)
    for (b = 0; 4 > b; b += 1)
      this.mmMat[a][b] =
        this.indexMat[a][0] * this.sizeMatInverse[0][b] +
        this.indexMat[a][1] * this.sizeMatInverse[1][b] +
        this.indexMat[a][2] * this.sizeMatInverse[2][b] +
        this.indexMat[a][3] * this.sizeMatInverse[3][b];
};
papaya.volume.Transform.prototype.updateOriginMat = function () {
  this.originMat[0][0] = 1;
  this.originMat[1][1] = -1;
  this.originMat[2][2] = -1;
  this.originMat[3][3] = 1;
  this.originMat[0][3] = this.volume.header.origin.x;
  this.originMat[1][3] = this.volume.header.origin.y;
  this.originMat[2][3] = this.volume.header.origin.z;
};
papaya.volume.Transform.prototype.updateImageMat = function (a, b, c, e, d, g) {
  this.updateCenterMat(a, b, c);
  b = (e * Math.PI) / 180;
  a = Math.cos(b);
  b = Math.sin(b);
  this.rotMatX[1][1] = a;
  this.rotMatX[1][2] = b;
  this.rotMatX[2][1] = -1 * b;
  this.rotMatX[2][2] = a;
  b = (d * Math.PI) / 180;
  a = Math.cos(b);
  b = Math.sin(b);
  this.rotMatY[0][0] = a;
  this.rotMatY[0][2] = -1 * b;
  this.rotMatY[2][0] = b;
  this.rotMatY[2][2] = a;
  b = (g * Math.PI) / 180;
  a = Math.cos(b);
  b = Math.sin(b);
  this.rotMatZ[0][0] = a;
  this.rotMatZ[0][1] = b;
  this.rotMatZ[1][0] = -1 * b;
  this.rotMatZ[1][1] = a;
  for (d = 0; 4 > d; d += 1)
    for (g = 0; 4 > g; g += 1)
      this.tempMat[d][g] =
        this.rotMatX[d][0] * this.rotMatY[0][g] +
        this.rotMatX[d][1] * this.rotMatY[1][g] +
        this.rotMatX[d][2] * this.rotMatY[2][g] +
        this.rotMatX[d][3] * this.rotMatY[3][g];
  for (d = 0; 4 > d; d += 1)
    for (g = 0; 4 > g; g += 1)
      this.rotMat[d][g] =
        this.tempMat[d][0] * this.rotMatZ[0][g] +
        this.tempMat[d][1] * this.rotMatZ[1][g] +
        this.tempMat[d][2] * this.rotMatZ[2][g] +
        this.tempMat[d][3] * this.rotMatZ[3][g];
  for (d = 0; 4 > d; d += 1)
    for (g = 0; 4 > g; g += 1)
      this.tempMat[d][g] =
        this.sizeMatInverse[d][0] * this.centerMatInverse[0][g] +
        this.sizeMatInverse[d][1] * this.centerMatInverse[1][g] +
        this.sizeMatInverse[d][2] * this.centerMatInverse[2][g] +
        this.sizeMatInverse[d][3] * this.centerMatInverse[3][g];
  for (d = 0; 4 > d; d += 1)
    for (g = 0; 4 > g; g += 1)
      this.tempMat2[d][g] =
        this.tempMat[d][0] * this.rotMat[0][g] +
        this.tempMat[d][1] * this.rotMat[1][g] +
        this.tempMat[d][2] * this.rotMat[2][g] +
        this.tempMat[d][3] * this.rotMat[3][g];
  for (d = 0; 4 > d; d += 1)
    for (g = 0; 4 > g; g += 1)
      this.tempMat[d][g] =
        this.tempMat2[d][0] * this.centerMat[0][g] +
        this.tempMat2[d][1] * this.centerMat[1][g] +
        this.tempMat2[d][2] * this.centerMat[2][g] +
        this.tempMat2[d][3] * this.centerMat[3][g];
  for (d = 0; 4 > d; d += 1)
    for (g = 0; 4 > g; g += 1)
      this.tempMat2[d][g] =
        this.tempMat[d][0] * this.sizeMat[0][g] +
        this.tempMat[d][1] * this.sizeMat[1][g] +
        this.tempMat[d][2] * this.sizeMat[2][g] +
        this.tempMat[d][3] * this.sizeMat[3][g];
  this.volume.transform.updateTransforms(this.tempMat2);
};
papaya.volume.Transform.prototype.updateCenterMat = function (a, b, c) {
  this.centerMat[0][0] = 1;
  this.centerMat[1][1] = 1;
  this.centerMat[2][2] = 1;
  this.centerMat[3][3] = 1;
  this.centerMat[0][3] = -1 * a;
  this.centerMat[1][3] = -1 * b;
  this.centerMat[2][3] = -1 * c;
  this.centerMatInverse[0][0] = 1;
  this.centerMatInverse[1][1] = 1;
  this.centerMatInverse[2][2] = 1;
  this.centerMatInverse[3][3] = 1;
  this.centerMatInverse[0][3] = a;
  this.centerMatInverse[1][3] = b;
  this.centerMatInverse[2][3] = c;
};
papaya.volume.Transform.prototype.updateWorldMat = function () {
  var a, b;
  if (this.worldMatNifti) {
    var c = [
      [-1, 0, 0, this.imageDimensions.xDim - 1],
      [0, 1, 0, 0],
      [0, 0, 1, 0],
      [0, 0, 0, 1],
    ];
    var e = papaya.volume.Transform.IDENTITY.clone();
    e[0][0] = -1;
    e[1][1] = -1;
    e[2][2] = -1;
    e[3][3] = 1;
    e[0][3] = this.volume.header.origin.x;
    e[1][3] = this.volume.header.origin.y;
    e[2][3] = this.volume.header.origin.z;
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat[a][b] =
          this.sizeMat[a][0] * e[0][b] +
          this.sizeMat[a][1] * e[1][b] +
          this.sizeMat[a][2] * e[2][b] +
          this.sizeMat[a][3] * e[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat2[a][b] =
          this.tempMat[a][0] * c[0][b] +
          this.tempMat[a][1] * c[1][b] +
          this.tempMat[a][2] * c[2][b] +
          this.tempMat[a][3] * c[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat[a][b] =
          this.tempMat2[a][0] * this.mat[0][b] +
          this.tempMat2[a][1] * this.mat[1][b] +
          this.tempMat2[a][2] * this.mat[2][b] +
          this.tempMat2[a][3] * this.mat[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat2[a][b] =
          this.tempMat[a][0] * c[0][b] +
          this.tempMat[a][1] * c[1][b] +
          this.tempMat[a][2] * c[2][b] +
          this.tempMat[a][3] * c[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat[a][b] =
          this.tempMat2[a][0] * e[0][b] +
          this.tempMat2[a][1] * e[1][b] +
          this.tempMat2[a][2] * e[2][b] +
          this.tempMat2[a][3] * e[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat2[a][b] =
          this.tempMat[a][0] * this.sizeMatInverse[0][b] +
          this.tempMat[a][1] * this.sizeMatInverse[1][b] +
          this.tempMat[a][2] * this.sizeMatInverse[2][b] +
          this.tempMat[a][3] * this.sizeMatInverse[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.worldMat[a][b] =
          this.worldMatNifti[a][0] * this.tempMat2[0][b] +
          this.worldMatNifti[a][1] * this.tempMat2[1][b] +
          this.worldMatNifti[a][2] * this.tempMat2[2][b] +
          this.worldMatNifti[a][3] * this.tempMat2[3][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1) this.matInverse[a][b] = this.tempMat2[b][a];
    this.matInverse[0][3] = -(
      this.tempMat2[0][0] * this.tempMat2[0][3] +
      this.tempMat2[1][0] * this.tempMat2[1][3] +
      this.tempMat2[2][0] * this.tempMat2[2][3]
    );
    this.matInverse[1][3] = -(
      this.tempMat2[0][1] * this.tempMat2[1][3] +
      this.tempMat2[1][1] * this.tempMat2[1][3] +
      this.tempMat2[2][1] * this.tempMat2[2][3]
    );
    this.matInverse[2][3] = -(
      this.tempMat2[0][2] * this.tempMat2[1][3] +
      this.tempMat2[1][2] * this.tempMat2[1][3] +
      this.tempMat2[2][2] * this.tempMat2[2][3]
    );
  } else {
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat[a][b] =
          this.originMat[a][0] * this.sizeMatInverse[0][b] +
          this.originMat[a][1] * this.sizeMatInverse[1][b] +
          this.originMat[a][2] * this.sizeMatInverse[2][b] +
          this.originMat[a][3] * this.sizeMatInverse[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.worldMat[a][b] =
          this.indexMat[a][0] * this.tempMat[0][b] +
          this.indexMat[a][1] * this.tempMat[1][b] +
          this.indexMat[a][2] * this.tempMat[2][b] +
          this.indexMat[a][3] * this.tempMat[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat2[a][b] =
          this.mat[a][0] * this.tempMat[0][b] +
          this.mat[a][1] * this.tempMat[1][b] +
          this.mat[a][2] * this.tempMat[2][b] +
          this.mat[a][3] * this.tempMat[3][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1) this.matInverse[a][b] = this.originMat[b][a];
    this.matInverse[0][3] = -(
      this.originMat[0][0] * this.originMat[0][3] +
      this.originMat[1][0] * this.originMat[1][3] +
      this.originMat[2][0] * this.originMat[2][3]
    );
    this.matInverse[1][3] = -(
      this.originMat[0][1] * this.originMat[0][3] +
      this.originMat[1][1] * this.originMat[1][3] +
      this.originMat[2][1] * this.originMat[2][3]
    );
    this.matInverse[2][3] = -(
      this.originMat[0][2] * this.originMat[0][3] +
      this.originMat[1][2] * this.originMat[1][3] +
      this.originMat[2][2] * this.originMat[2][3]
    );
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat[a][b] =
          this.matInverse[a][0] * this.tempMat2[0][b] +
          this.matInverse[a][1] * this.tempMat2[1][b] +
          this.matInverse[a][2] * this.tempMat2[2][b] +
          this.matInverse[a][3] * this.tempMat2[3][b];
    for (a = 0; 4 > a; a += 1)
      for (b = 0; 4 > b; b += 1)
        this.tempMat2[a][b] =
          this.sizeMat[a][0] * this.tempMat[0][b] +
          this.sizeMat[a][1] * this.tempMat[1][b] +
          this.sizeMat[a][2] * this.tempMat[2][b] +
          this.sizeMat[a][3] * this.tempMat[3][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1) this.matInverse[a][b] = this.tempMat2[b][a];
    this.matInverse[0][3] = -(
      this.tempMat2[0][0] * this.tempMat2[0][3] +
      this.tempMat2[1][0] * this.tempMat2[1][3] +
      this.tempMat2[2][0] * this.tempMat2[2][3]
    );
    this.matInverse[1][3] = -(
      this.tempMat2[0][1] * this.tempMat2[0][3] +
      this.tempMat2[1][1] * this.tempMat2[1][3] +
      this.tempMat2[2][1] * this.tempMat2[2][3]
    );
    this.matInverse[2][3] = -(
      this.tempMat2[0][2] * this.tempMat2[0][3] +
      this.tempMat2[1][2] * this.tempMat2[1][3] +
      this.tempMat2[2][2] * this.tempMat2[2][3]
    );
  }
};
papaya.volume.Transform.prototype.updateMat = function (a) {
  var b, c;
  for (c = 0; 4 > c; c += 1)
    for (b = 0; 4 > b; b += 1) this.mat[c][b] = a[c][b];
};
papaya.volume.Transform.prototype.updateTransforms = function (a) {
  this.updateMat(a);
  this.updateSizeMat();
  this.updateOrientMat();
  this.updateOriginMat();
  this.updateIndexTransform();
  this.updateMmTransform();
  this.updateWorldMat();
};
papaya.volume.Transform.prototype.getVoxelAtIndexNative = function (
  a,
  b,
  c,
  e,
  d
) {
  return this.voxelValue.getVoxelAtIndexNative(a, b, c, e, d);
};
papaya.volume.Transform.prototype.getVoxelAtIndex = function (a, b, c, e, d) {
  return this.voxelValue.getVoxelAtIndex(a, b, c, e, d);
};
papaya.volume.Transform.prototype.getVoxelAtCoordinate = function (
  a,
  b,
  c,
  e,
  d
) {
  a = this.getIndexAtCoordinate(a, b, c);
  return this.voxelValue.getVoxelAtIndexNative(a.x, a.y, a.z, e, d);
};
papaya.volume.Transform.prototype.getIndexAtCoordinate = function (a, b, c) {
  var e = [];
  e.x =
    a * this.worldMat[0][0] +
    b * this.worldMat[0][1] +
    c * this.worldMat[0][2] +
    this.worldMat[0][3];
  e.y =
    a * this.worldMat[1][0] +
    b * this.worldMat[1][1] +
    c * this.worldMat[1][2] +
    this.worldMat[1][3];
  e.z =
    a * this.worldMat[2][0] +
    b * this.worldMat[2][1] +
    c * this.worldMat[2][2] +
    this.worldMat[2][3];
  return e;
};
papaya.volume.Transform.prototype.getVoxelAtMM = function (a, b, c, e, d) {
  a = this.getIndexAtMM(a, b, c);
  return this.voxelValue.getVoxelAtIndexNative(a.x, a.y, a.z, e, d);
};
papaya.volume.Transform.prototype.getIndexAtMM = function (a, b, c) {
  var e = [];
  e.x =
    a * this.mmMat[0][0] +
    b * this.mmMat[0][1] +
    c * this.mmMat[0][2] +
    this.mmMat[0][3];
  e.y =
    a * this.mmMat[1][0] +
    b * this.mmMat[1][1] +
    c * this.mmMat[1][2] +
    this.mmMat[1][3];
  e.z =
    a * this.mmMat[2][0] +
    b * this.mmMat[2][1] +
    c * this.mmMat[2][2] +
    this.mmMat[2][3];
  return e;
};
papaya.volume.Transform.prototype.getRotatedCoordinate = function (a, b, c) {
  var e = [];
  e.x =
    a * this.matInverse[0][0] +
    b * this.matInverse[0][1] +
    c * this.matInverse[0][2] +
    this.matInverse[0][3];
  e.y =
    a * this.matInverse[1][0] +
    b * this.matInverse[1][1] +
    c * this.matInverse[1][2] +
    this.matInverse[1][3];
  e.z =
    a * this.matInverse[2][0] +
    b * this.matInverse[2][1] +
    c * this.matInverse[2][2] +
    this.matInverse[2][3];
  return e;
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.Volume =
  papaya.volume.Volume ||
  function (a, b, c) {
    this.progressMeter = a;
    this.dialogHandler = b;
    this.files = [];
    this.rawData = [];
    this.fileLength = 0;
    this.fileName = this.urls = null;
    this.compressed = !1;
    this.transform = null;
    this.numTimepoints = 0;
    this.transform = this.error = this.onFinishedRead = null;
    this.isLoaded = !1;
    this.numTimepoints = 1;
    this.loaded = !1;
    this.params = c;
    this.header = new papaya.volume.Header(
      void 0 !== this.params && this.params.padAllImages
    );
    this.imageData = new papaya.volume.ImageData(
      void 0 !== this.params && this.params.padAllImages
    );
  };
papaya.volume.Volume.PROGRESS_LABEL_LOADING = "Loading";
papaya.volume.Volume.prototype.fileIsCompressed = function (a, b) {
  return (a && -1 !== a.indexOf(".gz")) ||
    (b &&
      ((b = new DataView(b)),
      (a = b.getUint8(0)),
      (b = b.getUint8(1)),
      a === GUNZIP_MAGIC_COOKIE1 || b === GUNZIP_MAGIC_COOKIE2))
    ? !0
    : !1;
};
papaya.volume.Volume.prototype.readFiles = function (a, b) {
  this.files = a;
  this.fileName = a[0].name;
  this.onFinishedRead = b;
  this.compressed = this.fileIsCompressed(this.fileName);
  this.fileLength = this.files[0].size;
  this.readNextFile(this, 0);
};
papaya.volume.Volume.prototype.readNextFile = function (a, b) {
  if (b < this.files.length) {
    var c = papaya.utilities.PlatformUtils.makeSlice(
      this.files[b],
      0,
      this.files[b].size
    );
    try {
      var e = new FileReader();
      e.onloadend = papaya.utilities.ObjectUtils.bind(a, function (d) {
        d.target.readyState === FileReader.DONE &&
          ((a.rawData[b] = d.target.result),
          setTimeout(function () {
            a.readNextFile(a, b + 1);
          }, 0));
      });
      e.onerror = papaya.utilities.ObjectUtils.bind(a, function (d) {
        a.error = Error(
          "There was a problem reading that file:\n\n" + d.getMessage()
        );
        a.finishedLoad();
      });
      e.readAsArrayBuffer(c);
    } catch (d) {
      (a.error = Error(
        "There was a problem reading that file:\n\n" + d.message
      )),
        a.finishedLoad();
    }
  } else
    setTimeout(function () {
      a.decompress(a);
    }, 0);
};
papaya.volume.Volume.prototype.readURLs = function (a, b) {
  var c = this;
  this.urls = a;
  this.fileName = a[0].substr(a[0].lastIndexOf("/") + 1, a[0].length);
  this.onFinishedRead = b;
  this.compressed = this.fileIsCompressed(this.fileName);
  -1 !== this.fileName.indexOf("?") &&
    (this.fileName = this.fileName.substr(0, this.fileName.indexOf("?")));
  this.rawData = [];
  this.loadedFileCount = 0;
  this.readEachURL(this)
    .done(function () {
      setTimeout(function () {
        c.decompress(c);
      }, 0);
    })
    .fail(function (e, d, g) {
      d = d.message || "";
      "undefined" !== typeof g && (d = "Response status = " + g.status);
      e.error = Error(
        "There was a problem reading that file (" + e.fileName + "):\n\n" + d
      );
      e.finishedLoad();
    });
};
papaya.volume.Volume.prototype.loadURL = function (a, b, c) {
  var e, d;
  var g = jQuery.Deferred();
  if ("string" === typeof new XMLHttpRequest().responseType) {
    var h = new XMLHttpRequest();
    h.open("GET", a, !0);
    h.responseType = "arraybuffer";
    h.onreadystatechange = function () {
      4 === h.readyState &&
        (200 === h.status
          ? ((b.fileLength = b.rawData.byteLength), g.resolve(h.response))
          : g.reject(b, !1, h));
    };
    h.onprogress = function (n) {
      n.lengthComputable && g.notify(n.loaded, n.total);
    };
    h.send(null);
  } else
    (b.error = Error(
      "There was a problem reading that file (" +
        b.fileName +
        "):\n\nResponse type is not supported."
    )),
      b.finishedLoad();
  return g
    .promise()
    .done(function (n) {
      b.loadedFileCount++;
      b.rawData[c] = n;
    })
    .fail(function (n, q, t) {
      console.error(n, q, t);
    })
    .progress(function (n, q) {
      e = parseInt((100 * b.loadedFileCount) / b.urls.length, 10);
      d =
        papaya.volume.Volume.PROGRESS_LABEL_LOADING +
        " image " +
        (b.loadedFileCount + 1) +
        " of " +
        b.urls.length +
        " (" +
        e +
        "%)";
      b.progressMeter.drawProgress(n / q, d);
    });
};
papaya.volume.Volume.prototype.readEachURL = function (a) {
  for (var b = [], c = 0; c < a.urls.length; c++) {
    var e = a.loadURL(a.urls[c], a, c);
    b.push(e);
  }
  return $.when.apply($, b);
};
papaya.volume.Volume.prototype.readBinaryData = function (a, b) {
  var c = null;
  try {
    (this.fileName = a[0] instanceof ArrayBuffer ? "unknown" : a[0]),
      (this.onFinishedRead = b),
      (c = this),
      (this.fileLength = 0),
      c.readNextBinaryData(c, 0, a);
  } catch (e) {
    c &&
      ((c.error = Error(
        "There was a problem reading that file:\n\n" + e.message
      )),
      c.finishedLoad());
  }
};
papaya.volume.Volume.prototype.readNextBinaryData = function (a, b, c) {
  if (b < c.length)
    try {
      (a.rawData[b] =
        c[b] instanceof ArrayBuffer
          ? c[b]
          : papaya.utilities.ObjectUtils.dereference(c[b])),
        (a.compressed = this.fileIsCompressed(this.fileName, a.rawData[b])),
        setTimeout(function () {
          a.readNextBinaryData(a, b + 1, c);
        }, 0);
    } catch (e) {
      a &&
        ((a.error = Error(
          "There was a problem reading that file:\n\n" + e.message
        )),
        a.finishedLoad());
    }
  else a.decompress(a);
};
papaya.volume.Volume.prototype.readEncodedData = function (a, b) {
  var c = null;
  try {
    (this.fileName = a[0]),
      (this.onFinishedRead = b),
      (c = this),
      (this.fileLength = 0),
      c.readNextEncodedData(c, 0, a);
  } catch (e) {
    c &&
      ((c.error = Error(
        "There was a problem reading that file:\n\n" + e.message
      )),
      c.finishedLoad());
  }
};
papaya.volume.Volume.prototype.readNextEncodedData = function (a, b, c) {
  if (b < c.length)
    try {
      var e = papaya.utilities.ObjectUtils.dereference(c[b]);
      e
        ? (a.rawData[b] = Base64Binary.decodeArrayBuffer(e))
        : ((this.fileName = "unknown"),
          (a.rawData[b] = Base64Binary.decodeArrayBuffer(c[b])));
      a.compressed = this.fileIsCompressed(this.fileName, a.rawData[b]);
      setTimeout(function () {
        a.readNextEncodedData(a, b + 1, c);
      }, 0);
    } catch (d) {
      a &&
        ((a.error = Error(
          "There was a problem reading that file:\n\n" + d.message
        )),
        a.finishedLoad());
    }
  else a.decompress(a);
};
papaya.volume.Volume.prototype.getVoxelAtIndexNative = function (
  a,
  b,
  c,
  e,
  d
) {
  return this.transform.getVoxelAtIndexNative(a, b, c, 0, d);
};
papaya.volume.Volume.prototype.getVoxelAtIndex = function (a, b, c, e, d) {
  return this.transform.getVoxelAtIndex(a, b, c, e, d);
};
papaya.volume.Volume.prototype.getVoxelAtCoordinate = function (a, b, c, e, d) {
  return this.transform.getVoxelAtCoordinate(a, b, c, e, d);
};
papaya.volume.Volume.prototype.getVoxelAtMM = function (a, b, c, e, d) {
  return this.transform.getVoxelAtMM(a, b, c, e, d);
};
papaya.volume.Volume.prototype.hasError = function () {
  return null !== this.error;
};
papaya.volume.Volume.prototype.getXDim = function () {
  return this.header.imageDimensions.xDim;
};
papaya.volume.Volume.prototype.getYDim = function () {
  return this.header.imageDimensions.yDim;
};
papaya.volume.Volume.prototype.getZDim = function () {
  return this.header.imageDimensions.zDim;
};
papaya.volume.Volume.prototype.getXSize = function () {
  return this.header.voxelDimensions.xSize;
};
papaya.volume.Volume.prototype.getYSize = function () {
  return this.header.voxelDimensions.ySize;
};
papaya.volume.Volume.prototype.getZSize = function () {
  return this.header.voxelDimensions.zSize;
};
papaya.volume.Volume.prototype.decompress = function (a) {
  a.compressed = a.compressed || a.fileIsCompressed(a.fileName, a.rawData[0]);
  if (a.compressed)
    try {
      pako.inflate(
        new Uint8Array(a.rawData[0]),
        null,
        this.progressMeter,
        function (b) {
          a.finishedDecompress(a, b.buffer);
        }
      );
    } catch (b) {
      console.log(b);
    }
  else
    setTimeout(function () {
      a.finishedReadData(a);
    }, 0);
};
papaya.volume.Volume.prototype.finishedDecompress = function (a, b) {
  a.rawData[0] = b;
  setTimeout(function () {
    a.finishedReadData(a);
  }, 0);
};
papaya.volume.Volume.prototype.finishedReadData = function (a) {
  a.rawData = papaya.utilities.ArrayUtils.cleanArray(a.rawData);
  a.header.readHeaderData(
    a.fileName,
    a.rawData,
    this.progressMeter,
    this.dialogHandler,
    papaya.utilities.ObjectUtils.bind(this, this.finishedReadHeaderData)
  );
};
papaya.volume.Volume.prototype.finishedReadHeaderData = function () {
  this.rawData = null;
  this.header.hasError()
    ? ((this.error = this.header.error),
      console.error(this.error.stack),
      this.onFinishedRead(this))
    : ((this.header.imageType.swapped =
        this.header.imageType.littleEndian !==
        papaya.utilities.PlatformUtils.isPlatformLittleEndian()),
      this.header.getName() && (this.fileName = this.header.getName()),
      this.header.readImageData(
        this.progressMeter,
        papaya.utilities.ObjectUtils.bind(this, this.finishedReadImageData)
      ));
};
papaya.volume.Volume.prototype.finishedReadImageData = function (a) {
  this.imageData.readFileData(
    this.header,
    a,
    papaya.utilities.ObjectUtils.bind(this, this.finishedLoad)
  );
};
papaya.volume.Volume.prototype.finishedLoad = function () {
  this.loaded ||
    ((this.loaded = !0),
    this.onFinishedRead &&
      (this.hasError()
        ? console.log(this.error)
        : ((this.transform = new papaya.volume.Transform(
            papaya.volume.Transform.IDENTITY.clone(),
            this
          )),
          (this.numTimepoints = this.header.imageDimensions.timepoints || 1),
          this.applyBestTransform()),
      (this.isLoaded = !0),
      (this.rawData = null),
      this.onFinishedRead(this)));
};
papaya.volume.Volume.prototype.setOrigin = function (a) {
  a = this.header.orientation.convertCoordinate(
    a,
    new papaya.core.Coordinate(0, 0, 0)
  );
  this.header.origin.setCoordinate(a.x, a.y, a.z);
};
papaya.volume.Volume.prototype.getOrigin = function () {
  return this.header.orientation.convertCoordinate(
    this.header.origin,
    new papaya.core.Coordinate(0, 0, 0)
  );
};
papaya.volume.Volume.prototype.applyBestTransform = function () {
  var a = this.header.getBestTransform();
  null !== a &&
    ((this.transform.worldMatNifti = numeric.inv(a)),
    this.setOrigin(this.header.getBestTransformOrigin()),
    this.transform.updateWorldMat());
};
papaya.volume.Volume.prototype.isWorldSpaceOnly = function () {
  var a = !1;
  if (this.header.fileFormat instanceof papaya.volume.nifti.HeaderNIFTI) {
    var b = this.header.fileFormat;
    0 < b.nifti.qform_code && (a |= !b.qFormHasRotations());
    0 < b.nifti.sform_code && (a |= !b.sFormHasRotations());
    return !a;
  }
  return !1;
};
papaya.volume.Volume.prototype.getSeriesLabels = function () {
  return this.header.getSeriesLabels();
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.VoxelDimensions =
  papaya.volume.VoxelDimensions ||
  function (a, b, c, e) {
    this.colSize = Math.abs(a);
    this.rowSize = Math.abs(b);
    this.sliceSize = Math.abs(c);
    this.zSize = this.ySize = this.xSize = 0;
    this.flip = !1;
    this.timeSize = e;
    this.temporalUnit = this.spatialUnit =
      papaya.volume.VoxelDimensions.UNITS_UNKNOWN;
  };
papaya.volume.VoxelDimensions.UNITS_UNKNOWN = 0;
papaya.volume.VoxelDimensions.UNITS_METER = 1;
papaya.volume.VoxelDimensions.UNITS_MM = 2;
papaya.volume.VoxelDimensions.UNITS_MICRON = 3;
papaya.volume.VoxelDimensions.UNITS_SEC = 8;
papaya.volume.VoxelDimensions.UNITS_MSEC = 16;
papaya.volume.VoxelDimensions.UNITS_USEC = 24;
papaya.volume.VoxelDimensions.UNITS_HZ = 32;
papaya.volume.VoxelDimensions.UNITS_PPM = 40;
papaya.volume.VoxelDimensions.UNITS_RADS = 48;
papaya.volume.VoxelDimensions.UNIT_STRINGS = [];
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_UNKNOWN
] = "Unknown Unit";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_METER
] = "Meters";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_MM
] = "Millimeters";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_MICRON
] = "Microns";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_SEC
] = "Seconds";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_MSEC
] = "Milliseconds";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_USEC
] = "Microseconds";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_HZ
] = "Hertz";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_PPM
] = "Parts-per-million";
papaya.volume.VoxelDimensions.UNIT_STRINGS[
  papaya.volume.VoxelDimensions.UNITS_RADS
] = "Radians-per-second";
papaya.volume.VoxelDimensions.prototype.isValid = function () {
  return (
    0 < this.colSize &&
    0 < this.rowSize &&
    0 < this.sliceSize &&
    0 <= this.timeSize
  );
};
papaya.volume.VoxelDimensions.prototype.getSpatialUnitString = function () {
  return papaya.volume.VoxelDimensions.UNIT_STRINGS[this.spatialUnit];
};
papaya.volume.VoxelDimensions.prototype.getTemporalUnitString = function () {
  return papaya.volume.VoxelDimensions.UNIT_STRINGS[this.temporalUnit];
};
papaya.volume.VoxelDimensions.prototype.getTemporalUnitMultiplier =
  function () {
    return this.temporalUnit === papaya.volume.VoxelDimensions.UNITS_MSEC
      ? 0.001
      : this.temporalUnit === papaya.volume.VoxelDimensions.UNITS_USEC
      ? 1e-6
      : 1;
  };
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.volume.VoxelValue =
  papaya.volume.VoxelValue ||
  function (a, b, c, e, d) {
    this.imageData = a;
    this.imageType = b;
    this.imageRange = e;
    this.orientation = d;
    this.swap16 =
      2 === this.imageType.numBytes &&
      this.imageType.swapped &&
      this.imageType.datatype !== papaya.volume.ImageType.DATATYPE_FLOAT;
    this.swap32 =
      4 === this.imageType.numBytes &&
      this.imageType.swapped &&
      this.imageType.datatype !== papaya.volume.ImageType.DATATYPE_FLOAT;
    this.xIncrement = d.xIncrement;
    this.yIncrement = d.yIncrement;
    this.zIncrement = d.zIncrement;
    this.xDim = c.xDim;
    this.yDim = c.yDim;
    this.zDim = c.zDim;
    this.sliceSize = c.getNumVoxelsSlice();
    this.volSize = c.getNumVoxelsVolume();
    this.dataScaleSlopes = e.dataScaleSlopes;
    this.dataScaleIntercepts = e.dataScaleIntercepts;
    this.globalDataScaleSlope = e.globalDataScaleSlope;
    this.globalDataScaleIntercept = e.globalDataScaleIntercept;
    this.usesGlobalDataScale = e.usesGlobalDataScale;
    this.interpFirstPass = [
      [0, 0],
      [0, 0],
    ];
    this.interpSecondPass = [0, 0];
    this.forceABS = !1;
  };
papaya.volume.VoxelValue.prototype.getVoxelAtIndexNative = function (
  a,
  b,
  c,
  e,
  d
) {
  return d
    ? ((a = papayaRoundFast(a)),
      (b = papayaRoundFast(b)),
      (c = papayaRoundFast(c)),
      this.getVoxelAtOffset(
        this.orientation.convertIndexToOffsetNative(a, b, c),
        e,
        a,
        b,
        c
      ))
    : this.getVoxelAtIndexLinear(a, b, c, e);
};
papaya.volume.VoxelValue.prototype.getVoxelAtIndex = function (a, b, c, e, d) {
  return d
    ? ((a = papayaRoundFast(a)),
      (b = papayaRoundFast(b)),
      (c = papayaRoundFast(c)),
      this.getVoxelAtOffset(
        this.orientation.convertIndexToOffset(a, b, c),
        e,
        a,
        b,
        c
      ))
    : this.getVoxelAtIndexLinear(a, b, c, e);
};
papaya.volume.VoxelValue.prototype.getVoxelAtOffset = function (a, b, c, e, d) {
  a += this.volSize * b;
  if (
    0 > c ||
    c >= this.xDim ||
    0 > e ||
    e >= this.yDim ||
    0 > d ||
    d >= this.zDim
  )
    return 0;
  this.usesGlobalDataScale
    ? (c =
        this.checkSwap(this.imageData.data[a]) * this.globalDataScaleSlope +
        this.globalDataScaleIntercept)
    : ((c = parseInt(a / this.sliceSize)),
      (c =
        this.checkSwap(this.imageData.data[a]) * this.dataScaleSlopes[c] +
        this.dataScaleIntercepts[c]));
  return this.forceABS ? Math.abs(c) : c;
};
papaya.volume.VoxelValue.prototype.getVoxelAtIndexLinear = function (
  a,
  b,
  c,
  e
) {
  var d = Math.floor(a);
  var g = Math.floor(b);
  var h = Math.floor(c);
  var n = a - d;
  var q = b - g;
  var t = c - h;
  var u = 0 !== n;
  var A = 0 !== q;
  var G = 0 !== t;
  if (u && A && G) {
    for (b = 0; 2 > b; b += 1)
      for (c = 0; 2 > c; c += 1)
        (u = this.orientation.convertIndexToOffsetNative(d + b, g + c, h)),
          (a = this.getVoxelAtOffset(u, e, d + b, g + c, h) * (1 - t)),
          (u = this.orientation.convertIndexToOffsetNative(
            d + b,
            g + c,
            h + 1
          )),
          (u = this.getVoxelAtOffset(u, e, d + b, g + c, h + 1) * t),
          (this.interpFirstPass[b][c] = a + u);
    this.interpSecondPass[0] =
      this.interpFirstPass[0][0] * (1 - q) + this.interpFirstPass[0][1] * q;
    this.interpSecondPass[1] =
      this.interpFirstPass[1][0] * (1 - q) + this.interpFirstPass[1][1] * q;
    e = this.interpSecondPass[0] * (1 - n) + this.interpSecondPass[1] * n;
  } else if (u && A && !G) {
    for (b = 0; 2 > b; b += 1)
      (u = this.orientation.convertIndexToOffsetNative(d + b, g, h)),
        (a = this.getVoxelAtOffset(u, e, d + b, g, h) * (1 - q)),
        (u = this.orientation.convertIndexToOffsetNative(d + b, g + 1, h)),
        (u = this.getVoxelAtOffset(u, e, d + b, g + 1, h) * q),
        (this.interpSecondPass[b] = a + u);
    e = this.interpSecondPass[0] * (1 - n) + this.interpSecondPass[1] * n;
  } else if (u && !A && G) {
    for (b = 0; 2 > b; b += 1)
      (u = this.orientation.convertIndexToOffsetNative(d + b, g, h)),
        (a = this.getVoxelAtOffset(u, e, d + b, g, h) * (1 - t)),
        (u = this.orientation.convertIndexToOffsetNative(d + b, g, h + 1)),
        (u = this.getVoxelAtOffset(u, e, d + b, g, h + 1) * t),
        (this.interpSecondPass[b] = a + u);
    e = this.interpSecondPass[0] * (1 - n) + this.interpSecondPass[1] * n;
  } else if (!u && A && G) {
    for (c = 0; 2 > c; c += 1)
      (u = this.orientation.convertIndexToOffsetNative(d, g + c, h)),
        (a = this.getVoxelAtOffset(u, e, d, g + c, h) * (1 - t)),
        (u = this.orientation.convertIndexToOffsetNative(d, g + c, h + 1)),
        (u = this.getVoxelAtOffset(u, e, d, g + c, h + 1) * t),
        (this.interpSecondPass[c] = a + u);
    e = this.interpSecondPass[0] * (1 - q) + this.interpSecondPass[1] * q;
  } else
    u || A || !G
      ? u || !A || G
        ? !u || A || G
          ? (e = this.getVoxelAtOffset(
              this.orientation.convertIndexToOffsetNative(a, b, c),
              e,
              a,
              b,
              c
            ))
          : ((u = this.orientation.convertIndexToOffsetNative(d, g, h)),
            (a = this.getVoxelAtOffset(u, e, d, g, h) * (1 - n)),
            (u = this.orientation.convertIndexToOffsetNative(d + 1, g, h)),
            (u = this.getVoxelAtOffset(u, e, d + 1, g, h) * n),
            (e = a + u))
        : ((u = this.orientation.convertIndexToOffsetNative(d, g, h)),
          (a = this.getVoxelAtOffset(u, e, d, g, h) * (1 - q)),
          (u = this.orientation.convertIndexToOffsetNative(d, g + 1, h)),
          (u = this.getVoxelAtOffset(u, e, d, g + 1, h) * q),
          (e = a + u))
      : ((u = this.orientation.convertIndexToOffsetNative(d, g, h)),
        (a = this.getVoxelAtOffset(u, e, d, g, h) * (1 - t)),
        (u = this.orientation.convertIndexToOffsetNative(d, g, h + 1)),
        (u = this.getVoxelAtOffset(u, e, d, g, h + 1) * t),
        (e = a + u));
  return e;
};
papaya.volume.VoxelValue.prototype.checkSwap = function (a) {
  return this.swap16
    ? ((((a & 255) << 8) | ((a >> 8) & 255)) << 16) >> 16
    : this.swap32
    ? ((a & 255) << 24) |
      ((a & 65280) << 8) |
      ((a >> 8) & 65280) |
      ((a >> 24) & 255)
    : a;
};
("use strict");
papaya = papaya || {};
papaya.surface = papaya.surface || {};
papaya.surface.Surface =
  papaya.surface.Surface ||
  function (a, b) {
    this.progressMeter = a;
    this.colorsData =
      this.normalsData =
      this.triangleData =
      this.pointData =
      this.onFinishedRead =
      this.rawData =
      this.filename =
      this.error =
        null;
    this.numTriangles = this.numPoints = 0;
    this.solidColor =
      this.colorsBuffer =
      this.normalsBuffer =
      this.trianglesBuffer =
      this.pointsBuffer =
        null;
    this.surfaceType = papaya.surface.Surface.SURFACE_TYPE_UNKNOWN;
    this.fileFormat = null;
    this.params = b;
    this.volume = this.nextSurface = null;
    this.alpha = 1;
    this.parametricData = [];
    this.boundaryData = null;
  };
papaya.surface.Surface.SURFACE_TYPE_UNKNOWN = 0;
papaya.surface.Surface.SURFACE_TYPE_GIFTI = 1;
papaya.surface.Surface.SURFACE_TYPE_MANGO = 2;
papaya.surface.Surface.SURFACE_TYPE_VTK = 3;
papaya.surface.Surface.findSurfaceType = function (a) {
  return gifti.isThisFormat(a)
    ? papaya.surface.Surface.SURFACE_TYPE_GIFTI
    : papaya.surface.SurfaceMango.isThisFormat(a)
    ? papaya.surface.Surface.SURFACE_TYPE_MANGO
    : papaya.surface.SurfaceVTK.isThisFormat(a)
    ? papaya.surface.Surface.SURFACE_TYPE_VTK
    : papaya.surface.Surface.SURFACE_TYPE_UNKNOWN;
};
papaya.surface.Surface.prototype.makeFileFormat = function (a) {
  this.surfaceType = papaya.surface.Surface.findSurfaceType(a);
  this.surfaceType === papaya.surface.Surface.SURFACE_TYPE_GIFTI
    ? (this.fileFormat = new papaya.surface.SurfaceGIFTI())
    : this.surfaceType === papaya.surface.Surface.SURFACE_TYPE_MANGO
    ? (this.fileFormat = new papaya.surface.SurfaceMango())
    : this.surfaceType === papaya.surface.Surface.SURFACE_TYPE_VTK &&
      (this.fileFormat = new papaya.surface.SurfaceVTK());
};
papaya.surface.Surface.prototype.readURL = function (a, b, c) {
  var e = this;
  this.filename = a.substr(a.lastIndexOf("/") + 1, a.length);
  this.onFinishedRead = c;
  this.volume = b;
  this.processParams(this.filename);
  this.makeFileFormat(this.filename);
  if (this.surfaceType === papaya.surface.Surface.SURFACE_TYPE_UNKNOWN)
    (this.error = Error("This surface format is not supported!")),
      this.finishedLoading();
  else
    try {
      if ("string" === typeof new XMLHttpRequest().responseType) {
        var d = new XMLHttpRequest();
        d.open("GET", a, !0);
        this.fileFormat.isSurfaceDataBinary() &&
          (d.responseType = "arraybuffer");
        d.onreadystatechange = function () {
          4 === d.readyState &&
            (200 === d.status
              ? (e.rawData = d.response)
              : (e.error = Error(
                  "There was a problem reading that file (" +
                    e.filename +
                    "):\n\nResponse status = " +
                    d.status
                )),
            e.finishedLoading());
        };
        d.onprogress = function (g) {
          g.lengthComputable &&
            e.progressMeter.drawProgress(
              g.loaded / g.total,
              papaya.volume.Volume.PROGRESS_LABEL_LOADING
            );
        };
        d.send(null);
      } else
        (e.error = Error(
          "There was a problem reading that file (" +
            e.filename +
            "):\n\nResponse type is not supported."
        )),
          e.finishedLoading();
    } catch (g) {
      null !== e &&
        ((e.error = Error(
          "There was a problem reading that file (" +
            e.filename +
            "):\n\n" +
            g.message
        )),
        e.finishedLoading());
    }
};
papaya.surface.Surface.prototype.readFile = function (a, b, c) {
  var e = papaya.utilities.PlatformUtils.makeSlice(a, 0, a.size),
    d = this;
  this.filename = a.name;
  this.onFinishedRead = c;
  this.volume = b;
  this.processParams(this.filename);
  this.makeFileFormat(this.filename);
  if (this.surfaceType === papaya.surface.Surface.SURFACE_TYPE_UNKNOWN)
    (this.error = Error("This surface format is not supported!")),
      this.finishedLoading();
  else
    try {
      var g = new FileReader();
      g.onloadend = function (h) {
        h.target.readyState === FileReader.DONE &&
          ((d.rawData = h.target.result), d.finishedLoading());
      };
      g.onerror = function (h) {
        d.error = Error(
          "There was a problem reading that file:\n\n" + h.getMessage()
        );
        d.finishedLoading();
      };
      this.fileFormat.isSurfaceDataBinary()
        ? g.readAsArrayBuffer(e)
        : g.readAsText(e);
    } catch (h) {
      (d.error = Error(
        "There was a problem reading that file:\n\n" + h.message
      )),
        d.finishedLoading();
    }
};
papaya.surface.Surface.prototype.readEncodedData = function (a, b, c) {
  this.filename = a + ".surf.gii";
  this.onFinishedRead = c;
  this.volume = b;
  this.processParams(a);
  this.makeFileFormat(this.filename);
  if (this.surfaceType === papaya.surface.Surface.SURFACE_TYPE_UNKNOWN)
    this.error = Error("This surface format is not supported!");
  else
    try {
      this.fileFormat.isSurfaceDataBinary()
        ? (this.rawData = Base64Binary.decodeArrayBuffer(
            papaya.utilities.ObjectUtils.dereference(a)
          ))
        : (this.rawData = atob(papaya.utilities.ObjectUtils.dereference(a)));
    } catch (e) {
      this.error = Error(
        "There was a problem reading that file:\n\n" + e.message
      );
    }
  this.finishedLoading();
};
papaya.surface.Surface.prototype.processParams = function (a) {
  if ((a = this.params[a]))
    void 0 !== a.color && (this.solidColor = a.color),
      void 0 !== a.alpha && (this.alpha = a.alpha),
      void 0 !== a.icon && (this.staticIcon = a.icon);
};
papaya.surface.Surface.prototype.finishedLoading = function () {
  this.readData();
};
papaya.surface.Surface.prototype.readData = function () {
  if (this.error) console.log(this.error), this.onFinishedRead(this);
  else {
    var a = this.progressMeter,
      b = function (c) {
        a.drawProgress(c, "Loading surface...");
      };
    try {
      this.fileFormat.readData(
        this.rawData,
        b,
        papaya.utilities.ObjectUtils.bind(this, this.finishedReading),
        this.volume
      );
    } catch (c) {
      (this.error = c), this.onFinishedRead(this);
    }
  }
};
papaya.surface.Surface.prototype.finishedReading = function () {
  var a = this.fileFormat.getNumSurfaces(),
    b = this,
    c;
  if (this.fileFormat.error) this.error = this.fileFormat.error;
  else
    for (c = 0; c < a; c += 1)
      0 < c &&
        ((b.nextSurface = new papaya.surface.Surface()), (b = b.nextSurface)),
        this.fileFormat.getSolidColor(c) &&
          (b.solidColor = this.fileFormat.getSolidColor(c)),
        b.generateColorData(),
        (b.numPoints = this.fileFormat.getNumPoints(c)),
        (b.numTriangles = this.fileFormat.getNumTriangles(c)),
        (b.pointData = this.fileFormat.getPointData(c)),
        (b.normalsData = this.fileFormat.getNormalsData(c)),
        (b.triangleData = this.fileFormat.getTriangleData(c)),
        (b.colorsData = this.fileFormat.getColorsData(c)),
        null === b.normalsData && this.generateNormals();
  this.progressMeter.drawProgress(1, "Loading surface...");
  this.onFinishedRead(this);
};
papaya.surface.Surface.prototype.generateNormals = function () {
  var a = [],
    b = [],
    c = [],
    e = [],
    d = [],
    g,
    h = this.pointData.length;
  this.normalsData = new Float32Array(h);
  var n = 3 * this.numTriangles;
  for (g = 0; g < n; g += 3) {
    var q = 3 * this.triangleData[g];
    var t = 3 * this.triangleData[g + 1];
    var u = 3 * this.triangleData[g + 2];
    a.x = this.pointData[q];
    a.y = this.pointData[q + 1];
    a.z = this.pointData[q + 2];
    b.x = this.pointData[t];
    b.y = this.pointData[t + 1];
    b.z = this.pointData[t + 2];
    c.x = this.pointData[u];
    c.y = this.pointData[u + 1];
    c.z = this.pointData[u + 2];
    var A = b.x - a.x;
    var G = b.y - a.y;
    var O = b.z - a.z;
    var H = c.x - a.x;
    var P = c.y - a.y;
    var U = c.z - a.z;
    e[0] = P * O - U * G;
    e[1] = U * A - H * O;
    e[2] = H * G - P * A;
    this.normalsData[q] += e[0];
    this.normalsData[q + 1] += e[1];
    this.normalsData[q + 2] += e[2];
    this.normalsData[t] += e[0];
    this.normalsData[t + 1] += e[1];
    this.normalsData[t + 2] += e[2];
    this.normalsData[u] += e[0];
    this.normalsData[u + 1] += e[1];
    this.normalsData[u + 2] += e[2];
  }
  for (g = 0; g < h; g += 3)
    (e[0] = -1 * this.normalsData[g]),
      (e[1] = -1 * this.normalsData[g + 1]),
      (e[2] = -1 * this.normalsData[g + 2]),
      vec3.normalize(e, d),
      (this.normalsData[g] = d[0]),
      (this.normalsData[g + 1] = d[1]),
      (this.normalsData[g + 2] = d[2]);
};
papaya.surface.Surface.prototype.generateColorData = function () {
  var a = this.fileFormat.colorsData,
    b = this.fileFormat.getNumPoints();
  null == a && (this.fileFormat.colorsData = a = new Float32Array(4 * b));
  var c,
    e,
    d = [];
  for (c = this.parametricData.length - 1; 0 <= c; c--)
    if (
      this.parametricData[c].data &&
      this.parametricData[c].data.length === b
    ) {
      this.parametricData[c].positiveVolume = null;
      this.parametricData[c].negativeVolume = null;
      for (e = 0; e < this.parametricData[c].viewer.screenVolumes.length; e++) {
        var g = this.parametricData[c].viewer.screenVolumes[e];
        g.volume !== this.parametricData[c].volume ||
          g.hidden ||
          (g.negative
            ? (this.parametricData[c].negativeVolume = g)
            : (this.parametricData[c].positiveVolume = g));
      }
      this.parametricData[c].mapper = getColor;
      d.push(this.parametricData[c]);
    }
  null != this.boundaryData &&
    null != this.boundaryData.data &&
    this.boundaryData.data.length &&
    ((this.boundaryData.mapper = binaryMapper), d.push(this.boundaryData));
  if (1 > d.length) a.fill(1, 0, 4 * b);
  else {
    g = this.solidColor
      ? {
          r: this.solidColor[0],
          g: this.solidColor[1],
          b: this.solidColor[2],
          a: 1,
        }
      : {
          r: 1,
          g: 1,
          b: 1,
          a: 1,
        };
    var h = 0;
    for (c = 0; c < b; c++) {
      var n = { r: 0, g: 0, b: 0, a: 0 };
      for (e = 0; e < d.length; e++) {
        var q = d[e].mapper(d[e].data[c], d[e]);
        n = combine(n, q);
      }
      1 > n.a && (n = combine(n, g));
      a[h++] = n.r;
      a[h++] = n.g;
      a[h++] = n.b;
      a[h++] = n.a;
    }
  }
};
function binaryMapper(a, b) {
  return 0.5 < a
    ? { r: 0, g: 0, b: 0, a: b.range.alpha }
    : { r: 1, g: 1, b: 1, a: 1 };
}
function getColor(a, b) {
  var c = { r: 0, g: 0, b: 0, a: 0 };
  b.negativeVolume && a < b.negativeVolume.screenMin
    ? ((a =
        a >= b.negativeVolume.screenMin
          ? papaya.viewer.ScreenSlice.SCREEN_PIXEL_MIN
          : a <= b.negativeVolume.screenMax
          ? papaya.viewer.ScreenSlice.SCREEN_PIXEL_MAX
          : papayaRoundFast(
              (a - b.negativeVolume.screenMin) * b.negativeVolume.screenRatio
            )),
      (c.r =
        b.negativeVolume.colorTable.lookupRed(a) /
        papaya.viewer.ColorTable.LUT_MAX),
      (c.g =
        b.negativeVolume.colorTable.lookupGreen(a) /
        papaya.viewer.ColorTable.LUT_MAX),
      (c.b =
        b.negativeVolume.colorTable.lookupBlue(a) /
        papaya.viewer.ColorTable.LUT_MAX),
      (c.a = b.negativeVolume.alpha))
    : b.positiveVolume &&
      a >= b.positiveVolume.screenMin &&
      ((a =
        a <= b.positiveVolume.screenMin
          ? papaya.viewer.ScreenSlice.SCREEN_PIXEL_MIN
          : a >= b.positiveVolume.screenMax
          ? papaya.viewer.ScreenSlice.SCREEN_PIXEL_MAX
          : papayaRoundFast(
              (a - b.positiveVolume.screenMin) * b.positiveVolume.screenRatio
            )),
      (c.r =
        b.positiveVolume.colorTable.lookupRed(a) /
        papaya.viewer.ColorTable.LUT_MAX),
      (c.g =
        b.positiveVolume.colorTable.lookupGreen(a) /
        papaya.viewer.ColorTable.LUT_MAX),
      (c.b =
        b.positiveVolume.colorTable.lookupBlue(a) /
        papaya.viewer.ColorTable.LUT_MAX),
      (c.a = b.positiveVolume.alpha));
  return c;
}
function combine(a, b) {
  var c = (1 - a.a) * b.a + a.a;
  return c <= Number.EPSILON
    ? a
    : {
        a: c,
        r: ((1 - a.a) * b.a * b.r + a.a * a.r) / c,
        g: ((1 - a.a) * b.a * b.g + a.a * a.g) / c,
        b: ((1 - a.a) * b.a * b.b + a.a * a.b) / c,
      };
}
("use strict");
papaya = papaya || {};
papaya.surface = papaya.surface || {};
papaya.surface.SurfaceGIFTI =
  papaya.surface.SurfaceGIFTI ||
  function () {
    this.onFinishedRead =
      this.parametricData =
      this.colorsData =
      this.normalsData =
      this.triangleData =
      this.pointData =
      this.error =
      this.gii =
        null;
  };
papaya.surface.SurfaceGIFTI.prototype.isSurfaceDataBinary = function () {
  return !1;
};
papaya.surface.SurfaceGIFTI.prototype.readData = function (a, b, c) {
  var e = this;
  b(0);
  this.onFinishedRead = c;
  this.gii = gifti.parse(a);
  setTimeout(function () {
    e.readDataPoints(e, b);
  }, 0);
};
papaya.surface.SurfaceGIFTI.prototype.readDataPoints = function (a, b) {
  b(0.2);
  null != a.gii.getPointsDataArray()
    ? (a.pointData = a.gii.getPointsDataArray().getData())
    : (a.error = Error("Surface is missing point information!"));
  setTimeout(function () {
    a.readDataNormals(a, b);
  }, 0);
};
papaya.surface.SurfaceGIFTI.prototype.readDataNormals = function (a, b) {
  b(0.4);
  null != a.gii.getNormalsDataArray() &&
    (a.normalsData = a.gii.getNormalsDataArray().getData());
  setTimeout(function () {
    a.readDataTriangles(a, b);
  }, 0);
};
papaya.surface.SurfaceGIFTI.prototype.readDataTriangles = function (a, b) {
  b(0.6);
  null != a.gii.getTrianglesDataArray()
    ? (a.triangleData = a.gii.getTrianglesDataArray().getData())
    : (a.error = Error("Surface is missing triangle information!"));
  setTimeout(function () {
    a.readDataColors(a, b);
  }, 0);
};
papaya.surface.SurfaceGIFTI.prototype.readDataColors = function (a, b) {
  b(0.8);
  null != a.gii.getColorsDataArray() &&
    (a.colorsData = a.gii.getColorsDataArray().getData());
  setTimeout(function () {
    a.readParametricData(a, b);
  }, 0);
};
papaya.surface.SurfaceGIFTI.prototype.readParametricData = function (a, b) {
  b(0.9);
  null != a.gii.getZScoresDataArray() &&
    (a.parametricData = a.gii.getZScoresDataArray().getData());
  setTimeout(function () {
    a.onFinishedRead();
  }, 0);
};
papaya.surface.SurfaceGIFTI.prototype.getNumSurfaces = function () {
  return 1;
};
papaya.surface.SurfaceGIFTI.prototype.getNumPoints = function () {
  return this.gii.getNumPoints();
};
papaya.surface.SurfaceGIFTI.prototype.getNumTriangles = function () {
  return this.gii.getNumTriangles();
};
papaya.surface.SurfaceGIFTI.prototype.getPointData = function () {
  return this.pointData;
};
papaya.surface.SurfaceGIFTI.prototype.getNormalsData = function () {
  return this.normalsData;
};
papaya.surface.SurfaceGIFTI.prototype.getTriangleData = function () {
  return this.triangleData;
};
papaya.surface.SurfaceGIFTI.prototype.getColorsData = function () {
  return this.colorsData;
};
papaya.surface.SurfaceGIFTI.prototype.getSolidColor = function () {
  return this.solidColor;
};
("use strict");
papaya = papaya || {};
papaya.surface = papaya.surface || {};
papaya.surface.SurfaceMango =
  papaya.surface.SurfaceMango ||
  function () {
    this.onFinishedRead = this.error = null;
    this.origin = [];
    this.imageDims = [];
    this.voxelDims = [];
    this.center = [];
    this.diffs = [];
    this.dv = null;
    this.numSurfaces = this.dataLength = this.surfaceIndex = this.index = 0;
    this.littleEndian = !1;
    this.surfaces = [];
    this.v15 = this.v14 = !1;
  };
papaya.surface.SurfaceMangoData =
  papaya.surface.SurfaceMangoData ||
  function () {
    this.colorsData =
      this.normalsData =
      this.triangleData =
      this.pointData =
        null;
    this.solidColor = [];
  };
papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_5 = "mangol15".split("");
papaya.surface.SurfaceMango.MAGIC_NUMBER_BIG_1_5 = "mangob15".split("");
papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_4 = "mangol14".split("");
papaya.surface.SurfaceMango.MAGIC_NUMBER_BIG_1_4 = "mangob14".split("");
papaya.surface.SurfaceMango.SURFACE_OVERLAY_MAGIC_NUMBER = [
  0,
  0,
  0,
  0,
  "s",
  "c",
  "a",
  "l",
];
papaya.surface.SurfaceMango.NAME_SIZE = 64;
papaya.surface.SurfaceMango.isThisFormat = function (a) {
  return a.endsWith(".surf");
};
papaya.surface.SurfaceMango.prototype.isSurfaceDataBinary = function () {
  return !0;
};
papaya.surface.SurfaceMango.prototype.isLittleEndian15 = function (a) {
  a = new Uint8Array(a);
  var b;
  for (
    b = 0;
    b < papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_5.length;
    b += 1
  )
    if (
      a[b] !==
      papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_5[b].charCodeAt(0)
    )
      return !1;
  return !0;
};
papaya.surface.SurfaceMango.prototype.isLittleEndian14 = function (a) {
  a = new Uint8Array(a);
  var b;
  for (
    b = 0;
    b < papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_4.length;
    b += 1
  )
    if (
      a[b] !==
      papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_4[b].charCodeAt(0)
    )
      return !1;
  return !0;
};
papaya.surface.SurfaceMango.prototype.isVersion15 = function (a) {
  a = new Uint8Array(a);
  var b,
    c = !0;
  for (
    b = 0;
    b < papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_5.length;
    b += 1
  )
    if (
      a[b] !==
      papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_5[b].charCodeAt(0)
    ) {
      c = !1;
      break;
    }
  if (!c)
    for (
      c = !0, b = 0;
      b < papaya.surface.SurfaceMango.MAGIC_NUMBER_BIG_1_5.length;
      b += 1
    )
      if (
        a[b] !==
        papaya.surface.SurfaceMango.MAGIC_NUMBER_BIG_1_5[b].charCodeAt(0)
      ) {
        c = !1;
        break;
      }
  return c;
};
papaya.surface.SurfaceMango.prototype.isVersion14 = function (a) {
  a = new Uint8Array(a);
  var b,
    c = !0;
  for (
    b = 0;
    b < papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_4.length;
    b += 1
  )
    if (
      a[b] !==
      papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_4[b].charCodeAt(0)
    ) {
      c = !1;
      break;
    }
  if (!c)
    for (
      c = !0, b = 0;
      b < papaya.surface.SurfaceMango.MAGIC_NUMBER_BIG_1_4.length;
      b += 1
    )
      if (
        a[b] !==
        papaya.surface.SurfaceMango.MAGIC_NUMBER_BIG_1_4[b].charCodeAt(0)
      ) {
        c = !1;
        break;
      }
  return c;
};
papaya.surface.SurfaceMango.prototype.isLittleEndian = function (a) {
  return this.isLittleEndian15(a) || this.isLittleEndian14(a);
};
papaya.surface.SurfaceMango.prototype.hasOverlay = function () {
  var a, b;
  for (
    a = 0;
    a < papaya.surface.SurfaceMango.SURFACE_OVERLAY_MAGIC_NUMBER.length;
    a += 1
  )
    if (
      ((b = papaya.surface.SurfaceMango.SURFACE_OVERLAY_MAGIC_NUMBER[a]) &&
        (b =
          papaya.surface.SurfaceMango.SURFACE_OVERLAY_MAGIC_NUMBER[
            a
          ].charCodeAt(0)),
      this.dv.getUint8(this.index + a) !== b)
    )
      return !1;
  return !0;
};
papaya.surface.SurfaceMango.prototype.getString = function (a) {
  var b,
    c = [];
  for (b = 0; b < a; b += 1) c[b] = this.dv.getUint8(this.index + b);
  return String.fromCharCode.apply(null, c);
};
papaya.surface.SurfaceMango.prototype.readData = function (a, b, c) {
  b(0.2);
  this.littleEndian = this.isLittleEndian(a);
  this.dataLength = a.byteLength;
  this.v14 = this.isVersion14(a);
  this.v15 = this.isVersion15(a);
  this.index = papaya.surface.SurfaceMango.MAGIC_NUMBER_LITTLE_1_5.length;
  this.dv = new DataView(a);
  if (!this.v14 && !this.v15)
    throw Error("Only Mango surface format version 1.4 and 1.5 are supported!");
  this.onFinishedRead = c;
  a = this.dv.getUint32(this.index, this.littleEndian);
  this.index += 4;
  this.numSurfaces = this.dv.getUint32(this.index, this.littleEndian);
  this.index += 4;
  this.index += 128;
  this.imageDims[0] = this.dv.getUint32(this.index, this.littleEndian);
  this.index += 4;
  this.imageDims[1] = this.dv.getUint32(this.index, this.littleEndian);
  this.index += 4;
  this.imageDims[2] = this.dv.getUint32(this.index, this.littleEndian);
  this.index += 4;
  this.voxelDims[0] = this.dv.getFloat32(this.index, this.littleEndian);
  this.index += 4;
  this.voxelDims[1] = this.dv.getFloat32(this.index, this.littleEndian);
  this.index += 4;
  this.voxelDims[2] = this.dv.getFloat32(this.index, this.littleEndian);
  this.index += 4;
  this.origin[0] =
    this.dv.getFloat32(this.index, this.littleEndian) * this.voxelDims[0];
  this.index += 4;
  this.origin[1] =
    this.dv.getFloat32(this.index, this.littleEndian) * this.voxelDims[1];
  this.index += 4;
  this.origin[2] =
    this.dv.getFloat32(this.index, this.littleEndian) * this.voxelDims[2];
  this.index += 4;
  this.center[0] = (this.imageDims[0] * this.voxelDims[0]) / 2;
  this.center[1] = (this.imageDims[1] * this.voxelDims[1]) / 2;
  this.center[2] = (this.imageDims[2] * this.voxelDims[2]) / 2;
  this.v14
    ? ((this.diffs[0] = this.center[0] - this.origin[0]),
      (this.diffs[1] = this.center[1] - this.origin[1]),
      (this.diffs[2] = this.origin[2] - this.center[2]))
    : ((this.diffs[0] = this.center[0] - this.origin[0]),
      (this.diffs[1] = this.center[1] - this.origin[1]),
      (this.diffs[2] = this.center[2] - this.origin[2]));
  this.index += 4;
  this.index += a;
  this.readNextSurface(this, b);
};
papaya.surface.SurfaceMango.prototype.readNextSurface = function (a, b) {
  var c = new papaya.surface.SurfaceMangoData();
  a.index += papaya.surface.SurfaceMango.NAME_SIZE;
  a.surfaces[a.surfaceIndex] = c;
  a.surfaces[a.surfaceIndex].solidColor[0] = a.dv.getFloat32(
    a.index,
    a.littleEndian
  );
  a.index += 4;
  a.surfaces[a.surfaceIndex].solidColor[1] = a.dv.getFloat32(
    a.index,
    a.littleEndian
  );
  a.index += 4;
  a.surfaces[a.surfaceIndex].solidColor[2] = a.dv.getFloat32(
    a.index,
    a.littleEndian
  );
  a.index += 4;
  setTimeout(function () {
    a.readDataPoints(a, b);
  }, 0);
};
papaya.surface.SurfaceMango.prototype.readDataPoints = function (a, b) {
  var c;
  b(0.4);
  a.index += 4;
  var e = a.dv.getInt32(a.index, a.littleEndian);
  a.index += 4;
  a.surfaces[a.surfaceIndex].pointData = new Float32Array(e);
  if (a.v14)
    for (c = 0; c < e; c += 1, a.index += 4)
      a.surfaces[a.surfaceIndex].pointData[c] =
        (2 !== c % 3 ? -1 : 1) *
        (a.dv.getFloat32(a.index, a.littleEndian) + a.diffs[c % 3]);
  else
    for (c = 0; c < e; c += 1, a.index += 4)
      a.surfaces[a.surfaceIndex].pointData[c] =
        (0 !== c % 3 ? -1 : 1) *
        (a.dv.getFloat32(a.index, a.littleEndian) + a.diffs[c % 3]);
  setTimeout(function () {
    a.readDataNormals(a, b);
  }, 0);
};
papaya.surface.SurfaceMango.prototype.readDataNormals = function (a, b) {
  var c;
  b(0.6);
  a.index += 4;
  var e = a.dv.getInt32(a.index, a.littleEndian);
  a.index += 4;
  a.surfaces[a.surfaceIndex].normalsData = new Float32Array(e);
  if (a.v14)
    for (c = 0; c < e; c += 1, a.index += 4)
      a.surfaces[a.surfaceIndex].normalsData[c] =
        (2 !== c % 3 ? -1 : 1) * a.dv.getFloat32(a.index, a.littleEndian);
  else
    for (c = 0; c < e; c += 1, a.index += 4)
      a.surfaces[a.surfaceIndex].normalsData[c] =
        (0 !== c % 3 ? -1 : 1) * a.dv.getFloat32(a.index, a.littleEndian);
  setTimeout(function () {
    a.readDataTriangles(a, b);
  }, 0);
};
papaya.surface.SurfaceMango.prototype.readDataTriangles = function (a, b) {
  var c;
  b(0.8);
  a.index += 4;
  var e = a.dv.getInt32(a.index, a.littleEndian);
  a.index += 4;
  a.surfaces[a.surfaceIndex].triangleData = new Uint32Array(e);
  for (c = 0; c < e; c += 1, a.index += 4)
    a.surfaces[a.surfaceIndex].triangleData[c] = a.dv.getUint32(
      a.index,
      a.littleEndian
    );
  setTimeout(function () {
    a.readDataColors(a, b);
  }, 0);
};
papaya.surface.SurfaceMango.prototype.readDataColors = function (a, b) {
  for (var c, e, d, g, h, n, q, t; a.index < a.dataLength; )
    if (a.hasOverlay()) {
      a.index +=
        papaya.surface.SurfaceMango.SURFACE_OVERLAY_MAGIC_NUMBER.length;
      a.index += papaya.surface.SurfaceMango.NAME_SIZE;
      q = a.getString(papaya.surface.SurfaceMango.NAME_SIZE);
      a.index += papaya.surface.SurfaceMango.NAME_SIZE;
      q = q.replace(/\0/g, "");
      a.index += 4;
      c = a.dv.getFloat32(this.index, this.littleEndian);
      a.index += 4;
      e = a.dv.getFloat32(this.index, this.littleEndian);
      a.index += 4;
      d = 255 / (e - c);
      a.index += 4;
      a.index += 4;
      g = a.dv.getUint32(this.index, this.littleEndian);
      a.index += 4;
      h = new Float32Array(g);
      for (t = 0; t < g; t += 1, a.index += 4)
        h[t] = a.dv.getFloat32(a.index, a.littleEndian);
      q =
        papaya.viewer.ColorTable.findLUT(q) !==
        papaya.viewer.ColorTable.TABLE_GRAYSCALE
          ? new papaya.viewer.ColorTable(q, !1)
          : new papaya.viewer.ColorTable("Spectrum", !1);
      q.updateLUT(0, 255);
      g = a.surfaces[a.surfaceIndex].pointData.length / 3;
      null === a.surfaces[a.surfaceIndex].colorsData &&
        (a.surfaces[a.surfaceIndex].colorsData = new Float32Array(4 * g));
      for (t = 0; t < g; t += 1)
        (n = h[t]),
          n <= c
            ? 0 === a.surfaces[a.surfaceIndex].colorsData[4 * t + 3] &&
              ((a.surfaces[a.surfaceIndex].colorsData[4 * t] =
                a.surfaces[a.surfaceIndex].solidColor[0]),
              (a.surfaces[a.surfaceIndex].colorsData[4 * t + 1] =
                a.surfaces[a.surfaceIndex].solidColor[1]),
              (a.surfaces[a.surfaceIndex].colorsData[4 * t + 2] =
                a.surfaces[a.surfaceIndex].solidColor[2]),
              (a.surfaces[a.surfaceIndex].colorsData[4 * t + 3] = 1))
            : (n > e
                ? ((a.surfaces[a.surfaceIndex].colorsData[4 * t] =
                    q.lookupRed(255) / 255),
                  (a.surfaces[a.surfaceIndex].colorsData[4 * t + 1] =
                    q.lookupGreen(255) / 255),
                  (a.surfaces[a.surfaceIndex].colorsData[4 * t + 2] =
                    q.lookupBlue(255) / 255))
                : ((n = Math.floor((n - c) * d + 0.5)),
                  (a.surfaces[a.surfaceIndex].colorsData[4 * t] =
                    q.lookupRed(n) / 255),
                  (a.surfaces[a.surfaceIndex].colorsData[4 * t + 1] =
                    q.lookupGreen(n) / 255),
                  (a.surfaces[a.surfaceIndex].colorsData[4 * t + 2] =
                    q.lookupBlue(n) / 255)),
              (a.surfaces[a.surfaceIndex].colorsData[4 * t + 3] = 1));
    } else break;
  a.surfaceIndex++;
  a.surfaceIndex === a.numSurfaces
    ? setTimeout(function () {
        a.onFinishedRead();
      }, 0)
    : setTimeout(function () {
        a.readNextSurface(a, b);
      }, 0);
};
papaya.surface.SurfaceMango.prototype.getNumSurfaces = function () {
  return this.numSurfaces;
};
papaya.surface.SurfaceMango.prototype.getNumPoints = function (a) {
  return this.surfaces[a].pointData.length / 3;
};
papaya.surface.SurfaceMango.prototype.getNumTriangles = function (a) {
  return this.surfaces[a].triangleData.length / 3;
};
papaya.surface.SurfaceMango.prototype.getSolidColor = function (a) {
  return this.surfaces[a].solidColor;
};
papaya.surface.SurfaceMango.prototype.getPointData = function (a) {
  return this.surfaces[a].pointData;
};
papaya.surface.SurfaceMango.prototype.getNormalsData = function (a) {
  return this.surfaces[a].normalsData;
};
papaya.surface.SurfaceMango.prototype.getTriangleData = function (a) {
  return this.surfaces[a].triangleData;
};
papaya.surface.SurfaceMango.prototype.getColorsData = function (a) {
  return this.surfaces[a].colorsData;
};
("use strict");
papaya = papaya || {};
papaya.surface = papaya.surface || {};
papaya.surface.SurfaceVTK =
  papaya.surface.SurfaceVTK ||
  function () {
    this.dv = this.onFinishedRead = this.error = null;
    this.index = 0;
    this.littleEndian = !0;
    this.numPoints = 0;
    this.description =
      this.vtkVersion =
      this.colorsData =
      this.normalsData =
      this.triangleData =
      this.pointData =
        null;
    this.ascii = !1;
    this.volume = null;
    this.headerRead = this.done = !1;
  };
papaya.surface.SurfaceVTK.MAGIC_NUMBER = "# vtk DataFile Version";
papaya.surface.SurfaceVTK.MAGIC_NUMBER_ASCII = "ASCII";
papaya.surface.SurfaceVTK.MAGIC_NUMBER_DATASET = "DATASET";
papaya.surface.SurfaceVTK.MAGIC_NUMBER_POLYDATA = "POLYDATA";
papaya.surface.SurfaceVTK.MAGIC_NUMBER_POINTS = "POINTS";
papaya.surface.SurfaceVTK.MAGIC_NUMBER_POLYGONS = "POLYGONS";
papaya.surface.SurfaceVTK.MAGIC_NUMBER_NORMALS = "NORMALS";
papaya.surface.SurfaceVTK.isThisFormat = function (a) {
  return a.endsWith(".vtk");
};
papaya.surface.SurfaceVTK.prototype.isSurfaceDataBinary = function () {
  return !0;
};
papaya.surface.SurfaceVTK.prototype.hasOverlay = function () {
  return !1;
};
papaya.surface.SurfaceVTK.prototype.getNextLine = function (a) {
  var b,
    c = [];
  a || (a = 256);
  for (b = 0; b < a; b += 1) {
    if (this.index >= this.dv.byteLength) {
      this.done = !0;
      break;
    }
    var e = this.dv.getUint8(this.index++);
    if (32 > e) {
      (!this.headerRead || this.ascii) &&
        this.index < this.dv.byteLength &&
        32 > this.dv.getUint8(this.index) &&
        this.index++;
      break;
    }
    c[b] = e;
  }
  return String.fromCharCode.apply(null, c);
};
papaya.surface.SurfaceVTK.prototype.readData = function (a, b, c, e) {
  var d = this;
  b(0.2);
  this.onFinishedRead = c;
  this.dv = new DataView(a);
  this.volume = e;
  this.vtkVersion = this.getNextLine()
    .substring(papaya.surface.SurfaceVTK.MAGIC_NUMBER.length)
    .trim();
  this.description = this.getNextLine().trim();
  this.ascii =
    this.getNextLine() == papaya.surface.SurfaceVTK.MAGIC_NUMBER_ASCII;
  this.datasetType = this.getNextLine()
    .substring(papaya.surface.SurfaceVTK.MAGIC_NUMBER_DATASET.length)
    .trim();
  this.headerRead = !0;
  this.datasetType != papaya.surface.SurfaceVTK.MAGIC_NUMBER_POLYDATA &&
    ((this.error = Error("VTK: Only POLYDATA format is currently supported!")),
    this.onFinishedRead());
  var g = this.getNextLine().split(" ");
  g[0] == papaya.surface.SurfaceVTK.MAGIC_NUMBER_POINTS &&
    setTimeout(function () {
      d.readDataPoints(d, g[1], b);
    }, 0);
};
papaya.surface.SurfaceVTK.prototype.readNextData = function (a, b) {
  var c,
    e = 0.2;
  a.pointData && (e += 0.2);
  a.normalsData && (e += 0.2);
  a.triangleData && (e += 0.2);
  b(e);
  if (a.done || (a.pointData && a.normalsData && a.triangleData))
    a.onFinishedRead();
  else
    (c = this.getNextLine().split(" ")) &&
    c[0] == papaya.surface.SurfaceVTK.MAGIC_NUMBER_POINTS
      ? setTimeout(function () {
          a.readDataPoints(a, c[1], b);
        }, 0)
      : c && c[0] == papaya.surface.SurfaceVTK.MAGIC_NUMBER_POLYGONS
      ? setTimeout(function () {
          a.readDataTriangles(a, c[1], b);
        }, 0)
      : c && c[0] == papaya.surface.SurfaceVTK.MAGIC_NUMBER_NORMALS
      ? setTimeout(function () {
          a.readDataNormals(a, b);
        }, 0)
      : setTimeout(function () {
          a.readNextData(a, b);
        }, 0);
};
papaya.surface.SurfaceVTK.prototype.readDataPoints = function (a, b, c) {
  var e = 0,
    d = [],
    g = 0,
    h = 3 * b;
  a.numPoints = b;
  a.pointData = new Float32Array(h);
  var n = a.volume.header.orientation.orientation;
  var q = a.volume.header.voxelDimensions;
  var t = a.volume.header.origin;
  b = ("-" === n.charAt(3) ? 1 : -1) * (q.flip ? -1 : 1);
  var u = "-" !== n.charAt(4) ? 1 : -1,
    A = "-" !== n.charAt(5) ? 1 : -1,
    G = n.indexOf("X"),
    O = n.indexOf("Y");
  n = n.indexOf("Z");
  var H = b * t.x * q.xSize,
    P = u * t.y * q.ySize,
    U = A * t.z * q.zSize;
  if (a.ascii)
    for (; g < h; )
      for (t = a.getNextLine().trim().split(" "), q = 0; q < t.length; q += 1)
        (d[e] = parseFloat(t[q])),
          2 === e &&
            ((a.pointData[g++] = d[G] * b - H),
            (a.pointData[g++] = d[O] * u - P),
            (a.pointData[g++] = d[n] * A - U)),
          e++,
          (e %= 3);
  else
    for (q = 0; q < h; q += 1, a.index += 4)
      (d[e] = a.dv.getFloat32(a.index, !1)),
        2 === e &&
          ((a.pointData[g++] = d[G] * b - H),
          (a.pointData[g++] = d[O] * u - P),
          (a.pointData[g++] = d[n] * A - U)),
        e++,
        (e %= 3);
  a.readNextData(a, c);
};
papaya.surface.SurfaceVTK.prototype.readDataNormals = function (a, b) {
  var c,
    e = 0,
    d = 3 * a.numPoints;
  a.normalsData = new Float32Array(d);
  if (a.ascii)
    for (; e < d; ) {
      var g = a.getNextLine().trim().split(" ");
      for (c = 0; c < g.length; c += 1) a.normalsData[e++] = parseFloat(g[c]);
    }
  else
    for (c = 0; c < d; c += 1, a.index += 4)
      a.normalsData[c] = a.dv.getFloat32(a.index, !1);
  a.readNextData(a, b);
};
papaya.surface.SurfaceVTK.prototype.readDataTriangles = function (a, b, c) {
  var e,
    d = 0,
    g = 3 * b;
  a.triangleData = new Uint32Array(g);
  if (a.ascii)
    for (; d < g; )
      for (b = a.getNextLine().trim().split(" "), e = 1; e < b.length; e += 1)
        a.triangleData[d++] = parseInt(b[e], 10);
  else
    for (e = 0; e < b; e += 1, a.index += 16)
      (a.triangleData[3 * e] = a.dv.getUint32(a.index + 4, !1)),
        (a.triangleData[3 * e + 1] = a.dv.getUint32(a.index + 8, !1)),
        (a.triangleData[3 * e + 2] = a.dv.getUint32(a.index + 12, !1));
  a.readNextData(a, c);
};
papaya.surface.SurfaceVTK.prototype.getColorsData = function () {
  return null;
};
papaya.surface.SurfaceVTK.prototype.getNumSurfaces = function () {
  return 1;
};
papaya.surface.SurfaceVTK.prototype.getNumPoints = function () {
  return this.pointData.length / 3;
};
papaya.surface.SurfaceVTK.prototype.getNumTriangles = function () {
  return this.triangleData.length / 3;
};
papaya.surface.SurfaceVTK.prototype.getSolidColor = function () {
  return this.solidColor;
};
papaya.surface.SurfaceVTK.prototype.getPointData = function () {
  return this.pointData;
};
papaya.surface.SurfaceVTK.prototype.getNormalsData = function () {
  return this.normalsData;
};
papaya.surface.SurfaceVTK.prototype.getTriangleData = function () {
  return this.triangleData;
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.Dialog =
  papaya.ui.Dialog ||
  function (a, b, c, e, d, g, h, n) {
    this.container = a;
    this.viewer = a.viewer;
    this.title = b;
    this.modifier = "";
    papaya.utilities.StringUtils.isStringBlank(h) || (this.modifier = h);
    this.id = this.title.replace(/ /g, "_");
    this.content = c;
    this.dataSource = e;
    this.callback = d;
    this.callbackOk = g;
    this.doWrap = n;
    this.scrollBehavior2 = this.scrollBehavior1 = null;
  };
papaya.ui.Dialog.showModalDialog = function (a, b, c) {
  a = document.documentElement;
  var e = window.pageYOffset || a.scrollTop;
  var d = $(window).outerWidth();
  a = $(window).outerHeight();
  var g = $(c).outerWidth();
  var h = $(c).outerHeight();
  d = d / 2 - g / 2 + "px";
  a = e + a / 2 - h / 2 + "px";
  $(c).css({ position: "absolute", zIndex: 100, left: d, top: a });
  b.removeScroll();
  $(c).hide().fadeIn(200);
};
papaya.ui.Dialog.prototype.showDialog = function () {
  var a = "#" + this.id;
  var b = $(a);
  b.remove();
  var c = $("body");
  var e =
    "<div id='" +
    this.id +
    "' class='" +
    PAPAYA_DIALOG_CSS +
    "'><span class='" +
    PAPAYA_DIALOG_TITLE_CSS +
    "'>" +
    this.title +
    "</span>";
  if (this.content) {
    e += "<div class='" + PAPAYA_DIALOG_CONTENT_CSS + "'><table>";
    for (b = 0; b < this.content.items.length; b += 1)
      if (this.content.items[b].spacer)
        e +=
          "<tr><td class='" +
          PAPAYA_DIALOG_CONTENT_LABEL_CSS +
          "'>&nbsp;</td><td class='" +
          PAPAYA_DIALOG_CONTENT_CONTROL_CSS +
          "'>&nbsp;</td></tr>";
      else if (this.content.items[b].readonly)
        e +=
          "<tr><td class='" +
          PAPAYA_DIALOG_CONTENT_LABEL_CSS +
          "'>" +
          this.content.items[b].label +
          "</td><td class='" +
          PAPAYA_DIALOG_CONTENT_CONTROL_CSS +
          "' id='" +
          this.content.items[b].field +
          "'></td></tr>";
      else {
        var d =
          this.content.items[b].disabled &&
          !0 ===
            papaya.utilities.ObjectUtils.bind(
              this.container,
              papaya.utilities.ObjectUtils.dereferenceIn(
                this,
                this.content.items[b].disabled
              )
            )()
            ? "disabled='disabled'"
            : "";
        e +=
          "<tr><td class='" +
          PAPAYA_DIALOG_CONTENT_LABEL_CSS +
          "'>" +
          this.content.items[b].label +
          "</td><td class='" +
          PAPAYA_DIALOG_CONTENT_CONTROL_CSS +
          "'>";
        if (this.content.items[b].options) {
          e += "<select " + d + " id='" + this.content.items[b].field + "'>";
          for (d = 0; d < this.content.items[b].options.length; d += 1)
            e +=
              "<option value='" +
              this.content.items[b].options[d] +
              "'>" +
              papaya.utilities.StringUtils.truncateMiddleString(
                this.content.items[b].options[d].toString(),
                40
              ) +
              "</option>";
          e += "</select>";
        } else
          e += "<input type='text' id='" + this.content.items[b].field + "'/>";
        e += "</td></tr>";
        this.content.items[b].help &&
          (e +=
            "<tr><td colspan='2' class='" +
            PAPAYA_DIALOG_CONTENT_HELP +
            "'>" +
            this.content.items[b].help +
            "</td></tr>");
      }
    e += "</table></div>";
  }
  e +=
    "<div class='" +
    PAPAYA_DIALOG_BUTTON_CSS +
    "'><button type='button' id='" +
    this.id +
    "-Ok'>Ok</button></div></div>";
  c.append('<div class="' + PAPAYA_DIALOG_BACKGROUND + '"></div>');
  c.append(e);
  for (b = 0; b < this.content.items.length; b += 1)
    this.content.items[b].readonly
      ? ((e = this.dataSource[this.content.items[b].field](this.modifier)),
        null !== e
          ? $("#" + this.content.items[b].field).html(e)
          : $("#" + this.content.items[b].field)
              .parent()
              .remove())
      : this.content.items[b].spacer ||
        ((e = $("#" + this.content.items[b].field)),
        e.val(this.dataSource[this.content.items[b].field]),
        e.change(
          papaya.utilities.ObjectUtils.bind(this, this.doAction, [
            this.content.items[b].field,
          ])
        ));
  this.doWrap ||
    $("." + PAPAYA_DIALOG_CONTENT_CSS).addClass(
      PAPAYA_DIALOG_CONTENT_NOWRAP_CSS
    );
  $("#" + this.id + "-Ok").click(
    papaya.utilities.ObjectUtils.bind(this, this.doOk)
  );
  b = $(a);
  c.addClass(PAPAYA_DIALOG_STOPSCROLL);
  papaya.ui.Dialog.showModalDialog(this, this.viewer, b[0]);
};
papaya.ui.Dialog.prototype.doOk = function () {
  var a = $("." + PAPAYA_DIALOG_CSS);
  var b = $("." + PAPAYA_DIALOG_BACKGROUND);
  a.hide(100);
  b.hide(100);
  a.remove();
  b.remove();
  window.onmousewheel = this.scrollBehavior1;
  document.onmousewheel = this.scrollBehavior2;
  this.callbackOk && this.callbackOk();
  $("body").removeClass(PAPAYA_DIALOG_STOPSCROLL);
  this.container.viewer.addScroll();
};
papaya.ui.Dialog.prototype.doAction = function (a) {
  this.callback(a, $("#" + a).val());
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.Menu =
  papaya.ui.Menu ||
  function (a, b, c, e, d) {
    this.viewer = a;
    this.method = b.method;
    this.isTitleBar = b.titleBar;
    this.label = b.label;
    this.icons = b.icons;
    this.callback = c;
    this.dataSource = e;
    this.items = [];
    this.rangeItem = null;
    this.menuOnHover = b.menuOnHover;
    this.contextMenu = !1;
    void 0 === d || null === d
      ? ((this.imageIndex = -1),
        (this.modifier = this.viewer.container.containerIndex))
      : ((this.imageIndex = d),
        (this.modifier = d + this.viewer.container.containerIndex));
    this.buttonId =
      this.label.replace(/ /g, "_").replace("...", "_") + (this.modifier || "");
    this.menuId =
      (this.label + "Menu").replace(/ /g, "_").replace("...", "_") +
      (this.modifier || "");
    this.isRight = null !== b.icons;
    this.isImageButton = b.imageButton;
    this.isSurfaceButton = b.surfaceButton;
    this.htmlParent =
      this.viewer.container.showControlBar &&
      this.viewer.container.kioskMode &&
      this.viewer.container.showImageButtons
        ? this.viewer.container.sliderControlHtml
        : this.viewer.container.toolbarHtml;
  };
papaya.ui.Menu.doShowMenu = function (a, b, c, e) {
  var d = $(b).parent().offset();
  $(a.canvas).offset();
  $(a.container.display.canvas).outerHeight();
  var g = $(b).offset();
  var h = $(b).outerWidth();
  var n = $(c).outerWidth();
  var q = $(c).outerHeight();
  g = g.left - d.left + (e ? -1 * n + h : 0) + "px";
  a =
    a.container.showControlBar &&
    a.container.kioskMode &&
    a.container.showImageButtons
      ? -1 * PAPAYA_SPACING - q + "px"
      : $(b).outerHeight() + (e ? 0 : PAPAYA_SPACING) + "px";
  $(c).css({ position: "absolute", zIndex: 100, left: g, top: a });
  $(c).hide().fadeIn(200);
};
papaya.ui.Menu.getColorComponents = function (a) {
  return a ? a.match(/\d+/g) : [0, 0, 0, 255];
};
papaya.ui.Menu.getNiceForegroundColor = function (a) {
  a = papaya.ui.Menu.getColorComponents(a);
  127 < (parseInt(a[0]) + parseInt(a[1]) + parseInt(a[2])) / 3
    ? (a[0] = a[1] = a[2] = 0)
    : (a[0] = a[1] = a[2] = 255);
  return "rgb(" + a[0] + ", " + a[1] + ", " + a[2] + ")";
};
papaya.ui.Menu.prototype.buildMenuButton = function () {
  var a = "#" + this.buttonId;
  var b = $(a);
  b.remove();
  b = null;
  this.icons
    ? ((b =
        "<span id='" +
        this.buttonId +
        "' class='" +
        PAPAYA_MENU_UNSELECTABLE +
        " " +
        PAPAYA_MENU_ICON_CSS +
        " " +
        (this.isImageButton ? PAPAYA_MENU_BUTTON_CSS : "") +
        "'" +
        (this.isRight ? " style='float:right'" : "") +
        "><img class='" +
        PAPAYA_MENU_UNSELECTABLE +
        "' style='width:" +
        papaya.viewer.ColorTable.ICON_SIZE +
        "px; height:" +
        papaya.viewer.ColorTable.ICON_SIZE +
        "px; vertical-align:bottom; "),
      (b =
        !this.isSurfaceButton &&
        this.dataSource.isSelected(parseInt(this.imageIndex, 10))
          ? b + "border:2px solid #FF5A3D;background-color:#eeeeee;padding:1px;"
          : b +
            "border:2px outset lightgray;background-color:#eeeeee;padding:1px;"),
      (b = this.method
        ? b +
          ("' src='" +
            this.icons[
              papaya.utilities.ObjectUtils.bind(
                this.viewer,
                papaya.utilities.ObjectUtils.dereferenceIn(
                  this.viewer,
                  this.method
                )
              )()
                ? 1
                : 0
            ] +
            "' /></span>")
        : b + ("' src='" + this.icons[0] + "' /></span>")))
    : (b = this.isTitleBar
        ? "<div class='" +
          PAPAYA_MENU_UNSELECTABLE +
          " " +
          PAPAYA_MENU_TITLEBAR_CSS +
          " " +
          PAPAYA_TITLEBAR_CSS +
          "' style='z-index:-1;position:absolute;top:0px;width:" +
          this.htmlParent.width() +
          "px;text-align:center;color:" +
          papaya.ui.Menu.getNiceForegroundColor(this.viewer.bgColor) +
          "'>" +
          this.label +
          "</div>"
        : "<span id='" +
          this.buttonId +
          "' class='" +
          PAPAYA_MENU_UNSELECTABLE +
          " " +
          PAPAYA_MENU_LABEL_CSS +
          "'>" +
          this.label +
          "</span>");
  this.htmlParent.append(b);
  if (!this.isTitleBar) {
    b = $(a);
    a = "#" + this.buttonId + " > img";
    a = $(a);
    var c = this;
    this.menuOnHover &&
      (a.mouseenter(function () {
        c.showHoverMenuTimeout = setTimeout(
          papaya.utilities.ObjectUtils.bind(c, c.showMenu),
          500
        );
      }),
      a.mouseleave(function () {
        clearTimeout(c.showHoverMenuTimeout);
        c.showHoverMenuTimeout = null;
      }));
    b.click(papaya.utilities.ObjectUtils.bind(this, this.doClick));
    this.icons
      ? (a.hover(
          function () {
            1 < c.icons.length
              ? $(this).css({ "border-color": "gray" })
              : $(this).css({ "border-color": "#FF5A3D" });
          },
          papaya.utilities.ObjectUtils.bind(c, function () {
            c.dataSource.isSelected(parseInt(c.imageIndex, 10)) &&
            c.dataSource.isSelectable()
              ? $("#" + c.buttonId + " > img").css({
                  border: "2px solid #FF5A3D",
                })
              : $("#" + c.buttonId + " > img").css({
                  border: "2px outset lightgray",
                });
          })
        ),
        a.mousedown(function () {
          $(this).css({ border: "2px inset lightgray" });
        }),
        a.mouseup(function () {
          $(this).css({ border: "2px outset lightgray" });
        }))
      : this.isTitleBar ||
        b.hover(function () {
          $(this).toggleClass(PAPAYA_MENU_BUTTON_HOVERING_CSS);
        });
  }
  return this.buttonId;
};
papaya.ui.Menu.prototype.setMenuButton = function (a) {
  this.buttonId = a;
};
papaya.ui.Menu.prototype.buildMenu = function () {
  var a;
  this.htmlParent.append(
    "<ul id='" + this.menuId + "' class='" + PAPAYA_MENU_CSS + "'></ul>"
  );
  this.viewer.container.contextManager &&
    papaya.utilities.PlatformUtils.smallScreen &&
    ($("#" + this.menuId)[0].style.width = this.viewer.viewerDim - 10 + "px");
  for (a = 0; a < this.items.length; a += 1)
    this.items[a].hide || this.items[a].buildHTML(this.menuId);
};
papaya.ui.Menu.prototype.addMenuItem = function (a) {
  a instanceof papaya.ui.MenuItemRange && (this.rangeItem = a);
  this.items.push(a);
};
papaya.ui.Menu.prototype.showContextMenu = function () {
  var a = 0;
  if (0 < this.items.length) {
    var b = "#" + this.menuId;
    var c = $(b);
    var e = c.is(":visible");
    c.remove();
    if (!e) {
      this.htmlParent = this.viewer.container.viewerHtml;
      this.buildMenu();
      c = $(b);
      c.hide();
      e = c.outerHeight();
      b = $(this.viewer.canvas).offset();
      var d = $(this.viewer.container.display.canvas).outerHeight();
      this.viewer.contextMenuMousePositionY + e >
        b.top + d + $(this.viewer.canvas).outerHeight() + PAPAYA_SPACING &&
        (a =
          this.viewer.contextMenuMousePositionY +
          e -
          (b.top + d + $(this.viewer.canvas).outerHeight() + PAPAYA_SPACING) -
          1);
      this.viewer.container.contextManager &&
      papaya.utilities.PlatformUtils.smallScreen
        ? c.css({
            position: "absolute",
            zIndex: 100,
            left: this.viewer.canvasRect.left,
            top: this.viewer.canvasRect.top - a,
          })
        : c.css({
            position: "absolute",
            zIndex: 100,
            left:
              this.viewer.contextMenuMousePositionX +
              this.viewer.canvasRect.left,
            top:
              this.viewer.contextMenuMousePositionY +
              this.viewer.canvasRect.top -
              a,
          });
      c.hide().fadeIn(200);
    }
  }
};
papaya.ui.Menu.prototype.showMenu = function () {
  this.viewer.container.toolbar.closeAllMenus();
  if (this.contextMenu) this.showContextMenu();
  else if (0 < this.items.length) {
    var a = "#" + this.menuId;
    var b = $(a);
    var c = b.is(":visible");
    b.remove();
    c ||
      ((c = $("#" + this.buttonId)),
      this.buildMenu(),
      (b = $(a)),
      b.hide(),
      papaya.ui.Menu.doShowMenu(this.viewer, c[0], b[0], this.isRight));
  }
};
papaya.ui.Menu.prototype.doClick = function () {
  var a = $("#" + this.menuId).is(":visible");
  this.callback(this.buttonId);
  this.icons &&
    (this.method
      ? $("#" + this.buttonId + " > img").attr(
          "src",
          this.icons[
            papaya.utilities.ObjectUtils.bind(
              this.viewer,
              papaya.utilities.ObjectUtils.dereferenceIn(
                this.viewer,
                this.method
              )
            )()
              ? 1
              : 0
          ]
        )
      : $("#" + this.buttonId + " > img").attr("src", this.icons[0]));
  this.menuOnHover || a || this.showMenu();
};
papaya.ui.Menu.prototype.updateRangeItem = function (a, b) {
  this.rangeItem &&
    ($("#" + this.rangeItem.minId).val(a),
    $("#" + this.rangeItem.maxId).val(b));
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.MenuItem =
  papaya.ui.MenuItem ||
  function (a, b, c, e, d, g, h) {
    this.viewer = a;
    this.modifier = "";
    papaya.utilities.StringUtils.isStringBlank(h) || (this.modifier = "-" + h);
    this.dataSource = d;
    this.method = g;
    this.label =
      this.dataSource && this.method ? this.dataSource[this.method]() : b;
    this.action = c + this.modifier;
    this.id =
      this.action.replace(/ /g, "_") + this.viewer.container.containerIndex;
    this.callback = e;
    this.menu = null;
    this.isContext = !1;
  };
papaya.ui.MenuItem.prototype.buildHTML = function (a) {
  var b =
    this.dataSource && this.method
      ? this.dataSource[this.method]()
      : this.label;
  b =
    "<li id='" +
    this.id +
    "'><span class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "'>" +
    b +
    "</span>" +
    (this.menu ? "<span style='float:right'>&nbsp;&#x25B6;</span>" : "") +
    "</li>";
  $("#" + a).append(b);
  a = $("#" + this.id);
  this.viewer.container.contextManager &&
    papaya.utilities.PlatformUtils.smallScreen &&
    ((a[0].style.width = this.viewer.viewerDim - 10 + "px"),
    (a[0].style.fontSize = "18px"));
  a.click(
    papaya.utilities.ObjectUtils.bind(this, function (c) {
      this.doAction(this.isContext && c.shiftKey);
    })
  );
  a.hover(function () {
    $(this).toggleClass(PAPAYA_MENU_HOVERING_CSS);
  });
};
papaya.ui.MenuItem.prototype.doAction = function (a) {
  a || this.menu || (this.viewer.showingContextMenu = !1);
  this.callback(this.action, null, a);
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.MenuItemCheckBox =
  papaya.ui.MenuItemCheckBox ||
  function (a, b, c, e, d, g, h) {
    this.viewer = a;
    this.label = b;
    this.modifier = "";
    void 0 !== h && null !== h && (this.modifier = "-" + h);
    this.action = c + this.modifier;
    this.method = g;
    this.id =
      this.action.replace(/ /g, "_").replace(/\(/g, "").replace(/\)/g, "") +
      this.viewer.container.containerIndex;
    this.callback = e;
    this.dataSource = d;
  };
papaya.ui.MenuItemCheckBox.prototype.buildHTML = function (a) {
  var b = this.dataSource[this.method](this.label);
  var c = "";
  b && (c = "checked='checked'");
  b =
    "<li id='" +
    this.id +
    "'><input type='checkbox' class='" +
    PAPAYA_MENU_COLORTABLE_CSS +
    "' name='" +
    PAPAYA_MENU_COLORTABLE_CSS +
    "' id='" +
    this.id +
    "' value='" +
    this.id +
    "' " +
    c +
    "><span class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "'>&nbsp;" +
    this.label +
    "</span></li>";
  $("#" + a).append(b);
  a = $("#" + this.id);
  a.click(papaya.utilities.ObjectUtils.bind(this, this.doAction));
  a.hover(function () {
    $(this).toggleClass(PAPAYA_MENU_HOVERING_CSS);
  });
};
papaya.ui.MenuItemCheckBox.prototype.doAction = function () {
  $("." + PAPAYA_MENU_COLORTABLE_CSS).removeAttr("checked");
  $("#" + this.id + " > input")[0].checked = !0;
  this.callback(this.action, null, !0);
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.MenuItemRadioButton =
  papaya.ui.MenuItemRadioButton ||
  function (a, b, c, e, d, g, h) {
    this.viewer = a;
    this.label = b;
    this.modifier = "";
    void 0 !== h && null !== h && (this.modifier = "-" + h);
    this.methodParam = this.action = c + this.modifier;
    this.method = g;
    this.id =
      this.action.replace(/ /g, "_").replace(/\(/g, "").replace(/\)/g, "") +
      this.viewer.container.containerIndex;
    this.callback = e;
    this.dataSource = d;
  };
papaya.ui.MenuItemRadioButton.prototype.buildHTML = function (a) {
  var b = this.dataSource[this.method](this.label);
  var c = "";
  b && (c = "checked='checked'");
  b =
    "<li id='" +
    this.id +
    "'><input type='radio' class='" +
    PAPAYA_MENU_COLORTABLE_CSS +
    "' name='" +
    PAPAYA_MENU_COLORTABLE_CSS +
    "' id='" +
    this.id +
    "' value='" +
    this.id +
    "' " +
    c +
    "><span class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "'>&nbsp;" +
    this.label +
    "</span></li>";
  $("#" + a).append(b);
  a = $("#" + this.id);
  a.click(papaya.utilities.ObjectUtils.bind(this, this.doAction));
  a.hover(function () {
    $(this).toggleClass(PAPAYA_MENU_HOVERING_CSS);
  });
};
papaya.ui.MenuItemRadioButton.prototype.doAction = function () {
  $("." + PAPAYA_MENU_COLORTABLE_CSS).removeAttr("checked");
  $("#" + this.id + " > input")[0].checked = !0;
  this.callback(this.action, null, !0);
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.MenuItemFileChooser =
  papaya.ui.MenuItemFileChooser ||
  function (a, b, c, e, d, g) {
    this.viewer = a;
    this.label = b;
    this.modifier = "";
    void 0 !== g && null !== g && (this.modifier = "-" + g);
    this.action = c + this.modifier;
    this.id =
      this.action.replace(/ /g, "_") + this.viewer.container.containerIndex;
    this.fileChooserId =
      "fileChooser" +
      this.label.replace(/ /g, "_").replace(/\./g, "") +
      this.viewer.container.containerIndex +
      (d ? "folder" : "");
    this.callback = e;
    this.folder = d;
  };
papaya.ui.MenuItemFileChooser.prototype.buildHTML = function (a) {
  var b = this;
  var c =
    "<li id='" +
    this.id +
    "'><span class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "'><label class='" +
    PAPAYA_MENU_FILECHOOSER +
    "' for='" +
    this.fileChooserId +
    "'>" +
    this.label;
  c = this.folder
    ? c +
      ("</label><input type='file' id='" +
        this.fileChooserId +
        "' multiple='multiple' webkitdirectory directory name='files' /></span></li>")
    : c +
      ("</label><input type='file' id='" +
        this.fileChooserId +
        "' multiple='multiple' name='files' /></span></li>");
  $("#" + a).append(c);
  $("#" + this.fileChooserId)[0].onchange = papaya.utilities.ObjectUtils.bind(
    b,
    function () {
      b.callback(b.action, document.getElementById(b.fileChooserId).files);
    }
  );
  $("#" + this.id).hover(function () {
    $(this).toggleClass(PAPAYA_MENU_HOVERING_CSS);
  });
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.MenuItemRange =
  papaya.ui.MenuItemRange ||
  function (a, b, c, e, d, g, h) {
    "ChangeRangeNeg" === c &&
      ((this.negatives = !0),
      (h = a
        .getScreenVolumeIndex(a.screenVolumes[parseInt(h)].negativeScreenVol)
        .toString()));
    this.viewer = a;
    this.label = b;
    this.index = h;
    this.modifier = "";
    void 0 !== h && (this.modifier = "-" + h);
    this.action = c + this.modifier;
    this.minId =
      this.action.replace(/ /g, "_") +
      "Min" +
      this.viewer.container.containerIndex;
    this.maxId =
      this.action.replace(/ /g, "_") +
      "Max" +
      this.viewer.container.containerIndex;
    this.callback = e;
    this.dataSource = d;
    this.method = g;
    this.id = b + this.modifier + this.viewer.container.containerIndex;
    this.grabOffset = 0;
    this.screenVol = this.viewer.screenVolumes[this.index];
  };
papaya.ui.MenuItemRange.getRelativeMousePositionFromParentX = function (a, b) {
  a = a.parent().offset();
  return papaya.utilities.PlatformUtils.getMousePositionX(b) - a.left;
};
papaya.ui.MenuItemRange.getRelativeMousePositionX = function (a, b) {
  a = a.offset();
  return papaya.utilities.PlatformUtils.getMousePositionX(b) - a.left;
};
papaya.ui.MenuItemRange.prototype.buildHTML = function (a) {
  var b = this.id + "SliderMin";
  var c = this.id + "SliderMax";
  var e = this.id + "Slider";
  var d = this.dataSource[this.method]();
  var g = this;
  d =
    "<li id='" +
    this.id +
    "'><span class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "' style=''><input class='" +
    PAPAYA_MENU_INPUT_FIELD +
    "' type='text' size='4' id='" +
    this.minId +
    "' value='" +
    d[0].toPrecision(4) +
    "' /><div style='display:inline-block;position:relative;width:" +
    (papaya.viewer.ColorTable.COLOR_BAR_WIDTH +
      papaya.viewer.ColorTable.ARROW_ICON_WIDTH) +
    "px;top:-12px;'><img id='" +
    b +
    "' class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "' style='position:absolute;top:5px;left:" +
    (g.screenVol.colorTable.minLUT / papaya.viewer.ColorTable.LUT_MAX) *
      (papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1) +
    "px;z-index:99' src='" +
    papaya.viewer.ColorTable.ARROW_ICON +
    "' /><img id='" +
    c +
    "' class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "' style='position:absolute;top:5px;left:" +
    (g.screenVol.colorTable.maxLUT / papaya.viewer.ColorTable.LUT_MAX) *
      (papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1) +
    "px;z-index:99' src='" +
    papaya.viewer.ColorTable.ARROW_ICON +
    "' /><img id='" +
    e +
    "' class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "' style='position:absolute;top:0;left:" +
    parseInt(papaya.viewer.ColorTable.ARROW_ICON_WIDTH / 2, 10) +
    "px;' src='" +
    this.viewer.screenVolumes[parseInt(this.index, 10)].colorBar +
    "' /></div><input class='" +
    PAPAYA_MENU_INPUT_FIELD +
    "' type='text' size='4' id='" +
    this.maxId +
    "' value='" +
    d[1].toPrecision(4) +
    "' /></span></li>";
  $("#" + a).append(d);
  var h = $("#" + this.minId);
  a = $("#" + this.maxId);
  var n = $("#" + b);
  var q = $("#" + c);
  var t = $("#" + e);
  papaya.utilities.PlatformUtils.ios &&
    ((h[0].style.width = "35px"),
    (h[0].style.marginRight = "4px"),
    (a[0].style.width = "35px"),
    (a[0].style.marginRight = "4px"));
  n.bind(
    papaya.utilities.PlatformUtils.ios ? "touchstart" : "mousedown",
    function (u) {
      g.grabOffset = papaya.ui.MenuItemRange.getRelativeMousePositionX(n, u);
      $(window).bind(
        papaya.utilities.PlatformUtils.ios ? "touchmove" : "mousemove",
        function (A) {
          var G =
            (g.screenVol.colorTable.maxLUT / papaya.viewer.ColorTable.LUT_MAX) *
            (papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1);
          A =
            papaya.ui.MenuItemRange.getRelativeMousePositionFromParentX(n, A) -
            g.grabOffset;
          0 > A
            ? (A = 0)
            : A >= papaya.viewer.ColorTable.COLOR_BAR_WIDTH
            ? (A = papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1)
            : A > G && (A = G);
          g.screenVol.updateMinLUT(
            Math.round(
              (A / (papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1)) *
                papaya.viewer.ColorTable.LUT_MAX
            )
          );
          n.css({ left: A + "px" });
          g.viewer.drawViewer(!1, !0);
          g.screenVol.updateColorBar();
          t.attr("src", g.screenVol.colorBar);
        }
      );
      return !1;
    }
  );
  q.bind(
    papaya.utilities.PlatformUtils.ios ? "touchstart" : "mousedown",
    function (u) {
      g.grabOffset = papaya.ui.MenuItemRange.getRelativeMousePositionX(q, u);
      $(window).bind(
        papaya.utilities.PlatformUtils.ios ? "touchmove" : "mousemove",
        function (A) {
          var G =
            (g.screenVol.colorTable.minLUT / papaya.viewer.ColorTable.LUT_MAX) *
            (papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1);
          A =
            papaya.ui.MenuItemRange.getRelativeMousePositionFromParentX(q, A) -
            g.grabOffset;
          0 > A
            ? (A = 0)
            : A >= papaya.viewer.ColorTable.COLOR_BAR_WIDTH
            ? (A = papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1)
            : A < G && (A = G);
          g.screenVol.updateMaxLUT(
            Math.round(
              (A / (papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1)) *
                papaya.viewer.ColorTable.LUT_MAX
            )
          );
          q.css({ left: A + "px" });
          g.viewer.drawViewer(!1, !0);
          g.screenVol.updateColorBar();
          t.attr("src", g.screenVol.colorBar);
        }
      );
      return !1;
    }
  );
  $(window).bind(
    papaya.utilities.PlatformUtils.ios ? "touchend" : "mouseup",
    function () {
      $(window).unbind(
        papaya.utilities.PlatformUtils.ios ? "touchmove" : "mousemove"
      );
    }
  );
  $("#" + this.id).hover(function () {
    $(this).toggleClass(PAPAYA_MENU_HOVERING_CSS);
  });
  h.change(
    papaya.utilities.ObjectUtils.bind(this, function () {
      g.rangeChanged(!0);
    })
  );
  a.change(
    papaya.utilities.ObjectUtils.bind(this, function () {
      g.rangeChanged(!1);
    })
  );
  h.keyup(
    papaya.utilities.ObjectUtils.bind(this, function (u) {
      13 === u.keyCode &&
        (g.rangeChanged(!1), g.viewer.container.toolbar.closeAllMenus());
    })
  );
  a.keyup(
    papaya.utilities.ObjectUtils.bind(this, function (u) {
      13 === u.keyCode &&
        (g.rangeChanged(!1), g.viewer.container.toolbar.closeAllMenus());
    })
  );
  papaya.utilities.PlatformUtils.ios ||
    setTimeout(function () {
      h.focus();
      h.select();
    }, 10);
};
papaya.ui.MenuItemRange.prototype.rangeChanged = function (a) {
  this.updateDataSource(a);
  this.viewer.drawViewer(!0);
  this.resetSlider();
};
papaya.ui.MenuItemRange.prototype.updateDataSource = function (a) {
  var b = $("#" + this.minId);
  var c = $("#" + this.maxId);
  var e = parseFloat(b.val());
  isNaN(e) && (e = this.dataSource.screenMin);
  var d = parseFloat(c.val());
  isNaN(d) && (d = this.dataSource.screenMax);
  b.val(e.toPrecision(4));
  c.val(d.toPrecision(4));
  this.negatives
    ? this.dataSource.setScreenRangeNegatives(e, d)
    : this.dataSource.setScreenRange(e, d);
  a && (c.focus(), c.select());
};
papaya.ui.MenuItemRange.prototype.resetSlider = function () {
  var a = this.id + "SliderMin";
  var b = this.id + "SliderMax";
  var c = this.id + "Slider";
  a = $("#" + a);
  b = $("#" + b);
  c = $("#" + c);
  a.css({ left: 0 });
  b.css({ left: papaya.viewer.ColorTable.COLOR_BAR_WIDTH - 1 + "px" });
  this.screenVol.resetDynamicRange();
  c.attr("src", this.screenVol.colorBar);
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.MenuItemSlider =
  papaya.ui.MenuItemSlider ||
  function (a, b, c, e, d, g, h) {
    "alphaneg" === c &&
      ((c = "alpha"),
      (h = a
        .getScreenVolumeIndex(a.screenVolumes[parseInt(h)].negativeScreenVol)
        .toString()));
    this.viewer = a;
    this.label = b;
    this.index = h;
    this.modifier = "";
    papaya.utilities.StringUtils.isStringBlank(h) || (this.modifier = "-" + h);
    this.dataSource = d;
    this.method = g;
    this.action = c;
    this.event =
      -1 != this.action.toLowerCase().indexOf("alpha") ||
      this.viewer.screenVolumes[0].isHighResSlice
        ? "change"
        : "input change";
    this.id =
      this.action.replace(/ /g, "_") +
      this.viewer.container.containerIndex +
      "_" +
      this.index;
    this.callback = e;
    this.screenVol = d;
  };
papaya.ui.MenuItemSlider.prototype.buildHTML = function (a) {
  var b = this.event;
  var c = this.id + "Slider";
  var e =
    "<li id='" +
    this.id +
    "'><span style='padding-right:5px;' class='" +
    PAPAYA_MENU_UNSELECTABLE +
    "'>" +
    this.label +
    ":</span><input min='0' max='100' value='" +
    parseInt(100 * (1 - this.screenVol[this.action]), 10) +
    "' id='" +
    c +
    "' class='" +
    PAPAYA_MENU_SLIDER +
    "' type='range' /></li>";
  $("#" + a).append(e);
  $("#" + this.id).hover(function () {
    $(this).toggleClass(PAPAYA_MENU_HOVERING_CSS);
  });
  var d = $("#" + c);
  var g = this;
  $("#" + this.id + "Slider").on(b, function () {
    g.screenVol[g.action] = 1 - d.val() / 100;
    g.doAction();
    g.viewer.drawViewer(!0, !1);
  });
};
papaya.ui.MenuItemSlider.prototype.doAction = function () {
  this.callback(this.action, null, !0);
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papaya.ui.MenuItemSpacer = papaya.ui.MenuItemSpacer || function () {};
papaya.ui.MenuItemSpacer.prototype.buildHTML = function (a) {
  var b =
    "<div class='" +
    PAPAYA_MENU_SPACER_CSS +
    " " +
    PAPAYA_MENU_UNSELECTABLE +
    "'></div>";
  $("#" + a).append(b);
};
("use strict");
papaya = papaya || {};
papaya.ui = papaya.ui || {};
papayaLoadableImages = papayaLoadableImages || [];
papaya.ui.Toolbar =
  papaya.ui.Toolbar ||
  function (a) {
    this.container = a;
    this.viewer = a.viewer;
    this.spaceMenu = this.surfaceMenus = this.imageMenus = null;
  };
papaya.ui.Toolbar.SIZE = 22;
papaya.ui.Toolbar.ICON_IMAGESPACE =
  "data:image/gif;base64,R0lGODlhFAAUAPcAMf//////GP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2f/ZNbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1tbW1qWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpVpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAACoALAAAAAAUABQAAAipAFUIHEiwoMB/A1coXLiwisOHVf4hVLFCosWLGC9SzMgR48Z/VEJSUVjFj0mTESdWBCmS5EmU/6oIXCly5IqSLx/OlFjT5Us/DneybIkzp8yPDElChCjwj8Q/UKOqmkqVatOnUaGqmsaVq1UVTv+lGjv2z9SuXlVdFUs2ldmtaKeubev2bFy1YCXSfYt2mty8/6CS5XtXRcasVRMftJj1beK/hicanKwiIAA7";
papaya.ui.Toolbar.ICON_WORLDSPACE =
  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAplJREFUeNqM1H1ozVEcx/Hr3p+7O08jQzbzMErznEItK0+Fv0Ye/tki20ia//wn+YMSaXkoEiKkkCVKZhOipsnDstnFagzlrmGMNfeO6/Nd71unu2s59bq7O517ft/z/X7Pz+dLPUbLJrkqX+SbdEubfJZK2cC6PiOQYm61HJcpkintEpcmCcpryZV5spaHhvvbdJ9slsPyU67wgPlEli0X5aiMkMeyXSbKnVRRVxDRRtkm5czbZrv5vkgu8z1P9stWfleRHGkhT3xCLu1YzZIjpfKWnA6VEn43mwcWEaWlo1Ve2YZj5Jms53iP5BjFsFz9lg/yDj0U7JbslFpZQyBP2a83khoiLiWPA/h/OVGOk+GwnJ5y1iyRS5Im1VLm18cKOc+CYrlGjnxUuZPIOlAn0yWdNXdlrMyRE7LM00eBjBT7niFVTvHsKJ8k6sw1yC4ZIl0EUMOcRT/X44v14xEZSBWfk+d8NpzKujgPGiYrOXI+XTGeGtjpewtjm16Qh3JT3sgvickfNo4yF6V4PVyE2wQUZvP7FmmIa/iDIpwkHRPkrC2iEIlhEZ2mtarIsz3sOoX0PPrP7nAWPRYjj51E85JiJEYO0VsfR5hL5wZal3T7aZl10kLiEyNEHtOSbt4g/gaduRjzC+S9RwtZ332XBxQpzGZ+p72SR5BumUYHLaaDSiySUXKPig6Wj+SmjX5s4BQB0pFBQVo4dhenspfKC1kaYLKVa9pOAW5Q2Ww2qeU92kHbzZRDvK2sBSfLDLtNUp/82rOj7nDm9tJi7lhoeWNzG7Pkqxz8R5p8ByhcGVd0CzkOOWv28KBJvNGa+V2/Y5U08vQm8mgvmTNyjpxHSFUj6/9rZPKerGSTuCPCi7qIdX3GXwEGAPFYt+/OgAXDAAAAAElFTkSuQmCC";
papaya.ui.Toolbar.ICON_EXPAND =
  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAE00lEQVR42u2djW3UQBCFJx3QAemAdJBQAVABTgekAqCC0EGOCoAKWDqADkIHKQGPfKdEh3Nr7493Z977pJWQwtk7+77ETs6zdyYEmrPWEyBtoQDgUABwKAA4FAAcCgAOBQCHAoBDAcChAOBQAHAoADgUABwKAE6uALfjuGg094dx7Mbxo9H5D7wZxzCOF43O/3scN6kvzhXg5ziuGhV+4K20k0DD/964/jCO16kv9iCABvCu0bm/ySRgS4KAC7Abx3Wjc9/J9OO/JUGABXjYn/9Po/O/kimAVtd/EQMC6E1Krevkbhx/Kx17KSpBrcuAHjd2kx2kcwGUYRxfy60LBO9lEjxGEAMCKINQgqUsDV8JYkQAZRBKEGNN+EqQzgTQa/6p69YglOA5YuHPrW2QzgT4NI77SCGDUIJjYuEP4ziXaX2fEqRDAT4vLIgSTCxdq49iSIA1hSGzZo3MCbC2QDTWro1JAVIKRSBlTcwKkFqwV1LXwrQAOYV7ImcNzAuQuwDWya3dhQAlFsIiJWp2I0CpBbFCqVpdCVByYXqmZI3uBCi9QL1RujaXAigeJahRk1sBFE8S1KrFtQCKBwlq1uBeAMWyBLXnDiGAYlGCLeYMI4BiSYKt5golgGJBgi3nCCeA0rMEW88NUgClRwlazKk7AeaaI3WCpQVQepKg1VzmBMhqjs0V4Lg9unavXg8StJzDS5keDX/ai5jVHl9ih5DDBgka/hep36jZMoAeBNRexA8ySaBzydobweoWMS2C6CH84lgVQNkyEJfhK5YFULYIxm34inUBlFhA55K+h8DcTddTBjEcvuJBAOWUBIOkh3Qp0+/ZpY/bDV4EUJ6T4GocvxKP+ZwAgzgIX/EkgKIS6K+ihx/ZQTL+Srbn+K+dgzgJX/EmgKLX7fP9v1O/84+53B8zSPs9iYriUQCyAgoADgUAhwKAQwHAoQDgUABwKAA4FAAcCgAOBQCHAoBDAcChAOB4FEDfDr6Sacfykm8Hy/6YfDu4Y46fCgpS9oEQ7X3QZ/L5QEiH8JGwBLwIcOqh0CtJF6DWw6bd4EGAUyHpj2z9iJWcx8LvT3x9EOMSWBeAjSGZWBaArWEFsCoAm0MLwfZwO+c+0FV7+NwGETk3XTF6CKDlHOY+rLrpBhHcImbbuXS3RQw3idp2Tt1tEsVt4rhNHDeK3HCOUAJYCH/rucIIYCn8LecMIYDF8Leau3sBLIe/RQ2uBfAQfu1a3ArgKfyaNbkUwGP4tWpzJ4Dn8GvU6EoAhPBL1+pGAKTwS9bsQgDE8EvVbl4A5PBLrIFpARj+I6lrYVYAhv8/KWtiUgCG/zxr18acAAw/zpo1MiUAw1/O0rUyI8D9woLII0skOBcDAuhHrFxECmH488QkmFvbIJ0JcIpBGH6MmATHBDEiwCAMfylrJAhiQIBBGP5alkoQpHMB9Lr1PX6oJPS4tXsRY+geAkOlY2vX1UXk/wTpXICa1P6w6hhzvXpbo+eHFUDZjeO60bnvpN53/1KCgAuQ1RyZyVxz7NYEARcgqz06k+P2+BYEaSjArcRvUmqh1/+dtAv/wGGDjFb3AXqTfZP6YqtbxJBCUABwKAA4FAAcCgAOBQCHAoBDAcChAOBQAHAoADgUABwKAA4FAIcCgPMPvdAfn3qMP2kAAAAASUVORK5CYII=";
papaya.ui.Toolbar.ICON_COLLAPSE =
  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAEJGlDQ1BJQ0MgUHJvZmlsZQAAOBGFVd9v21QUPolvUqQWPyBYR4eKxa9VU1u5GxqtxgZJk6XtShal6dgqJOQ6N4mpGwfb6baqT3uBNwb8AUDZAw9IPCENBmJ72fbAtElThyqqSUh76MQPISbtBVXhu3ZiJ1PEXPX6yznfOec7517bRD1fabWaGVWIlquunc8klZOnFpSeTYrSs9RLA9Sr6U4tkcvNEi7BFffO6+EdigjL7ZHu/k72I796i9zRiSJPwG4VHX0Z+AxRzNRrtksUvwf7+Gm3BtzzHPDTNgQCqwKXfZwSeNHHJz1OIT8JjtAq6xWtCLwGPLzYZi+3YV8DGMiT4VVuG7oiZpGzrZJhcs/hL49xtzH/Dy6bdfTsXYNY+5yluWO4D4neK/ZUvok/17X0HPBLsF+vuUlhfwX4j/rSfAJ4H1H0qZJ9dN7nR19frRTeBt4Fe9FwpwtN+2p1MXscGLHR9SXrmMgjONd1ZxKzpBeA71b4tNhj6JGoyFNp4GHgwUp9qplfmnFW5oTdy7NamcwCI49kv6fN5IAHgD+0rbyoBc3SOjczohbyS1drbq6pQdqumllRC/0ymTtej8gpbbuVwpQfyw66dqEZyxZKxtHpJn+tZnpnEdrYBbueF9qQn93S7HQGGHnYP7w6L+YGHNtd1FJitqPAR+hERCNOFi1i1alKO6RQnjKUxL1GNjwlMsiEhcPLYTEiT9ISbN15OY/jx4SMshe9LaJRpTvHr3C/ybFYP1PZAfwfYrPsMBtnE6SwN9ib7AhLwTrBDgUKcm06FSrTfSj187xPdVQWOk5Q8vxAfSiIUc7Z7xr6zY/+hpqwSyv0I0/QMTRb7RMgBxNodTfSPqdraz/sDjzKBrv4zu2+a2t0/HHzjd2Lbcc2sG7GtsL42K+xLfxtUgI7YHqKlqHK8HbCCXgjHT1cAdMlDetv4FnQ2lLasaOl6vmB0CMmwT/IPszSueHQqv6i/qluqF+oF9TfO2qEGTumJH0qfSv9KH0nfS/9TIp0Wboi/SRdlb6RLgU5u++9nyXYe69fYRPdil1o1WufNSdTTsp75BfllPy8/LI8G7AUuV8ek6fkvfDsCfbNDP0dvRh0CrNqTbV7LfEEGDQPJQadBtfGVMWEq3QWWdufk6ZSNsjG2PQjp3ZcnOWWing6noonSInvi0/Ex+IzAreevPhe+CawpgP1/pMTMDo64G0sTCXIM+KdOnFWRfQKdJvQzV1+Bt8OokmrdtY2yhVX2a+qrykJfMq4Ml3VR4cVzTQVz+UoNne4vcKLoyS+gyKO6EHe+75Fdt0Mbe5bRIf/wjvrVmhbqBN97RD1vxrahvBOfOYzoosH9bq94uejSOQGkVM6sN/7HelL4t10t9F4gPdVzydEOx83Gv+uNxo7XyL/FtFl8z9ZAHF4bBsrEwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAeJJREFUOBG1lU1KA0EQhTP5c5MggkvFvQfQjS4iIcled3qBrDyCHsFsvEBcegBBkEBA0VuIW0UFBX8w4/c6VUMbAhoYG16qquvVm05Nd0+SpmlBI0mSogzxV5iY8Yf6EiWUp6NQasJFWfPL7lucQIzzvoDAn6xxrsRDEXYVrE0S44dM86kJC1GtNKxeDy+ULFDiAbQsrpqtMFeXb3GNuDLBaVmtL6zkZH+qCPegGQm1iftR3CduR3HTanxBY62I4OIiPoGOcoxdMIh4A81ZroMvblgINmiEnBcY0f++Cl6B2rMBzp0n3+aUE8cXEGqdVyaRDSY/FGDP2D4N3B64Bs/Ah/wdsA4acG+U8Fr5GuHtIaItpb1cAW2gv18FEt0HC8CHfM0pVxXXavSSpRG0fMUK1NA5sAeWwSfQ6i7AEPhwf4mJAyDBO3AJVBO0dNLw8x+hFfnLsj0kSlt0+kbYOuExiFuhng7JH2LFld0Ej2AeeCu6cF5cy3vs/XiDeAIWwS3Q298G8ZDoFuiBI7ACdKjegcZYSz2eBgjap1dAxafOkW9zyoUj7LnY/hCFmNsByYQRzf9IR6L5XUKI/uXarHn/4Gvn/H5tQvqfi14rcXHzs6vPYh3RmT9N2ZHWxkYgt4/pN/LAOfka/AG9AAAAAElFTkSuQmCC";
papaya.ui.Toolbar.FILE_MENU_DATA = {
  label: "File",
  icons: null,
  items: [
    {
      label: "Add Image...",
      action: "OpenImage",
      type: "file",
      hide: papaya.utilities.PlatformUtils.ios,
    },
    {
      label: "Add Surface...",
      action: "OpenSurface",
      type: "file",
      hide: papaya.utilities.PlatformUtils.ios,
    },
    {
      label: "Add DICOM Folder...",
      action: "OpenFolder",
      type: "folder",
      hide:
        "Chrome" !== papaya.utilities.PlatformUtils.browser ||
        "undefined" === typeof daikon,
    },
    { label: "Add DTI Vector Series...", action: "OpenDTI", type: "file" },
    { type: "spacer" },
    {
      label: "Close All",
      action: "CloseAllImages",
    },
  ],
};
papaya.ui.Toolbar.RGB_FILE_MENU_DATA = {
  label: "File",
  icons: null,
  items: [{ label: "Close All", action: "CloseAllImages" }],
};
papaya.ui.Toolbar.MENU_DATA = {
  menus: [
    papaya.ui.Toolbar.FILE_MENU_DATA,
    {
      label: "View",
      icons: null,
      items: [
        {
          label: "Orientation",
          action: "ShowOrientation",
          type: "checkbox",
          method: "isShowingOrientation",
        },
        {
          label: "Crosshairs",
          action: "ShowCrosshairs",
          type: "checkbox",
          method: "isShowingCrosshairs",
        },
        {
          label: "Ruler",
          action: "ShowRuler",
          type: "checkbox",
          method: "isShowingRuler",
        },
        { type: "spacer", required: "hasSurface" },
        {
          label: "Surface Planes",
          action: "ShowSurfacePlanes",
          type: "checkbox",
          method: "isShowingSurfacePlanes",
          required: "hasSurface",
        },
        { type: "spacer", required: "hasBoundaries" },
        {
          label: "Volume Boundaries",
          action: "ShowVolumeBoundaries",
          type: "checkbox",
          method: "isShowingVolumeBoundaries",
          required: "hasVolumeBoundaries",
        },
        {
          label: "Surface Boundaries",
          action: "ShowSurfaceBoundaries",
          type: "checkbox",
          method: "isShowingSurfaceBoundaries",
          required: "hasSurfaceBoundaries",
        },
      ],
    },
    {
      label: "Settings",
      icons: null,
      items: [
        { label: "Viewer Preferences", action: "Preferences" },
        {
          label: "Surface Preferences",
          action: "SurfacePreferences",
          required: "hasSurface",
        },
      ],
    },
    {
      label: "Help",
      icons: null,
      items: [
        { label: "Show Keyboard Reference", action: "KeyboardRef" },
        { label: "Show Mouse Reference", action: "MouseRef" },
        { label: "Show License", action: "License" },
      ],
    },
    { label: "TITLE", icons: null, titleBar: "true" },
    {
      label: "EXPAND",
      icons: [papaya.ui.Toolbar.ICON_EXPAND, papaya.ui.Toolbar.ICON_COLLAPSE],
      items: [],
      method: "isCollapsable",
      required: "isExpandable",
    },
    {
      label: "SPACE",
      icons: [
        papaya.ui.Toolbar.ICON_IMAGESPACE,
        papaya.ui.Toolbar.ICON_WORLDSPACE,
      ],
      items: [],
      method: "isWorldMode",
      menuOnHover: !0,
    },
  ],
};
papaya.ui.Toolbar.MENU_DATA_KIOSK = {
  menus: [
    {
      label: "EXPAND",
      icons: [papaya.ui.Toolbar.ICON_EXPAND, papaya.ui.Toolbar.ICON_COLLAPSE],
      items: [],
      method: "isCollapsable",
      required: "isExpandable",
    },
  ],
};
papaya.ui.Toolbar.OVERLAY_IMAGE_MENU_DATA = {
  items: [
    { label: "Show Header", action: "ShowHeader" },
    { label: "Show Image Info", action: "ImageInfo" },
    { type: "spacer", required: "isParametricCombined" },
    {
      label: "DisplayRange",
      action: "ChangeRange",
      type: "displayrange",
      method: "getRange",
    },
    {
      label: "Load Negatives",
      action: "LoadNegatives",
      required: "canCurrentOverlayLoadNegatives",
    },
    {
      label: "Transparency",
      action: "alpha",
      type: "range",
      method: "getAlpha",
    },
    {
      label: "Color Table",
      action: "ColorTable",
      items: [],
      required: "isNonParametricCombined",
    },
    { type: "spacer", required: "isParametricCombined" },
    {
      label: "DisplayRange",
      action: "ChangeRangeNeg",
      type: "displayrange",
      method: "getRangeNegative",
      required: "isParametricCombined",
    },
    {
      label: "Transparency",
      action: "alphaneg",
      type: "range",
      method: "getAlpha",
      required: "isParametricCombined",
    },
    { type: "spacer", required: "isParametricCombined" },
    {
      label: "Hide Overlay",
      action: "ToggleOverlay",
      method: "getHiddenLabel",
    },
    {
      label: "Close Overlay",
      action: "CloseOverlay",
      required: "isDesktopMode",
    },
    {
      label: "Open in Mango",
      action: "OpenInMango",
      required: "canOpenInMango",
    },
  ],
};
papaya.ui.Toolbar.BASE_IMAGE_MENU_DATA = {
  items: [
    { label: "Show Header", action: "ShowHeader" },
    { label: "Show Image Info", action: "ImageInfo" },
    {
      label: "DisplayRange",
      action: "ChangeRange",
      type: "displayrange",
      method: "getRange",
    },
    papaya.ui.Toolbar.OVERLAY_IMAGE_MENU_DATA.items[6],
    {
      label: "Rotation",
      action: "Rotation",
      items: [
        {
          label: "About X Axis",
          action: "rotationX",
          type: "range",
          method: "getRotationX",
        },
        {
          label: "About Y Axis",
          action: "rotationY",
          type: "range",
          method: "getRotationY",
        },
        {
          label: "About Z Axis",
          action: "rotationZ",
          type: "range",
          method: "getRotationZ",
        },
        { label: "Reset Transform", action: "ResetTransform" },
        {
          label: "Rotate About Center",
          action: "Rotate About Center",
          type: "radiobutton",
          method: "isRotatingAbout",
        },
        {
          label: "Rotate About Origin",
          action: "Rotate About Origin",
          type: "radiobutton",
          method: "isRotatingAbout",
        },
        {
          label: "Rotate About Crosshairs",
          action: "Rotate About Crosshairs",
          type: "radiobutton",
          method: "isRotatingAbout",
        },
      ],
    },
    {
      label: "Open in Mango",
      action: "OpenInMango",
      required: "canOpenInMango",
    },
  ],
};
papaya.ui.Toolbar.RGB_IMAGE_MENU_DATA = {
  items: [
    { label: "Show Header", action: "ShowHeader" },
    { label: "Show Image Info", action: "ImageInfo" },
    {
      label: "Open in Mango",
      action: "OpenInMango",
      required: "canOpenInMango",
    },
  ],
};
papaya.ui.Toolbar.SURFACE_MENU_DATA = {
  items: [
    { label: "Show Surface Info", action: "SurfaceInfo" },
    {
      label: "Transparency",
      action: "alpha",
      type: "range",
      method: "getAlpha",
    },
  ],
};
papaya.ui.Toolbar.DTI_IMAGE_MENU_DATA = {
  items: [
    { label: "Show Header", action: "ShowHeader" },
    { label: "Show Image Info", action: "ImageInfo" },
    {
      label: "Display Colors",
      action: "DTI-RGB",
      type: "checkbox",
      method: "isDTIRGB",
    },
    {
      label: "Display Lines",
      action: "DTI-Lines",
      type: "checkbox",
      method: "isDTILines",
    },
    {
      label: "Display Lines &amp; Colors",
      action: "DTI-LinesColors",
      type: "checkbox",
      method: "isDTILinesAndRGB",
    },
    {
      label: "Transparency",
      action: "alpha",
      type: "range",
      method: "getAlpha",
      required: "canCurrentOverlayLoadMod",
    },
    {
      label: "Modulate with...",
      action: "DTI-Mod",
      type: "file",
      hide: papaya.utilities.PlatformUtils.ios,
      required: "canCurrentOverlayLoadMod",
    },
    {
      label: "Modulation",
      action: "dtiAlphaFactor",
      type: "range",
      method: "getDtiAlphaFactor",
      required: "canCurrentOverlayModulate",
    },
    {
      label: "Open in Mango",
      action: "OpenInMango",
      required: "canOpenInMango",
    },
  ],
};
papaya.ui.Toolbar.PREFERENCES_DATA = {
  items: [
    {
      label: "Coordinate display of:",
      field: "atlasLocks",
      options: ["Mouse", "Crosshairs"],
    },
    {
      label: "Scroll wheel behavior:",
      field: "scrollBehavior",
      options: ["Zoom", "Increment Slice"],
      disabled: "container.disableScrollWheel",
    },
    { spacer: "true" },
    {
      label: "Smooth display:",
      field: "smoothDisplay",
      options: ["Yes", "No"],
    },
    {
      label: "Radiological display:",
      field: "radiological",
      options: ["Yes", "No"],
    },
    { spacer: "true" },
    { label: "Default min range:", field: "minRange" },
    {
      label: "Default max range:",
      field: "maxRange",
    },
  ],
};
papaya.ui.Toolbar.PREFERENCES_SURFACE_DATA = {
  items: [
    {
      label: "Background color:",
      field: "surfaceBackgroundColor",
      options: ["Black", "Dark Gray", "Gray", "Light Gray", "White"],
    },
  ],
};
papaya.ui.Toolbar.IMAGE_INFO_DATA = {
  items: [
    { label: "Filename:", field: "getFilename", readonly: "true" },
    { spacer: "true" },
    {
      label: "Image Dims:",
      field: "getImageDimensionsDescription",
      readonly: "true",
    },
    {
      label: "Voxel Dims:",
      field: "getVoxelDimensionsDescription",
      readonly: "true",
    },
    { spacer: "true" },
    { label: "Byte Type:", field: "getByteTypeDescription", readonly: "true" },
    {
      label: "Byte Order:",
      field: "getByteOrderDescription",
      readonly: "true",
    },
    { spacer: "true" },
    {
      label: "Orientation:",
      field: "getOrientationDescription",
      readonly: "true",
    },
    { spacer: "true" },
    { label: "Notes:", field: "getImageDescription", readonly: "true" },
  ],
};
papaya.ui.Toolbar.SERIES_INFO_DATA = {
  items: [
    { label: "Filename:", field: "getFilename", readonly: "true" },
    { label: "File Length:", field: "getFileLength", readonly: "true" },
    { spacer: "true" },
    {
      label: "Image Dims:",
      field: "getImageDimensionsDescription",
      readonly: "true",
    },
    {
      label: "Voxel Dims:",
      field: "getVoxelDimensionsDescription",
      readonly: "true",
    },
    {
      label: "Series Points:",
      field: "getSeriesDimensionsDescription",
      readonly: "true",
    },
    {
      label: "Series Point Size:",
      field: "getSeriesSizeDescription",
      readonly: "true",
    },
    { spacer: "true" },
    { label: "Byte Type:", field: "getByteTypeDescription", readonly: "true" },
    {
      label: "Byte Order:",
      field: "getByteOrderDescription",
      readonly: "true",
    },
    {
      label: "Compressed:",
      field: "getCompressedDescription",
      readonly: "true",
    },
    { spacer: "true" },
    {
      label: "Orientation:",
      field: "getOrientationDescription",
      readonly: "true",
    },
    { label: "Notes:", field: "getImageDescription", readonly: "true" },
  ],
};
papaya.ui.Toolbar.SURFACE_INFO_DATA = {
  items: [
    { label: "Filename:", field: "getSurfaceFilename", readonly: "true" },
    { spacer: "true" },
    { label: "Points:", field: "getSurfaceNumPoints", readonly: "true" },
    { label: "Triangles:", field: "getSurfaceNumTriangles", readonly: "true" },
  ],
};
papaya.ui.Toolbar.HEADER_DATA = {
  items: [{ label: "", field: "getHeaderDescription", readonly: "true" }],
};
papaya.ui.Toolbar.LICENSE_DATA = {
  items: [{ label: "", field: "getLicense", readonly: "true" }],
};
papaya.ui.Toolbar.KEYBOARD_REF_DATA = {
  items: [{ label: "", field: "getKeyboardReference", readonly: "true" }],
};
papaya.ui.Toolbar.MOUSE_REF_DATA = {
  items: [{ label: "", field: "getMouseReference", readonly: "true" }],
};
papaya.ui.Toolbar.applyContextState = function (a) {
  var b;
  a.contextMenu = !0;
  if (a.items)
    for (b = 0; b < a.items.length; b += 1)
      a.items[b].menu
        ? papaya.ui.Toolbar.applyContextState(a.items[b].menu)
        : (a.items[b].isContext = !0);
};
papaya.ui.Toolbar.prototype.buildToolbar = function () {
  var a;
  this.spaceMenu = this.surfaceMenus = this.imageMenus = null;
  this.container.toolbarHtml.find("." + PAPAYA_MENU_ICON_CSS).remove();
  this.container.toolbarHtml.find("." + PAPAYA_MENU_LABEL_CSS).remove();
  this.container.toolbarHtml.find("." + PAPAYA_TITLEBAR_CSS).remove();
  if (this.container.kioskMode)
    for (a = 0; a < papaya.ui.Toolbar.MENU_DATA_KIOSK.menus.length; a += 1)
      this.buildMenu(
        papaya.ui.Toolbar.MENU_DATA_KIOSK.menus[a],
        null,
        this.viewer,
        null
      );
  else {
    0 < this.container.viewer.screenVolumes.length &&
    this.container.viewer.screenVolumes[0].rgb
      ? (papaya.ui.Toolbar.MENU_DATA.menus[0] =
          papaya.ui.Toolbar.RGB_FILE_MENU_DATA)
      : ((papaya.ui.Toolbar.MENU_DATA.menus[0] = this.container.noNewFiles
          ? papaya.ui.Toolbar.RGB_FILE_MENU_DATA
          : papaya.ui.Toolbar.FILE_MENU_DATA),
        this.buildOpenMenuItems(papaya.ui.Toolbar.MENU_DATA));
    for (a = 0; a < papaya.ui.Toolbar.MENU_DATA.menus.length; a += 1)
      this.buildMenu(
        papaya.ui.Toolbar.MENU_DATA.menus[a],
        null,
        this.viewer,
        null
      );
    this.buildAtlasMenu();
  }
  this.buildColorMenuItems();
  this.container.titlebarHtml = this.container.containerHtml.find(
    "." + PAPAYA_TITLEBAR_CSS
  );
  600 > this.container.getViewerDimensions()[0]
    ? this.container.titlebarHtml.css({ visibility: "hidden" })
    : this.container.titlebarHtml.css({ visibility: "visible" });
};
papaya.ui.Toolbar.prototype.buildAtlasMenu = function () {
  if (papaya.data && papaya.data.Atlases) {
    var a = this.spaceMenu.items;
    a.length = 0;
    for (var b in papaya.data.Atlases)
      if (papaya.data.Atlases.hasOwnProperty(b)) {
        var c = b,
          e = papaya.data.Atlases[b];
        a.push({
          label: e.labels.atlas.header.name,
          action: "AtlasChanged-" + c + "-" + e.labels.atlas.header.name,
          type: "radiobutton",
          method: "isUsingAtlas",
        });
        e.labels.atlas.header.transformedname &&
          a.push({
            label: e.labels.atlas.header.transformedname,
            action:
              "AtlasChanged-" + c + "-" + e.labels.atlas.header.transformedname,
            type: "radiobutton",
            method: "isUsingAtlas",
          });
      }
  }
};
papaya.ui.Toolbar.prototype.buildColorMenuItems = function () {
  var a, b;
  if ((a = this.container.params.luts))
    for (b = 0; b < a.length; b += 1)
      papaya.viewer.ColorTable.addCustomLUT(a[b]);
  var c = papaya.viewer.ColorTable.TABLE_ALL;
  a = papaya.ui.Toolbar.OVERLAY_IMAGE_MENU_DATA.items;
  for (b = 0; b < a.length; b += 1)
    if ("Color Table" === a[b].label) {
      a = a[b].items;
      break;
    }
  for (b = 0; b < c.length; b += 1) {
    var e = {
      label: c[b].name,
      action: "ColorTable-" + c[b].name,
      type: "radiobutton",
      method: "isUsingColorTable",
    };
    a[b] = e;
  }
};
papaya.ui.Toolbar.prototype.buildOpenMenuItems = function (a) {
  var b;
  for (b = 0; b < a.menus.length; b += 1)
    if ("File" === a.menus[b].label) {
      var c = a.menus[b].items;
      break;
    }
  if (c)
    for (b = 0; b < papayaLoadableImages.length; b += 1)
      papayaLoadableImages[b].hide ||
        (papayaLoadableImages[b].surface
          ? ((a = "Add Surface " + papayaLoadableImages[b].nicename),
            this.menuContains(c, a) ||
              c.splice(2, 0, {
                label: a,
                action: "OpenSurface-" + papayaLoadableImages[b].name,
              }))
          : ((a = "Add " + papayaLoadableImages[b].nicename),
            this.menuContains(c, a) ||
              c.splice(2, 0, {
                label: a,
                action: "Open-" + papayaLoadableImages[b].name,
              })));
};
papaya.ui.Toolbar.prototype.menuContains = function (a, b) {
  var c;
  if (a) for (c = 0; c < a.length; c += 1) if (a[c].label === b) return !0;
  return !1;
};
papaya.ui.Toolbar.prototype.buildMenu = function (a, b, c, e, d) {
  var g = null;
  void 0 === d && (d = !1);
  (a.required &&
    !0 !==
      papaya.utilities.ObjectUtils.bind(
        this.container,
        papaya.utilities.ObjectUtils.dereferenceIn(this.container, a.required)
      )()) ||
    ((g = new papaya.ui.Menu(
      this.viewer,
      a,
      papaya.utilities.ObjectUtils.bind(this, this.doAction),
      this.viewer,
      e
    )),
    "SPACE" === a.label && (this.spaceMenu = a),
    d || (b ? g.setMenuButton(b) : (b = g.buildMenuButton())),
    (a = a.items) && this.buildMenuItems(g, a, b, c, e));
  return g;
};
papaya.ui.Toolbar.prototype.buildMenuItems = function (a, b, c, e, d) {
  var g;
  void 0 === d && (d = "");
  for (g = 0; g < b.length; g += 1) {
    var h = null;
    (b[g].required &&
      !0 !==
        papaya.utilities.ObjectUtils.bind(
          this.container,
          papaya.utilities.ObjectUtils.dereferenceIn(
            this.container,
            b[g].required
          )
        )(parseInt(d))) ||
      ("spacer" === b[g].type
        ? (h = new papaya.ui.MenuItemSpacer())
        : "radiobutton" === b[g].type
        ? (h = new papaya.ui.MenuItemRadioButton(
            this.viewer,
            b[g].label,
            b[g].action,
            papaya.utilities.ObjectUtils.bind(this, this.doAction),
            e,
            b[g].method,
            d
          ))
        : "checkbox" === b[g].type
        ? (h = new papaya.ui.MenuItemCheckBox(
            this.viewer,
            b[g].label,
            b[g].action,
            papaya.utilities.ObjectUtils.bind(this, this.doAction),
            e,
            b[g].method,
            d
          ))
        : "file" === b[g].type
        ? b[g].hide ||
          (b[g].required &&
            !0 !==
              papaya.utilities.ObjectUtils.bind(
                this.container,
                papaya.utilities.ObjectUtils.dereferenceIn(
                  this.container,
                  b[g].required
                )
              )(parseInt(d))) ||
          (h = new papaya.ui.MenuItemFileChooser(
            this.viewer,
            b[g].label,
            b[g].action,
            papaya.utilities.ObjectUtils.bind(this, this.doAction),
            !1,
            d
          ))
        : "folder" === b[g].type
        ? (h =
            b[g].hide ||
            (b[g].required &&
              !0 !==
                papaya.utilities.ObjectUtils.bind(
                  this.container,
                  papaya.utilities.ObjectUtils.dereferenceIn(
                    this.container,
                    b[g].required
                  )
                )(parseInt(d)))
              ? null
              : new papaya.ui.MenuItemFileChooser(
                  this.viewer,
                  b[g].label,
                  b[g].action,
                  papaya.utilities.ObjectUtils.bind(this, this.doAction),
                  !0,
                  d
                ))
        : "displayrange" === b[g].type
        ? (h = this.viewer.screenVolumes[d].supportsDynamicColorTable()
            ? new papaya.ui.MenuItemRange(
                this.viewer,
                b[g].label,
                b[g].action,
                papaya.utilities.ObjectUtils.bind(this, this.doAction),
                e,
                b[g].method,
                d
              )
            : null)
        : "range" === b[g].type
        ? papaya.utilities.PlatformUtils.isInputRangeSupported() &&
          (h = new papaya.ui.MenuItemSlider(
            this.viewer,
            b[g].label,
            b[g].action,
            papaya.utilities.ObjectUtils.bind(this, this.doAction),
            e,
            b[g].method,
            d
          ))
        : (h = new papaya.ui.MenuItem(
            this.viewer,
            b[g].label,
            b[g].action,
            papaya.utilities.ObjectUtils.bind(this, this.doAction),
            e,
            b[g].method,
            d
          )));
    if (h && (a.addMenuItem(h), b[g].items)) {
      var n = this.buildMenu(b[g], c, e, d);
      h.menu = n;
      h.callback = papaya.utilities.ObjectUtils.bind(n, n.showMenu);
    }
  }
};
papaya.ui.Toolbar.prototype.updateImageButtons = function () {
  this.container.toolbarHtml.find("." + PAPAYA_MENU_BUTTON_CSS).remove();
  this.doUpdateImageButtons();
  this.updateSurfaceButtons();
};
papaya.ui.Toolbar.prototype.doUpdateImageButtons = function () {
  var a;
  this.imageMenus = [];
  if (this.container.showImageButtons)
    for (a = this.viewer.screenVolumes.length - 1; 0 <= a; --a) {
      var b = this.viewer.screenVolumes[a];
      var c = b.icon;
      c = [{ label: "ImageButton", icons: [c], items: null, imageButton: !0 }];
      c[0].items =
        0 === a
          ? b.rgb
            ? papaya.ui.Toolbar.RGB_IMAGE_MENU_DATA.items
            : b.dti
            ? papaya.ui.Toolbar.DTI_IMAGE_MENU_DATA.items
            : papaya.ui.Toolbar.BASE_IMAGE_MENU_DATA.items
          : b.dti
          ? papaya.ui.Toolbar.DTI_IMAGE_MENU_DATA.items
          : papaya.ui.Toolbar.OVERLAY_IMAGE_MENU_DATA.items;
      (this.container.combineParametric && b.parametric) ||
        this.imageMenus.unshift(this.buildMenu(c[0], null, b, a.toString()));
    }
};
papaya.ui.Toolbar.prototype.updateSurfaceButtons = function () {
  var a,
    b = this;
  this.surfaceMenus = [];
  if (this.container.showImageButtons)
    for (a = this.viewer.surfaces.length - 1; 0 <= a; --a) {
      var c = this.viewer.surfaces[a];
      if (c.staticIcon)
        papaya.viewer.ScreenVolume.makeStaticIcon(
          c.staticIcon,
          function (d, g) {
            b.surfaceMenus.push(
              b.buildMenu(
                {
                  label: "SurfaceButton",
                  icons: [d],
                  items: papaya.ui.Toolbar.SURFACE_MENU_DATA.items,
                  imageButton: !0,
                  surfaceButton: !0,
                },
                null,
                b.viewer.surfaces[g],
                g.toString()
              )
            );
          },
          a
        );
      else {
        var e = c.solidColor;
        null === e && (e = [0.5, 0.5, 0.5]);
        e = papaya.viewer.ScreenVolume.makeSolidIcon(e[0], e[1], e[2]);
        this.surfaceMenus.push(
          this.buildMenu(
            {
              label: "SurfaceButton",
              icons: [e],
              items: papaya.ui.Toolbar.SURFACE_MENU_DATA.items,
              imageButton: !0,
              surfaceButton: !0,
            },
            null,
            c,
            a.toString()
          )
        );
      }
    }
};
papaya.ui.Toolbar.prototype.closeAllMenus = function (a) {
  var b = this.container.toolbarHtml.find("." + PAPAYA_MENU_CSS);
  b.hide(100);
  b.remove();
  this.container.showControlBar &&
    ((b = this.container.sliderControlHtml.find("." + PAPAYA_MENU_CSS)),
    b.hide(100),
    b.remove());
  b = this.container.toolbarHtml.find("." + PAPAYA_DIALOG_CSS);
  b.hide(100);
  b.remove();
  b = this.container.toolbarHtml.find("." + PAPAYA_DIALOG_BACKGROUND);
  b.hide(100);
  b.remove();
  !a &&
    (a = this.container.viewerHtml.find("." + PAPAYA_MENU_CSS)) &&
    (a.hide(100), a.remove());
};
papaya.ui.Toolbar.prototype.isShowingMenus = function () {
  var a = this.container.toolbarHtml.find("." + PAPAYA_MENU_CSS).is(":visible");
  var b = this.container.toolbarHtml
    .find("." + PAPAYA_DIALOG_CSS)
    .is(":visible");
  return a || b;
};
papaya.ui.Toolbar.prototype.doAction = function (a, b, c) {
  var e;
  c || this.closeAllMenus();
  if (a)
    if (a.startsWith("ImageButton"))
      (a = parseInt(a.substr(a.length - 2, 1), 10)),
        this.viewer.setCurrentScreenVol(a),
        this.updateImageButtons();
    else if (a.startsWith("OpenSurface-"))
      (b = a.substring(a.indexOf("-") + 1)), this.viewer.loadSurface(b);
    else if (a.startsWith("Open-"))
      (b = a.substring(a.indexOf("-") + 1)), this.viewer.loadImage(b);
    else if ("OpenImage" === a)
      this.container.display.drawProgress(0.1, "Loading"),
        this.viewer.loadImage(b);
    else if ("OpenDTI" === a)
      this.container.display.drawProgress(0.1, "Loading"),
        (this.viewer.loadingDTI = !0),
        this.viewer.loadImage(b);
    else if ("OpenSurface" === a)
      this.container.display.drawProgress(0.1, "Loading"),
        this.viewer.loadSurface(b);
    else if ("OpenFolder" === a) {
      a = [];
      for (c = 0; c < b.length; c += 1) {
        var d = !1;
        for (e = 0; e < papaya.Container.ignorePatterns.length; e += 1)
          papaya.Container.ignorePatterns[e].test(b[c].name) && (d = !0);
        d ? console.log("Ignoring file " + b[c].name) : a.push(b[c]);
      }
      this.container.display.drawProgress(0.1, "Loading");
      this.viewer.loadImage(a);
    } else if (a.startsWith("ColorTable"))
      (b = a.substring(a.indexOf("-") + 1, a.lastIndexOf("-"))),
        (a = a.substring(a.lastIndexOf("-") + 1)),
        this.viewer.screenVolumes[a].changeColorTable(this.viewer, b),
        this.updateImageButtons();
    else if (a.startsWith("CloseAllImages"))
      papaya.Container.resetViewer(this.container.containerIndex, {});
    else if ("Preferences" === a)
      (b = new papaya.ui.Dialog(
        this.container,
        "Viewer Preferences",
        papaya.ui.Toolbar.PREFERENCES_DATA,
        this.container.preferences,
        papaya.utilities.ObjectUtils.bind(
          this.container.preferences,
          this.container.preferences.updatePreference
        ),
        papaya.utilities.ObjectUtils.bind(this, function () {
          this.viewer.updateScreenSliceTransforms();
          this.viewer.drawViewer(!1, !0);
        })
      )),
        b.showDialog();
    else if ("SurfacePreferences" === a)
      (b = new papaya.ui.Dialog(
        this.container,
        "Surface Preferences",
        papaya.ui.Toolbar.PREFERENCES_SURFACE_DATA,
        this.container.preferences,
        papaya.utilities.ObjectUtils.bind(
          this.container.preferences,
          this.container.preferences.updatePreference
        ),
        papaya.utilities.ObjectUtils.bind(this, function () {
          this.viewer.updateScreenSliceTransforms();
          this.viewer.surfaceView.updatePreferences();
          this.viewer.drawViewer(!1, !0);
        })
      )),
        b.showDialog();
    else if ("License" === a)
      (b = new papaya.ui.Dialog(
        this.container,
        "License",
        papaya.ui.Toolbar.LICENSE_DATA,
        papaya.Container,
        null,
        null,
        null,
        !0
      )),
        b.showDialog();
    else if ("KeyboardRef" === a)
      (b = new papaya.ui.Dialog(
        this.container,
        "Keyboard Reference",
        papaya.ui.Toolbar.KEYBOARD_REF_DATA,
        papaya.Container,
        null,
        null,
        null,
        !0
      )),
        b.showDialog();
    else if ("MouseRef" === a)
      (b = new papaya.ui.Dialog(
        this.container,
        "Mouse Reference",
        papaya.ui.Toolbar.MOUSE_REF_DATA,
        papaya.Container,
        null,
        null,
        null,
        !0
      )),
        b.showDialog();
    else if (a.startsWith("ImageInfo"))
      (a = a.substring(a.lastIndexOf("-") + 1)),
        (b =
          1 < this.viewer.screenVolumes[a].volume.numTimepoints
            ? new papaya.ui.Dialog(
                this.container,
                "Image Info",
                papaya.ui.Toolbar.SERIES_INFO_DATA,
                this.viewer,
                null,
                null,
                a.toString()
              )
            : new papaya.ui.Dialog(
                this.container,
                "Image Info",
                papaya.ui.Toolbar.IMAGE_INFO_DATA,
                this.viewer,
                null,
                null,
                a.toString()
              )),
        b.showDialog();
    else if (a.startsWith("SurfaceInfo"))
      (a = a.substring(a.lastIndexOf("-") + 1)),
        (b = new papaya.ui.Dialog(
          this.container,
          "Surface Info",
          papaya.ui.Toolbar.SURFACE_INFO_DATA,
          this.viewer,
          null,
          null,
          a.toString()
        )),
        b.showDialog();
    else if (a.startsWith("ShowHeader"))
      (a = a.substring(a.lastIndexOf("-") + 1)),
        (b = new papaya.ui.Dialog(
          this.container,
          "Header",
          papaya.ui.Toolbar.HEADER_DATA,
          this.viewer,
          null,
          null,
          a.toString()
        )),
        b.showDialog();
    else if (a.startsWith("SPACE"))
      this.viewer.toggleWorldSpace(), this.viewer.drawViewer(!0);
    else if (a.startsWith("AtlasChanged"))
      (b = a.split("-", 3)),
        (a = papaya.data.Atlases[b[1]]),
        a.atlas ||
          (a.atlas = new papaya.viewer.Atlas(
            papaya.data.Atlases[b[1]],
            this.container,
            function () {}
          )),
        (this.viewer.atlas = a.atlas),
        (this.viewer.atlas.currentAtlas = b[2]),
        papaya.data.hasOwnProperty("configureAtlas") &&
          papaya.data.configureAtlas(this.viewer),
        this.viewer.drawViewer(!0);
    else if (a.startsWith("ShowRuler"))
      "Yes" === this.container.preferences.showRuler
        ? this.container.preferences.updatePreference("showRuler", "No")
        : this.container.preferences.updatePreference("showRuler", "Yes"),
        this.viewer.drawViewer(),
        this.closeAllMenus();
    else if (a.startsWith("ShowOrientation"))
      "Yes" === this.container.preferences.showOrientation
        ? this.container.preferences.updatePreference("showOrientation", "No")
        : this.container.preferences.updatePreference("showOrientation", "Yes"),
        this.viewer.drawViewer(),
        this.closeAllMenus();
    else if (a.startsWith("ShowCrosshairs"))
      "Yes" === this.container.preferences.showCrosshairs
        ? this.container.preferences.updatePreference("showCrosshairs", "No")
        : this.container.preferences.updatePreference("showCrosshairs", "Yes"),
        this.viewer.drawViewer(),
        this.closeAllMenus();
    else if (a.startsWith("EXPAND"))
      this.container.collapsable
        ? this.container.collapseViewer()
        : this.container.expandViewer();
    else if (a.startsWith("OpenInMango"))
      (a = parseInt(a.substring(a.lastIndexOf("-") + 1), 10)),
        0 === a
          ? this.container.viewer.volume.urls[0] &&
            papaya.utilities.PlatformUtils.launchCustomProtocol(
              this.container,
              papaya.utilities.UrlUtils.getAbsoluteUrl(
                PAPAYA_CUSTOM_PROTOCOL,
                this.container.viewer.volume.urls[0]
              ),
              this.customProtocolResult
            )
          : this.container.viewer.screenVolumes[a].volume.urls[0] &&
            papaya.utilities.PlatformUtils.launchCustomProtocol(
              this.container,
              papaya.utilities.UrlUtils.getAbsoluteUrl(
                PAPAYA_CUSTOM_PROTOCOL,
                this.container.viewer.screenVolumes[a].volume.urls[0]
              ) +
                "?" +
                encodeURIComponent(
                  "baseimage=" +
                    this.container.viewer.volume.fileName +
                    "&params=o"
                ),
              this.customProtocolResult
            );
    else if (a.startsWith("CloseOverlay"))
      (a = parseInt(a.substring(a.lastIndexOf("-") + 1), 10)),
        this.container.viewer.removeOverlay(a);
    else if (a.startsWith("ToggleOverlay"))
      (a = parseInt(a.substring(a.lastIndexOf("-") + 1), 10)),
        this.container.viewer.toggleOverlay(a);
    else if (a.startsWith("Context-"))
      this.container.contextManager.actionPerformed(a.substring(8));
    else if (a.startsWith("DTI-RGB"))
      (a = a.substring(a.lastIndexOf("-") + 1)),
        (this.viewer.screenVolumes[a].dtiLines = !1),
        (this.viewer.screenVolumes[a].dtiColors = !0),
        this.viewer.screenVolumes[a].initDTI(),
        this.viewer.drawViewer(!0, !1);
    else if (a.startsWith("DTI-LinesColors"))
      (a = a.substring(a.lastIndexOf("-") + 1)),
        (this.viewer.screenVolumes[a].dtiLines = !0),
        (this.viewer.screenVolumes[a].dtiColors = !0),
        this.viewer.screenVolumes[a].initDTI(),
        this.viewer.drawViewer(!0, !1);
    else if (a.startsWith("DTI-Lines"))
      (a = a.substring(a.lastIndexOf("-") + 1)),
        (this.viewer.screenVolumes[a].dtiLines = !0),
        (this.viewer.screenVolumes[a].dtiColors = !1),
        this.viewer.screenVolumes[a].initDTI(),
        this.viewer.drawViewer(!0, !1);
    else if (a.startsWith("DTI-Mod"))
      (a = a.substring(a.lastIndexOf("-") + 1)),
        this.container.display.drawProgress(0.1, "Loading"),
        (this.viewer.loadingDTIModRef = this.viewer.screenVolumes[a]),
        this.viewer.loadImage(b);
    else if (a.startsWith("LoadNegatives"))
      (a = a.substring(a.lastIndexOf("-") + 1)), this.viewer.addParametric(a);
    else if (a.startsWith("ShowSurfacePlanes"))
      (this.viewer.surfaceView.showSurfacePlanes =
        !this.viewer.surfaceView.showSurfacePlanes),
        this.viewer.surfaceView.updateActivePlanes(),
        "Yes" === this.container.preferences.showSurfacePlanes
          ? this.container.preferences.updatePreference(
              "showSurfacePlanes",
              "No"
            )
          : this.container.preferences.updatePreference(
              "showSurfacePlanes",
              "Yes"
            ),
        this.viewer.drawViewer(!1, !0),
        this.closeAllMenus();
    else if (a.startsWith("ShowVolumeBoundaries"))
      "Yes" === this.container.preferences.showVolumeBoundaries
        ? this.container.preferences.updatePreference(
            "showVolumeBoundaries",
            "No"
          )
        : this.container.preferences.updatePreference(
            "showVolumeBoundaries",
            "Yes"
          ),
        papaya.data.configureAtlas(this.viewer),
        this.viewer.drawViewer(!1, !0),
        this.closeAllMenus();
    else if (a.startsWith("ShowSurfaceBoundaries"))
      "Yes" === this.container.preferences.showSurfaceBoundaries
        ? this.container.preferences.updatePreference(
            "showSurfaceBoundaries",
            "No"
          )
        : this.container.preferences.updatePreference(
            "showSurfaceBoundaries",
            "Yes"
          ),
        papaya.data.configureAtlas(this.viewer),
        this.viewer.drawViewer(!0, !0),
        this.closeAllMenus();
    else if (a.startsWith("ShowSurfaceCrosshairs"))
      (this.viewer.surfaceView.showSurfaceCrosshairs =
        !this.viewer.surfaceView.showSurfaceCrosshairs),
        this.viewer.surfaceView.updateActivePlanes(),
        "Yes" === this.container.preferences.showSurfaceCrosshairs
          ? this.container.preferences.updatePreference(
              "showSurfaceCrosshairs",
              "No"
            )
          : this.container.preferences.updatePreference(
              "showSurfaceCrosshairs",
              "Yes"
            ),
        this.viewer.drawViewer(!1, !0),
        this.closeAllMenus();
    else if (a.startsWith("rotation")) {
      this.viewer.screenVolumes[0].updateTransform();
      for (c = 1; c < this.viewer.screenVolumes.length; c++)
        (this.viewer.screenVolumes[c].rotationX =
          this.viewer.screenVolumes[0].rotationX),
          (this.viewer.screenVolumes[c].rotationY =
            this.viewer.screenVolumes[0].rotationY),
          (this.viewer.screenVolumes[c].rotationZ =
            this.viewer.screenVolumes[0].rotationZ),
          (this.viewer.screenVolumes[c].rotationAbout =
            this.viewer.screenVolumes[0].rotationAbout),
          this.viewer.screenVolumes[c].updateTransform();
      this.viewer.surfaceView.updateActivePlanes();
    } else if (a.startsWith("Rotate About")) {
      this.viewer.screenVolumes[0].rotationAbout = a.substring(
        0,
        a.indexOf("-")
      );
      this.viewer.screenVolumes[0].updateTransform();
      for (c = 1; c < this.viewer.screenVolumes.length; c++)
        (this.viewer.screenVolumes[c].rotationX =
          this.viewer.screenVolumes[0].rotationX),
          (this.viewer.screenVolumes[c].rotationY =
            this.viewer.screenVolumes[0].rotationY),
          (this.viewer.screenVolumes[c].rotationZ =
            this.viewer.screenVolumes[0].rotationZ),
          (this.viewer.screenVolumes[c].rotationAbout =
            this.viewer.screenVolumes[0].rotationAbout),
          this.viewer.screenVolumes[c].updateTransform();
      this.viewer.surfaceView.updateActivePlanes();
      this.viewer.drawViewer(!0, !1);
    } else if (a.startsWith("ResetTransform")) {
      for (c = 0; c < this.viewer.screenVolumes.length; c++)
        this.viewer.screenVolumes[c].resetTransform(),
          this.viewer.screenVolumes[c].updateTransform();
      this.viewer.surfaceView.resetRotation();
      this.viewer.surfaceView.updateActivePlanes();
      this.viewer.drawViewer(!0, !1);
    }
};
papaya.ui.Toolbar.prototype.customProtocolResult = function (a) {
  !1 === a &&
    ("Chrome" === papaya.utilities.PlatformUtils.browser ||
    "Internet Explorer" === papaya.utilities.PlatformUtils.browser
      ? alert(
          "Mango does not appear to be installed.  You can download Mango at:\n\nhttp://ric.uthscsa.edu/mango"
        )
      : papaya.utilities.PlatformUtils.ios
      ? confirm(
          "iMango does not appear to be installed.  Would you like to download it now?"
        ) && window.open("http://itunes.apple.com/us/app/imango/id423626092")
      : confirm(
          "Mango does not appear to be installed.  Would you like to download it now?"
        ) && window.open("http://ric.uthscsa.edu/mango/mango.html"));
};
papaya.ui.Toolbar.prototype.updateTitleBar = function (a) {
  var b = this.container.titlebarHtml[0];
  b && (b.innerHTML = a);
  this.container.titlebarHtml.css({ top: 0 });
};
papaya.ui.Toolbar.prototype.showImageMenu = function (a) {
  this.viewer.screenVolumes[a].resetDynamicRange();
  this.imageMenus[a].showMenu();
};
papaya.ui.Toolbar.prototype.updateImageMenuRange = function (a, b, c) {
  this.imageMenus[a].updateRangeItem(b, c);
};
("use strict");
papaya = papaya || {};
papaya.viewer = papaya.viewer || {};
papaya.viewer.Atlas =
  papaya.viewer.Atlas ||
  function (a, b, c) {
    this.container = b;
    this.callback = c;
    this.transformedname = this.name = null;
    this.labels = [];
    this.atlasLabelData = a.labels;
    this.volume = new papaya.volume.Volume(b.display, b.viewer);
    this.currentAtlas =
      this.transform =
      this.returnLabels =
      this.displayColumns =
        null;
    this.maxLabels = 0;
    this.probabilistic = !1;
    this.boundaryData = a.boundaryData;
    a = b.findLoadableImage(a.labels.atlas.header.images.summaryimagefile);
    b.params.atlasURL
      ? this.volume.readURLs(
          [b.params.atlasURL],
          papaya.utilities.ObjectUtils.bind(this, this.readFinished)
        )
      : null !== a && void 0 !== a.encode
      ? this.volume.readEncodedData(
          [a.encode],
          papaya.utilities.ObjectUtils.bind(this, this.readFinished)
        )
      : null !== a &&
        void 0 !== a.url &&
        this.volume.readURLs(
          [a.url],
          papaya.utilities.ObjectUtils.bind(this, this.readFinished)
        );
  };
papaya.viewer.Atlas.MAX_LABELS = 4;
papaya.viewer.Atlas.PROBABILISTIC = [
  "probabalistic",
  "probabilistic",
  "statistic",
];
papaya.viewer.Atlas.LABEL_SPLIT_REGEX = /\.|:|,|\//;
papaya.viewer.Atlas.prototype.getLabelAtCoordinate = function (a, b, c) {
  if (this.transform && this.currentAtlas === this.transformedname) {
    var e =
      a * this.transform[0][0] +
      b * this.transform[0][1] +
      c * this.transform[0][2] +
      this.transform[0][3];
    var d =
      a * this.transform[1][0] +
      b * this.transform[1][1] +
      c * this.transform[1][2] +
      this.transform[1][3];
    var g =
      a * this.transform[2][0] +
      b * this.transform[2][1] +
      c * this.transform[2][2] +
      this.transform[2][3];
  } else (e = a), (d = b), (g = c);
  a = papaya.Container.atlasWorldSpace
    ? this.volume.getVoxelAtCoordinate(e, d, g, 0, !0)
    : this.volume.getVoxelAtIndex(a, b, c, 0, !0);
  this.probabilistic && --a;
  return this.formatLabels(this.labels[a], this.returnLabels);
};
papaya.viewer.Atlas.prototype.readFinished = function () {
  this.parseTransform();
  this.parseLabels();
  this.parseDisplayColumns();
  this.maxLabels = this.findMaxLabelParts();
  this.probabilistic =
    this.atlasLabelData.atlas.header.type &&
    (this.atlasLabelData.atlas.header.type.toLowerCase() ===
      papaya.viewer.Atlas.PROBABILISTIC[0] ||
      this.atlasLabelData.atlas.header.type.toLowerCase() ===
        papaya.viewer.Atlas.PROBABILISTIC[1] ||
      this.atlasLabelData.atlas.header.type.toLowerCase() ===
        papaya.viewer.Atlas.PROBABILISTIC[2]);
  this.returnLabels = [];
  this.returnLabels.length = this.maxLabels;
  this.atlasLabelData.atlas.header.transformedname &&
    (this.transformedname = this.atlasLabelData.atlas.header.transformedname);
  this.currentAtlas = this.name = this.atlasLabelData.atlas.header.name;
  var a = this.container.params.atlas;
  a && a === this.transformedname && (this.currentAtlas = this.transformedname);
  this.callback();
};
papaya.viewer.Atlas.prototype.parseDisplayColumns = function () {
  var a;
  if (this.atlasLabelData.atlas.header.display) {
    this.displayColumns = [];
    var b = 0;
    var c = this.atlasLabelData.atlas.header.display.split(
      papaya.viewer.Atlas.LABEL_SPLIT_REGEX
    );
    for (a = 0; a < c.length; a += 1)
      "*" === c[a] && ((this.displayColumns[b] = a), (b += 1));
  }
};
papaya.viewer.Atlas.prototype.parseTransform = function () {
  var a, b;
  if (this.atlasLabelData.atlas.header.transform) {
    var c = this.atlasLabelData.atlas.header.transform.split(" ");
    this.transform = papaya.volume.Transform.IDENTITY.clone();
    if (16 === c.length)
      for (a = 0; 4 > a; a += 1)
        for (b = 0; 4 > b; b += 1)
          this.transform[a][b] = parseFloat(c[4 * a + b]);
  }
};
papaya.viewer.Atlas.prototype.parseLabels = function () {
  var a;
  for (a = 0; a < this.atlasLabelData.atlas.data.label.length; a += 1) {
    var b = this.atlasLabelData.atlas.data.label[a];
    var c = b.index ? parseInt(b.index, 10) : a;
    this.labels[c] = b.content ? b.content : b;
  }
};
papaya.viewer.Atlas.prototype.formatLabels = function (a, b) {
  var c;
  if (a)
    if (
      ((a = a.split(papaya.viewer.Atlas.LABEL_SPLIT_REGEX)),
      this.displayColumns)
    )
      for (c = 0; c < a.length; c += 1)
        c < this.displayColumns.length && (b[c] = a[this.displayColumns[c]]);
    else {
      var e = a.length;
      c = 0;
      for (
        e > papaya.viewer.Atlas.MAX_LABELS &&
        (c = e - papaya.viewer.Atlas.MAX_LABELS);
        c < a.length;
        c += 1
      )
        b[c] = a[c].trim();
    }
  else for (c = 0; c < b.length; c += 1) b[c] = "";
  return b;
};
papaya.viewer.Atlas.prototype.findMaxLabelParts = function () {
  var a;
  if (this.displayColumns) return this.displayColumns.length;
  var b = [];
  for (a = 0; a < this.labels.length; a += 1)
    this.formatLabels(this.labels[a], b);
  return b.length;
};
("use strict");
papaya = papaya || {};
papaya.viewer = papaya.viewer || {};
papaya.viewer.ColorTable =
  papaya.viewer.ColorTable ||
  function (a, b, c) {
    a = void 0 !== c ? c : papaya.viewer.ColorTable.findLUT(a);
    this.lutData = a.data;
    this.minLUT = this.maxLUT = 0;
    this.knotThresholds = [];
    this.knotRangeRatios = [];
    this.LUTarrayG = Array(256);
    this.LUTarrayR = Array(256);
    this.LUTarrayB = Array(256);
    this.isBaseImage = b;
    this.knotMin = this.lutData[0];
    this.knotMax = this.lutData[this.lutData.length - 1];
    this.useGradation = "undefined" === typeof a.gradation || a.gradation;
    this.updateLUT(
      papaya.viewer.ColorTable.LUT_MIN,
      papaya.viewer.ColorTable.LUT_MAX
    );
  };
papaya.viewer.ColorTable.TABLE_GRAYSCALE = {
  name: "Grayscale",
  data: [
    [0, 0, 0, 0],
    [1, 1, 1, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_SPECTRUM = {
  name: "Spectrum",
  data: [
    [0, 0, 0, 0],
    [0.1, 0, 0, 1],
    [0.33, 0, 1, 1],
    [0.5, 0, 1, 0],
    [0.66, 1, 1, 0],
    [0.9, 1, 0, 0],
    [1, 1, 1, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_RED2YELLOW = {
  name: "Overlay (Positives)",
  data: [
    [0, 1, 0, 0],
    [1, 1, 1, 0],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_BLUE2GREEN = {
  name: "Overlay (Negatives)",
  data: [
    [0, 0, 0, 1],
    [1, 0, 1, 0],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_HOTANDCOLD = {
  name: "Hot-and-Cold",
  data: [
    [0, 0, 0, 1],
    [0.15, 0, 1, 1],
    [0.3, 0, 1, 0],
    [0.45, 0, 0, 0],
    [0.5, 0, 0, 0],
    [0.55, 0, 0, 0],
    [0.7, 1, 1, 0],
    [0.85, 1, 0, 0],
    [1, 1, 1, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_GOLD = {
  name: "Gold",
  data: [
    [0, 0, 0, 0],
    [0.13, 0.19, 0.03, 0],
    [0.25, 0.39, 0.12, 0],
    [0.38, 0.59, 0.26, 0],
    [0.5, 0.8, 0.46, 0.08],
    [0.63, 0.99, 0.71, 0.21],
    [0.75, 0.99, 0.88, 0.34],
    [0.88, 0.99, 0.99, 0.48],
    [1, 0.9, 0.95, 0.61],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_RED2WHITE = {
  name: "Red Overlay",
  data: [
    [0, 0.75, 0, 0],
    [0.5, 1, 0.5, 0],
    [0.95, 1, 1, 0],
    [1, 1, 1, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_GREEN2WHITE = {
  name: "Green Overlay",
  data: [
    [0, 0, 0.75, 0],
    [0.5, 0.5, 1, 0],
    [0.95, 1, 1, 0],
    [1, 1, 1, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_BLUE2WHITE = {
  name: "Blue Overlay",
  data: [
    [0, 0, 0, 1],
    [0.5, 0, 0.5, 1],
    [0.95, 0, 1, 1],
    [1, 1, 1, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_DTI_SPECTRUM = {
  name: "Spectrum",
  data: [
    [0, 1, 0, 0],
    [0.5, 0, 1, 0],
    [1, 0, 0, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.TABLE_FIRE = {
  name: "Fire",
  data: [
    [0, 0, 0, 0],
    [0.06, 0, 0, 0.36],
    [0.16, 0.29, 0, 0.75],
    [0.22, 0.48, 0, 0.89],
    [0.31, 0.68, 0, 0.6],
    [0.37, 0.76, 0, 0.36],
    [0.5, 0.94, 0.31, 0],
    [0.56, 1, 0.45, 0],
    [0.81, 1, 0.91, 0],
    [0.88, 1, 1, 0.38],
    [1, 1, 1, 1],
  ],
  gradation: !0,
};
papaya.viewer.ColorTable.ARROW_ICON =
  "data:image/gif;base64,R0lGODlhCwARAPfGMf//////zP//mf//Zv//M///AP/M///MzP/Mmf/MZv/MM//MAP+Z//+ZzP+Zmf+ZZv+ZM/+ZAP9m//9mzP9mmf9mZv9mM/9mAP8z//8zzP8zmf8zZv8zM/8zAP8A//8AzP8Amf8AZv8AM/8AAMz//8z/zMz/mcz/Zsz/M8z/AMzM/8zMzMzMmczMZszMM8zMAMyZ/8yZzMyZmcyZZsyZM8yZAMxm/8xmzMxmmcxmZsxmM8xmAMwz/8wzzMwzmcwzZswzM8wzAMwA/8wAzMwAmcwAZswAM8wAAJn//5n/zJn/mZn/Zpn/M5n/AJnM/5nMzJnMmZnMZpnMM5nMAJmZ/5mZzJmZmZmZZpmZM5mZAJlm/5lmzJlmmZlmZplmM5lmAJkz/5kzzJkzmZkzZpkzM5kzAJkA/5kAzJkAmZkAZpkAM5kAAGb//2b/zGb/mWb/Zmb/M2b/AGbM/2bMzGbMmWbMZmbMM2bMAGaZ/2aZzGaZmWaZZmaZM2aZAGZm/2ZmzGZmmWZmZmZmM2ZmAGYz/2YzzGYzmWYzZmYzM2YzAGYA/2YAzGYAmWYAZmYAM2YAADP//zP/zDP/mTP/ZjP/MzP/ADPM/zPMzDPMmTPMZjPMMzPMADOZ/zOZzDOZmTOZZjOZMzOZADNm/zNmzDNmmTNmZjNmMzNmADMz/zMzzDMzmTMzZjMzMzMzADMA/zMAzDMAmTMAZjMAMzMAAAD//wD/zAD/mQD/ZgD/MwD/AADM/wDMzADMmQDMZgDMMwDMAACZ/wCZzACZmQCZZgCZMwCZAABm/wBmzABmmQBmZgBmMwBmAAAz/wAzzAAzmQAzZgAzMwAzAAAA/wAAzAAAmQAAZgAAM+4AAN0AALsAAKoAAIgAAHcAAFUAAEQAACIAABEAAADuAADdAAC7AACqAACIAAB3AABVAABEAAAiAAARAAAA7gAA3QAAuwAAqgAAiAAAdwAAVQAARAAAIgAAEe7u7t3d3bu7u6qqqoiIiHd3d1VVVURERCIiIhEREQAAACH5BAEAAMYALAAAAAALABEAAAg/AI0JFGhvoEGC+vodRKgv4UF7DSMqZBixoUKIFSv2w5jRIseOGztK/JgxpMiEJDWmHHkSZUuTIvvt60ezps2AADs=";
papaya.viewer.ColorTable.ARROW_ICON_WIDTH = 11;
papaya.viewer.ColorTable.DEFAULT_COLOR_TABLE =
  papaya.viewer.ColorTable.TABLE_GRAYSCALE;
papaya.viewer.ColorTable.PARAMETRIC_COLOR_TABLES = [
  papaya.viewer.ColorTable.TABLE_RED2YELLOW,
  papaya.viewer.ColorTable.TABLE_BLUE2GREEN,
];
papaya.viewer.ColorTable.OVERLAY_COLOR_TABLES = [
  papaya.viewer.ColorTable.TABLE_RED2WHITE,
  papaya.viewer.ColorTable.TABLE_GREEN2WHITE,
  papaya.viewer.ColorTable.TABLE_BLUE2WHITE,
];
papaya.viewer.ColorTable.TABLE_ALL = [
  papaya.viewer.ColorTable.TABLE_GRAYSCALE,
  papaya.viewer.ColorTable.TABLE_SPECTRUM,
  papaya.viewer.ColorTable.TABLE_FIRE,
  papaya.viewer.ColorTable.TABLE_HOTANDCOLD,
  papaya.viewer.ColorTable.TABLE_GOLD,
  papaya.viewer.ColorTable.TABLE_RED2YELLOW,
  papaya.viewer.ColorTable.TABLE_BLUE2GREEN,
  papaya.viewer.ColorTable.TABLE_RED2WHITE,
  papaya.viewer.ColorTable.TABLE_GREEN2WHITE,
  papaya.viewer.ColorTable.TABLE_BLUE2WHITE,
];
papaya.viewer.ColorTable.LUT_MIN = 0;
papaya.viewer.ColorTable.LUT_MAX = 255;
papaya.viewer.ColorTable.ICON_SIZE = 18;
papaya.viewer.ColorTable.COLOR_BAR_WIDTH = 100;
papaya.viewer.ColorTable.COLOR_BAR_HEIGHT = 15;
papaya.viewer.ColorTable.findLUT = function (a) {
  var b;
  for (b = 0; b < papaya.viewer.ColorTable.TABLE_ALL.length; b += 1)
    if (papaya.viewer.ColorTable.TABLE_ALL[b].name == a)
      return papaya.viewer.ColorTable.TABLE_ALL[b];
  return papaya.viewer.ColorTable.TABLE_GRAYSCALE;
};
papaya.viewer.ColorTable.addCustomLUT = function (a) {
  papaya.viewer.ColorTable.findLUT(a.name).data ===
    papaya.viewer.ColorTable.TABLE_GRAYSCALE.data &&
    papaya.viewer.ColorTable.TABLE_ALL.push(a);
};
papaya.viewer.ColorTable.prototype.updateMinLUT = function (a) {
  this.updateLUT(a, this.maxLUT);
};
papaya.viewer.ColorTable.prototype.updateMaxLUT = function (a) {
  this.updateLUT(this.minLUT, a);
};
papaya.viewer.ColorTable.prototype.updateLUT = function (a, b) {
  this.maxLUT = b;
  this.minLUT = a;
  b = this.maxLUT - this.minLUT;
  for (a = 0; a < this.lutData.length; a += 1)
    this.knotThresholds[a] = this.lutData[a][0] * b + this.minLUT;
  for (a = 0; a < this.lutData.length - 1; a += 1)
    this.knotRangeRatios[a] =
      papaya.viewer.ColorTable.LUT_MAX /
      (this.knotThresholds[a + 1] - this.knotThresholds[a]);
  for (a = 0; 256 > a; a += 1)
    if (a <= this.minLUT)
      (this.LUTarrayR[a] = this.knotMin[1] * papaya.viewer.ColorTable.LUT_MAX),
        (this.LUTarrayG[a] =
          this.knotMin[2] * papaya.viewer.ColorTable.LUT_MAX),
        (this.LUTarrayB[a] =
          this.knotMin[3] * papaya.viewer.ColorTable.LUT_MAX);
    else if (a > this.maxLUT)
      (this.LUTarrayR[a] = this.knotMax[1] * papaya.viewer.ColorTable.LUT_MAX),
        (this.LUTarrayG[a] =
          this.knotMax[2] * papaya.viewer.ColorTable.LUT_MAX),
        (this.LUTarrayB[a] =
          this.knotMax[3] * papaya.viewer.ColorTable.LUT_MAX);
    else
      for (b = 0; b < this.lutData.length - 1; b += 1)
        if (a > this.knotThresholds[b] && a <= this.knotThresholds[b + 1])
          if (this.useGradation) {
            var c =
              ((a - this.knotThresholds[b]) * this.knotRangeRatios[b] + 0.5) /
              papaya.viewer.ColorTable.LUT_MAX;
            this.LUTarrayR[a] =
              ((1 - c) * this.lutData[b][1] + c * this.lutData[b + 1][1]) *
              papaya.viewer.ColorTable.LUT_MAX;
            this.LUTarrayG[a] =
              ((1 - c) * this.lutData[b][2] + c * this.lutData[b + 1][2]) *
              papaya.viewer.ColorTable.LUT_MAX;
            this.LUTarrayB[a] =
              ((1 - c) * this.lutData[b][3] + c * this.lutData[b + 1][3]) *
              papaya.viewer.ColorTable.LUT_MAX;
          } else
            (this.LUTarrayR[a] =
              this.lutData[b][1] * papaya.viewer.ColorTable.LUT_MAX),
              (this.LUTarrayG[a] =
                this.lutData[b][2] * papaya.viewer.ColorTable.LUT_MAX),
              (this.LUTarrayB[a] =
                this.lutData[b][3] * papaya.viewer.ColorTable.LUT_MAX);
};
papaya.viewer.ColorTable.prototype.lookupRed = function (a) {
  return 0 <= a && 256 > a ? this.LUTarrayR[a] & 255 : 0;
};
papaya.viewer.ColorTable.prototype.lookupGreen = function (a) {
  return 0 <= a && 256 > a ? this.LUTarrayG[a] & 255 : 0;
};
papaya.viewer.ColorTable.prototype.lookupBlue = function (a) {
  return 0 <= a && 256 > a ? this.LUTarrayB[a] & 255 : 0;
};
("use strict");
papaya = papaya || {};
papaya.viewer = papaya.viewer || {};
papaya.viewer.Display =
  papaya.viewer.Display ||
  function (a, b) {
    this.container = a;
    this.viewer = a.viewer;
    this.canvas = document.createElement("canvas");
    this.canvas.width = b;
    this.canvas.height = papaya.viewer.Display.SIZE;
    this.context = this.canvas.getContext("2d");
    this.canvas.style.padding = 0;
    this.canvas.style.margin = 0;
    this.canvas.style.border = "none";
    this.canvas.style.cursor = "default";
    this.tempCoord = new papaya.core.Coordinate(0, 0, 0);
    this.drawingError = !1;
    this.progressStartTime = this.progress = 0;
    this.progressTimeout = null;
    this.drawingProgress = !1;
    this.errorMessage = "";
    this.drawUninitializedDisplay();
  };
papaya.viewer.Display.SIZE = 50;
papaya.viewer.Display.MINI_LABELS_THRESH = 700;
papaya.viewer.Display.PADDING = 8;
papaya.viewer.Display.FONT_COLOR_WHITE = "white";
papaya.viewer.Display.FONT_COLOR_ORANGE = "rgb(182, 59, 0)";
papaya.viewer.Display.FONT_SIZE_COORDINATE_LABEL = 12;
papaya.viewer.Display.FONT_COLOR_COORDINATE_LABEL =
  papaya.viewer.Display.FONT_COLOR_WHITE;
papaya.viewer.Display.FONT_TYPE_COORDINATE_LABEL = "sans-serif";
papaya.viewer.Display.FONT_SIZE_COORDINATE_VALUE = 18;
papaya.viewer.Display.FONT_COLOR_COORDINATE_VALUE =
  papaya.viewer.Display.FONT_COLOR_ORANGE;
papaya.viewer.Display.FONT_TYPE_COORDINATE_VALUE = "sans-serif";
papaya.viewer.Display.PRECISION_COORDINATE_VALUE = 5;
papaya.viewer.Display.PRECISION_COORDINATE_MAX = 12;
papaya.viewer.Display.FONT_SIZE_IMAGE_VALUE = 20;
papaya.viewer.Display.FONT_COLOR_IMAGE_VALUE =
  papaya.viewer.Display.FONT_COLOR_WHITE;
papaya.viewer.Display.FONT_TYPE_IMAGE_VALUE = "sans-serif";
papaya.viewer.Display.PRECISION_IMAGE_VALUE = 9;
papaya.viewer.Display.PRECISION_IMAGE_MAX = 14;
papaya.viewer.Display.FONT_SIZE_ATLAS_MINI = 14;
papaya.viewer.Display.FONT_SIZE_ATLAS = 20;
papaya.viewer.Display.FONT_TYPE_ATLAS = "sans-serif";
papaya.viewer.Display.FONT_SIZE_MESSAGE_VALUE = 20;
papaya.viewer.Display.FONT_TYPE_MESSAGE_VALUE = "sans-serif";
papaya.viewer.Display.FONT_COLOR_MESSAGE = "rgb(200, 75, 25)";
papaya.viewer.Display.PROGRESS_LABEL_SUFFIX = ["...", "", ".", ".."];
papaya.viewer.Display.PROGRESS_LABEL_DEFAULT = "Loading";
papaya.viewer.Display.prototype.drawUninitializedDisplay = function () {
  this.context.fillStyle = "#000000";
  this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);
};
papaya.viewer.Display.prototype.canDraw = function () {
  return !(this.drawingError || this.drawingProgress);
};
papaya.viewer.Display.prototype.drawEmptyDisplay = function () {
  this.canDraw()
    ? (this.context.clearRect(0, 0, this.canvas.width, this.canvas.height),
      (this.context.fillStyle = "#000000"),
      this.context.fillRect(0, 0, this.canvas.width, this.canvas.height))
    : this.drawError && this.drawError(this.errorMessage);
};
papaya.viewer.Display.prototype.drawDisplay = function (a, b, c) {
  if (this.canDraw()) {
    var e = this.viewer.canvas.width / 600;
    var d = this.viewer.canvas.width / 2;
    var g = d / 5;
    var h = this.canvas.height;
    var n = 300 > d;
    "Mouse" !== this.container.preferences.atlasLocks &&
      ((a = this.viewer.currentCoord.x),
      (b = this.viewer.currentCoord.y),
      (c = this.viewer.currentCoord.z));
    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
    this.context.fillStyle = "#000000";
    this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);
    this.context.fillStyle = papaya.viewer.Display.FONT_COLOR_COORDINATE_LABEL;
    this.context.font =
      papaya.viewer.Display.FONT_SIZE_COORDINATE_LABEL +
      "px " +
      papaya.viewer.Display.FONT_TYPE_COORDINATE_LABEL;
    var q =
      papaya.viewer.Display.FONT_SIZE_COORDINATE_LABEL +
      0.75 * papaya.viewer.Display.PADDING;
    this.context.fillText("x", 1.5 * papaya.viewer.Display.PADDING, q);
    this.context.fillText("y", 1.5 * papaya.viewer.Display.PADDING + g, q);
    this.context.fillText("z", 1.5 * papaya.viewer.Display.PADDING + 2 * g, q);
    q +=
      papaya.viewer.Display.FONT_SIZE_COORDINATE_VALUE +
      papaya.viewer.Display.PADDING / 2;
    this.context.fillStyle = papaya.viewer.Display.FONT_COLOR_COORDINATE_VALUE;
    this.context.font =
      papaya.viewer.Display.FONT_SIZE_COORDINATE_VALUE -
      (n ? 2 : 0) +
      "px " +
      papaya.viewer.Display.FONT_TYPE_COORDINATE_VALUE;
    var t = this.viewer.getIndexAt(a, b, c);
    if (this.viewer.worldSpace) {
      var u = this.viewer.screenVolumes[0].volume.header.origin;
      var A = this.viewer.screenVolumes[0].volume.header.voxelDimensions;
      var G = Math.min(
        papaya.viewer.Display.PRECISION_COORDINATE_MAX,
        Math.round(papaya.viewer.Display.PRECISION_COORDINATE_VALUE * e)
      );
      this.context.fillText(
        parseFloat(((t.x - u.x) * A.xSize).toString().substr(0, G)),
        1.5 * papaya.viewer.Display.PADDING,
        q
      );
      this.context.fillText(
        parseFloat(((u.y - t.y) * A.ySize).toString().substr(0, G)),
        1.5 * papaya.viewer.Display.PADDING + g,
        q
      );
      this.context.fillText(
        parseFloat(((u.z - t.z) * A.zSize).toString().substr(0, G)),
        1.5 * papaya.viewer.Display.PADDING + 2 * g,
        q
      );
    } else
      this.context.fillText(
        Math.round(t.x).toString(),
        1.5 * papaya.viewer.Display.PADDING,
        q
      ),
        this.context.fillText(
          Math.round(t.y).toString(),
          1.5 * papaya.viewer.Display.PADDING + g,
          q
        ),
        this.context.fillText(
          Math.round(t.z).toString(),
          1.5 * papaya.viewer.Display.PADDING + 2 * g,
          q
        );
    this.viewer.currentScreenVolume.rgb ||
      this.viewer.currentScreenVolume.dti ||
      ((a = this.viewer.getCurrentValueAt(a, b, c)),
      (this.canvas.currentval = a.toString()),
      (q =
        h / 2 +
        papaya.viewer.Display.FONT_SIZE_IMAGE_VALUE / 2 -
        papaya.viewer.Display.PADDING / 2),
      (this.context.fillStyle = papaya.viewer.Display.FONT_COLOR_IMAGE_VALUE),
      (this.context.font =
        papaya.viewer.Display.FONT_SIZE_IMAGE_VALUE -
        (n ? 2 : 0) +
        "px " +
        papaya.viewer.Display.FONT_TYPE_IMAGE_VALUE),
      (G = Math.min(
        papaya.viewer.Display.PRECISION_IMAGE_MAX,
        Math.round(papaya.viewer.Display.PRECISION_IMAGE_VALUE * e)
      )),
      this.context.fillText(
        parseFloat(a.toString().substr(0, G)),
        2 * papaya.viewer.Display.PADDING + 3 * g,
        q
      ));
    if (
      this.viewer.atlas &&
      (!this.viewer.atlas.volume || this.viewer.atlas.volume.isLoaded)
    )
      if (
        (papaya.Container.atlasWorldSpace
          ? (this.viewer.getWorldCoordinateAtIndex(
              t.x,
              t.y,
              t.z,
              this.tempCoord
            ),
            (G = this.viewer.atlas.getLabelAtCoordinate(
              this.tempCoord.x,
              this.tempCoord.y,
              this.tempCoord.z,
              t.x,
              t.y,
              t.z
            )))
          : (G = this.viewer.atlas.getLabelAtCoordinate(
              t.x,
              t.y,
              t.z,
              t.x,
              t.y,
              t.z
            )),
        (e = G.length),
        (b = Math.ceil(this.viewer.atlas.maxLabels / 2)),
        300 > d && 2 <= e)
      )
        for (g = 0.75 * d, t = e - 1; 0 <= t; --t)
          (this.context.fillStyle =
            t === e - 2
              ? papaya.viewer.Display.FONT_COLOR_ORANGE
              : papaya.viewer.Display.FONT_COLOR_WHITE),
            (this.context.font =
              papaya.viewer.Display.FONT_SIZE_ATLAS_MINI +
              "px " +
              papaya.viewer.Display.FONT_TYPE_ATLAS),
            (a = this.context.measureText(G[t])),
            a.width > g - 2 * papaya.viewer.Display.PADDING &&
              (G[t] =
                G[t].substr(0, Math.round(G[t].length / 3)) +
                " ... " +
                G[t].substr(G[t].length - 3, 3)),
            t === e - 2
              ? this.context.fillText(
                  G[t],
                  d + 0.25 * d,
                  1.5 * papaya.viewer.Display.PADDING +
                    papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                )
              : t === e - 1 &&
                this.context.fillText(
                  G[t],
                  d + 0.25 * d,
                  papaya.viewer.Display.PADDING +
                    h / 2 +
                    papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                );
      else if (600 > d && 2 < e)
        for (g = d / 2, t = e - 1; 0 <= t; --t)
          (this.context.fillStyle =
            t < b
              ? papaya.viewer.Display.FONT_COLOR_ORANGE
              : papaya.viewer.Display.FONT_COLOR_WHITE),
            (this.context.font =
              papaya.viewer.Display.FONT_SIZE_ATLAS_MINI +
              "px " +
              papaya.viewer.Display.FONT_TYPE_ATLAS),
            (a = this.context.measureText(G[t])),
            a.width > g - 6 * papaya.viewer.Display.PADDING &&
              (G[t] =
                G[t].substr(0, Math.round(G[t].length / 3)) +
                " ... " +
                G[t].substr(G[t].length - 3, 3)),
            0 === t
              ? this.context.fillText(
                  G[t],
                  d + 5 * papaya.viewer.Display.PADDING,
                  1.5 * papaya.viewer.Display.PADDING +
                    papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                )
              : 1 === t
              ? this.context.fillText(
                  G[t],
                  d + 5 * papaya.viewer.Display.PADDING,
                  papaya.viewer.Display.PADDING +
                    h / 2 +
                    papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                )
              : 2 === t
              ? this.context.fillText(
                  G[t],
                  1.5 * d + 5 * papaya.viewer.Display.PADDING,
                  1.5 * papaya.viewer.Display.PADDING +
                    papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                )
              : 3 === t &&
                this.context.fillText(
                  G[t],
                  1.5 * d + 5 * papaya.viewer.Display.PADDING,
                  papaya.viewer.Display.PADDING +
                    h / 2 +
                    papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                );
      else if (800 > d && 3 < e)
        for (g = d / 3, t = 0; 4 > t; t += 1)
          2 > t
            ? ((this.context.fillStyle =
                t < b
                  ? papaya.viewer.Display.FONT_COLOR_ORANGE
                  : papaya.viewer.Display.FONT_COLOR_WHITE),
              (this.context.font =
                papaya.viewer.Display.FONT_SIZE_ATLAS_MINI +
                "px " +
                papaya.viewer.Display.FONT_TYPE_ATLAS),
              (a = this.context.measureText(G[t])),
              a.width > g - 6 * papaya.viewer.Display.PADDING &&
                (G[t] =
                  G[t].substr(0, Math.round(G[t].length / 3)) +
                  " ... " +
                  G[t].substr(G[t].length - 3, 3)),
              0 === t
                ? this.context.fillText(
                    G[t],
                    d + 5 * papaya.viewer.Display.PADDING,
                    1.5 * papaya.viewer.Display.PADDING +
                      papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                  )
                : 1 === t
                ? this.context.fillText(
                    G[t],
                    d + 5 * papaya.viewer.Display.PADDING,
                    papaya.viewer.Display.PADDING +
                      h / 2 +
                      papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                  )
                : 2 === t
                ? this.context.fillText(
                    G[t],
                    1.5 * d + 5 * papaya.viewer.Display.PADDING,
                    1.5 * papaya.viewer.Display.PADDING +
                      papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                  )
                : 3 === t &&
                  this.context.fillText(
                    G[t],
                    1.5 * d + 5 * papaya.viewer.Display.PADDING,
                    papaya.viewer.Display.PADDING +
                      h / 2 +
                      papaya.viewer.Display.FONT_SIZE_ATLAS_MINI / 2
                  ))
            : ((q =
                h / 2 +
                papaya.viewer.Display.FONT_SIZE_ATLAS / 2 -
                papaya.viewer.Display.PADDING / 2),
              (this.context.fillStyle =
                t < b
                  ? papaya.viewer.Display.FONT_COLOR_ORANGE
                  : papaya.viewer.Display.FONT_COLOR_WHITE),
              (this.context.font =
                papaya.viewer.Display.FONT_SIZE_ATLAS +
                "px " +
                papaya.viewer.Display.FONT_TYPE_ATLAS),
              (a = this.context.measureText(G[t])),
              a.width > g - 2 * papaya.viewer.Display.PADDING &&
                (G[t] =
                  G[t].substr(0, Math.round(G[t].length / 3)) +
                  " ... " +
                  G[t].substr(G[t].length - 3, 3)),
              2 === t
                ? this.context.fillText(
                    G[t],
                    d + papaya.viewer.Display.PADDING + g,
                    q
                  )
                : 3 === t &&
                  this.context.fillText(
                    G[t],
                    d + papaya.viewer.Display.PADDING + 2 * g,
                    q
                  ));
      else
        for (
          g = d / e,
            q =
              h / 2 +
              papaya.viewer.Display.FONT_SIZE_ATLAS / 2 -
              papaya.viewer.Display.PADDING / 2,
            t = 0;
          t < e;
          t += 1
        )
          (this.context.fillStyle =
            t < b
              ? papaya.viewer.Display.FONT_COLOR_ORANGE
              : papaya.viewer.Display.FONT_COLOR_WHITE),
            (this.context.font =
              papaya.viewer.Display.FONT_SIZE_ATLAS -
              (n ? 4 : 0) +
              "px " +
              papaya.viewer.Display.FONT_TYPE_ATLAS),
            (a = this.context.measureText(G[t])),
            a.width >
              g -
                2 * papaya.viewer.Display.PADDING -
                0.05 * d * Math.max(0, 3 - e) &&
              (G[t] =
                G[t].substr(0, Math.round(G[t].length / 3)) +
                " ... " +
                G[t].substr(G[t].length - 3, 3)),
            this.context.fillText(
              G[t],
              d +
                papaya.viewer.Display.PADDING +
                0.05 * d * Math.max(0, 3 - e) +
                t * g,
              q
            );
  } else this.drawError && this.drawError(this.errorMessage);
};
papaya.viewer.Display.prototype.drawError = function (a) {
  this.errorMessage = a;
  this.drawingError = !0;
  var b = this;
  window.setTimeout(
    papaya.utilities.ObjectUtils.bind(b, function () {
      b.drawingError = !1;
    }),
    3e3
  );
  this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
  this.context.fillStyle = "#000000";
  this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);
  this.context.fillStyle = "red";
  this.context.font =
    papaya.viewer.Display.FONT_SIZE_MESSAGE_VALUE +
    "px " +
    papaya.viewer.Display.FONT_TYPE_MESSAGE_VALUE;
  this.context.fillText(
    a,
    papaya.viewer.Display.PADDING,
    papaya.viewer.Display.FONT_SIZE_COORDINATE_LABEL +
      papaya.viewer.Display.PADDING +
      1.5 * papaya.viewer.Display.PADDING
  );
};
papaya.viewer.Display.prototype.drawProgress = function (a, b) {
  var c = Math.round(1e3 * a);
  if (c > this.progress)
    if (
      ((this.progress = c),
      (b = void 0 !== b ? b : papaya.viewer.Display.PROGRESS_LABEL_DEFAULT),
      (c =
        0 === this.progressStartTime
          ? (this.progressStartTime = new Date().getTime())
          : new Date().getTime()),
      (c = parseInt((c - this.progressStartTime) / 500, 10) % 4),
      990 <= this.progress)
    )
      this.progressTimeout &&
        (window.clearTimeout(this.progressTimeout),
        (this.progressTimeout = null)),
        (this.drawingProgress = !1),
        (this.progressStartTime = this.progress = 0),
        this.drawEmptyDisplay();
    else {
      this.progressTimeout && window.clearTimeout(this.progressTimeout);
      var e = this;
      this.progressTimeout = window.setTimeout(
        papaya.utilities.ObjectUtils.bind(e, function () {
          e.drawingProgress = !1;
        }),
        3e3
      );
      this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
      this.context.fillStyle = "#fff";
      this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);
      this.context.fillStyle = "#000";
      this.context.fillRect(0, 0, this.canvas.width * a, this.canvas.height);
      this.context.font =
        papaya.viewer.Display.FONT_SIZE_MESSAGE_VALUE +
        "px " +
        papaya.viewer.Display.FONT_TYPE_MESSAGE_VALUE;
      this.context.fillStyle = papaya.viewer.Display.FONT_COLOR_MESSAGE;
      a =
        papaya.viewer.Display.FONT_SIZE_COORDINATE_LABEL +
        papaya.viewer.Display.PADDING +
        1.5 * papaya.viewer.Display.PADDING;
      this.context.fillText(
        b + papaya.viewer.Display.PROGRESS_LABEL_SUFFIX[c],
        2 * papaya.viewer.Display.PADDING,
        a
      );
    }
};
("use strict");
papaya = papaya || {};
papaya.volume = papaya.volume || {};
papaya.viewer.Preferences =
  papaya.viewer.Preferences ||
  function () {
    this.viewer = null;
    this.showCrosshairs = papaya.viewer.Preferences.DEFAULT_SHOW_CROSSHAIRS;
    this.atlasLocks = papaya.viewer.Preferences.DEFAULT_ATLAS_LOCKS;
    this.showOrientation = papaya.viewer.Preferences.DEFAULT_SHOW_ORIENTATION;
    this.scrollBehavior = papaya.viewer.Preferences.DEFAULT_SCROLL;
    this.smoothDisplay = papaya.viewer.Preferences.DEFAULT_SMOOTH_DISPLAY;
    this.radiological = papaya.viewer.Preferences.DEFAULT_RADIOLOGICAL;
    this.showRuler = papaya.viewer.Preferences.DEFAULT_SHOW_RULER;
    this.surfaceBackgroundColor =
      papaya.viewer.Preferences.DEFAULT_SURFACE_BACKGROUND_COLOR;
    this.showSurfacePlanes =
      papaya.viewer.Preferences.DEFAULT_SHOW_SURFACE_PLANES;
    this.showSurfaceCrosshairs =
      papaya.viewer.Preferences.DEFAULT_SHOW_SURFACE_CROSSHAIRS;
    this.showVolumeBoundaries =
      papaya.viewer.Preferences.DEFAULT_SHOW_VOLUME_BOUNDARIES;
    this.showSurfaceBoundaries =
      papaya.viewer.Preferences.DEFAULT_SHOW_SURFACE_BOUNDARIES;
    this.minRange = papaya.viewer.Preferences.DEFAULT_MIN_RANGE;
    this.maxRange = papaya.viewer.Preferences.DEFAULT_MAX_RANGE;
    for (var a in papaya.viewer.Preferences.CUSTOM_PREFS)
      papaya.viewer.Preferences.CUSTOM_PREFS.hasOwnProperty(a) &&
        (this[a] = papaya.viewer.Preferences.CUSTOM_PREFS[a]);
  };
papaya.viewer.Preferences.CUSTOM_PREFS = {};
papaya.viewer.Preferences.ALL_PREFS =
  "showCrosshairs atlasLocks showOrientation scrollBehavior smoothDisplay radiological showRuler surfaceBackgroundColor showSurfacePlanes showVolumeBoundaries showSurfaceBoundaries minRange maxRange".split(
    " "
  );
papaya.viewer.Preferences.COOKIE_PREFIX = "papaya-";
papaya.viewer.Preferences.COOKIE_EXPIRY_DAYS = 365;
papaya.viewer.Preferences.DEFAULT_SHOW_CROSSHAIRS = "Yes";
papaya.viewer.Preferences.DEFAULT_ATLAS_LOCKS = "Mouse";
papaya.viewer.Preferences.DEFAULT_SHOW_ORIENTATION = "No";
papaya.viewer.Preferences.DEFAULT_SCROLL = "Increment Slice";
papaya.viewer.Preferences.DEFAULT_SMOOTH_DISPLAY = "Yes";
papaya.viewer.Preferences.DEFAULT_RADIOLOGICAL = "No";
papaya.viewer.Preferences.DEFAULT_SHOW_RULER = "No";
papaya.viewer.Preferences.DEFAULT_SURFACE_BACKGROUND_COLOR = "Gray";
papaya.viewer.Preferences.DEFAULT_SHOW_SURFACE_PLANES = "Yes";
papaya.viewer.Preferences.DEFAULT_SHOW_SURFACE_CROSSHAIRS = "Yes";
papaya.viewer.Preferences.DEFAULT_SHOW_VOLUME_BOUNDARIES = "No";
papaya.viewer.Preferences.DEFAULT_SHOW_SURFACE_BOUNDARIES = "Yes";
papaya.viewer.Preferences.DEFAULT_MIN_RANGE = 3.28;
papaya.viewer.Preferences.DEFAULT_MAX_RANGE = 10;
papaya.viewer.Preferences.prototype.updatePreference = function (a, b) {
  this[a] = b;
  this.viewer.drawViewer(!0);
  papaya.utilities.UrlUtils.createCookie(
    papaya.viewer.Preferences.COOKIE_PREFIX + a,
    b,
    papaya.viewer.Preferences.COOKIE_EXPIRY_DAYS
  );
};
papaya.viewer.Preferences.prototype.readPreferences = function () {
  var a, b;
  for (a = 0; a < papaya.viewer.Preferences.ALL_PREFS.length; a += 1)
    (b = papaya.utilities.UrlUtils.readCookie(
      papaya.viewer.Preferences.COOKIE_PREFIX +
        papaya.viewer.Preferences.ALL_PREFS[a]
    )) && (this[papaya.viewer.Preferences.ALL_PREFS[a]] = b);
};
("use strict");
papaya = papaya || {};
papaya.viewer = papaya.viewer || {};
papaya.viewer.ScreenSlice =
  papaya.viewer.ScreenSlice ||
  function (a, b, c, e, d, g, h, n) {
    this.screenVolumes = h;
    this.sliceDirection = b;
    this.currentSlice = -1;
    this.xDim = c;
    this.yDim = e;
    this.xSize = d;
    this.ySize = g;
    this.canvasMain = document.createElement("canvas");
    this.canvasMain.width = this.xDim;
    this.canvasMain.height = this.yDim;
    this.contextMain = this.canvasMain.getContext("2d");
    this.imageDataDraw = this.contextMain.createImageData(this.xDim, this.yDim);
    this.screenDim = this.screenOffsetY = this.screenOffsetX = 0;
    this.screenTransform = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.zoomTransform = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.finalTransform = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.radiologicalTransform = [
      [-1, 0, this.xDim],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.tempTransform = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.tempTransform2 = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.screenTransform2 = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.finalTransform2 = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.imageData = [];
    this.imageData2 = [];
    this.manager = n;
    this.rulerPoints = [
      new papaya.core.Point(parseInt(0.25 * c), parseInt(0.25 * e)),
      new papaya.core.Point(parseInt(0.75 * c), parseInt(0.75 * e)),
    ];
    this.tempPoint = new papaya.core.Point();
    this.contextDTILines = this.canvasDTILines = null;
  };
papaya.viewer.ScreenSlice.DIRECTION_UNKNOWN = 0;
papaya.viewer.ScreenSlice.DIRECTION_AXIAL = 1;
papaya.viewer.ScreenSlice.DIRECTION_CORONAL = 2;
papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL = 3;
papaya.viewer.ScreenSlice.DIRECTION_TEMPORAL = 4;
papaya.viewer.ScreenSlice.DIRECTION_SURFACE = 5;
papaya.viewer.ScreenSlice.SCREEN_PIXEL_MAX = 255;
papaya.viewer.ScreenSlice.SCREEN_PIXEL_MIN = 0;
papaya.viewer.ScreenSlice.GRAB_RADIUS = 5;
papaya.viewer.ScreenSlice.DTI_COLORS = ["#ff0000", "#00ff00", "#0000ff"];
papaya.viewer.ScreenSlice.prototype.updateSlice = function (a, b) {
  var c,
    e,
    d,
    g = !1,
    h = 0,
    n = !1,
    q = this.manager.isWorldMode();
  a = Math.round(a);
  var t =
    this.manager.isRadiologicalMode() && this.isRadiologicalSensitive()
      ? -1
      : 1;
  if (b || this.currentSlice !== a) {
    this.currentSlice = a;
    b = this.screenVolumes[0].volume.header.origin;
    var u = this.screenVolumes[0].volume.header.voxelDimensions;
    this.contextMain.clearRect(
      0,
      0,
      this.canvasMain.width,
      this.canvasMain.height
    );
    this.contextDTILines &&
      this.contextDTILines.clearRect(0, 0, this.screenDim, this.screenDim);
    this.imageData.length < this.screenVolumes.length &&
      ((this.imageData = papaya.utilities.ArrayUtils.createArray(
        this.screenVolumes.length,
        this.xDim * this.yDim
      )),
      (this.imageData2 = papaya.utilities.ArrayUtils.createArray(
        this.screenVolumes.length,
        1
      )));
    for (c = 0; c < this.screenVolumes.length; c += 1)
      if (!this.screenVolumes[c].hidden) {
        var A = this.screenVolumes[c].currentTimepoint;
        var G = this.screenVolumes[c].rgb;
        var O = this.screenVolumes[c].dti;
        var H = this.screenVolumes[c].dtiLines;
        n |= !H;
        var P = this.screenVolumes[c].dtiColors;
        var U = this.screenVolumes[c].dtiAlphaFactor;
        var ha = 0 === c || this.screenVolumes[c].interpolation;
        ha &= "Yes" === this.manager.container.preferences.smoothDisplay;
        H &&
          (this.updateDTILinesImage(),
          (this.contextDTILines.lineWidth = 1),
          P ||
            ((this.contextDTILines.strokeStyle =
              papaya.viewer.ScreenSlice.DTI_COLORS[h]),
            (h += 1),
            (h %= 3),
            this.contextDTILines.beginPath()));
        for (e = 0; e < this.yDim; e += 1)
          for (d = 0; d < this.xDim; d += 1) {
            var w = 0;
            var I = 255;
            var aa = this.screenVolumes[c].alpha;
            if (G) {
              this.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
                ? (w = this.screenVolumes[c].volume.getVoxelAtIndex(
                    d,
                    e,
                    a,
                    A,
                    !0
                  ))
                : this.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_CORONAL
                ? (w = this.screenVolumes[c].volume.getVoxelAtIndex(
                    d,
                    a,
                    e,
                    A,
                    !0
                  ))
                : this.sliceDirection ===
                    papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                  (w = this.screenVolumes[c].volume.getVoxelAtIndex(
                    a,
                    d,
                    e,
                    A,
                    !0
                  ));
              var T = 4 * (e * this.xDim + d);
              this.imageData[c][T] = w;
              this.imageDataDraw.data[T] = (w >> 16) & 255;
              this.imageDataDraw.data[T + 1] = (w >> 8) & 255;
              this.imageDataDraw.data[T + 2] = w & 255;
              this.imageDataDraw.data[T + 3] = I;
            } else if (O) {
              if (q) {
                if (
                  this.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_AXIAL
                ) {
                  var ka = (d - b.x) * u.xSize;
                  var k = (b.y - e) * u.ySize;
                  var X = (b.z - a) * u.zSize;
                } else
                  this.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_CORONAL
                    ? ((ka = (d - b.x) * u.xSize),
                      (k = (b.y - a) * u.ySize),
                      (X = (b.z - e) * u.zSize))
                    : this.sliceDirection ===
                        papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                      ((ka = (a - b.x) * u.xSize),
                      (k = (b.y - d) * u.ySize),
                      (X = (b.z - e) * u.zSize));
                var V = this.screenVolumes[c].volume.getVoxelAtCoordinate(
                  ka,
                  k,
                  X,
                  0,
                  !ha
                );
                var p = this.screenVolumes[c].volume.getVoxelAtCoordinate(
                  ka,
                  k,
                  X,
                  1,
                  !ha
                );
                var m = this.screenVolumes[c].volume.getVoxelAtCoordinate(
                  ka,
                  k,
                  X,
                  2,
                  !ha
                );
                this.screenVolumes[c].dtiVolumeMod &&
                  (aa = Math.min(
                    1,
                    this.screenVolumes[c].dtiVolumeMod.getVoxelAtCoordinate(
                      ka,
                      k,
                      X,
                      0,
                      !ha
                    )
                  ));
              } else
                this.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_AXIAL
                  ? ((ka = d * u.xSize), (k = e * u.ySize), (X = a * u.zSize))
                  : this.sliceDirection ===
                    papaya.viewer.ScreenSlice.DIRECTION_CORONAL
                  ? ((ka = d * u.xSize), (k = a * u.ySize), (X = e * u.zSize))
                  : this.sliceDirection ===
                      papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                    ((ka = a * u.xSize), (k = d * u.ySize), (X = e * u.zSize)),
                  (V = this.screenVolumes[c].volume.getVoxelAtMM(
                    ka,
                    k,
                    X,
                    0,
                    !ha
                  )),
                  (p = this.screenVolumes[c].volume.getVoxelAtMM(
                    ka,
                    k,
                    X,
                    1,
                    !ha
                  )),
                  (m = this.screenVolumes[c].volume.getVoxelAtMM(
                    ka,
                    k,
                    X,
                    2,
                    !ha
                  )),
                  this.screenVolumes[c].dtiVolumeMod &&
                    (aa = Math.min(
                      1,
                      this.screenVolumes[c].dtiVolumeMod.getVoxelAtMM(
                        ka,
                        k,
                        X,
                        0,
                        !ha
                      )
                    ));
              T = 4 * (e * this.xDim + d);
              if (H)
                if (0 !== V || 0 !== p || 0 !== m) {
                  if (
                    this.sliceDirection ===
                    papaya.viewer.ScreenSlice.DIRECTION_AXIAL
                  ) {
                    var F = Math.atan2(t * p, V);
                    var r = Math.acos(
                      Math.abs(m) / Math.sqrt(V * V + p * p + m * m)
                    );
                  } else
                    this.sliceDirection ===
                    papaya.viewer.ScreenSlice.DIRECTION_CORONAL
                      ? ((F = Math.atan2(t * m, V)),
                        (r = Math.acos(
                          Math.abs(p) / Math.sqrt(V * V + p * p + m * m)
                        )))
                      : this.sliceDirection ===
                          papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                        ((F = Math.atan2(m, p)),
                        (r = Math.acos(
                          Math.abs(V) / Math.sqrt(V * V + p * p + m * m)
                        )));
                  r = 1 - r / 1.5708;
                  V = papayaRoundFast(Math.abs(255 * V));
                  p = papayaRoundFast(Math.abs(255 * p));
                  m = papayaRoundFast(Math.abs(255 * m));
                  w = papayaRoundFast(255 * aa);
                  w =
                    ((w & 255) << 24) |
                    ((V & 255) << 16) |
                    ((p & 255) << 8) |
                    (m & 255);
                  P &&
                    (this.contextDTILines.beginPath(),
                    (I = w & 16777215),
                    (this.contextDTILines.strokeStyle =
                      "#" +
                      papaya.utilities.StringUtils.pad(I.toString(16), 6)));
                  this.imageData[c][T] = F;
                  this.imageData2[c][T] = w;
                  aa = Math.sin(F);
                  w = Math.cos(F);
                  T =
                    this.finalTransform2[0][2] +
                    (d + 0.5) * this.finalTransform2[0][0];
                  I =
                    this.finalTransform2[1][2] +
                    (e + 0.5) * this.finalTransform2[1][1];
                  p =
                    this.finalTransform2[0][2] +
                    (d + 0.5 * r) * this.finalTransform2[0][0];
                  m =
                    this.finalTransform2[1][2] +
                    (e + 0.5) * this.finalTransform2[1][1];
                  V = w * (p - T) - aa * (m - I) + T;
                  p = aa * (p - T) + w * (m - I) + I;
                  this.contextDTILines.moveTo(V, p);
                  p =
                    this.finalTransform2[0][2] +
                    (d + 1 - 0.5 * r) * this.finalTransform2[0][0];
                  m =
                    this.finalTransform2[1][2] +
                    (e + 0.5) * this.finalTransform2[1][1];
                  V = w * (p - T) - aa * (m - I) + T;
                  T = aa * (p - T) + w * (m - I) + I;
                  this.contextDTILines.lineTo(V, T);
                  P && this.contextDTILines.stroke();
                } else this.imageData[c][T] = Number.NaN;
              else
                (aa = 0 !== V || 0 !== p || 0 !== m ? 1 - (1 - aa) * U : 0),
                  (V = papayaRoundFast(Math.abs(255 * V))),
                  (p = papayaRoundFast(Math.abs(255 * p))),
                  (m = papayaRoundFast(Math.abs(255 * m))),
                  (w = papayaRoundFast(255 * aa)),
                  (this.imageData[c][T] =
                    ((w & 255) << 24) |
                    ((V & 255) << 16) |
                    ((p & 255) << 8) |
                    (m & 255)),
                  g
                    ? ((this.imageDataDraw.data[T] =
                        this.imageDataDraw.data[T] * (1 - aa) + (V & 255) * aa),
                      (this.imageDataDraw.data[T + 1] =
                        this.imageDataDraw.data[T + 1] * (1 - aa) +
                        (p & 255) * aa),
                      (this.imageDataDraw.data[T + 2] =
                        this.imageDataDraw.data[T + 2] * (1 - aa) +
                        (m & 255) * aa),
                      (this.imageDataDraw.data[T + 3] = I))
                    : ((this.imageDataDraw.data[T] = V & 255),
                      (this.imageDataDraw.data[T + 1] = p & 255),
                      (this.imageDataDraw.data[T + 2] = m & 255),
                      (this.imageDataDraw.data[T + 3] = w & 255));
            } else
              (q
                ? this.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_AXIAL
                  ? (w = this.screenVolumes[c].volume.getVoxelAtCoordinate(
                      (d - b.x) * u.xSize,
                      (b.y - e) * u.ySize,
                      (b.z - a) * u.zSize,
                      A,
                      !ha
                    ))
                  : this.sliceDirection ===
                    papaya.viewer.ScreenSlice.DIRECTION_CORONAL
                  ? (w = this.screenVolumes[c].volume.getVoxelAtCoordinate(
                      (d - b.x) * u.xSize,
                      (b.y - a) * u.ySize,
                      (b.z - e) * u.zSize,
                      A,
                      !ha
                    ))
                  : this.sliceDirection ===
                      papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                    (w = this.screenVolumes[c].volume.getVoxelAtCoordinate(
                      (a - b.x) * u.xSize,
                      (b.y - d) * u.ySize,
                      (b.z - e) * u.zSize,
                      A,
                      !ha
                    ))
                : this.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_AXIAL
                ? (w = this.screenVolumes[c].volume.getVoxelAtMM(
                    d * u.xSize,
                    e * u.ySize,
                    a * u.zSize,
                    A,
                    !ha
                  ))
                : this.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_CORONAL
                ? (w = this.screenVolumes[c].volume.getVoxelAtMM(
                    d * u.xSize,
                    a * u.ySize,
                    e * u.zSize,
                    A,
                    !ha
                  ))
                : this.sliceDirection ===
                    papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                  (w = this.screenVolumes[c].volume.getVoxelAtMM(
                    a * u.xSize,
                    d * u.ySize,
                    e * u.zSize,
                    A,
                    !ha
                  )),
              (T = 4 * (e * this.xDim + d)),
              (V = w),
              (this.imageData[c][T] = w),
              (!this.screenVolumes[c].negative &&
                w <= this.screenVolumes[c].screenMin) ||
              (this.screenVolumes[c].negative &&
                w >= this.screenVolumes[c].screenMin) ||
              isNaN(w)
                ? ((w = papaya.viewer.ScreenSlice.SCREEN_PIXEL_MIN),
                  (I = this.screenVolumes[c].isOverlay() ? 0 : 255))
                : (w =
                    (!this.screenVolumes[c].negative &&
                      w >= this.screenVolumes[c].screenMax) ||
                    (this.screenVolumes[c].negative &&
                      w <= this.screenVolumes[c].screenMax)
                      ? papaya.viewer.ScreenSlice.SCREEN_PIXEL_MAX
                      : papayaRoundFast(
                          (w - this.screenVolumes[c].screenMin) *
                            this.screenVolumes[c].screenRatio
                        )),
              g)
                ? 0 < I &&
                  ((this.imageDataDraw.data[T] =
                    this.imageDataDraw.data[T] * (1 - aa) +
                    this.screenVolumes[c].colorTable.lookupRed(w, V) * aa),
                  (this.imageDataDraw.data[T + 1] =
                    this.imageDataDraw.data[T + 1] * (1 - aa) +
                    this.screenVolumes[c].colorTable.lookupGreen(w, V) * aa),
                  (this.imageDataDraw.data[T + 2] =
                    this.imageDataDraw.data[T + 2] * (1 - aa) +
                    this.screenVolumes[c].colorTable.lookupBlue(w, V) * aa),
                  (this.imageDataDraw.data[T + 3] = I))
                : ((this.imageDataDraw.data[T] =
                    this.screenVolumes[c].colorTable.lookupRed(w, V) * aa),
                  (this.imageDataDraw.data[T + 1] =
                    this.screenVolumes[c].colorTable.lookupGreen(w, V) * aa),
                  (this.imageDataDraw.data[T + 2] =
                    this.screenVolumes[c].colorTable.lookupBlue(w, V) * aa),
                  (this.imageDataDraw.data[T + 3] = I));
          }
        P || this.contextDTILines.stroke();
        H || (g = !0);
      }
    n && this.contextMain.putImageData(this.imageDataDraw, 0, 0);
  }
};
papaya.viewer.ScreenSlice.prototype.repaint = function (a, b, c) {
  var e, d;
  b = 0;
  var g;
  c = 0;
  var h = !1;
  this.currentSlice = a = Math.round(a);
  this.contextMain.clearRect(
    0,
    0,
    this.canvasMain.width,
    this.canvasMain.height
  );
  this.contextDTILines &&
    this.contextDTILines.clearRect(0, 0, this.screenDim, this.screenDim);
  if (this.imageData.length === this.screenVolumes.length) {
    for (a = 0; a < this.screenVolumes.length; a += 1)
      if (!this.screenVolumes[a].hidden) {
        var n = this.screenVolumes[a].rgb;
        var q = this.screenVolumes[a].dti;
        var t = this.screenVolumes[a].dtiLines;
        var u = this.screenVolumes[a].dtiColors;
        t &&
          ((this.contextDTILines.lineWidth = 1),
          u ||
            ((this.contextDTILines.strokeStyle =
              papaya.viewer.ScreenSlice.DTI_COLORS[c]),
            (c += 1),
            (c %= 3),
            this.contextDTILines.beginPath()));
        for (e = 0; e < this.yDim; e += 1)
          for (d = 0; d < this.xDim; d += 1) {
            var A = this.imageData[a][b];
            var G = 255;
            var O = this.screenVolumes[a].alpha;
            b = 4 * (e * this.xDim + d);
            if (n)
              (this.imageDataDraw.data[b] = (A >> 16) & 255),
                (this.imageDataDraw.data[b + 1] = (A >> 8) & 255),
                (this.imageDataDraw.data[b + 2] = A & 255),
                (this.imageDataDraw.data[b + 3] = G);
            else if (q)
              if (t) {
                if (((G = this.imageData[a][b]), !isNaN(G))) {
                  A = this.imageData2[a][b];
                  var H = (A >> 16) & 255;
                  var P = (A >> 8) & 255;
                  var U = A & 255;
                  O = A & 16777215;
                  this.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_AXIAL
                    ? (g = Math.acos(
                        Math.abs(U) / Math.sqrt(H * H + P * P + U * U)
                      ))
                    : this.sliceDirection ===
                      papaya.viewer.ScreenSlice.DIRECTION_CORONAL
                    ? (g = Math.acos(
                        Math.abs(P) / Math.sqrt(H * H + P * P + U * U)
                      ))
                    : this.sliceDirection ===
                        papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                      (g = Math.acos(
                        Math.abs(H) / Math.sqrt(H * H + P * P + U * U)
                      ));
                  g = 1 - g / 1.5708;
                  u &&
                    (this.contextDTILines.beginPath(),
                    (this.contextDTILines.strokeStyle =
                      "#" +
                      papaya.utilities.StringUtils.pad(O.toString(16), 6)));
                  A = Math.sin(G);
                  H = Math.cos(G);
                  O =
                    this.finalTransform2[0][2] +
                    (d + 0.5) * this.finalTransform2[0][0];
                  G =
                    this.finalTransform2[1][2] +
                    (e + 0.5) * this.finalTransform2[1][1];
                  U =
                    this.finalTransform2[0][2] +
                    (d + 0.5 * g) * this.finalTransform2[0][0];
                  var ha =
                    this.finalTransform2[1][2] +
                    (e + 0.5) * this.finalTransform2[1][1];
                  P = H * (U - O) - A * (ha - G) + O;
                  U = A * (U - O) + H * (ha - G) + G;
                  this.contextDTILines.moveTo(P, U);
                  U =
                    this.finalTransform2[0][2] +
                    (d + 1 - 0.5 * g) * this.finalTransform2[0][0];
                  ha =
                    this.finalTransform2[1][2] +
                    (e + 0.5) * this.finalTransform2[1][1];
                  P = H * (U - O) - A * (ha - G) + O;
                  A = A * (U - O) + H * (ha - G) + G;
                  this.contextDTILines.lineTo(P, A);
                  u && this.contextDTILines.stroke();
                }
              } else
                (A = this.imageData[a][b]),
                  (O = A & 16777215),
                  (O = 0 !== O ? ((A >> 24) & 255) / 255 : 0),
                  h
                    ? ((this.imageDataDraw.data[b] =
                        this.imageDataDraw.data[b] * (1 - O) +
                        ((A >> 16) & 255) * O),
                      (this.imageDataDraw.data[b + 1] =
                        this.imageDataDraw.data[b + 1] * (1 - O) +
                        ((A >> 8) & 255) * O),
                      (this.imageDataDraw.data[b + 2] =
                        this.imageDataDraw.data[b + 2] * (1 - O) +
                        (A & 255) * O),
                      (this.imageDataDraw.data[b + 3] = G))
                    : ((this.imageDataDraw.data[b] = (A >> 16) & 255),
                      (this.imageDataDraw.data[b + 1] = (A >> 8) & 255),
                      (this.imageDataDraw.data[b + 2] = A & 255),
                      (this.imageDataDraw.data[b + 3] = (A >> 24) & 255));
            else
              ((H = A = this.imageData[a][b]),
              (!this.screenVolumes[a].negative &&
                A <= this.screenVolumes[a].screenMin) ||
              (this.screenVolumes[a].negative &&
                A >= this.screenVolumes[a].screenMin) ||
              isNaN(A)
                ? ((A = papaya.viewer.ScreenSlice.SCREEN_PIXEL_MIN),
                  (G = this.screenVolumes[a].isOverlay() ? 0 : 255))
                : (A =
                    (!this.screenVolumes[a].negative &&
                      A >= this.screenVolumes[a].screenMax) ||
                    (this.screenVolumes[a].negative &&
                      A <= this.screenVolumes[a].screenMax)
                      ? papaya.viewer.ScreenSlice.SCREEN_PIXEL_MAX
                      : papayaRoundFast(
                          (A - this.screenVolumes[a].screenMin) *
                            this.screenVolumes[a].screenRatio
                        )),
              h)
                ? 0 < G &&
                  ((this.imageDataDraw.data[b] =
                    this.imageDataDraw.data[b] * (1 - O) +
                    this.screenVolumes[a].colorTable.lookupRed(A, H) * O),
                  (this.imageDataDraw.data[b + 1] =
                    this.imageDataDraw.data[b + 1] * (1 - O) +
                    this.screenVolumes[a].colorTable.lookupGreen(A, H) * O),
                  (this.imageDataDraw.data[b + 2] =
                    this.imageDataDraw.data[b + 2] * (1 - O) +
                    this.screenVolumes[a].colorTable.lookupBlue(A, H) * O),
                  (this.imageDataDraw.data[b + 3] = G))
                : ((this.imageDataDraw.data[b] =
                    this.screenVolumes[a].colorTable.lookupRed(A, H) * O),
                  (this.imageDataDraw.data[b + 1] =
                    this.screenVolumes[a].colorTable.lookupGreen(A, H) * O),
                  (this.imageDataDraw.data[b + 2] =
                    this.screenVolumes[a].colorTable.lookupBlue(A, H) * O),
                  (this.imageDataDraw.data[b + 3] = G));
          }
        u || this.contextDTILines.stroke();
        t || (h = !0);
      }
    this.contextMain.putImageData(this.imageDataDraw, 0, 0);
  } else this.updateSlice(a, !0);
};
papaya.viewer.ScreenSlice.prototype.getRealWidth = function () {
  return this.xDim * this.xSize;
};
papaya.viewer.ScreenSlice.prototype.getRealHeight = function () {
  return this.yDim * this.ySize;
};
papaya.viewer.ScreenSlice.prototype.getXYratio = function () {
  return this.xSize / this.ySize;
};
papaya.viewer.ScreenSlice.prototype.getYXratio = function () {
  return this.ySize / this.xSize;
};
papaya.viewer.ScreenSlice.prototype.getXSize = function () {
  return this.xSize;
};
papaya.viewer.ScreenSlice.prototype.getYSize = function () {
  return this.ySize;
};
papaya.viewer.ScreenSlice.prototype.getXDim = function () {
  return this.xDim;
};
papaya.viewer.ScreenSlice.prototype.getYDim = function () {
  return this.yDim;
};
papaya.viewer.ScreenSlice.prototype.updateZoomTransform = function (
  a,
  b,
  c,
  e,
  d,
  g
) {
  b = (b + 0.5) * (a - 1) * -1;
  c = (c + 0.5) * (a - 1) * -1;
  e = b + e * (a - 1);
  var h = -1 * (a - 1) * this.xDim;
  0 < e ? (e = 0) : e < h && (e = h);
  d = c + d * (a - 1);
  h = -1 * (a - 1) * this.yDim;
  0 < d ? (d = 0) : d < h && (d = h);
  1 < a &&
    (this.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
      ? ((g.panAmountX = Math.round((e - b) / (a - 1))),
        (g.panAmountY = Math.round((d - c) / (a - 1))))
      : this.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
      ? ((g.panAmountX = Math.round((e - b) / (a - 1))),
        (g.panAmountZ = Math.round((d - c) / (a - 1))))
      : this.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
        ((g.panAmountY = Math.round((e - b) / (a - 1))),
        (g.panAmountZ = Math.round((d - c) / (a - 1)))));
  this.zoomTransform[0][0] = a;
  this.zoomTransform[0][1] = 0;
  this.zoomTransform[0][2] = e;
  this.zoomTransform[1][0] = 0;
  this.zoomTransform[1][1] = a;
  this.zoomTransform[1][2] = d;
  this.updateFinalTransform();
};
papaya.viewer.ScreenSlice.prototype.updateFinalTransform = function () {
  var a, b;
  if (this.manager.isRadiologicalMode() && this.isRadiologicalSensitive()) {
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.tempTransform[a][b] = this.screenTransform[a][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.tempTransform2[a][b] =
          this.tempTransform[a][0] * this.radiologicalTransform[0][b] +
          this.tempTransform[a][1] * this.radiologicalTransform[1][b] +
          this.tempTransform[a][2] * this.radiologicalTransform[2][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.finalTransform[a][b] =
          this.tempTransform2[a][0] * this.zoomTransform[0][b] +
          this.tempTransform2[a][1] * this.zoomTransform[1][b] +
          this.tempTransform2[a][2] * this.zoomTransform[2][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.tempTransform[a][b] = this.screenTransform2[a][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.tempTransform2[a][b] =
          this.tempTransform[a][0] * this.radiologicalTransform[0][b] +
          this.tempTransform[a][1] * this.radiologicalTransform[1][b] +
          this.tempTransform[a][2] * this.radiologicalTransform[2][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.finalTransform2[a][b] =
          this.tempTransform2[a][0] * this.zoomTransform[0][b] +
          this.tempTransform2[a][1] * this.zoomTransform[1][b] +
          this.tempTransform2[a][2] * this.zoomTransform[2][b];
  } else {
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.finalTransform[a][b] =
          this.screenTransform[a][0] * this.zoomTransform[0][b] +
          this.screenTransform[a][1] * this.zoomTransform[1][b] +
          this.screenTransform[a][2] * this.zoomTransform[2][b];
    for (a = 0; 3 > a; a += 1)
      for (b = 0; 3 > b; b += 1)
        this.finalTransform2[a][b] =
          this.screenTransform2[a][0] * this.zoomTransform[0][b] +
          this.screenTransform2[a][1] * this.zoomTransform[1][b] +
          this.screenTransform2[a][2] * this.zoomTransform[2][b];
  }
};
papaya.viewer.ScreenSlice.prototype.isRadiologicalSensitive = function () {
  return (
    this.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_AXIAL ||
    this.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
  );
};
papaya.viewer.ScreenSlice.prototype.findProximalRulerHandle = function (a, b) {
  this.tempPoint.x = a;
  this.tempPoint.y = b;
  return papaya.utilities.MathUtils.lineDistance(
    this.tempPoint.x,
    this.tempPoint.y,
    this.rulerPoints[0].x,
    this.rulerPoints[0].y
  ) < papaya.viewer.ScreenSlice.GRAB_RADIUS
    ? this.rulerPoints[0]
    : papaya.utilities.MathUtils.lineDistance(
        this.tempPoint.x,
        this.tempPoint.y,
        this.rulerPoints[1].x,
        this.rulerPoints[1].y
      ) < papaya.viewer.ScreenSlice.GRAB_RADIUS
    ? this.rulerPoints[1]
    : null;
};
papaya.viewer.ScreenSlice.prototype.updateDTILinesImage = function () {
  if (
    null === this.canvasDTILines ||
    this.canvasDTILines.width !== this.screenDim
  )
    (this.canvasDTILines = document.createElement("canvas")),
      (this.canvasDTILines.width = this.screenDim),
      (this.canvasDTILines.height = this.screenDim),
      (this.contextDTILines = this.canvasDTILines.getContext("2d"));
};
papaya.viewer.ScreenSlice.prototype.clearDTILinesImage = function () {
  this.contextDTILines = this.canvasDTILines = null;
};
("use strict");
papaya = papaya || {};
papaya.viewer = papaya.viewer || {};
papaya.viewer.ScreenVolume =
  papaya.viewer.ScreenVolume ||
  function (a, b, c, e, d, g) {
    this.volume = a;
    this.lutName = c;
    this.colorTable = new papaya.viewer.ColorTable(this.lutName, e);
    this.screenMin = this.volume.header.imageRange.displayMin;
    this.screenMax = this.volume.header.imageRange.displayMax;
    this.imageMin = this.volume.header.imageRange.imageMin;
    this.imageMax = this.volume.header.imageRange.imageMax;
    this.alpha = 1;
    this.currentTimepoint = 0;
    this.parametric = void 0 !== d && d;
    this.negativeScreenVol = null;
    this.dtiLines = this.dti = !1;
    this.dtiColors = !0;
    this.dtiVolumeMod = null;
    this.dtiAlphaFactor = 1;
    this.rgb =
      this.volume.header.imageType.datatype ===
      papaya.volume.ImageType.DATATYPE_RGB;
    this.hasCheckedImageRange = !1;
    this.interpolation = !0;
    this.error = null;
    this.hidden = !1;
    this.rotationZ = this.rotationY = this.rotationX = 0.5;
    this.rotationAbout = "Rotate About Center";
    this.isHighResSlice =
      262144 < this.volume.header.imageDimensions.getNumVoxelsSlice();
    this.currentCoord = g;
    this.seriesLabels = this.volume.getSeriesLabels();
    this.staticIcon = null;
    (a = b[this.volume.fileName])
      ? (a.icon && (this.staticIcon = a.icon),
        void 0 !== a.interpolation && (this.interpolation = a.interpolation),
        void 0 !== a.dti &&
          ((this.dti = a.dti) &&
            3 !== this.volume.numTimepoints &&
            (this.error = Error(
              "DTI vector series must have 3 series points!"
            )),
          this.dti &&
            ((this.dtiLines = a.dtiLines),
            (this.dtiColors = a.dtiColors),
            this.dtiLines || this.dtiColors || (this.dtiColors = !0),
            this.initDTI())),
        void 0 !== a.min && void 0 !== a.max
          ? d
            ? ((this.screenMin = -1 * Math.abs(a.min)),
              (this.screenMax = -1 * Math.abs(a.max)))
            : ((this.screenMin = a.min), (this.screenMax = a.max))
          : this.findDisplayRange(d, a),
        d
          ? void 0 !== a.negative_lut &&
            ((this.lutName = a.negative_lut),
            (this.colorTable = new papaya.viewer.ColorTable(this.lutName, e)))
          : void 0 !== a.lut &&
            ("string" === typeof a.lut || a.lut instanceof String
              ? ((this.lutName = a.lut),
                (this.colorTable = new papaya.viewer.ColorTable(
                  this.lutName,
                  e
                )))
              : ((this.lutName = "Object"), (this.colorTable = a.lut))),
        void 0 === a.alpha || e || (this.alpha = a.alpha),
        a.labels && !this.seriesLabels && (this.seriesLabels = a.labels),
        e &&
          (void 0 !== a.rotation &&
            a.rotation.length &&
            3 === a.rotation.length &&
            ((this.rotationX =
              (Math.min(Math.max(a.rotation[0], -90), 90) + 90) / 180),
            (this.rotationY =
              (Math.min(Math.max(a.rotation[1], -90), 90) + 90) / 180),
            (this.rotationZ =
              (Math.min(Math.max(a.rotation[2], -90), 90) + 90) / 180)),
          a.rotationPoint &&
            ("origin" === a.rotationPoint.toLowerCase()
              ? (this.rotationAbout = "Rotate About Origin")
              : "crosshairs" === a.rotationPoint.toLowerCase()
              ? (this.rotationAbout = "Rotate About Crosshairs")
              : (this.rotationAbout = "Rotate About Center")),
          this.updateTransform()))
      : this.findDisplayRange(d, {});
    this.negative = !1;
    this.updateScreenRange();
    this.canvasIcon = document.createElement("canvas");
    this.canvasIcon.width = papaya.viewer.ColorTable.ICON_SIZE;
    this.canvasIcon.height = papaya.viewer.ColorTable.ICON_SIZE;
    this.contextIcon = this.canvasIcon.getContext("2d");
    this.imageDataIcon = this.contextIcon.createImageData(
      papaya.viewer.ColorTable.ICON_SIZE,
      papaya.viewer.ColorTable.ICON_SIZE
    );
    this.icon = null;
    this.canvasBar = document.createElement("canvas");
    this.canvasBar.width = papaya.viewer.ColorTable.COLOR_BAR_WIDTH;
    this.canvasBar.height = papaya.viewer.ColorTable.COLOR_BAR_HEIGHT;
    this.contextBar = this.canvasBar.getContext("2d");
    this.imageDataBar = this.contextBar.createImageData(
      papaya.viewer.ColorTable.COLOR_BAR_WIDTH,
      papaya.viewer.ColorTable.COLOR_BAR_HEIGHT
    );
    this.colorBar = null;
    this.originalScreenMin = this.screenMin;
    this.originalScreenMax = this.screenMax;
    this.updateIcon();
    this.updateColorBar();
  };
papaya.viewer.ScreenVolume.makeSolidIcon = function (a, b, c) {
  var e = document.createElement("canvas");
  e.width = papaya.viewer.ColorTable.ICON_SIZE;
  e.height = papaya.viewer.ColorTable.ICON_SIZE;
  var d = e.getContext("2d");
  d.fillStyle =
    "rgb(" +
    parseInt(255 * a, 10) +
    "," +
    parseInt(255 * b, 10) +
    "," +
    parseInt(255 * c, 10) +
    ")";
  d.fillRect(
    0,
    0,
    papaya.viewer.ColorTable.ICON_SIZE,
    papaya.viewer.ColorTable.ICON_SIZE
  );
  return e.toDataURL();
};
papaya.viewer.ScreenVolume.makeStaticIcon = function (a, b, c) {
  var e = new Image(
      papaya.viewer.ColorTable.ICON_SIZE,
      papaya.viewer.ColorTable.ICON_SIZE
    ),
    d = document.createElement("canvas");
  d.width = papaya.viewer.ColorTable.ICON_SIZE;
  d.height = papaya.viewer.ColorTable.ICON_SIZE;
  var g = d.getContext("2d");
  e.onload = function () {
    g.drawImage(
      e,
      0,
      0,
      e.naturalWidth,
      e.naturalHeight,
      0,
      0,
      papaya.viewer.ColorTable.ICON_SIZE,
      papaya.viewer.ColorTable.ICON_SIZE
    );
    b(d.toDataURL(), c);
  };
  e.src = a;
};
papaya.viewer.ScreenVolume.prototype.setScreenRange = function (a, b) {
  this.negative
    ? (0 < a && (a = 0), 0 < b && (b = 0))
    : this.negativeScreenVol && (0 > a && (a = 0), 0 > b && (b = 0));
  this.screenMin = a;
  this.screenMax = b;
  this.updateScreenRange();
};
papaya.viewer.ScreenVolume.prototype.resetScreenRange = function () {
  this.screenMin = this.originalScreenMin;
  this.screenMax = this.originalScreenMax;
  this.updateScreenRange();
};
papaya.viewer.ScreenVolume.prototype.setScreenRangeNegatives = function (a, b) {
  this.negativeScreenVol.setScreenRange(a, b);
};
papaya.viewer.ScreenVolume.prototype.updateScreenRange = function () {
  this.screenRatio =
    papaya.viewer.ScreenSlice.SCREEN_PIXEL_MAX /
    (this.screenMax - this.screenMin);
  this.negative = this.screenMax < this.screenMin;
};
papaya.viewer.ScreenVolume.prototype.isOverlay = function () {
  return !this.colorTable.isBaseImage;
};
papaya.viewer.ScreenVolume.prototype.findImageRange = function () {
  var a, b, c;
  if (
    this.volume.header.imageRange.imageMin ===
      this.volume.header.imageRange.imageMax &&
    !this.hasCheckedImageRange
  ) {
    this.hasCheckedImageRange = !0;
    var e = Number.MAX_VALUE;
    var d = Number.MIN_VALUE;
    var g = this.volume.header.imageDimensions.xDim;
    var h = this.volume.header.imageDimensions.yDim;
    var n = this.volume.header.imageDimensions.zDim;
    for (a = 0; a < n; a += 1)
      for (b = 0; b < h; b += 1)
        for (c = 0; c < g; c += 1) {
          var q = this.volume.getVoxelAtIndexNative(c, b, a, 0, !0);
          q > d && (d = q);
          q < e && (e = q);
        }
    this.volume.header.imageRange.imageMin = this.imageMin = e;
    this.volume.header.imageRange.imageMax = this.imageMax = d;
  }
};
papaya.viewer.ScreenVolume.prototype.findDisplayRange = function (a, b) {
  var c =
    this.volume.header.imageRange.imageMin !==
    this.volume.header.imageRange.imageMax;
  var e = this.screenMin;
  var d = this.screenMax;
  if (a && Math.abs(e) > Math.abs(d)) {
    var g = d;
    d = e;
    e = g;
  }
  if (a || (void 0 === b.minPercent && void 0 === b.maxPercent))
    if (this.isOverlay()) {
      if (
        e === d ||
        (0 > e && 0 < d) ||
        (0 < e && 0 > d) ||
        (a && (0 < e || 0 < d)) ||
        b.symmetric
      )
        this.findImageRange(),
          a
            ? b.symmetric || 0 === this.imageMin
              ? ((e = -1 * (this.imageMax - 0.75 * this.imageMax)),
                (d = -1 * (this.imageMax - 0.25 * this.imageMax)))
              : ((e = this.imageMin - 0.75 * this.imageMin),
                (d = this.imageMin - 0.25 * this.imageMin))
            : ((e = this.imageMax - 0.75 * this.imageMax),
              (d = this.imageMax - 0.25 * this.imageMax));
      (1 > e && -1 < e && 1 > d && -1 < d) ||
        ((e = Math.round(e)), (d = Math.round(d)));
    } else
      (1 > e && -1 < e && 1 > d && -1 < d) ||
        ((e = Math.round(e)), (d = Math.round(d))),
        0 === e &&
          0 === d &&
          (this.findImageRange(), (e = this.imageMin), (d = this.imageMax)),
        d <= e &&
          (this.findImageRange(), (e = this.imageMin), (d = this.imageMax)),
        c && e < this.imageMin && (this.findImageRange(), (e = this.imageMin)),
        c && d > this.imageMax && (this.findImageRange(), (d = this.imageMax));
  else
    this.findImageRange(),
      (e =
        void 0 !== b.minPercent ? this.imageMax * b.minPercent : this.imageMin),
      (d =
        void 0 !== b.maxPercent ? this.imageMax * b.maxPercent : this.imageMax);
  this.screenMin = e;
  this.screenMax = d;
};
papaya.viewer.ScreenVolume.prototype.isUsingColorTable = function (a) {
  return this.lutName === a;
};
papaya.viewer.ScreenVolume.prototype.isRotatingAbout = function (a) {
  return this.rotationAbout === a;
};
papaya.viewer.ScreenVolume.prototype.changeColorTable = function (a, b) {
  this.colorTable = new papaya.viewer.ColorTable(b, !this.isOverlay());
  this.lutName = b;
  this.updateIcon();
  this.updateColorBar();
  a.drawViewer(!0);
};
papaya.viewer.ScreenVolume.prototype.getRange = function () {
  var a = Array(2);
  a[0] =
    this.colorTable.minLUT / (255 / (this.screenMax - this.screenMin)) +
    this.screenMin;
  a[1] =
    this.colorTable.maxLUT / (255 / (this.screenMax - this.screenMin)) +
    this.screenMin;
  return a;
};
papaya.viewer.ScreenVolume.prototype.getRangeNegative = function () {
  return this.negativeScreenVol.getRange();
};
papaya.viewer.ScreenVolume.prototype.getAlphaNegative = function () {
  return this.negativeScreenVol.alpha;
};
papaya.viewer.ScreenVolume.prototype.incrementTimepoint = function () {
  var a = this.volume.numTimepoints;
  this.currentTimepoint += 1;
  this.currentTimepoint >= a && (this.currentTimepoint = a - 1);
};
papaya.viewer.ScreenVolume.prototype.decrementTimepoint = function () {
  --this.currentTimepoint;
  0 > this.currentTimepoint && (this.currentTimepoint = 0);
};
papaya.viewer.ScreenVolume.prototype.setTimepoint = function (a) {
  this.currentTimepoint =
    0 > a
      ? 0
      : a >= this.volume.numTimepoints
      ? this.volume.numTimepoints - 1
      : a;
};
papaya.viewer.ScreenVolume.prototype.updateMinLUT = function (a) {
  this.colorTable.updateMinLUT(a);
};
papaya.viewer.ScreenVolume.prototype.updateMaxLUT = function (a) {
  this.colorTable.updateMaxLUT(a);
};
papaya.viewer.ScreenVolume.prototype.updateLUT = function (a, b) {
  this.colorTable.updateLUT(a, b);
};
papaya.viewer.ScreenVolume.prototype.supportsDynamicColorTable = function () {
  return (
    void 0 !== this.colorTable.updateMinLUT &&
    void 0 !== this.colorTable.updateMaxLUT &&
    void 0 !== this.colorTable.updateLUT
  );
};
papaya.viewer.ScreenVolume.prototype.resetDynamicRange = function () {
  this.colorTable.minLUT = 0;
  this.colorTable.maxLUT = papaya.viewer.ColorTable.LUT_MAX;
  this.updateLUT(this.colorTable.minLUT, this.colorTable.maxLUT);
  this.updateColorBar();
};
papaya.viewer.ScreenVolume.prototype.getCurrentTime = function () {
  return (
    this.currentTimepoint *
    this.volume.header.voxelDimensions.timeSize *
    this.volume.header.voxelDimensions.getTemporalUnitMultiplier()
  );
};
papaya.viewer.ScreenVolume.prototype.setCurrentTime = function (a) {
  var b =
    this.volume.header.voxelDimensions.timeSize *
    this.volume.header.voxelDimensions.getTemporalUnitMultiplier();
  0 === b
    ? this.setTimepoint(0)
    : this.setTimepoint(parseInt(Math.round(a / b), 10));
};
papaya.viewer.ScreenVolume.prototype.hasError = function () {
  return null !== this.error;
};
papaya.viewer.ScreenVolume.prototype.initDTI = function () {
  this.volume.numTimepoints = 1;
  this.volume.header.imageDimensions.timepoints = 1;
  this.colorTable = new papaya.viewer.ColorTable(
    this.lutName,
    !1,
    papaya.viewer.ColorTable.TABLE_DTI_SPECTRUM
  );
  this.volume.transform.voxelValue.forceABS = !this.dtiLines;
  this.updateIcon();
};
papaya.viewer.ScreenVolume.prototype.isDTILines = function () {
  return this.dtiLines && !this.dtiColors;
};
papaya.viewer.ScreenVolume.prototype.isDTIRGB = function () {
  return !this.dtiLines && this.dtiColors;
};
papaya.viewer.ScreenVolume.prototype.isDTILinesAndRGB = function () {
  return this.dtiLines && this.dtiColors;
};
papaya.viewer.ScreenVolume.prototype.getHiddenLabel = function () {
  return this.hidden ? "Show Overlay" : "Hide Overlay";
};
papaya.viewer.ScreenVolume.prototype.updateIcon = function () {
  var a, b;
  if (this.staticIcon) {
    var c = this;
    papaya.viewer.ScreenVolume.makeStaticIcon(this.staticIcon, function (h) {
      c.icon = h;
    });
  } else if (this.imageDataIcon) {
    var e =
      papaya.viewer.ColorTable.LUT_MAX / papaya.viewer.ColorTable.ICON_SIZE;
    for (a = 0; a < papaya.viewer.ColorTable.ICON_SIZE; a += 1)
      for (b = 0; b < papaya.viewer.ColorTable.ICON_SIZE; b += 1) {
        var d = 4 * (a * papaya.viewer.ColorTable.ICON_SIZE + b);
        var g = Math.round(b * e);
        this.imageDataIcon.data[d] = this.colorTable.lookupRed(g);
        this.imageDataIcon.data[d + 1] = this.colorTable.lookupGreen(g);
        this.imageDataIcon.data[d + 2] = this.colorTable.lookupBlue(g);
        this.imageDataIcon.data[d + 3] = 255;
      }
    this.contextIcon.putImageData(this.imageDataIcon, 0, 0);
    this.icon = this.canvasIcon.toDataURL();
  }
};
papaya.viewer.ScreenVolume.prototype.updateColorBar = function () {
  var a, b;
  if (this.imageDataBar) {
    var c =
      papaya.viewer.ColorTable.LUT_MAX /
      papaya.viewer.ColorTable.COLOR_BAR_WIDTH;
    for (a = 0; a < papaya.viewer.ColorTable.COLOR_BAR_HEIGHT; a += 1)
      for (b = 0; b < papaya.viewer.ColorTable.COLOR_BAR_WIDTH; b += 1) {
        var e = 4 * (a * papaya.viewer.ColorTable.COLOR_BAR_WIDTH + b);
        var d = Math.round(b * c);
        this.imageDataBar.data[e] = this.colorTable.lookupRed(d);
        this.imageDataBar.data[e + 1] = this.colorTable.lookupGreen(d);
        this.imageDataBar.data[e + 2] = this.colorTable.lookupBlue(d);
        this.imageDataBar.data[e + 3] = 255;
      }
    this.contextBar.putImageData(this.imageDataBar, 0, 0);
    this.colorBar = this.canvasBar.toDataURL();
  }
};
papaya.viewer.ScreenVolume.prototype.updateTransform = function () {
  var a = 180 * (this.rotationX - 0.5),
    b = 180 * (this.rotationY - 0.5),
    c = 180 * (this.rotationZ - 0.5);
  var e = this.volume;
  try {
    e = papayaContainers[0].viewer.screenVolumes[0].volume || this.volume;
  } catch (h) {}
  if (this.volume === e)
    if ("Rotate About Origin" === this.rotationAbout) {
      var d =
        this.volume.header.origin.x * this.volume.header.voxelDimensions.xSize;
      var g =
        this.volume.header.origin.y * this.volume.header.voxelDimensions.ySize;
      e =
        this.volume.header.origin.z * this.volume.header.voxelDimensions.zSize;
    } else
      "Rotate About Crosshairs" === this.rotationAbout
        ? ((d = this.currentCoord.x * this.volume.header.voxelDimensions.xSize),
          (g = this.currentCoord.y * this.volume.header.voxelDimensions.ySize),
          (e = this.currentCoord.z * this.volume.header.voxelDimensions.zSize))
        : ((d =
            (this.volume.header.imageDimensions.xDim / 2) *
            this.volume.header.voxelDimensions.xSize),
          (g =
            (this.volume.header.imageDimensions.yDim / 2) *
            this.volume.header.voxelDimensions.ySize),
          (e =
            (this.volume.header.imageDimensions.zDim / 2) *
            this.volume.header.voxelDimensions.zSize));
  else
    (d = e.transform.centerMatInverse[0][3]),
      (g = e.transform.centerMatInverse[1][3]),
      (e = e.transform.centerMatInverse[2][3]);
  this.volume.transform.updateImageMat(d, g, e, a, b, c);
};
papaya.viewer.ScreenVolume.prototype.resetTransform = function () {
  this.rotationZ = this.rotationY = this.rotationX = 0.5;
};
("use strict");
papaya = papaya || {};
papaya.viewer = papaya.viewer || {};
var PAPAYA_BUILD_NUM = PAPAYA_BUILD_NUM || "0";
papaya.viewer.Viewer =
  papaya.viewer.Viewer ||
  function (a, b, c, e) {
    this.container = a;
    this.canvas = document.createElement("canvas");
    this.canvas.width = b;
    this.canvas.height = c;
    this.context = this.canvas.getContext("2d");
    this.canvas.style.padding = 0;
    this.canvas.style.margin = 0;
    this.canvas.style.border = "none";
    this.atlas = null;
    this.pageLoaded = this.initialized = !1;
    this.loadingVolume = null;
    this.volume = new papaya.volume.Volume(this.container.display, this);
    this.screenVolumes = [];
    this.surfaces = [];
    this.lowerImageTop =
      this.lowerImageBot =
      this.lowerImageBot2 =
      this.mainImage =
      this.selectedSlice =
      this.surfaceView =
      this.sagittalSlice =
      this.coronalSlice =
      this.axialSlice =
      this.currentScreenVolume =
        null;
    this.viewerDim = 0;
    this.ignoreSync = this.worldSpace = !1;
    this.currentCoord = new papaya.core.Coordinate(0, 0, 0);
    this.cursorPosition = new papaya.core.Coordinate(0, 0, 0);
    this.draggingSliceDir = this.longestDimSize = this.longestDim = 0;
    this.isLongTouch =
      this.didLongTouch =
      this.isPanning =
      this.isContextMode =
      this.isZoomMode =
      this.isWindowControl =
      this.isDragging =
        !1;
    this.zoomFactorPrevious = this.zoomFactor =
      papaya.viewer.Viewer.ZOOM_FACTOR_MIN;
    this.panAmountZ =
      this.panAmountY =
      this.panAmountX =
      this.panLocZ =
      this.panLocY =
      this.panLocX =
      this.zoomLocZ =
      this.zoomLocY =
      this.zoomLocX =
        0;
    this.keyPressIgnored = !1;
    this.previousMousePosition = new papaya.core.Point();
    this.isShiftKeyDown = this.isAltKeyDown = this.isControlKeyDown = !1;
    this.toggleMainCrosshairs = !0;
    this.bgColor = null;
    this.loadingDTI = this.controlsHidden = this.hasSeries = !1;
    this.loadingDTIModRef = null;
    this.tempCoor = new papaya.core.Coordinate();
    this.listenerContextMenu = function (d) {
      d.preventDefault();
      return !1;
    };
    this.listenerMouseMove = papaya.utilities.ObjectUtils.bind(
      this,
      this.mouseMoveEvent
    );
    this.listenerMouseDown = papaya.utilities.ObjectUtils.bind(
      this,
      this.mouseDownEvent
    );
    this.listenerMouseOut = papaya.utilities.ObjectUtils.bind(
      this,
      this.mouseOutEvent
    );
    this.listenerMouseLeave = papaya.utilities.ObjectUtils.bind(
      this,
      this.mouseLeaveEvent
    );
    this.listenerMouseUp = papaya.utilities.ObjectUtils.bind(
      this,
      this.mouseUpEvent
    );
    this.listenerMouseDoubleClick = papaya.utilities.ObjectUtils.bind(
      this,
      this.mouseDoubleClickEvent
    );
    this.listenerKeyDown = papaya.utilities.ObjectUtils.bind(
      this,
      this.keyDownEvent
    );
    this.listenerKeyUp = papaya.utilities.ObjectUtils.bind(
      this,
      this.keyUpEvent
    );
    this.listenerTouchMove = papaya.utilities.ObjectUtils.bind(
      this,
      this.touchMoveEvent
    );
    this.listenerTouchStart = papaya.utilities.ObjectUtils.bind(
      this,
      this.touchStartEvent
    );
    this.listenerTouchEnd = papaya.utilities.ObjectUtils.bind(
      this,
      this.touchEndEvent
    );
    this.initialCoordinate = null;
    this.listenerScroll = papaya.utilities.ObjectUtils.bind(
      this,
      this.scrolled
    );
    this.updateTimerEvent = this.updateTimer = this.longTouchTimer = null;
    this.drawEmptyViewer();
    this.processParams(e);
  };
papaya.viewer.Viewer.GAP = PAPAYA_SPACING;
papaya.viewer.Viewer.BACKGROUND_COLOR = "rgba(0, 0, 0, 255)";
papaya.viewer.Viewer.CROSSHAIRS_COLOR = "rgba(28, 134, 238, 255)";
papaya.viewer.Viewer.KEYCODE_ROTATE_VIEWS = 32;
papaya.viewer.Viewer.KEYCODE_CENTER = 67;
papaya.viewer.Viewer.KEYCODE_ORIGIN = 79;
papaya.viewer.Viewer.KEYCODE_ARROW_UP = 38;
papaya.viewer.Viewer.KEYCODE_ARROW_DOWN = 40;
papaya.viewer.Viewer.KEYCODE_ARROW_RIGHT = 39;
papaya.viewer.Viewer.KEYCODE_ARROW_LEFT = 37;
papaya.viewer.Viewer.KEYCODE_PAGE_UP = 33;
papaya.viewer.Viewer.KEYCODE_PAGE_DOWN = 34;
papaya.viewer.Viewer.KEYCODE_SINGLE_QUOTE = 222;
papaya.viewer.Viewer.KEYCODE_FORWARD_SLASH = 191;
papaya.viewer.Viewer.KEYCODE_INCREMENT_MAIN = 71;
papaya.viewer.Viewer.KEYCODE_DECREMENT_MAIN = 86;
papaya.viewer.Viewer.KEYCODE_TOGGLE_CROSSHAIRS = 65;
papaya.viewer.Viewer.KEYCODE_SERIES_BACK = 188;
papaya.viewer.Viewer.KEYCODE_SERIES_FORWARD = 190;
papaya.viewer.Viewer.KEYCODE_RULER = 82;
papaya.viewer.Viewer.MAX_OVERLAYS = 8;
papaya.viewer.Viewer.ORIENTATION_MARKER_SUPERIOR = "S";
papaya.viewer.Viewer.ORIENTATION_MARKER_INFERIOR = "I";
papaya.viewer.Viewer.ORIENTATION_MARKER_ANTERIOR = "A";
papaya.viewer.Viewer.ORIENTATION_MARKER_POSTERIOR = "P";
papaya.viewer.Viewer.ORIENTATION_MARKER_LEFT = "L";
papaya.viewer.Viewer.ORIENTATION_MARKER_RIGHT = "R";
papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE = 16;
papaya.viewer.Viewer.ORIENTATION_CERTAINTY_UNKNOWN_COLOR = "red";
papaya.viewer.Viewer.ORIENTATION_CERTAINTY_LOW_COLOR = "yellow";
papaya.viewer.Viewer.ORIENTATION_CERTAINTY_HIGH_COLOR = "white";
papaya.viewer.Viewer.UPDATE_TIMER_INTERVAL = 250;
papaya.viewer.Viewer.ZOOM_FACTOR_MAX = 10;
papaya.viewer.Viewer.ZOOM_FACTOR_MIN = 1;
papaya.viewer.Viewer.MOUSE_SCROLL_THRESHLD = 0.25;
papaya.viewer.Viewer.TITLE_MAX_LENGTH = 30;
papaya.viewer.Viewer.validDimBounds = function (a, b) {
  return a < b ? a : b - 1;
};
papaya.viewer.Viewer.getKeyCode = function (a) {
  return a.keyCode || a.charCode;
};
papaya.viewer.Viewer.isControlKey = function (a) {
  a = papaya.viewer.Viewer.getKeyCode(a);
  return "MacOS" !== papaya.utilities.PlatformUtils.os ||
    (91 !== a && 93 !== a && 224 !== a)
    ? "MacOS" !== papaya.utilities.PlatformUtils.os && 17 === a
    : !0;
};
papaya.viewer.Viewer.isAltKey = function (a) {
  return 18 === papaya.viewer.Viewer.getKeyCode(a);
};
papaya.viewer.Viewer.isShiftKey = function (a) {
  a = !!a.shiftKey;
  !a && window.event && (a = !!window.event.shiftKey);
  return a;
};
papaya.viewer.Viewer.getOffsetRect = function (a) {
  a = a.getBoundingClientRect();
  var b = document.body,
    c = document.documentElement;
  return {
    top: Math.round(
      a.top +
        (window.pageYOffset || c.scrollTop) -
        (c.clientTop || b.clientTop || 0)
    ),
    left: Math.round(
      a.left +
        (window.pageXOffset || c.scrollLeft) -
        (c.clientLeft || b.clientLeft || 0)
    ),
  };
};
papaya.viewer.Viewer.drawRoundRect = function (a, b, c, e, d, g, h, n) {
  "undefined" === typeof n && (n = !0);
  "undefined" === typeof g && (g = 5);
  a.beginPath();
  a.moveTo(b + g, c);
  a.lineTo(b + e - g, c);
  a.quadraticCurveTo(b + e, c, b + e, c + g);
  a.lineTo(b + e, c + d - g);
  a.quadraticCurveTo(b + e, c + d, b + e - g, c + d);
  a.lineTo(b + g, c + d);
  a.quadraticCurveTo(b, c + d, b, c + d - g);
  a.lineTo(b, c + g);
  a.quadraticCurveTo(b, c, b + g, c);
  a.closePath();
  n && a.stroke();
  h && a.fill();
};
papaya.viewer.Viewer.prototype.loadImage = function (a, b, c, e) {
  0 === this.screenVolumes.length
    ? this.loadBaseImage(a, b, c, e)
    : this.loadOverlay(a, b, c, e);
};
papaya.viewer.Viewer.prototype.showDialog = function (a, b, c, e, d) {
  var g,
    h = -1;
  for (g = 0; g < papayaContainers.length; g += 1)
    if (papayaContainers[g] === this.container) {
      h = g;
      break;
    }
  new papaya.ui.Dialog(this.container, a, b, c, e, d, h).showDialog();
};
papaya.viewer.Viewer.prototype.loadBaseImage = function (a, b, c, e) {
  var d = [],
    g = this.container.findLoadableImages(a);
  this.volume = new papaya.volume.Volume(
    this.container.display,
    this,
    this.container.params
  );
  if (e) {
    if (g && g.length) for (a = 0; a < g.length; a += 1) d.push(g[a].encode);
    else Array.isArray(a) || (a = [a]), (d = a);
    this.volume.readBinaryData(
      d,
      papaya.utilities.ObjectUtils.bind(this, this.initializeViewer)
    );
  } else if (c) {
    if (g) for (a = 0; a < g.length; a += 1) d.push(g[a].encode);
    else d = a;
    this.volume.readEncodedData(
      d,
      papaya.utilities.ObjectUtils.bind(this, this.initializeViewer)
    );
  } else if (null !== g && void 0 !== g[0].encode) {
    for (a = 0; a < g.length; a += 1) d.push(g[a].encode);
    this.volume.readEncodedData(
      d,
      papaya.utilities.ObjectUtils.bind(this, this.initializeViewer)
    );
  } else if (b)
    this.volume.readURLs(
      a,
      papaya.utilities.ObjectUtils.bind(this, this.initializeViewer)
    );
  else if (null !== g && void 0 !== g[0].url) {
    if (g) for (a = 0; a < g.length; a += 1) d.push(g[a].url);
    this.volume.readURLs(
      d,
      papaya.utilities.ObjectUtils.bind(this, this.initializeViewer)
    );
  } else
    this.volume.readFiles(
      a,
      papaya.utilities.ObjectUtils.bind(this, this.initializeViewer)
    );
};
papaya.viewer.Viewer.prototype.loadOverlay = function (a, b, c, e) {
  for (
    var d = this.container.findLoadableImage(a), g = 0;
    g < this.screenVolumes.length;
    g++
  )
    if (d && d.url && -1 < this.screenVolumes[g].volume.urls.indexOf(d.url))
      return;
  this.loadingVolume = new papaya.volume.Volume(
    this.container.display,
    this,
    this.container.params
  );
  this.screenVolumes.length > papaya.viewer.Viewer.MAX_OVERLAYS
    ? ((this.loadingVolume.error = Error(
        "Maximum number of overlays (" +
          papaya.viewer.Viewer.MAX_OVERLAYS +
          ") has been reached!"
      )),
      this.initializeOverlay())
    : e
    ? (Array.isArray(a) || (a = [a]),
      this.loadingVolume.readBinaryData(
        a,
        papaya.utilities.ObjectUtils.bind(this, this.initializeOverlay)
      ))
    : c
    ? ((a = d.encode),
      a instanceof Array || ((a = []), (a[0] = d.encode)),
      this.loadingVolume.readEncodedData(
        a,
        papaya.utilities.ObjectUtils.bind(this, this.initializeOverlay)
      ))
    : null !== d && void 0 !== d.encode
    ? ((a = d.encode),
      a instanceof Array || ((a = []), (a[0] = d.encode)),
      this.loadingVolume.readEncodedData(
        a,
        papaya.utilities.ObjectUtils.bind(this, this.initializeOverlay)
      ))
    : b
    ? this.loadingVolume.readURLs(
        a,
        papaya.utilities.ObjectUtils.bind(this, this.initializeOverlay)
      )
    : null !== d && void 0 !== d.url
    ? this.loadingVolume.readURLs(
        [d.url],
        papaya.utilities.ObjectUtils.bind(this, this.initializeOverlay)
      )
    : this.loadingVolume.readFiles(
        a,
        papaya.utilities.ObjectUtils.bind(this, this.initializeOverlay)
      );
};
papaya.viewer.Viewer.prototype.loadSurface = function (a, b, c) {
  var e = this.container.findLoadableImage(a, !0);
  if (0 == this.screenVolumes.length)
    this.container.display.drawError("Load an image before loading a surface!");
  else {
    for (var d = 0; d < this.surfaces.length; d++)
      if (e.url.endsWith(this.surfaces[d].filename)) return;
    d = new papaya.surface.Surface(
      this.container.display,
      this.container.params
    );
    this.atlas && (d.boundaryData = this.atlas.boundaryData);
    c
      ? d.readEncodedData(
          a[0],
          this.volume,
          papaya.utilities.ObjectUtils.bind(this, this.initializeSurface)
        )
      : null !== e && void 0 !== e.encode
      ? d.readEncodedData(
          e.encode,
          this.volume,
          papaya.utilities.ObjectUtils.bind(this, this.initializeSurface)
        )
      : b
      ? d.readURL(
          a,
          this.volume,
          papaya.utilities.ObjectUtils.bind(this, this.initializeSurface)
        )
      : null !== e && void 0 !== e.url
      ? d.readURL(
          e.url,
          this.volume,
          papaya.utilities.ObjectUtils.bind(this, this.initializeSurface)
        )
      : d.readFile(
          a[0],
          this.volume,
          papaya.utilities.ObjectUtils.bind(this, this.initializeSurface)
        );
  }
};
papaya.viewer.Viewer.prototype.initializeSurface = function (a) {
  var b = a;
  if (a.error) a.error && this.container.display.drawError(a.error);
  else {
    for (; null !== b; ) this.surfaces.push(b), (b = b.nextSurface);
    if (null === this.surfaceView)
      (this.lowerImageBot2 = this.surfaceView =
        new papaya.viewer.ScreenSurface(
          this.volume,
          this.surfaces,
          this,
          this.container.params
        )),
        this.container.resizeViewerComponents(!0);
    else
      for (b = a; null !== b; )
        this.surfaceView.initBuffers(this.surfaceView.context, b),
          (b = b.nextSurface);
    this.container.params.mainView &&
      "surface" === this.container.params.mainView.toLowerCase() &&
      ((this.mainImage = this.surfaceView),
      (this.lowerImageTop = this.axialSlice),
      (this.lowerImageBot = this.sagittalSlice),
      (this.lowerImageBot2 = this.coronalSlice),
      this.viewsChanged());
    this.container.toolbar.buildToolbar();
    this.container.toolbar.updateImageButtons();
    this.container.hasMoreToLoad()
      ? this.container.loadNext()
      : this.finishedLoading();
  }
};
papaya.viewer.Viewer.prototype.atlasLoaded = function () {
  this.finishedLoading();
};
papaya.viewer.Viewer.prototype.initializeViewer = function () {
  var a = this;
  if (this.volume.hasError()) {
    var b = this.volume.error.message;
    this.resetViewer();
    this.container.clearParams();
    this.container.display.drawError(b);
  } else if (
    ((this.screenVolumes[0] = new papaya.viewer.ScreenVolume(
      this.volume,
      this.container.params,
      papaya.viewer.ColorTable.DEFAULT_COLOR_TABLE.name,
      !0,
      !1,
      this.currentCoord
    )),
    this.loadingDTI &&
      ((this.loadingDTI = !1),
      (this.screenVolumes[0].dti = !0),
      this.screenVolumes[0].dti &&
        3 !== this.screenVolumes[0].volume.numTimepoints &&
        (this.screenVolumes[0].error = Error(
          "DTI vector series must have 3 series points!"
        )),
      this.screenVolumes[0].dti && this.screenVolumes[0].initDTI()),
    this.screenVolumes[0].hasError())
  )
    (b = this.screenVolumes[0].error.message),
      this.resetViewer(),
      this.container.clearParams(),
      this.container.display.drawError(b);
  else {
    this.setCurrentScreenVol(0);
    this.axialSlice = new papaya.viewer.ScreenSlice(
      this.volume,
      papaya.viewer.ScreenSlice.DIRECTION_AXIAL,
      this.volume.getXDim(),
      this.volume.getYDim(),
      this.volume.getXSize(),
      this.volume.getYSize(),
      this.screenVolumes,
      this
    );
    this.coronalSlice = new papaya.viewer.ScreenSlice(
      this.volume,
      papaya.viewer.ScreenSlice.DIRECTION_CORONAL,
      this.volume.getXDim(),
      this.volume.getZDim(),
      this.volume.getXSize(),
      this.volume.getZSize(),
      this.screenVolumes,
      this
    );
    this.sagittalSlice = new papaya.viewer.ScreenSlice(
      this.volume,
      papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL,
      this.volume.getYDim(),
      this.volume.getZDim(),
      this.volume.getYSize(),
      this.volume.getZSize(),
      this.screenVolumes,
      this
    );
    void 0 === this.container.params.mainView ||
    "axial" === this.container.params.mainView.toLowerCase()
      ? ((this.mainImage = this.axialSlice),
        (this.lowerImageTop = this.sagittalSlice),
        (this.lowerImageBot = this.coronalSlice))
      : "coronal" === this.container.params.mainView.toLowerCase()
      ? ((this.mainImage = this.coronalSlice),
        (this.lowerImageTop = this.axialSlice),
        (this.lowerImageBot = this.sagittalSlice))
      : "sagittal" === this.container.params.mainView.toLowerCase()
      ? ((this.mainImage = this.sagittalSlice),
        (this.lowerImageTop = this.coronalSlice),
        (this.lowerImageBot = this.axialSlice))
      : ((this.mainImage = this.axialSlice),
        (this.lowerImageTop = this.sagittalSlice),
        (this.lowerImageBot = this.coronalSlice));
    this.canvas.addEventListener("mousemove", this.listenerMouseMove, !1);
    this.canvas.addEventListener("mousedown", this.listenerMouseDown, !1);
    this.canvas.addEventListener("mouseout", this.listenerMouseOut, !1);
    this.canvas.addEventListener("mouseleave", this.listenerMouseLeave, !1);
    this.canvas.addEventListener("mouseup", this.listenerMouseUp, !1);
    document.addEventListener("keydown", this.listenerKeyDown, !0);
    document.addEventListener("keyup", this.listenerKeyUp, !0);
    this.canvas.addEventListener("touchmove", this.listenerTouchMove, !1);
    this.canvas.addEventListener("touchstart", this.listenerTouchStart, !1);
    this.canvas.addEventListener("touchend", this.listenerTouchEnd, !1);
    this.canvas.addEventListener("dblclick", this.listenerMouseDoubleClick, !1);
    document.addEventListener("contextmenu", this.listenerContextMenu, !1);
    this.container.showControlBar
      ? ($(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_MAIN_SLIDER)
            .find("button")
        )
          .eq(0)
          .click(function () {
            a.mainImage.sliceDirection ===
            papaya.viewer.ScreenSlice.DIRECTION_AXIAL
              ? a.incrementAxial(!1)
              : a.mainImage.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_CORONAL
              ? a.incrementCoronal(!1)
              : a.mainImage.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                a.incrementSagittal(!0);
          }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_MAIN_SLIDER)
            .find("button")
        )
          .eq(1)
          .click(function () {
            a.mainImage.sliceDirection ===
            papaya.viewer.ScreenSlice.DIRECTION_AXIAL
              ? a.incrementAxial(!0)
              : a.mainImage.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_CORONAL
              ? a.incrementCoronal(!0)
              : a.mainImage.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                a.incrementSagittal(!1);
          }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(0)
            .find("button")
            .eq(0)
        ).click(function () {
          a.incrementAxial(!1);
        }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(0)
            .find("button")
            .eq(1)
        ).click(function () {
          a.incrementAxial(!0);
        }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(1)
            .find("button")
            .eq(0)
        ).click(function () {
          a.incrementCoronal(!1);
        }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(1)
            .find("button")
            .eq(1)
        ).click(function () {
          a.incrementCoronal(!0);
        }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(2)
            .find("button")
            .eq(0)
        ).click(function () {
          a.incrementSagittal(!0);
        }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(2)
            .find("button")
            .eq(1)
        ).click(function () {
          a.incrementSagittal(!1);
        }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(3)
            .find("button")
            .eq(0)
        ).click(function () {
          a.decrementSeriesPoint();
        }),
        $(
          this.container.sliderControlHtml
            .find("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(3)
            .find("button")
            .eq(1)
        ).click(function () {
          a.incrementSeriesPoint();
        }),
        $(
          this.container.sliderControlHtml.find(
            "." + PAPAYA_CONTROL_SWAP_BUTTON_CSS
          )
        ).click(function () {
          a.rotateViews();
        }),
        $(
          this.container.sliderControlHtml.find(
            "." + PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS
          )
        ).click(function () {
          var c = new papaya.core.Coordinate(
            Math.floor(a.volume.header.imageDimensions.xDim / 2),
            Math.floor(a.volume.header.imageDimensions.yDim / 2),
            Math.floor(a.volume.header.imageDimensions.zDim / 2)
          );
          a.gotoCoordinate(c);
        }),
        $(
          this.container.sliderControlHtml.find(
            "." + PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS
          )
        ).click(function () {
          a.gotoCoordinate(a.volume.header.origin);
        }),
        $("." + PAPAYA_CONTROL_INCREMENT_BUTTON_CSS).prop("disabled", !1),
        $("." + PAPAYA_CONTROL_SWAP_BUTTON_CSS).prop("disabled", !1),
        $("." + PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).prop("disabled", !1),
        $("." + PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).prop("disabled", !1))
      : this.container.showControls &&
        ($(
          "#" +
            PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).css({ display: "inline" }),
        $(
          "#" +
            PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).css({ display: "inline" }),
        $(
          "#" +
            PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS +
            this.container.containerIndex
        ).css({ display: "inline" }),
        $(
          this.container.containerHtml.find(
            "#" +
              PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS +
              this.container.containerIndex
          )
        ).click(function () {
          a.rotateViews();
        }),
        $(
          this.container.containerHtml.find(
            "#" +
              PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
              this.container.containerIndex
          )
        ).click(function () {
          a.mainImage.sliceDirection ===
          papaya.viewer.ScreenSlice.DIRECTION_AXIAL
            ? a.incrementAxial(!1)
            : a.mainImage.sliceDirection ===
              papaya.viewer.ScreenSlice.DIRECTION_CORONAL
            ? a.incrementCoronal(!1)
            : a.mainImage.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
              a.incrementSagittal(!0);
        }),
        $(
          this.container.containerHtml.find(
            "#" +
              PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
              this.container.containerIndex
          )
        ).click(function () {
          a.mainImage.sliceDirection ===
          papaya.viewer.ScreenSlice.DIRECTION_AXIAL
            ? a.incrementAxial(!0)
            : a.mainImage.sliceDirection ===
              papaya.viewer.ScreenSlice.DIRECTION_CORONAL
            ? a.incrementCoronal(!0)
            : a.mainImage.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
              a.incrementSagittal(!1);
        }),
        $(
          this.container.containerHtml.find(
            "#" +
              PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
              this.container.containerIndex
          )
        ).click(function () {
          var c = new papaya.core.Coordinate(
            Math.floor(a.volume.header.imageDimensions.xDim / 2),
            Math.floor(a.volume.header.imageDimensions.yDim / 2),
            Math.floor(a.volume.header.imageDimensions.zDim / 2)
          );
          a.gotoCoordinate(c);
        }),
        $(
          this.container.containerHtml.find(
            "#" +
              PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
              this.container.containerIndex
          )
        ).click(function () {
          a.gotoCoordinate(a.volume.header.origin);
        }));
    this.hasSeries = 1 < this.volume.header.imageDimensions.timepoints;
    this.container.allowScroll && this.addScroll();
    this.setLongestDim(this.volume);
    this.calculateScreenSliceTransforms(this);
    this.currentCoord.setCoordinate(
      papayaFloorFast(this.volume.getXDim() / 2),
      papayaFloorFast(this.volume.getYDim() / 2),
      papayaFloorFast(this.volume.getZDim() / 2)
    );
    this.updateOffsetRect();
    this.bgColor = $("body").css("background-color");
    if ("rgba(0, 0, 0, 0)" === this.bgColor || "transparent" === this.bgColor)
      this.bgColor = "rgba(255, 255, 255, 255)";
    this.context.fillStyle = this.bgColor;
    this.context.fillRect(
      0,
      0,
      this.canvas.offsetWidth,
      this.canvas.offsetHeight
    );
    this.volume.isWorldSpaceOnly() &&
      (this.ignoreNiftiTransforms
        ? (this.volume.header.orientationCertainty =
            papaya.volume.Header.ORIENTATION_CERTAINTY_UNKNOWN)
        : (this.worldSpace = !0));
    papaya.Container.atlas && (this.atlas = papaya.Container.atlas);
    this.initialized = !0;
    this.container.resizeViewerComponents(!0);
    this.drawViewer();
    this.container.toolbar.buildToolbar();
    this.container.toolbar.updateImageButtons();
    this.updateWindowTitle();
    this.container.loadingImageIndex = 1;
    this.container.hasMoreToLoad()
      ? this.container.loadNext()
      : this.finishedLoading();
  }
};
papaya.viewer.Viewer.prototype.finishedLoading = function () {
  this.pageLoaded ||
    (this.goToInitialCoordinate(),
    this.updateSliceSliderControl(),
    (this.pageLoaded = !0));
  this.container.loadingComplete &&
    (this.container.loadingComplete(), (this.container.loadingComplete = null));
  this.atlas &&
    papaya.data.hasOwnProperty("configureAtlas") &&
    papaya.data.configureAtlas(this);
  this.container.toolbar.buildToolbar();
  this.container.toolbar.updateImageButtons();
  this.updateWindowTitle();
};
papaya.viewer.Viewer.prototype.addScroll = function () {
  window.addEventListener(
    papaya.utilities.PlatformUtils.getSupportedScrollEvent(),
    this.listenerScroll,
    !1
  );
};
papaya.viewer.Viewer.prototype.removeScroll = function () {
  window.removeEventListener(
    papaya.utilities.PlatformUtils.getSupportedScrollEvent(),
    this.listenerScroll,
    !1
  );
};
papaya.viewer.Viewer.prototype.updateOffsetRect = function () {
  this.canvasRect = papaya.viewer.Viewer.getOffsetRect(this.canvas);
};
papaya.viewer.Viewer.prototype.initializeOverlay = function () {
  var a;
  if (this.loadingVolume.hasError())
    this.container.display.drawError(this.loadingVolume.error.message),
      this.container.clearParams(),
      (this.loadingVolume = null);
  else {
    var b =
      (a = this.container.params[this.loadingVolume.fileName]) && a.parametric;
    var c = a && a.dtiMod;
    if (this.loadingDTIModRef)
      (this.loadingDTIModRef.dtiVolumeMod = this.loadingVolume),
        (this.loadingDTIModRef = null);
    else if (c) {
      if ((b = this.getScreenVolumeByName(a.dtiRef)))
        (b.dtiVolumeMod = this.loadingVolume),
          (b.dtiAlphaFactor =
            void 0 !== a.dtiModAlphaFactor ? a.dtiModAlphaFactor : 1);
    } else {
      c = new papaya.viewer.ScreenVolume(
        this.loadingVolume,
        this.container.params,
        b
          ? papaya.viewer.ColorTable.PARAMETRIC_COLOR_TABLES[0].name
          : this.getNextColorTable(),
        !1,
        !1,
        this.currentCoord
      );
      this.loadingDTI &&
        ((this.loadingDTI = !1),
        (c.dti = !0),
        c.dti &&
          3 !== c.volume.numTimepoints &&
          (c.error = Error("DTI vector series must have 3 series points!")),
        c.dti && c.initDTI());
      if (c.hasError()) {
        this.container.display.drawError(c.error.message);
        this.container.clearParams();
        this.loadingVolume = null;
        return;
      }
      c.rotationX = this.screenVolumes[0].rotationX;
      c.rotationY = this.screenVolumes[0].rotationY;
      c.rotationZ = this.screenVolumes[0].rotationZ;
      c.rotationAbout = this.screenVolumes[0].rotationAbout;
      c.updateTransform();
      c.hidden = a && a.hidden;
      this.screenVolumes[this.screenVolumes.length] = c;
      this.setCurrentScreenVol(this.screenVolumes.length - 1);
      b &&
        (this.screenVolumes[this.screenVolumes.length - 1].findImageRange(),
        0 >
          this.screenVolumes[this.screenVolumes.length - 1].volume.header
            .imageRange.imageMin &&
          ((this.screenVolumes[this.screenVolumes.length] = b =
            new papaya.viewer.ScreenVolume(
              this.loadingVolume,
              this.container.params,
              papaya.viewer.ColorTable.PARAMETRIC_COLOR_TABLES[1].name,
              !1,
              !0,
              this.currentCoord
            )),
          (c.negativeScreenVol = b),
          this.setCurrentScreenVol(this.screenVolumes.length - 1)));
    }
    this.container.toolbar.buildToolbar();
    this.container.toolbar.updateImageButtons();
    this.drawViewer(!0);
    this.hasSeries = !1;
    for (b = 0; b < this.screenVolumes.length; b += 1)
      if (1 < this.screenVolumes[b].volume.header.imageDimensions.timepoints) {
        this.hasSeries = !0;
        break;
      }
    this.container.resizeViewerComponents();
    this.updateWindowTitle();
    this.loadingVolume = null;
    a && a.loadingComplete && a.loadingComplete();
    this.container.hasMoreToLoad()
      ? this.container.loadNext()
      : this.finishedLoading();
  }
};
papaya.viewer.Viewer.prototype.closeOverlayByRef = function (a) {
  this.closeOverlay(this.getScreenVolumeIndex(a));
};
papaya.viewer.Viewer.prototype.closeOverlay = function (a) {
  var b;
  for (b = 0; b < this.screenVolumes.length; b += 1)
    this.screenVolumes[b].negativeScreenVol === this.screenVolumes[a] &&
      (this.screenVolumes[b].negativeScreenVol = null);
  this.screenVolumes.splice(a, 1);
  this.setCurrentScreenVol(this.screenVolumes.length - 1);
  this.drawViewer(!0);
  this.container.toolbar.buildToolbar();
  this.container.toolbar.updateImageButtons();
  this.updateWindowTitle();
  this.hasSeries = !1;
  for (b = 0; b < this.screenVolumes.length; b += 1)
    if (1 < this.screenVolumes[b].volume.header.imageDimensions.timepoints) {
      this.hasSeries = !0;
      break;
    }
  this.container.resizeViewerComponents();
};
papaya.viewer.Viewer.prototype.hasDefinedAtlas = function () {
  if ("undefined" !== typeof papaya.data) {
    var a = typeof papaya.data.Atlas;
    if ("undefined" !== a) return !0;
  }
  return !1;
};
papaya.viewer.Viewer.prototype.loadAtlas = function () {
  null === this.atlas &&
    (papaya.data.Atlas.data ||
      (papaya.data.Atlas.atlas = new papaya.viewer.Atlas(
        papaya.data.Atlas,
        this.container,
        papaya.utilities.ObjectUtils.bind(this, this.atlasLoaded)
      )),
    (papaya.Container.atlas = this.atlas = papaya.data.Atlas.atlas));
};
papaya.viewer.Viewer.prototype.isInsideMainSlice = function (a, b) {
  this.updateOffsetRect();
  a -= this.canvasRect.left;
  b -= this.canvasRect.top;
  return this.mainImage === this.axialSlice
    ? this.insideScreenSlice(
        this.axialSlice,
        a,
        b,
        this.volume.getXDim(),
        this.volume.getYDim()
      )
    : this.mainImage === this.coronalSlice
    ? this.insideScreenSlice(
        this.coronalSlice,
        a,
        b,
        this.volume.getXDim(),
        this.volume.getZDim()
      )
    : this.mainImage === this.sagittalSlice
    ? this.insideScreenSlice(
        this.sagittalSlice,
        a,
        b,
        this.volume.getYDim(),
        this.volume.getZDim()
      )
    : !1;
};
papaya.viewer.Viewer.prototype.updatePosition = function (a, b, c, e) {
  a.updateOffsetRect();
  var d = b;
  var g = c;
  b -= this.canvasRect.left;
  c -= this.canvasRect.top;
  if (
    this.insideScreenSlice(
      a.axialSlice,
      b,
      c,
      a.volume.getXDim(),
      a.volume.getYDim()
    )
  ) {
    if (
      !this.isDragging ||
      this.draggingSliceDir === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
    )
      if (
        ((b = this.convertScreenToImageCoordinateX(b, a.axialSlice)),
        (c = this.convertScreenToImageCoordinateY(c, a.axialSlice)),
        b !== a.currentCoord.x || c !== a.currentCoord.y)
      )
        (a.currentCoord.x = b),
          (a.currentCoord.y = c),
          (this.draggingSliceDir = papaya.viewer.ScreenSlice.DIRECTION_AXIAL);
  } else if (
    this.insideScreenSlice(
      a.coronalSlice,
      b,
      c,
      a.volume.getXDim(),
      a.volume.getZDim()
    )
  ) {
    if (
      !this.isDragging ||
      this.draggingSliceDir === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
    )
      if (
        ((b = this.convertScreenToImageCoordinateX(b, a.coronalSlice)),
        (c = this.convertScreenToImageCoordinateY(c, a.coronalSlice)),
        b !== a.currentCoord.x || c !== a.currentCoord.y)
      )
        (a.currentCoord.x = b),
          (a.currentCoord.z = c),
          (this.draggingSliceDir = papaya.viewer.ScreenSlice.DIRECTION_CORONAL);
  } else if (
    this.insideScreenSlice(
      a.sagittalSlice,
      b,
      c,
      a.volume.getYDim(),
      a.volume.getZDim()
    )
  ) {
    if (
      !this.isDragging ||
      this.draggingSliceDir === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL
    )
      if (
        ((b = this.convertScreenToImageCoordinateX(b, a.sagittalSlice)),
        (c = this.convertScreenToImageCoordinateY(c, a.sagittalSlice)),
        b !== a.currentCoord.x || c !== a.currentCoord.y)
      )
        (a.currentCoord.y = b),
          (a.currentCoord.z = c),
          (this.draggingSliceDir =
            papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL);
  } else
    a.surfaceView &&
      this.insideScreenSlice(
        a.surfaceView,
        b,
        c,
        a.surfaceView.screenDim,
        a.surfaceView.screenDim
      ) &&
      a.surfaceView.updateDynamic(
        d,
        g,
        this.selectedSlice === this.mainImage ? 1 : 3
      );
  this.container.coordinateChanged(this);
  a.drawViewer(!1, e);
};
papaya.viewer.Viewer.prototype.convertScreenToImageCoordinateX = function (
  a,
  b
) {
  return papaya.viewer.Viewer.validDimBounds(
    papayaFloorFast((a - b.finalTransform[0][2]) / b.finalTransform[0][0]),
    b.xDim
  );
};
papaya.viewer.Viewer.prototype.convertScreenToImageCoordinateY = function (
  a,
  b
) {
  return papaya.viewer.Viewer.validDimBounds(
    papayaFloorFast((a - b.finalTransform[1][2]) / b.finalTransform[1][1]),
    b.yDim
  );
};
papaya.viewer.Viewer.prototype.convertScreenToImageCoordinate = function (
  a,
  b,
  c
) {
  void 0 === c && (c = this.mainImage);
  if (c.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_AXIAL) {
    var e = this.convertScreenToImageCoordinateX(a, c);
    var d = this.convertScreenToImageCoordinateY(b, c);
    var g = this.axialSlice.currentSlice;
  } else
    c.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
      ? ((e = this.convertScreenToImageCoordinateX(a, c)),
        (g = this.convertScreenToImageCoordinateY(b, c)),
        (d = this.coronalSlice.currentSlice))
      : c.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
        ((d = this.convertScreenToImageCoordinateX(a, c)),
        (g = this.convertScreenToImageCoordinateY(b, c)),
        (e = this.sagittalSlice.currentSlice));
  return new papaya.core.Coordinate(e, d, g);
};
papaya.viewer.Viewer.prototype.convertCurrentCoordinateToScreen = function (a) {
  return this.convertCoordinateToScreen(this.currentCoord, a);
};
papaya.viewer.Viewer.prototype.intersectsMainSlice = function (a) {
  var b = this.mainImage.sliceDirection;
  return b === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
    ? a.z === this.mainImage.currentSlice
    : b === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
    ? a.y === this.mainImage.currentSlice
    : b === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL
    ? a.x === this.mainImage.currentSlice
    : !1;
};
papaya.viewer.Viewer.prototype.convertCoordinateToScreen = function (a, b) {
  void 0 === b && (b = this.mainImage);
  var c = b.sliceDirection;
  if (c === papaya.viewer.ScreenSlice.DIRECTION_AXIAL) {
    var e = papayaFloorFast(
      b.finalTransform[0][2] + (a.x + 0.5) * b.finalTransform[0][0]
    );
    var d = papayaFloorFast(
      b.finalTransform[1][2] + (a.y + 0.5) * b.finalTransform[1][1]
    );
  } else
    c === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
      ? ((e = papayaFloorFast(
          b.finalTransform[0][2] + (a.x + 0.5) * b.finalTransform[0][0]
        )),
        (d = papayaFloorFast(
          b.finalTransform[1][2] + (a.z + 0.5) * b.finalTransform[1][1]
        )))
      : c === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
        ((e = papayaFloorFast(
          b.finalTransform[0][2] + (a.y + 0.5) * b.finalTransform[0][0]
        )),
        (d = papayaFloorFast(
          b.finalTransform[1][2] + (a.z + 0.5) * b.finalTransform[1][1]
        )));
  return new papaya.core.Point(e, d);
};
papaya.viewer.Viewer.prototype.updateCursorPosition = function (a, b, c) {
  if (this.container.display) {
    b -= this.canvasRect.left;
    c -= this.canvasRect.top;
    if (
      this.insideScreenSlice(
        a.axialSlice,
        b,
        c,
        a.volume.getXDim(),
        a.volume.getYDim()
      )
    ) {
      var e = this.convertScreenToImageCoordinateX(b, a.axialSlice);
      var d = this.convertScreenToImageCoordinateY(c, a.axialSlice);
      var g = a.axialSlice.currentSlice;
      var h = !0;
    } else
      this.insideScreenSlice(
        a.coronalSlice,
        b,
        c,
        a.volume.getXDim(),
        a.volume.getZDim()
      )
        ? ((e = this.convertScreenToImageCoordinateX(b, a.coronalSlice)),
          (g = this.convertScreenToImageCoordinateY(c, a.coronalSlice)),
          (d = a.coronalSlice.currentSlice),
          (h = !0))
        : this.insideScreenSlice(
            a.sagittalSlice,
            b,
            c,
            a.volume.getYDim(),
            a.volume.getZDim()
          )
        ? ((d = this.convertScreenToImageCoordinateX(b, a.sagittalSlice)),
          (g = this.convertScreenToImageCoordinateY(c, a.sagittalSlice)),
          (e = a.sagittalSlice.currentSlice),
          (h = !0))
        : this.insideScreenSlice(a.surfaceView, b, c) &&
          ((b -= a.surfaceView.screenOffsetX),
          (c -= a.surfaceView.screenOffsetY),
          (a = this.surfaceView.pick(b, c))) &&
          (this.getIndexCoordinateAtWorld(
            a.coordinate[0],
            a.coordinate[1],
            a.coordinate[2],
            this.tempCoor
          ),
          (e = this.tempCoor.x),
          (d = this.tempCoor.y),
          (g = this.tempCoor.z),
          (h = !0));
    h
      ? ((this.cursorPosition.x = e),
        (this.cursorPosition.y = d),
        (this.cursorPosition.z = g),
        this.container.display.drawDisplay(e, d, g))
      : this.container.display.drawEmptyDisplay();
  }
};
papaya.viewer.Viewer.prototype.insideScreenSlice = function (a, b, c, e, d) {
  if (!a) return !1;
  if (a === this.surfaceView) {
    var g = a.screenOffsetX;
    e = a.screenOffsetX + a.screenDim;
    var h = a.screenOffsetY;
    a = a.screenOffsetY + a.screenDim;
  } else
    (g = papayaRoundFast(a.screenTransform[0][2])),
      (e = papayaRoundFast(
        a.screenTransform[0][2] + e * a.screenTransform[0][0]
      )),
      (h = papayaRoundFast(a.screenTransform[1][2])),
      (a = papayaRoundFast(
        a.screenTransform[1][2] + d * a.screenTransform[1][1]
      ));
  return b >= g && b < e && c >= h && c < a;
};
papaya.viewer.Viewer.prototype.drawEmptyViewer = function () {
  this.context.fillStyle = "#000000";
  this.context.fillRect(0, 0, this.canvas.width, this.canvas.height);
  this.context.fillStyle = "#AAAAAA";
  if (this.container.readyForDnD()) {
    this.context.font = "18px sans-serif";
    var a = this.canvas.height - 22;
    var b = "Drop here or click the File menu";
    var c = this.context.measureText(b);
    c = c.width;
    this.context.fillText(b, this.canvas.width / 2 - c / 2, a);
  }
  900 < this.canvas.width &&
    ((this.context.font = "14px sans-serif"),
    (a = this.canvas.height - 20),
    (b =
      "Supported formats: NIFTI" +
      (papaya.Container.DICOM_SUPPORT ? ", DICOM" : "")),
    this.context.fillText(b, 20, a),
    (this.context.font = "14px sans-serif"),
    (a = this.canvas.height - 20),
    (b = "Papaya (Build " + PAPAYA_BUILD_NUM + ")"),
    (c = this.context.measureText(b)),
    (c = c.width),
    this.context.fillText(b, this.canvas.width - c - 20, a));
};
papaya.viewer.Viewer.prototype.drawViewer = function (a, b) {
  var c = "Yes" === this.container.preferences.radiological,
    e = "Yes" === this.container.preferences.showOrientation;
  if (this.initialized) {
    this.context.save();
    b
      ? (this.axialSlice.repaint(this.currentCoord.z, a, this.worldSpace),
        this.coronalSlice.repaint(this.currentCoord.y, a, this.worldSpace),
        this.sagittalSlice.repaint(this.currentCoord.x, a, this.worldSpace))
      : ((a ||
          this.draggingSliceDir !==
            papaya.viewer.ScreenSlice.DIRECTION_AXIAL) &&
          this.axialSlice.updateSlice(this.currentCoord.z, a, this.worldSpace),
        (a ||
          this.draggingSliceDir !==
            papaya.viewer.ScreenSlice.DIRECTION_CORONAL) &&
          this.coronalSlice.updateSlice(
            this.currentCoord.y,
            a,
            this.worldSpace
          ),
        (a ||
          this.draggingSliceDir !==
            papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL) &&
          this.sagittalSlice.updateSlice(
            this.currentCoord.x,
            a,
            this.worldSpace
          ));
    if (
      this.hasSurface() &&
      (!papaya.utilities.PlatformUtils.smallScreen ||
        a ||
        this.selectedSlice === this.surfaceView)
    ) {
      if (a)
        for (a = 0; a < this.surfaces.length; a++)
          this.surfaces[a].generateColorData();
      this.surfaceView.draw();
    }
    "No" === this.container.preferences.smoothDisplay
      ? ((this.context.imageSmoothingEnabled = !1),
        (this.context.mozImageSmoothingEnabled = !1),
        (this.context.msImageSmoothingEnabled = !1))
      : ((this.context.imageSmoothingEnabled = !0),
        (this.context.mozImageSmoothingEnabled = !0),
        (this.context.msImageSmoothingEnabled = !0));
    this.drawScreenSlice(this.mainImage);
    this.container.orthogonal &&
      (this.drawScreenSlice(this.lowerImageTop),
      this.drawScreenSlice(this.lowerImageBot),
      this.hasSurface() && this.drawScreenSlice(this.lowerImageBot2));
    (e || c) && this.drawOrientation();
    "Yes" === this.container.preferences.showCrosshairs &&
      this.drawCrosshairs();
    "Yes" === this.container.preferences.showRuler && this.drawRuler();
    this.container.display &&
      this.container.display.drawDisplay(
        this.currentCoord.x,
        this.currentCoord.y,
        this.currentCoord.z
      );
    this.container.contextManager &&
      this.container.contextManager.drawToViewer &&
      this.container.contextManager.drawToViewer(this.context);
  } else this.drawEmptyViewer();
};
papaya.viewer.Viewer.prototype.hasSurface = function () {
  return (
    this.container.hasSurface() &&
    this.surfaceView &&
    this.surfaceView.initialized
  );
};
papaya.viewer.Viewer.prototype.drawScreenSlice = function (a) {
  if (a === this.surfaceView) {
    if (
      ((this.context.fillStyle = this.surfaceView.getBackgroundColor()),
      this.context.fillRect(
        a.screenOffsetX,
        a.screenOffsetY,
        a.screenDim,
        a.screenDim
      ),
      this.context.drawImage(a.canvas, a.screenOffsetX, a.screenOffsetY),
      "Yes" === this.container.preferences.showRuler &&
        this.surfaceView === this.mainImage)
    ) {
      this.context.font =
        papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE + "px sans-serif";
      var b = this.context.measureText("Ruler Length: ").width;
      var c = this.context.measureText("Ruler Length: 000.00").width;
      c /= 2;
      this.context.fillStyle = "#ffb3db";
      this.context.fillText(
        "Ruler Length:  ",
        a.screenDim / 2 - c / 2,
        papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE + 5
      );
      this.context.fillStyle = "#FFFFFF";
      this.context.fillText(
        this.surfaceView.getRulerLength().toFixed(2),
        a.screenDim / 2 + b - c / 2,
        papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE + 5
      );
    }
  } else
    (this.context.fillStyle = papaya.viewer.Viewer.BACKGROUND_COLOR),
      this.context.setTransform(1, 0, 0, 1, 0, 0),
      this.context.fillRect(
        a.screenOffsetX,
        a.screenOffsetY,
        a.screenDim,
        a.screenDim
      ),
      this.context.save(),
      this.context.beginPath(),
      this.context.rect(
        a.screenOffsetX,
        a.screenOffsetY,
        a.screenDim,
        a.screenDim
      ),
      this.context.clip(),
      this.context.setTransform(
        a.finalTransform[0][0],
        0,
        0,
        a.finalTransform[1][1],
        a.finalTransform[0][2],
        a.finalTransform[1][2]
      ),
      this.context.drawImage(a.canvasMain, 0, 0),
      this.context.restore(),
      a.canvasDTILines &&
        this.context.drawImage(
          a.canvasDTILines,
          a.screenOffsetX,
          a.screenOffsetY
        );
};
papaya.viewer.Viewer.prototype.drawOrientation = function () {
  var a = "Yes" === this.container.preferences.showOrientation;
  if (
    this.mainImage !== this.surfaceView &&
    0.5 === this.currentScreenVolume.rotationX &&
    0.5 === this.currentScreenVolume.rotationY &&
    0.5 === this.currentScreenVolume.rotationZ
  ) {
    this.context.setTransform(1, 0, 0, 1, 0, 0);
    this.context.fillStyle = this.getOrientationCertaintyColor();
    this.context.font =
      papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE + "px sans-serif";
    var b = this.context.measureText("X").width;
    var c = "Yes" === this.container.preferences.radiological;
    if (this.mainImage === this.axialSlice) {
      var e = papaya.viewer.Viewer.ORIENTATION_MARKER_ANTERIOR;
      var d = papaya.viewer.Viewer.ORIENTATION_MARKER_POSTERIOR;
      if (c) {
        var g = papaya.viewer.Viewer.ORIENTATION_MARKER_RIGHT;
        var h = papaya.viewer.Viewer.ORIENTATION_MARKER_LEFT;
      } else
        (g = papaya.viewer.Viewer.ORIENTATION_MARKER_LEFT),
          (h = papaya.viewer.Viewer.ORIENTATION_MARKER_RIGHT);
    } else
      this.mainImage === this.coronalSlice
        ? ((e = papaya.viewer.Viewer.ORIENTATION_MARKER_SUPERIOR),
          (d = papaya.viewer.Viewer.ORIENTATION_MARKER_INFERIOR),
          c
            ? ((g = papaya.viewer.Viewer.ORIENTATION_MARKER_RIGHT),
              (h = papaya.viewer.Viewer.ORIENTATION_MARKER_LEFT))
            : ((g = papaya.viewer.Viewer.ORIENTATION_MARKER_LEFT),
              (h = papaya.viewer.Viewer.ORIENTATION_MARKER_RIGHT)))
        : this.mainImage === this.sagittalSlice &&
          ((e = papaya.viewer.Viewer.ORIENTATION_MARKER_SUPERIOR),
          (d = papaya.viewer.Viewer.ORIENTATION_MARKER_INFERIOR),
          (g = papaya.viewer.Viewer.ORIENTATION_MARKER_ANTERIOR),
          (h = papaya.viewer.Viewer.ORIENTATION_MARKER_POSTERIOR));
    c = this.mainImage.screenOffsetX;
    var n = this.mainImage.screenOffsetX + this.mainImage.screenDim;
    var q = Math.round(n / 2);
    var t = this.mainImage.screenOffsetY;
    var u = this.mainImage.screenOffsetY + this.mainImage.screenDim;
    var A = Math.round(u / 2);
    if (a || this.mainImage.isRadiologicalSensitive())
      this.context.fillText(
        g,
        c + papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE,
        A + 0.5 * papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE
      ),
        this.context.fillText(
          h,
          n - 1.5 * papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE,
          A + 0.5 * papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE
        );
    a &&
      (this.context.fillText(
        e,
        q - b / 2,
        t + 1.5 * papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE
      ),
      this.context.fillText(
        d,
        q - b / 2,
        u - papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE
      ));
  }
};
papaya.viewer.Viewer.prototype.drawRuler = function () {
  if (this.mainImage !== this.surfaceView) {
    if (this.mainImage === this.axialSlice) {
      var a =
        this.axialSlice.finalTransform[0][2] +
        (this.axialSlice.rulerPoints[0].x + 0.5) *
          this.axialSlice.finalTransform[0][0];
      var b =
        this.axialSlice.finalTransform[1][2] +
        (this.axialSlice.rulerPoints[0].y + 0.5) *
          this.axialSlice.finalTransform[1][1];
      var c =
        this.axialSlice.finalTransform[0][2] +
        (this.axialSlice.rulerPoints[1].x + 0.5) *
          this.axialSlice.finalTransform[0][0];
      var e =
        this.axialSlice.finalTransform[1][2] +
        (this.axialSlice.rulerPoints[1].y + 0.5) *
          this.axialSlice.finalTransform[1][1];
    } else
      this.mainImage === this.coronalSlice
        ? ((a =
            this.coronalSlice.finalTransform[0][2] +
            (this.coronalSlice.rulerPoints[0].x + 0.5) *
              this.coronalSlice.finalTransform[0][0]),
          (b =
            this.coronalSlice.finalTransform[1][2] +
            (this.coronalSlice.rulerPoints[0].y + 0.5) *
              this.coronalSlice.finalTransform[1][1]),
          (c =
            this.coronalSlice.finalTransform[0][2] +
            (this.coronalSlice.rulerPoints[1].x + 0.5) *
              this.coronalSlice.finalTransform[0][0]),
          (e =
            this.coronalSlice.finalTransform[1][2] +
            (this.coronalSlice.rulerPoints[1].y + 0.5) *
              this.coronalSlice.finalTransform[1][1]))
        : this.mainImage === this.sagittalSlice &&
          ((a =
            this.sagittalSlice.finalTransform[0][2] +
            (this.sagittalSlice.rulerPoints[0].x + 0.5) *
              this.sagittalSlice.finalTransform[0][0]),
          (b =
            this.sagittalSlice.finalTransform[1][2] +
            (this.sagittalSlice.rulerPoints[0].y + 0.5) *
              this.sagittalSlice.finalTransform[1][1]),
          (c =
            this.sagittalSlice.finalTransform[0][2] +
            (this.sagittalSlice.rulerPoints[1].x + 0.5) *
              this.sagittalSlice.finalTransform[0][0]),
          (e =
            this.sagittalSlice.finalTransform[1][2] +
            (this.sagittalSlice.rulerPoints[1].y + 0.5) *
              this.sagittalSlice.finalTransform[1][1]));
    this.context.setTransform(1, 0, 0, 1, 0, 0);
    this.context.strokeStyle = "#FF1493";
    this.context.fillStyle = "#FF1493";
    this.context.lineWidth = 2;
    this.context.save();
    this.context.beginPath();
    this.context.moveTo(a, b);
    this.context.lineTo(c, e);
    this.context.stroke();
    this.context.closePath();
    this.context.beginPath();
    this.context.arc(a, b, 3, 0, 2 * Math.PI, !1);
    this.context.arc(c, e, 3, 0, 2 * Math.PI, !1);
    this.context.fill();
    this.context.closePath();
    var d = papaya.utilities.StringUtils.formatNumber(
      papaya.utilities.MathUtils.lineDistance(
        this.mainImage.rulerPoints[0].x * this.mainImage.xSize,
        this.mainImage.rulerPoints[0].y * this.mainImage.ySize,
        this.mainImage.rulerPoints[1].x * this.mainImage.xSize,
        this.mainImage.rulerPoints[1].y * this.mainImage.ySize
      ),
      !1
    );
    var g = this.context.measureText(d).width;
    a = parseInt((a + c) / 2) - g / 2;
    b = parseInt((b + e) / 2) + 7;
    this.context.fillStyle = "#FFFFFF";
    papaya.viewer.Viewer.drawRoundRect(
      this.context,
      a - 2,
      b - 14 - 2 + 1,
      g + 4,
      18,
      5,
      !0,
      !1
    );
    this.context.font =
      papaya.viewer.Viewer.ORIENTATION_MARKER_SIZE + "px sans-serif";
    this.context.strokeStyle = "#FF1493";
    this.context.fillStyle = "#FF1493";
    this.context.fillText(d, a, b);
  }
};
papaya.viewer.Viewer.prototype.drawCrosshairs = function () {
  this.context.setTransform(1, 0, 0, 1, 0, 0);
  this.context.strokeStyle = papaya.viewer.Viewer.CROSSHAIRS_COLOR;
  this.context.lineWidth = 1;
  if (this.mainImage !== this.axialSlice || this.toggleMainCrosshairs) {
    this.context.save();
    this.context.beginPath();
    this.context.rect(
      this.axialSlice.screenOffsetX,
      this.axialSlice.screenOffsetY,
      this.axialSlice.screenDim,
      this.axialSlice.screenDim
    );
    this.context.closePath();
    this.context.clip();
    this.context.beginPath();
    var a =
      this.axialSlice.finalTransform[0][2] +
      (this.currentCoord.x + 0.5) * this.axialSlice.finalTransform[0][0];
    var b = this.axialSlice.finalTransform[1][2];
    var c =
      this.axialSlice.finalTransform[1][2] +
      this.axialSlice.yDim * this.axialSlice.finalTransform[1][1];
    this.context.moveTo(a, b);
    this.context.lineTo(a, c);
    a =
      this.axialSlice.finalTransform[1][2] +
      (this.currentCoord.y + 0.5) * this.axialSlice.finalTransform[1][1];
    b = this.axialSlice.finalTransform[0][2];
    c =
      this.axialSlice.finalTransform[0][2] +
      this.axialSlice.xDim * this.axialSlice.finalTransform[0][0];
    this.context.moveTo(b, a);
    this.context.lineTo(c, a);
    this.context.closePath();
    this.context.stroke();
    this.context.restore();
  }
  if (this.mainImage !== this.coronalSlice || this.toggleMainCrosshairs)
    this.context.save(),
      this.context.beginPath(),
      this.context.rect(
        this.coronalSlice.screenOffsetX,
        this.coronalSlice.screenOffsetY,
        this.coronalSlice.screenDim,
        this.coronalSlice.screenDim
      ),
      this.context.closePath(),
      this.context.clip(),
      this.context.beginPath(),
      (a =
        this.coronalSlice.finalTransform[0][2] +
        (this.currentCoord.x + 0.5) * this.coronalSlice.finalTransform[0][0]),
      (b = this.coronalSlice.finalTransform[1][2]),
      (c =
        this.coronalSlice.finalTransform[1][2] +
        this.coronalSlice.yDim * this.coronalSlice.finalTransform[1][1]),
      this.context.moveTo(a, b),
      this.context.lineTo(a, c),
      (a =
        this.coronalSlice.finalTransform[1][2] +
        (this.currentCoord.z + 0.5) * this.coronalSlice.finalTransform[1][1]),
      (b = this.coronalSlice.finalTransform[0][2]),
      (c =
        this.coronalSlice.finalTransform[0][2] +
        this.coronalSlice.xDim * this.coronalSlice.finalTransform[0][0]),
      this.context.moveTo(b, a),
      this.context.lineTo(c, a),
      this.context.closePath(),
      this.context.stroke(),
      this.context.restore();
  if (this.mainImage !== this.sagittalSlice || this.toggleMainCrosshairs)
    this.context.save(),
      this.context.beginPath(),
      this.context.rect(
        this.sagittalSlice.screenOffsetX,
        this.sagittalSlice.screenOffsetY,
        this.sagittalSlice.screenDim,
        this.sagittalSlice.screenDim
      ),
      this.context.closePath(),
      this.context.clip(),
      this.context.beginPath(),
      (a =
        this.sagittalSlice.finalTransform[0][2] +
        (this.currentCoord.y + 0.5) * this.sagittalSlice.finalTransform[0][0]),
      (b = this.sagittalSlice.finalTransform[1][2]),
      (c =
        this.sagittalSlice.finalTransform[1][2] +
        this.sagittalSlice.yDim * this.sagittalSlice.finalTransform[1][1]),
      this.context.moveTo(a, b),
      this.context.lineTo(a, c),
      (a =
        this.sagittalSlice.finalTransform[1][2] +
        (this.currentCoord.z + 0.5) * this.sagittalSlice.finalTransform[1][1]),
      (b = this.sagittalSlice.finalTransform[0][2]),
      (c =
        this.sagittalSlice.finalTransform[0][2] +
        this.sagittalSlice.xDim * this.sagittalSlice.finalTransform[0][0]),
      this.context.moveTo(b, a),
      this.context.lineTo(c, a),
      this.context.closePath(),
      this.context.stroke(),
      this.context.restore();
};
papaya.viewer.Viewer.prototype.calculateScreenSliceTransforms = function () {
  this.container.orthogonalTall
    ? this.container.hasSurface()
      ? ((this.viewerDim = this.canvas.height / 1.333),
        this.getTransformParameters(this.mainImage, this.viewerDim, !1, 3),
        (this.mainImage.screenTransform[0][2] += this.mainImage.screenOffsetX =
          0),
        (this.mainImage.screenTransform[1][2] += this.mainImage.screenOffsetY =
          0),
        this.getTransformParameters(this.lowerImageTop, this.viewerDim, !0, 3),
        (this.lowerImageTop.screenTransform[0][2] +=
          this.lowerImageTop.screenOffsetX =
            0),
        (this.lowerImageTop.screenTransform[1][2] +=
          this.lowerImageTop.screenOffsetY =
            this.viewerDim + papaya.viewer.Viewer.GAP),
        this.getTransformParameters(this.lowerImageBot, this.viewerDim, !0, 3),
        (this.lowerImageBot.screenTransform[0][2] +=
          this.lowerImageBot.screenOffsetX =
            (this.viewerDim - papaya.viewer.Viewer.GAP) / 3 +
            papaya.viewer.Viewer.GAP),
        (this.lowerImageBot.screenTransform[1][2] +=
          this.lowerImageBot.screenOffsetY =
            this.viewerDim + papaya.viewer.Viewer.GAP),
        this.getTransformParameters(this.lowerImageBot2, this.viewerDim, !0, 3),
        (this.lowerImageBot2.screenTransform[0][2] +=
          this.lowerImageBot2.screenOffsetX =
            2 *
            ((this.viewerDim - papaya.viewer.Viewer.GAP) / 3 +
              papaya.viewer.Viewer.GAP)),
        (this.lowerImageBot2.screenTransform[1][2] +=
          this.lowerImageBot2.screenOffsetY =
            this.viewerDim + papaya.viewer.Viewer.GAP))
      : ((this.viewerDim = this.canvas.height / 1.5),
        this.getTransformParameters(this.mainImage, this.viewerDim, !1, 2),
        (this.mainImage.screenTransform[0][2] += this.mainImage.screenOffsetX =
          0),
        (this.mainImage.screenTransform[1][2] += this.mainImage.screenOffsetY =
          0),
        this.getTransformParameters(this.lowerImageBot, this.viewerDim, !0, 2),
        (this.lowerImageBot.screenTransform[0][2] +=
          this.lowerImageBot.screenOffsetX =
            0),
        (this.lowerImageBot.screenTransform[1][2] +=
          this.lowerImageBot.screenOffsetY =
            this.viewerDim + papaya.viewer.Viewer.GAP),
        this.getTransformParameters(this.lowerImageTop, this.viewerDim, !0, 2),
        (this.lowerImageTop.screenTransform[0][2] +=
          this.lowerImageTop.screenOffsetX =
            (this.viewerDim - papaya.viewer.Viewer.GAP) / 2 +
            papaya.viewer.Viewer.GAP),
        (this.lowerImageTop.screenTransform[1][2] +=
          this.lowerImageTop.screenOffsetY =
            this.viewerDim + papaya.viewer.Viewer.GAP))
    : ((this.viewerDim = this.canvas.height),
      this.container.hasSurface()
        ? (this.getTransformParameters(this.mainImage, this.viewerDim, !1, 3),
          (this.mainImage.screenTransform[0][2] +=
            this.mainImage.screenOffsetX =
              0),
          (this.mainImage.screenTransform[1][2] +=
            this.mainImage.screenOffsetY =
              0),
          this.getTransformParameters(
            this.lowerImageTop,
            this.viewerDim,
            !0,
            3
          ),
          (this.lowerImageTop.screenTransform[0][2] +=
            this.lowerImageTop.screenOffsetX =
              this.viewerDim + papaya.viewer.Viewer.GAP),
          (this.lowerImageTop.screenTransform[1][2] +=
            this.lowerImageTop.screenOffsetY =
              0),
          this.getTransformParameters(
            this.lowerImageBot,
            this.viewerDim,
            !0,
            3
          ),
          (this.lowerImageBot.screenTransform[0][2] +=
            this.lowerImageBot.screenOffsetX =
              this.viewerDim + papaya.viewer.Viewer.GAP),
          (this.lowerImageBot.screenTransform[1][2] +=
            this.lowerImageBot.screenOffsetY =
              (this.viewerDim - papaya.viewer.Viewer.GAP) / 3 +
              papaya.viewer.Viewer.GAP),
          this.getTransformParameters(
            this.lowerImageBot2,
            this.viewerDim,
            !0,
            3
          ),
          (this.lowerImageBot2.screenTransform[0][2] +=
            this.lowerImageBot2.screenOffsetX =
              this.viewerDim + papaya.viewer.Viewer.GAP),
          (this.lowerImageBot2.screenTransform[1][2] +=
            this.lowerImageBot2.screenOffsetY =
              ((this.viewerDim - papaya.viewer.Viewer.GAP) / 3) * 2 +
              2 * papaya.viewer.Viewer.GAP))
        : (this.getTransformParameters(this.mainImage, this.viewerDim, !1, 2),
          (this.mainImage.screenTransform[0][2] +=
            this.mainImage.screenOffsetX =
              0),
          (this.mainImage.screenTransform[1][2] +=
            this.mainImage.screenOffsetY =
              0),
          this.getTransformParameters(
            this.lowerImageBot,
            this.viewerDim,
            !0,
            2
          ),
          (this.lowerImageBot.screenTransform[0][2] +=
            this.lowerImageBot.screenOffsetX =
              this.viewerDim + papaya.viewer.Viewer.GAP),
          (this.lowerImageBot.screenTransform[1][2] +=
            this.lowerImageBot.screenOffsetY =
              (this.viewerDim - papaya.viewer.Viewer.GAP) / 2 +
              papaya.viewer.Viewer.GAP),
          this.getTransformParameters(
            this.lowerImageTop,
            this.viewerDim,
            !0,
            2
          ),
          (this.lowerImageTop.screenTransform[0][2] +=
            this.lowerImageTop.screenOffsetX =
              this.viewerDim + papaya.viewer.Viewer.GAP),
          (this.lowerImageTop.screenTransform[1][2] +=
            this.lowerImageTop.screenOffsetY =
              0)));
  this.updateScreenSliceTransforms();
};
papaya.viewer.Viewer.prototype.updateScreenSliceTransforms = function () {
  this.axialSlice.updateFinalTransform();
  this.coronalSlice.updateFinalTransform();
  this.sagittalSlice.updateFinalTransform();
};
papaya.viewer.Viewer.prototype.getTransformParameters = function (a, b, c, e) {
  var d = c ? e : 1;
  if (a === this.surfaceView) this.surfaceView.resize(this.viewerDim / d);
  else {
    if (a.getRealWidth() > a.getRealHeight()) {
      var g =
        ((c ? b - papaya.viewer.Viewer.GAP : b) / this.longestDim / d) *
        (a.getXSize() / this.longestDimSize);
      var h =
        ((((c ? b - papaya.viewer.Viewer.GAP : b) / this.longestDim) *
          a.getYXratio()) /
          d) *
        (a.getXSize() / this.longestDimSize);
    } else
      (g =
        ((((c ? b - papaya.viewer.Viewer.GAP : b) / this.longestDim) *
          a.getXYratio()) /
          d) *
        (a.getYSize() / this.longestDimSize)),
        (h =
          ((c ? b - papaya.viewer.Viewer.GAP : b) / this.longestDim / d) *
          (a.getYSize() / this.longestDimSize));
    var n = ((c ? b - papaya.viewer.Viewer.GAP : b) / d - a.getXDim() * g) / 2;
    d = ((c ? b - papaya.viewer.Viewer.GAP : b) / d - a.getYDim() * h) / 2;
    a.screenDim = c ? (b - papaya.viewer.Viewer.GAP) / e : b;
    a.screenTransform[0][0] = g;
    a.screenTransform[1][1] = h;
    a.screenTransform[0][2] = n;
    a.screenTransform[1][2] = d;
    a.screenTransform2[0][0] = g;
    a.screenTransform2[1][1] = h;
    a.screenTransform2[0][2] = n;
    a.screenTransform2[1][2] = d;
  }
};
papaya.viewer.Viewer.prototype.setLongestDim = function (a) {
  this.longestDim = a.getXDim();
  this.longestDimSize = a.getXSize();
  a.getYDim() * a.getYSize() > this.longestDim * this.longestDimSize &&
    ((this.longestDim = a.getYDim()), (this.longestDimSize = a.getYSize()));
  a.getZDim() * a.getZSize() > this.longestDim * this.longestDimSize &&
    ((this.longestDim = a.getZDim()), (this.longestDimSize = a.getZSize()));
};
papaya.viewer.Viewer.prototype.keyDownEvent = function (a) {
  this.keyPressIgnored = !1;
  if (
    !(
      this.container.toolbar.isShowingMenus() ||
      ((1 < papayaContainers.length || papayaContainers[0].nestedViewer) &&
        papaya.Container.papayaLastHoveredViewer !== this)
    )
  ) {
    var b = papaya.viewer.Viewer.getKeyCode(a);
    papaya.viewer.Viewer.isControlKey(a)
      ? (this.isControlKeyDown = !0)
      : papaya.viewer.Viewer.isAltKey(a)
      ? (this.isAltKeyDown = !0)
      : papaya.viewer.Viewer.isShiftKey(a)
      ? (this.isShiftKeyDown = !0)
      : b === papaya.viewer.Viewer.KEYCODE_ROTATE_VIEWS
      ? this.rotateViews()
      : b === papaya.viewer.Viewer.KEYCODE_CENTER
      ? ((b = new papaya.core.Coordinate(
          Math.floor(this.volume.header.imageDimensions.xDim / 2),
          Math.floor(this.volume.header.imageDimensions.yDim / 2),
          Math.floor(this.volume.header.imageDimensions.zDim / 2)
        )),
        this.gotoCoordinate(b))
      : b === papaya.viewer.Viewer.KEYCODE_ORIGIN
      ? this.gotoCoordinate(this.volume.header.origin)
      : b === papaya.viewer.Viewer.KEYCODE_ARROW_UP
      ? this.incrementCoronal(!1)
      : b === papaya.viewer.Viewer.KEYCODE_ARROW_DOWN
      ? this.incrementCoronal(!0)
      : b === papaya.viewer.Viewer.KEYCODE_ARROW_LEFT
      ? this.incrementSagittal(!0)
      : b === papaya.viewer.Viewer.KEYCODE_ARROW_RIGHT
      ? this.incrementSagittal(!1)
      : b === papaya.viewer.Viewer.KEYCODE_PAGE_DOWN ||
        b === papaya.viewer.Viewer.KEYCODE_FORWARD_SLASH
      ? this.incrementAxial(!0)
      : b === papaya.viewer.Viewer.KEYCODE_PAGE_UP ||
        b === papaya.viewer.Viewer.KEYCODE_SINGLE_QUOTE
      ? this.incrementAxial(!1)
      : b === papaya.viewer.Viewer.KEYCODE_INCREMENT_MAIN
      ? this.mainImage.sliceDirection ===
        papaya.viewer.ScreenSlice.DIRECTION_AXIAL
        ? this.incrementAxial(!1)
        : this.mainImage.sliceDirection ===
          papaya.viewer.ScreenSlice.DIRECTION_CORONAL
        ? this.incrementCoronal(!1)
        : this.mainImage.sliceDirection ===
            papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
          this.incrementSagittal(!0)
      : b === papaya.viewer.Viewer.KEYCODE_DECREMENT_MAIN
      ? this.mainImage.sliceDirection ===
        papaya.viewer.ScreenSlice.DIRECTION_AXIAL
        ? this.incrementAxial(!0)
        : this.mainImage.sliceDirection ===
          papaya.viewer.ScreenSlice.DIRECTION_CORONAL
        ? this.incrementCoronal(!0)
        : this.mainImage.sliceDirection ===
            papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
          this.incrementSagittal(!1)
      : b === papaya.viewer.Viewer.KEYCODE_TOGGLE_CROSSHAIRS
      ? "Yes" === this.container.preferences.showCrosshairs &&
        ((this.toggleMainCrosshairs = !this.toggleMainCrosshairs),
        this.drawViewer(!0))
      : b === papaya.viewer.Viewer.KEYCODE_SERIES_FORWARD
      ? this.incrementSeriesPoint()
      : b === papaya.viewer.Viewer.KEYCODE_SERIES_BACK
      ? this.decrementSeriesPoint()
      : b === papaya.viewer.Viewer.KEYCODE_RULER
      ? ((this.container.preferences.showRuler =
          "Yes" === this.container.preferences.showRuler ? "No" : "Yes"),
        this.drawViewer(!0, !0))
      : (this.keyPressIgnored = !0);
    this.keyPressIgnored || ((a.handled = !0), a.preventDefault());
  }
};
papaya.viewer.Viewer.prototype.keyUpEvent = function (a) {
  (1 < papayaContainers.length &&
    papaya.Container.papayaLastHoveredViewer !== this) ||
    ((this.isShiftKeyDown = this.isAltKeyDown = this.isControlKeyDown = !1),
    this.keyPressIgnored || ((a.handled = !0), a.preventDefault()),
    this.hasSurface() &&
      papaya.utilities.PlatformUtils.smallScreen &&
      this.drawViewer(!0, !1));
};
papaya.viewer.Viewer.prototype.rotateViews = function () {
  this.container.contextManager &&
    this.container.contextManager.clearContext &&
    this.container.contextManager.clearContext();
  if (this.hasSurface()) {
    var a = this.lowerImageBot2;
    this.lowerImageBot2 = this.lowerImageBot;
  } else a = this.lowerImageBot;
  this.lowerImageBot = this.lowerImageTop;
  this.lowerImageTop = this.mainImage;
  this.mainImage = a;
  this.viewsChanged();
};
papaya.viewer.Viewer.prototype.viewsChanged = function () {
  this.calculateScreenSliceTransforms();
  this.hasSurface() && this.lowerImageBot2.clearDTILinesImage();
  this.lowerImageBot.clearDTILinesImage();
  this.lowerImageTop.clearDTILinesImage();
  this.mainImage.clearDTILinesImage();
  this.controlsHidden ||
    (this.mainImage !== this.surfaceView
      ? this.fadeInControls()
      : ($(
          "#" +
            PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).fadeOut(),
        $(
          "#" +
            PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).fadeOut()),
    $("#" + PAPAYA_DEFAULT_SLIDER_ID + this.container.containerIndex + "main")
      .find("button")
      .prop("disabled", this.mainImage === this.surfaceView));
  this.drawViewer(!0);
  this.updateSliceSliderControl();
};
papaya.viewer.Viewer.prototype.timepointChanged = function () {
  this.drawViewer(!0);
  this.updateSliceSliderControl();
  this.updateWindowTitle();
};
papaya.viewer.Viewer.prototype.resetUpdateTimer = function (a) {
  var b = this;
  null !== this.updateTimer &&
    (window.clearTimeout(this.updateTimer),
    (this.updateTimerEvent = this.updateTimer = null));
  null !== a &&
    ((this.updateTimerEvent = a),
    (this.updateTimer = window.setTimeout(
      papaya.utilities.ObjectUtils.bind(b, function () {
        b.updatePosition(
          this,
          papaya.utilities.PlatformUtils.getMousePositionX(b.updateTimerEvent),
          papaya.utilities.PlatformUtils.getMousePositionY(b.updateTimerEvent)
        );
      }),
      papaya.viewer.Viewer.UPDATE_TIMER_INTERVAL
    )));
};
papaya.viewer.Viewer.prototype.mouseDownEvent = function (a) {
  var b = !0;
  papaya.Container.allowPropagation || a.stopPropagation();
  a.preventDefault();
  if (this.showingContextMenu)
    this.container.toolbar.closeAllMenus(), (a.handled = !0);
  else if ("IMG" === a.target.nodeName || "CANVAS" === a.target.nodeName) {
    if (!0 !== a.handled) {
      this.container.toolbar.closeAllMenus();
      this.previousMousePosition.x =
        papaya.utilities.PlatformUtils.getMousePositionX(a);
      this.previousMousePosition.y =
        papaya.utilities.PlatformUtils.getMousePositionY(a);
      this.findClickedSlice(
        this,
        this.previousMousePosition.x,
        this.previousMousePosition.y
      );
      if (
        (2 === a.button || this.isControlKeyDown || this.isLongTouch) &&
        this.container.contextManager &&
        this.selectedSlice === this.mainImage &&
        this.mainImage === this.surfaceView
      ) {
        this.contextMenuMousePositionX =
          this.previousMousePosition.x - this.canvasRect.left;
        this.contextMenuMousePositionY =
          this.previousMousePosition.y - this.canvasRect.top;
        if (
          this.container.contextManager.prefersColorPicking &&
          this.container.contextManager.prefersColorPicking()
        ) {
          var c = this.surfaceView.pickColor(
            this.contextMenuMousePositionX,
            this.contextMenuMousePositionY
          );
          c = this.container.contextManager.getContextAtColor(c[0], c[1], c[2]);
        }
        c &&
          ((this.isContextMode = !0),
          (c = this.container.toolbar.buildMenu(c, null, null, null, !0)),
          papaya.ui.Toolbar.applyContextState(c),
          (b = !1),
          c.showMenu(),
          (this.showingContextMenu = !0));
        this.isContextMode = !0;
      } else
        (2 !== a.button && !this.isControlKeyDown && !this.isLongTouch) ||
        !this.container.contextManager ||
        (this.selectedSlice !== this.mainImage &&
          (this.isLongTouch ||
            this.selectedSlice === this.surfaceView ||
            (this.selectedSlice !== this.lowerImageTop &&
              this.selectedSlice !== this.lowerImageBot &&
              this.selectedSlice !== this.lowerImageBot2)))
          ? (2 !== a.button && !this.isControlKeyDown) ||
            this.currentScreenVolume.rgb
            ? this.isAltKeyDown && this.selectedSlice
              ? ((this.isZoomMode = !0),
                this.selectedSlice === this.surfaceView
                  ? ((this.isPanning = this.isShiftKeyDown),
                    this.surfaceView.setStartDynamic(
                      this.previousMousePosition.x,
                      this.previousMousePosition.y
                    ))
                  : this.isZooming() && this.isShiftKeyDown
                  ? ((this.isPanning = !0),
                    this.setStartPanLocation(
                      this.convertScreenToImageCoordinateX(
                        this.previousMousePosition.x,
                        this.selectedSlice
                      ),
                      this.convertScreenToImageCoordinateY(
                        this.previousMousePosition.y,
                        this.selectedSlice
                      ),
                      this.selectedSlice.sliceDirection
                    ))
                  : this.setZoomLocation())
              : this.selectedSlice && this.selectedSlice !== this.surfaceView
              ? ((this.grabbedHandle =
                  this.selectedSlice.findProximalRulerHandle(
                    this.convertScreenToImageCoordinateX(
                      this.previousMousePosition.x - this.canvasRect.left,
                      this.selectedSlice
                    ),
                    this.convertScreenToImageCoordinateY(
                      this.previousMousePosition.y - this.canvasRect.top,
                      this.selectedSlice
                    )
                  )),
                null === this.grabbedHandle &&
                  (this.updatePosition(
                    this,
                    papaya.utilities.PlatformUtils.getMousePositionX(a),
                    papaya.utilities.PlatformUtils.getMousePositionY(a),
                    !1
                  ),
                  this.resetUpdateTimer(a)))
              : this.selectedSlice &&
                this.selectedSlice === this.surfaceView &&
                (this.surfaceView.findProximalRulerHandle(
                  this.previousMousePosition.x - this.canvasRect.left,
                  this.previousMousePosition.y - this.canvasRect.top
                ) ||
                  ((this.isPanning = this.isShiftKeyDown),
                  this.surfaceView.setStartDynamic(
                    this.previousMousePosition.x,
                    this.previousMousePosition.y
                  )),
                this.container.display.drawEmptyDisplay())
            : ((this.isWindowControl = !0),
              this.container.showImageButtons &&
                (this.container.showControlBar || !this.container.kioskMode) &&
                this.screenVolumes[
                  this.getCurrentScreenVolIndex()
                ].supportsDynamicColorTable() &&
                this.container.toolbar.showImageMenu(
                  this.getCurrentScreenVolIndex()
                ))
          : (this.isLongTouch
              ? ((c = this.convertCurrentCoordinateToScreen(this.mainImage)),
                (this.contextMenuMousePositionX = c.x),
                (this.contextMenuMousePositionY = c.y),
                (c = this.container.contextManager.getContextAtImagePosition(
                  this.currentCoord.x,
                  this.currentCoord.y,
                  this.currentCoord.z
                )))
              : ((this.contextMenuMousePositionX =
                  this.previousMousePosition.x - this.canvasRect.left),
                (this.contextMenuMousePositionY =
                  this.previousMousePosition.y - this.canvasRect.top),
                (c = this.container.contextManager.getContextAtImagePosition(
                  this.cursorPosition.x,
                  this.cursorPosition.y,
                  this.cursorPosition.z
                ))),
            c &&
              ((this.isContextMode = !0),
              (c = this.container.toolbar.buildMenu(c, null, null, null, !0)),
              papaya.ui.Toolbar.applyContextState(c),
              (b = !1),
              c.showMenu(),
              (this.showingContextMenu = !0)));
      this.isDragging = b;
      a.handled = !0;
    }
    this.controlsHidden || (this.controlsHiddenPrimed = !0);
  }
};
papaya.viewer.Viewer.prototype.mouseUpEvent = function (a) {
  papaya.Container.allowPropagation || a.stopPropagation();
  a.preventDefault();
  this.showingContextMenu
    ? ((this.showingContextMenu = !1), (a.handled = !0))
    : (("IMG" !== a.target.nodeName && "CANVAS" !== a.target.nodeName) ||
        !0 === a.handled ||
        (this.isWindowControl ||
          this.isZoomMode ||
          this.isContextMode ||
          null !== this.grabbedHandle ||
          (this.surfaceView && -1 !== this.surfaceView.grabbedRulerPoint) ||
          this.updatePosition(
            this,
            papaya.utilities.PlatformUtils.getMousePositionX(a),
            papaya.utilities.PlatformUtils.getMousePositionY(a)
          ),
        this.selectedSlice === this.surfaceView &&
          this.updateCursorPosition(
            this,
            papaya.utilities.PlatformUtils.getMousePositionX(a),
            papaya.utilities.PlatformUtils.getMousePositionY(a)
          ),
        (this.zoomFactorPrevious = this.zoomFactor),
        (this.isPanning =
          this.isZoomMode =
          this.isWindowControl =
          this.isDragging =
            !1),
        (this.selectedSlice = null),
        (this.controlsHiddenPrimed = !1),
        (a.handled = !0)),
      (this.grabbedHandle = null),
      (this.isContextMode = !1),
      this.updateWindowTitle(),
      this.updateSliceSliderControl(),
      this.container.toolbar.closeAllMenus(!0),
      this.hasSurface() &&
        (-1 === this.surfaceView.grabbedRulerPoint
          ? this.surfaceView.updateCurrent()
          : (this.surfaceView.grabbedRulerPoint = -1),
        papaya.utilities.PlatformUtils.smallScreen && this.drawViewer(!0, !1)),
      this.controlsHidden &&
        ((this.controlsHidden = !1), this.fadeInControls()));
};
papaya.viewer.Viewer.prototype.fadeOutControls = function () {
  $(
    "#" +
      PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
      this.container.containerIndex
  ).fadeOut();
  $(
    "#" +
      PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
      this.container.containerIndex
  ).fadeOut();
  $(
    "#" + PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS + this.container.containerIndex
  ).fadeOut();
  $(
    "#" +
      PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
      this.container.containerIndex
  ).fadeOut();
  $(
    "#" +
      PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
      this.container.containerIndex
  ).fadeOut();
};
papaya.viewer.Viewer.prototype.fadeInControls = function () {
  600 > this.container.getViewerDimensions()[0]
    ? (this.mainImage !== this.surfaceView &&
        ($(
          "#" +
            PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).fadeIn(),
        $(
          "#" +
            PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).fadeIn()),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS +
          this.container.containerIndex
      ).fadeIn())
    : (this.mainImage !== this.surfaceView &&
        ($(
          "#" +
            PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).fadeIn(),
        $(
          "#" +
            PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
            this.container.containerIndex
        ).fadeIn()),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS +
          this.container.containerIndex
      ).fadeIn(),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
          this.container.containerIndex
      ).fadeIn(),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
          this.container.containerIndex
      ).fadeIn());
};
papaya.viewer.Viewer.prototype.findClickedSlice = function (a, b, c) {
  b -= this.canvasRect.left;
  c -= this.canvasRect.top;
  this.insideScreenSlice(
    a.axialSlice,
    b,
    c,
    a.volume.getXDim(),
    a.volume.getYDim()
  )
    ? (this.selectedSlice = this.axialSlice)
    : this.insideScreenSlice(
        a.coronalSlice,
        b,
        c,
        a.volume.getXDim(),
        a.volume.getZDim()
      )
    ? (this.selectedSlice = this.coronalSlice)
    : this.insideScreenSlice(
        a.sagittalSlice,
        b,
        c,
        a.volume.getYDim(),
        a.volume.getZDim()
      )
    ? (this.selectedSlice = this.sagittalSlice)
    : this.insideScreenSlice(
        a.surfaceView,
        b,
        c,
        a.volume.getYDim(),
        a.volume.getZDim()
      )
    ? (this.selectedSlice = this.surfaceView)
    : (this.selectedSlice = null);
};
papaya.viewer.Viewer.prototype.mouseMoveEvent = function (a) {
  a.preventDefault();
  if (this.showingContextMenu) a.handled = !0;
  else {
    papaya.Container.papayaLastHoveredViewer = this;
    var b = papaya.utilities.PlatformUtils.getMousePositionX(a);
    var c = papaya.utilities.PlatformUtils.getMousePositionY(a);
    this.isDragging
      ? this.grabbedHandle
        ? this.isInsideMainSlice(b, c) &&
          ((this.grabbedHandle.x = this.convertScreenToImageCoordinateX(
            b - this.canvasRect.left,
            this.selectedSlice
          )),
          (this.grabbedHandle.y = this.convertScreenToImageCoordinateY(
            c - this.canvasRect.top,
            this.selectedSlice
          )),
          this.drawViewer(!0, !0))
        : this.isWindowControl
        ? (this.windowLevelChanged(
            this.previousMousePosition.x - b,
            this.previousMousePosition.y - c
          ),
          (this.previousMousePosition.x = b),
          (this.previousMousePosition.y = c))
        : this.isPanning
        ? this.selectedSlice === this.surfaceView
          ? (this.surfaceView.updateTranslateDynamic(
              papaya.utilities.PlatformUtils.getMousePositionX(a),
              papaya.utilities.PlatformUtils.getMousePositionY(a),
              this.selectedSlice === this.mainImage ? 1 : 3
            ),
            this.drawViewer(!1, !0))
          : this.setCurrentPanLocation(
              this.convertScreenToImageCoordinateX(b, this.selectedSlice),
              this.convertScreenToImageCoordinateY(c, this.selectedSlice),
              this.selectedSlice.sliceDirection
            )
        : this.isZoomMode
        ? (this.selectedSlice === this.surfaceView
            ? ((a =
                0.5 *
                (this.previousMousePosition.y - c) *
                this.surfaceView.scaleFactor),
              (this.surfaceView.zoom += a),
              (this.previousMousePosition.x = b),
              (this.previousMousePosition.y = c))
            : ((a = 0.05 * (this.previousMousePosition.y - c)),
              this.setZoomFactor(this.zoomFactorPrevious - a),
              this.axialSlice.updateZoomTransform(
                this.zoomFactor,
                this.zoomLocX,
                this.zoomLocY,
                this.panAmountX,
                this.panAmountY,
                this
              ),
              this.coronalSlice.updateZoomTransform(
                this.zoomFactor,
                this.zoomLocX,
                this.zoomLocZ,
                this.panAmountX,
                this.panAmountZ,
                this
              ),
              this.sagittalSlice.updateZoomTransform(
                this.zoomFactor,
                this.zoomLocY,
                this.zoomLocZ,
                this.panAmountY,
                this.panAmountZ,
                this
              )),
          this.drawViewer(!0))
        : (this.resetUpdateTimer(null),
          null !== this.selectedSlice &&
            (this.selectedSlice === this.surfaceView
              ? -1 !== this.surfaceView.grabbedRulerPoint
                ? (this.surfaceView.pickRuler(
                    b - this.canvasRect.left,
                    c - this.canvasRect.top
                  ),
                  this.drawViewer(!1, !0))
                : (this.surfaceView.updateDynamic(
                    papaya.utilities.PlatformUtils.getMousePositionX(a),
                    papaya.utilities.PlatformUtils.getMousePositionY(a),
                    this.selectedSlice === this.mainImage ? 1 : 3
                  ),
                  this.drawViewer(!1, !0),
                  this.container.display.drawEmptyDisplay())
              : this.updatePosition(
                  this,
                  papaya.utilities.PlatformUtils.getMousePositionX(a),
                  papaya.utilities.PlatformUtils.getMousePositionY(a)
                )))
      : (this.updateCursorPosition(
          this,
          papaya.utilities.PlatformUtils.getMousePositionX(a),
          papaya.utilities.PlatformUtils.getMousePositionY(a)
        ),
        (this.isZoomMode = !1));
    this.controlsHidden &&
      !this.isDragging &&
      ((this.controlsHidden = !1), this.fadeInControls());
    this.controlsTimer &&
      (clearTimeout(this.controlsTimer), (this.controlsTimer = null));
    this.controlsTimer = setTimeout(
      papaya.utilities.ObjectUtils.bind(this, function () {
        this.controlsHidden = !0;
        this.fadeOutControls();
      }),
      8e3
    );
    this.controlsHiddenPrimed &&
      ((this.controlsHiddenPrimed = !1),
      (this.controlsHidden = !0),
      this.fadeOutControls());
  }
};
papaya.viewer.Viewer.prototype.mouseDoubleClickEvent = function () {
  this.isAltKeyDown && ((this.zoomFactorPrevious = 1), this.setZoomFactor(1));
};
papaya.viewer.Viewer.prototype.mouseOutEvent = function (a) {
  papaya.Container.papayaLastHoveredViewer = null;
  this.isDragging
    ? this.mouseUpEvent(a)
    : (this.container.display && this.container.display.drawEmptyDisplay(),
      (this.grabbedHandle = null));
};
papaya.viewer.Viewer.prototype.mouseLeaveEvent = function () {};
papaya.viewer.Viewer.prototype.touchMoveEvent = function (a) {
  this.didLongTouch ||
    (this.longTouchTimer &&
      (clearTimeout(this.longTouchTimer), (this.longTouchTimer = null)),
    this.isDragging || (this.mouseDownEvent(a), (this.isDragging = !0)),
    this.mouseMoveEvent(a));
};
papaya.viewer.Viewer.prototype.touchStartEvent = function (a) {
  papaya.Container.allowPropagation || a.stopPropagation();
  a.preventDefault();
  this.longTouchTimer = setTimeout(
    papaya.utilities.ObjectUtils.bind(this, function () {
      this.doLongTouch(a);
    }),
    500
  );
};
papaya.viewer.Viewer.prototype.touchEndEvent = function (a) {
  this.didLongTouch ||
    (this.longTouchTimer &&
      (clearTimeout(this.longTouchTimer), (this.longTouchTimer = null)),
    this.isDragging || this.mouseDownEvent(a),
    this.mouseUpEvent(a));
  this.isLongTouch = this.didLongTouch = !1;
};
papaya.viewer.Viewer.prototype.doLongTouch = function (a) {
  this.longTouchTimer = null;
  this.isLongTouch = this.didLongTouch = !0;
  this.updateCursorPosition(
    this,
    papaya.utilities.PlatformUtils.getMousePositionX(a),
    papaya.utilities.PlatformUtils.getMousePositionY(a)
  );
  this.mouseDownEvent(a);
  this.mouseUpEvent(a);
};
papaya.viewer.Viewer.prototype.windowLevelChanged = function (a, b) {
  var c =
    0.025 *
    (this.currentScreenVolume.screenMax - this.currentScreenVolume.screenMin);
  if (Math.abs(a) > Math.abs(b)) {
    var e =
      this.currentScreenVolume.screenMin +
      c * papaya.utilities.MathUtils.signum(a);
    a =
      this.currentScreenVolume.screenMax +
      -1 * c * papaya.utilities.MathUtils.signum(a);
    this.currentScreenVolume.negative
      ? a >= e && (a = e = this.currentScreenVolume.screenMin)
      : a <= e && (a = e = this.currentScreenVolume.screenMin);
  } else
    (e =
      this.currentScreenVolume.screenMin +
      c * papaya.utilities.MathUtils.signum(b)),
      (a =
        this.currentScreenVolume.screenMax +
        c * papaya.utilities.MathUtils.signum(b));
  this.currentScreenVolume.setScreenRange(e, a);
  this.container.showImageButtons &&
    this.container.toolbar.updateImageMenuRange(
      this.getCurrentScreenVolIndex(),
      parseFloat(e.toPrecision(7)),
      parseFloat(a.toPrecision(7))
    );
  this.drawViewer(!0);
};
papaya.viewer.Viewer.prototype.gotoCoordinate = function (a, b) {
  if (this.initialized) {
    var c = this.volume.header.imageDimensions.xDim,
      e = this.volume.header.imageDimensions.yDim,
      d = this.volume.header.imageDimensions.zDim;
    this.currentCoord.x = 0 > a.x ? 0 : a.x >= c ? c - 1 : a.x;
    this.currentCoord.y = 0 > a.y ? 0 : a.y >= e ? e - 1 : a.y;
    this.currentCoord.z = 0 > a.z ? 0 : a.z >= d ? d - 1 : a.z;
    this.drawViewer(!0);
    this.updateSliceSliderControl();
    b || (this.container.coordinateChanged(this), this.drawViewer(!1));
  }
};
papaya.viewer.Viewer.prototype.gotoWorldCoordinate = function (a, b) {
  var c = new papaya.core.Coordinate();
  this.gotoCoordinate(this.getIndexCoordinateAtWorld(a.x, a.y, a.z, c), b);
};
papaya.viewer.Viewer.prototype.resizeViewer = function (a) {
  var b = PAPAYA_PADDING / 2;
  this.canvas.width = a[0];
  this.canvas.height = a[1];
  if (
    this.initialized &&
    (this.calculateScreenSliceTransforms(),
    (this.canvasRect = this.canvas.getBoundingClientRect()),
    this.drawViewer(!0),
    this.container.showControls)
  ) {
    a = $(this.canvas).offset();
    var c = $(
      "#" +
        PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
        this.container.containerIndex
    );
    c.css({
      top: a.top + b,
      left: a.left + this.mainImage.screenDim - c.outerWidth() - b,
      position: "absolute",
    });
    c = $(
      "#" +
        PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
        this.container.containerIndex
    );
    c.css({
      top: a.top + c.outerHeight() + PAPAYA_PADDING,
      left: a.left + this.mainImage.screenDim - c.outerWidth() - b,
      position: "absolute",
    });
    c = $(
      "#" + PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS + this.container.containerIndex
    );
    c.css({
      top: a.top + this.mainImage.screenDim - c.outerHeight() - b,
      left: a.left + this.mainImage.screenDim - c.outerWidth() - b,
      position: "absolute",
    });
    c = $(
      "#" +
        PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
        this.container.containerIndex
    );
    c.css({
      top: a.top + this.mainImage.screenDim - c.outerHeight() - b,
      left: a.left + b,
      position: "absolute",
    });
    c = $(
      "#" +
        PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
        this.container.containerIndex
    );
    c.css({
      top: a.top + this.mainImage.screenDim - c.outerHeight() - b,
      left: a.left + b + c.outerWidth() + PAPAYA_PADDING,
      position: "absolute",
    });
  }
};
papaya.viewer.Viewer.prototype.getWorldCoordinateAtIndex = function (
  a,
  b,
  c,
  e
) {
  e.setCoordinate(
    (a - this.volume.header.origin.x) *
      this.volume.header.voxelDimensions.xSize,
    (this.volume.header.origin.y - b) *
      this.volume.header.voxelDimensions.ySize,
    (this.volume.header.origin.z - c) * this.volume.header.voxelDimensions.zSize
  );
  return e;
};
papaya.viewer.Viewer.prototype.getIndexCoordinateAtWorld = function (
  a,
  b,
  c,
  e
) {
  a = this.volume.transform.getRotatedCoordinate(a, b, c);
  a.x =
    a.x / this.volume.header.voxelDimensions.xSize +
    this.volume.header.origin.x;
  a.y =
    -1 *
    (a.y / this.volume.header.voxelDimensions.ySize -
      this.volume.header.origin.y);
  a.z =
    -1 *
    (a.z / this.volume.header.voxelDimensions.zSize -
      this.volume.header.origin.z);
  e.setCoordinate(a.x, a.y, a.z, !0);
  return e;
};
papaya.viewer.Viewer.prototype.getNextColorTable = function () {
  var a,
    b = 0;
  for (a = 1; a < this.screenVolumes.length; a += 1)
    this.screenVolumes[a].dti || (b += 1);
  return papaya.viewer.ColorTable.OVERLAY_COLOR_TABLES[
    b % papaya.viewer.ColorTable.OVERLAY_COLOR_TABLES.length
  ].name;
};
papaya.viewer.Viewer.prototype.getCurrentValueAt = function (a, b, c) {
  var e = !this.currentScreenVolume.interpolation;
  e &= "Yes" === this.container.preferences.smoothDisplay;
  return this.worldSpace
    ? ((e |=
        this.currentScreenVolume.volume === this.volume &&
        this.volume.isWorldSpaceOnly()),
      this.currentScreenVolume.volume.getVoxelAtCoordinate(
        (a - this.volume.header.origin.x) *
          this.volume.header.voxelDimensions.xSize,
        (this.volume.header.origin.y - b) *
          this.volume.header.voxelDimensions.ySize,
        (this.volume.header.origin.z - c) *
          this.volume.header.voxelDimensions.zSize,
        this.currentScreenVolume.currentTimepoint,
        !e
      ))
    : this.currentScreenVolume.volume.getVoxelAtMM(
        a * this.volume.header.voxelDimensions.xSize,
        b * this.volume.header.voxelDimensions.ySize,
        c * this.volume.header.voxelDimensions.zSize,
        this.currentScreenVolume.currentTimepoint,
        !e
      );
};
papaya.viewer.Viewer.prototype.getIndexAt = function (a, b, c, e) {
  a =
    this.worldSpace || e
      ? this.screenVolumes[0].volume.transform.getIndexAtCoordinate(
          (a - this.volume.header.origin.x) *
            this.volume.header.voxelDimensions.xSize,
          (this.volume.header.origin.y - b) *
            this.volume.header.voxelDimensions.ySize,
          (this.volume.header.origin.z - c) *
            this.volume.header.voxelDimensions.zSize
        )
      : this.screenVolumes[0].volume.transform.getIndexAtMM(
          a * this.volume.header.voxelDimensions.xSize,
          b * this.volume.header.voxelDimensions.ySize,
          c * this.volume.header.voxelDimensions.zSize
        );
  a.y = this.volume.header.imageDimensions.yDim - a.y - 1;
  a.z = this.volume.header.imageDimensions.zDim - a.z - 1;
  return a;
};
papaya.viewer.Viewer.prototype.resetViewer = function () {
  this.container.showControlBar
    ? ($("." + PAPAYA_CONTROL_INCREMENT_BUTTON_CSS).prop("disabled", !0),
      $("." + PAPAYA_CONTROL_SWAP_BUTTON_CSS).prop("disabled", !0),
      $("." + PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).prop("disabled", !0),
      $("." + PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).prop("disabled", !0))
    : this.container.showControls &&
      ($(
        "#" +
          PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
          this.container.containerIndex
      ).css({ display: "none" }),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
          this.container.containerIndex
      ).css({ display: "none" }),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS +
          this.container.containerIndex
      ).css({ display: "none" }),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
          this.container.containerIndex
      ).css({ display: "none" }),
      $(
        "#" +
          PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
          this.container.containerIndex
      ).css({ display: "none" }));
  this.initialized = !1;
  this.loadingVolume = null;
  this.volume = new papaya.volume.Volume(this.container.display, this);
  this.screenVolumes = [];
  this.surfaces = [];
  this.lowerImageTop =
    this.lowerImageBot =
    this.lowerImageBot2 =
    this.mainImage =
    this.sagittalSlice =
    this.coronalSlice =
    this.axialSlice =
    this.currentScreenVolume =
    this.surfaceView =
      null;
  this.viewerDim = 0;
  this.currentCoord = new papaya.core.Coordinate(0, 0, 0);
  this.draggingSliceDir = this.longestDimSize = this.longestDim = 0;
  this.hasSeries = this.isWindowControl = this.isDragging = !1;
  this.previousMousePosition = new papaya.core.Point();
  this.canvas.removeEventListener("mousemove", this.listenerMouseMove, !1);
  this.canvas.removeEventListener("mousedown", this.listenerMouseDown, !1);
  this.canvas.removeEventListener("mouseout", this.listenerMouseOut, !1);
  this.canvas.removeEventListener("mouseleave", this.listenerMouseLeave, !1);
  this.canvas.removeEventListener("mouseup", this.listenerMouseUp, !1);
  document.removeEventListener("keydown", this.listenerKeyDown, !0);
  document.removeEventListener("keyup", this.listenerKeyUp, !0);
  document.removeEventListener("contextmenu", this.listenerContextMenu, !1);
  this.canvas.removeEventListener("touchmove", this.listenerTouchMove, !1);
  this.canvas.removeEventListener("touchstart", this.listenerTouchStart, !1);
  this.canvas.removeEventListener("touchend", this.listenerTouchEnd, !1);
  this.canvas.removeEventListener(
    "dblclick",
    this.listenerMouseDoubleClick,
    !1
  );
  this.removeScroll();
  this.updateTimerEvent = this.updateTimer = null;
  this.drawEmptyViewer();
  this.container.display && this.container.display.drawEmptyDisplay();
  this.updateSliceSliderControl();
  this.container.toolbar.buildToolbar();
};
papaya.viewer.Viewer.prototype.getHeaderDescription = function (a) {
  return this.screenVolumes[a || 0].volume.header.toString();
};
papaya.viewer.Viewer.prototype.getImageDimensionsDescription = function (a) {
  var b = this.screenVolumes[a].volume.header.orientation.orientation;
  a = this.screenVolumes[a].volume.header.imageDimensions;
  return (
    "(" +
    b.charAt(0) +
    ", " +
    b.charAt(1) +
    ", " +
    b.charAt(2) +
    ") " +
    a.cols +
    " x " +
    a.rows +
    " x " +
    a.slices
  );
};
papaya.viewer.Viewer.prototype.getVoxelDimensionsDescription = function (a) {
  var b = this.screenVolumes[a].volume.header.orientation.orientation;
  a = this.screenVolumes[a].volume.header.voxelDimensions;
  return (
    "(" +
    b.charAt(0) +
    ", " +
    b.charAt(1) +
    ", " +
    b.charAt(2) +
    ") " +
    papaya.utilities.StringUtils.formatNumber(a.colSize, !0) +
    " x " +
    papaya.utilities.StringUtils.formatNumber(a.rowSize, !0) +
    " x " +
    papaya.utilities.StringUtils.formatNumber(a.sliceSize, !0) +
    " " +
    a.getSpatialUnitString()
  );
};
papaya.viewer.Viewer.prototype.getSeriesDimensionsDescription = function (a) {
  return this.screenVolumes[
    a
  ].volume.header.imageDimensions.timepoints.toString();
};
papaya.viewer.Viewer.prototype.getSeriesSizeDescription = function (a) {
  a = this.screenVolumes[a].volume.header.voxelDimensions;
  return a.timeSize.toString() + " " + a.getTemporalUnitString();
};
papaya.viewer.Viewer.prototype.getFilename = function (a) {
  return papaya.utilities.StringUtils.wordwrap(
    this.screenVolumes[a].volume.fileName,
    25,
    "<br />",
    !0
  );
};
papaya.viewer.Viewer.prototype.getSurfaceFilename = function (a) {
  return papaya.utilities.StringUtils.wordwrap(
    this.surfaces[a].filename,
    25,
    "<br />",
    !0
  );
};
papaya.viewer.Viewer.prototype.getSurfaceNumPoints = function (a) {
  return this.surfaces[a].numPoints;
};
papaya.viewer.Viewer.prototype.getSurfaceNumTriangles = function (a) {
  return this.surfaces[a].numTriangles;
};
papaya.viewer.Viewer.prototype.getNiceFilename = function (a) {
  var b = !1;
  var c = this.screenVolumes[a].volume.fileName;
  if (
    this.screenVolumes[a].volume.params[c] &&
    this.screenVolumes[a].volume.params[c].nicename
  )
    (c = this.screenVolumes[a].volume.params[c].nicename),
      (b = !0),
      this.screenVolumes[a].negative && (c += " (Neg)");
  else
    for (var e = 0; e < papayaLoadableImages.length; e++)
      if (
        ((a = papayaLoadableImages[e]),
        a.hasOwnProperty("url") &&
          a.hasOwnProperty("nicename") &&
          a.url.endsWith(c))
      ) {
        c = a.nicename;
        b = !0;
        break;
      }
  b || (c = c.replace(".nii", "").replace(".gz", "").replace(".gii", ""));
  c.length > papaya.viewer.Viewer.TITLE_MAX_LENGTH &&
    (c = c.substr(0, papaya.viewer.Viewer.TITLE_MAX_LENGTH - 3) + "...");
  return c;
};
papaya.viewer.Viewer.prototype.getFileLength = function (a) {
  return papaya.utilities.StringUtils.getSizeString(
    this.screenVolumes[a].volume.fileLength
  );
};
papaya.viewer.Viewer.prototype.getByteTypeDescription = function (a) {
  return (
    this.screenVolumes[a].volume.header.imageType.numBytes +
    "-Byte " +
    this.screenVolumes[a].volume.header.imageType.getTypeDescription()
  );
};
papaya.viewer.Viewer.prototype.getByteOrderDescription = function (a) {
  return this.screenVolumes[a].volume.header.imageType.getOrderDescription();
};
papaya.viewer.Viewer.prototype.getCompressedDescription = function (a) {
  return this.screenVolumes[a].volume.header.imageType.compressed
    ? "Yes"
    : "No";
};
papaya.viewer.Viewer.prototype.getOrientationDescription = function (a) {
  return this.screenVolumes[
    a
  ].volume.header.orientation.getOrientationDescription();
};
papaya.viewer.Viewer.prototype.getImageDescription = function (a) {
  return papaya.utilities.StringUtils.wordwrap(
    this.screenVolumes[a].volume.header.imageDescription.notes,
    35,
    "<br />",
    !0
  );
};
papaya.viewer.Viewer.prototype.setCurrentScreenVol = function (a) {
  this.currentScreenVolume = this.screenVolumes[a];
  this.updateWindowTitle();
};
papaya.viewer.Viewer.prototype.updateWindowTitle = function () {
  if (this.initialized) {
    var a = this.getNiceFilename(this.getCurrentScreenVolIndex());
    1 < this.currentScreenVolume.volume.numTimepoints &&
      (a =
        this.currentScreenVolume.seriesLabels &&
        this.currentScreenVolume.seriesLabels.length >
          this.currentScreenVolume.currentTimepoint
          ? this.currentScreenVolume.seriesLabels[
              this.currentScreenVolume.currentTimepoint
            ]
          : a +
            " (" +
            (this.currentScreenVolume.currentTimepoint + 1) +
            " of " +
            this.currentScreenVolume.volume.numTimepoints +
            ")");
    this.isZooming() && (a = a + " " + this.getZoomString());
    this.container.toolbar.updateTitleBar(a);
  }
};
papaya.viewer.Viewer.prototype.getCurrentScreenVolIndex = function () {
  var a;
  for (a = 0; a < this.screenVolumes.length; a += 1)
    if (this.screenVolumes[a] === this.currentScreenVolume) return a;
  return -1;
};
papaya.viewer.Viewer.prototype.toggleWorldSpace = function () {
  this.worldSpace = !this.worldSpace;
  this.container.syncOverlaySeries &&
    this.reconcileOverlaySeriesPoint(this.currentScreenVolume);
};
papaya.viewer.Viewer.prototype.isSelected = function (a) {
  return this.isSelectable() && a === this.getCurrentScreenVolIndex();
};
papaya.viewer.Viewer.prototype.isSelectable = function () {
  return 1 < this.screenVolumes.length;
};
papaya.viewer.Viewer.prototype.processParams = function (a) {
  a.worldSpace && (this.worldSpace = !0);
  a.ignoreNiftiTransforms && (this.ignoreNiftiTransforms = !0);
  a.coordinate && (this.initialCoordinate = a.coordinate);
  a.ignoreSync && (this.ignoreSync = a.ignoreSync);
  this.container.isDesktopMode() ||
    (void 0 !== a.showOrientation &&
      (this.container.preferences.showOrientation = a.showOrientation
        ? "Yes"
        : "No"),
    void 0 !== a.smoothDisplay &&
      (this.container.preferences.smoothDisplay = a.smoothDisplay
        ? "Yes"
        : "No"),
    void 0 !== a.radiological &&
      (this.container.preferences.radiological = a.radiological ? "Yes" : "No"),
    void 0 !== a.showRuler &&
      (this.container.preferences.showRuler = a.showRuler ? "Yes" : "No"),
    void 0 !== a.showSurfacePlanes &&
      (this.container.preferences.showSurfacePlanes = a.showSurfacePlanes
        ? "Yes"
        : "No"),
    void 0 !== a.showSurfaceCrosshairs &&
      (this.container.preferences.showSurfaceCrosshairs =
        a.showSurfaceCrosshairs ? "Yes" : "No"));
};
papaya.viewer.Viewer.prototype.hasLoadedDTI = function () {
  return (
    1 === this.screenVolumes.length &&
    this.screenVolumes[0].dti &&
    null === this.screenVolumes[0].dtiVolumeMod
  );
};
papaya.viewer.Viewer.prototype.goToInitialCoordinate = function () {
  var a = new papaya.core.Coordinate();
  0 < this.screenVolumes.length &&
    (null === this.initialCoordinate
      ? a.setCoordinate(
          papayaFloorFast(this.volume.header.imageDimensions.xDim / 2),
          papayaFloorFast(this.volume.header.imageDimensions.yDim / 2),
          papayaFloorFast(this.volume.header.imageDimensions.zDim / 2),
          !0
        )
      : (this.worldSpace
          ? this.getIndexCoordinateAtWorld(
              this.initialCoordinate[0],
              this.initialCoordinate[1],
              this.initialCoordinate[2],
              a
            )
          : a.setCoordinate(
              this.initialCoordinate[0],
              this.initialCoordinate[1],
              this.initialCoordinate[2],
              !0
            ),
        (this.initialCoordinate = null)),
    this.gotoCoordinate(a),
    this.container.display &&
      this.container.display.drawDisplay(
        this.currentCoord.x,
        this.currentCoord.y,
        this.currentCoord.z
      ));
};
papaya.viewer.Viewer.prototype.getOrientationCertaintyColor = function () {
  var a = this.screenVolumes[0].volume.header.orientationCertainty;
  return a === papaya.volume.Header.ORIENTATION_CERTAINTY_LOW
    ? papaya.viewer.Viewer.ORIENTATION_CERTAINTY_LOW_COLOR
    : a === papaya.volume.Header.ORIENTATION_CERTAINTY_HIGH
    ? papaya.viewer.Viewer.ORIENTATION_CERTAINTY_HIGH_COLOR
    : papaya.viewer.Viewer.ORIENTATION_CERTAINTY_UNKNOWN_COLOR;
};
papaya.viewer.Viewer.prototype.isUsingAtlas = function (a) {
  return a === this.atlas.currentAtlas;
};
papaya.viewer.Viewer.prototype.scrolled = function (a) {
  a = a || window.event;
  if (a.target == this.canvas) {
    a.preventDefault && a.preventDefault();
    a.returnValue = !1;
    var b = "Increment Slice" === this.container.preferences.scrollBehavior;
    a = papaya.utilities.PlatformUtils.getScrollSign(a, !b);
    b
      ? 0 > a
        ? (this.mainImage.sliceDirection ===
          papaya.viewer.ScreenSlice.DIRECTION_AXIAL
            ? this.incrementAxial(!1, Math.abs(a))
            : this.mainImage.sliceDirection ===
              papaya.viewer.ScreenSlice.DIRECTION_CORONAL
            ? this.incrementCoronal(!1, Math.abs(a))
            : this.mainImage.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
              this.incrementSagittal(!1, Math.abs(a)),
          this.gotoCoordinate(this.currentCoord))
        : 0 < a &&
          (this.mainImage.sliceDirection ===
          papaya.viewer.ScreenSlice.DIRECTION_AXIAL
            ? this.incrementAxial(!0, Math.abs(a))
            : this.mainImage.sliceDirection ===
              papaya.viewer.ScreenSlice.DIRECTION_CORONAL
            ? this.incrementCoronal(!0, Math.abs(a))
            : this.mainImage.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
              this.incrementSagittal(!0, Math.abs(a)),
          this.gotoCoordinate(this.currentCoord))
      : 0 !== a &&
        ((this.isZoomMode = !0),
        this.mainImage === this.surfaceView
          ? ((this.surfaceView.zoom += -5 * a * this.surfaceView.scaleFactor),
            this.drawViewer(!1, !0))
          : (this.mainImage.sliceDirection ===
            papaya.viewer.ScreenSlice.DIRECTION_AXIAL
              ? this.setZoomLocation(
                  this.currentCoord.x,
                  this.currentCoord.y,
                  this.mainImage.sliceDirection
                )
              : this.mainImage.sliceDirection ===
                papaya.viewer.ScreenSlice.DIRECTION_CORONAL
              ? this.setZoomLocation(
                  this.currentCoord.x,
                  this.currentCoord.z,
                  this.mainImage.sliceDirection
                )
              : this.mainImage.sliceDirection ===
                  papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
                this.setZoomLocation(
                  this.currentCoord.y,
                  this.currentCoord.z,
                  this.mainImage.sliceDirection
                ),
            this.setZoomFactor(
              this.zoomFactorPrevious + 0.1 * a * this.zoomFactorPrevious
            )),
        (this.zoomFactorPrevious = this.zoomFactor));
  }
};
papaya.viewer.Viewer.prototype.incrementAxial = function (a, b) {
  var c = this.volume.header.imageDimensions.zDim;
  void 0 === b && (b = 1);
  a
    ? ((this.currentCoord.z += b),
      this.currentCoord.z >= c && (this.currentCoord.z = c - 1))
    : ((this.currentCoord.z -= b),
      0 > this.currentCoord.z && (this.currentCoord.z = 0));
  this.gotoCoordinate(this.currentCoord);
};
papaya.viewer.Viewer.prototype.incrementCoronal = function (a, b) {
  var c = this.volume.header.imageDimensions.yDim;
  void 0 === b && (b = 1);
  a
    ? ((this.currentCoord.y += b),
      this.currentCoord.y >= c && (this.currentCoord.y = c - 1))
    : ((this.currentCoord.y -= b),
      0 > this.currentCoord.y && (this.currentCoord.y = 0));
  this.gotoCoordinate(this.currentCoord);
};
papaya.viewer.Viewer.prototype.incrementSagittal = function (a, b) {
  var c = this.volume.header.imageDimensions.xDim;
  void 0 === b && (b = 1);
  a
    ? ((this.currentCoord.x -= b),
      0 > this.currentCoord.x && (this.currentCoord.x = 0))
    : ((this.currentCoord.x += b),
      this.currentCoord.x >= c && (this.currentCoord.x = c - 1));
  this.gotoCoordinate(this.currentCoord);
};
papaya.viewer.Viewer.prototype.setZoomFactor = function (a) {
  a > papaya.viewer.Viewer.ZOOM_FACTOR_MAX
    ? (a = papaya.viewer.Viewer.ZOOM_FACTOR_MAX)
    : a < papaya.viewer.Viewer.ZOOM_FACTOR_MIN &&
      (a = papaya.viewer.Viewer.ZOOM_FACTOR_MIN);
  this.zoomFactor = a;
  1 === this.zoomFactor &&
    (this.panAmountX = this.panAmountY = this.panAmountZ = 0);
  this.axialSlice.updateZoomTransform(
    this.zoomFactor,
    this.zoomLocX,
    this.zoomLocY,
    this.panAmountX,
    this.panAmountY,
    this
  );
  this.coronalSlice.updateZoomTransform(
    this.zoomFactor,
    this.zoomLocX,
    this.zoomLocZ,
    this.panAmountX,
    this.panAmountZ,
    this
  );
  this.sagittalSlice.updateZoomTransform(
    this.zoomFactor,
    this.zoomLocY,
    this.zoomLocZ,
    this.panAmountY,
    this.panAmountZ,
    this
  );
  this.drawViewer(!1, !0);
  this.updateWindowTitle();
};
papaya.viewer.Viewer.prototype.getZoomString = function () {
  return parseInt(100 * this.zoomFactor, 10) + "%";
};
papaya.viewer.Viewer.prototype.isZooming = function () {
  return 1 < this.zoomFactor;
};
papaya.viewer.Viewer.prototype.setZoomLocation = function () {
  1 === this.zoomFactor &&
    ((this.zoomLocX = this.currentCoord.x),
    (this.zoomLocY = this.currentCoord.y),
    (this.zoomLocZ = this.currentCoord.z),
    this.axialSlice.updateZoomTransform(
      this.zoomFactor,
      this.zoomLocX,
      this.zoomLocY,
      this.panAmountX,
      this.panAmountY,
      this
    ),
    this.coronalSlice.updateZoomTransform(
      this.zoomFactor,
      this.zoomLocX,
      this.zoomLocZ,
      this.panAmountX,
      this.panAmountZ,
      this
    ),
    this.sagittalSlice.updateZoomTransform(
      this.zoomFactor,
      this.zoomLocY,
      this.zoomLocZ,
      this.panAmountY,
      this.panAmountZ,
      this
    ),
    this.drawViewer(!1, !0));
};
papaya.viewer.Viewer.prototype.setStartPanLocation = function (a, b, c) {
  1 < this.zoomFactor &&
    (c === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
      ? ((this.panLocX = a),
        (this.panLocY = b),
        (this.panLocZ = this.axialSlice.currentSlice))
      : c === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
      ? ((this.panLocX = a),
        (this.panLocY = this.coronalSlice.currentSlice),
        (this.panLocZ = b))
      : c === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
        ((this.panLocX = this.sagittalSlice.currentSlice),
        (this.panLocY = a),
        (this.panLocZ = b)));
};
papaya.viewer.Viewer.prototype.setCurrentPanLocation = function (a, b, c) {
  1 < this.zoomFactor &&
    (c === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
      ? ((this.panAmountX += a - this.panLocX),
        (this.panAmountY += b - this.panLocY),
        (this.panAmountZ = 0))
      : c === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
      ? ((this.panAmountX += a - this.panLocX),
        (this.panAmountY = 0),
        (this.panAmountZ += b - this.panLocZ))
      : c === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
        ((this.panAmountX = 0),
        (this.panAmountY += a - this.panLocY),
        (this.panAmountZ += b - this.panLocZ)),
    this.axialSlice.updateZoomTransform(
      this.zoomFactor,
      this.zoomLocX,
      this.zoomLocY,
      this.panAmountX,
      this.panAmountY,
      this
    ),
    this.coronalSlice.updateZoomTransform(
      this.zoomFactor,
      this.zoomLocX,
      this.zoomLocZ,
      this.panAmountX,
      this.panAmountZ,
      this
    ),
    this.sagittalSlice.updateZoomTransform(
      this.zoomFactor,
      this.zoomLocY,
      this.zoomLocZ,
      this.panAmountY,
      this.panAmountZ,
      this
    ),
    this.drawViewer(!1, !0));
};
papaya.viewer.Viewer.prototype.isWorldMode = function () {
  return this.worldSpace;
};
papaya.viewer.Viewer.prototype.isRadiologicalMode = function () {
  return "Yes" === this.container.preferences.radiological;
};
papaya.viewer.Viewer.prototype.isCollapsable = function () {
  return this.container.collapsable;
};
papaya.viewer.Viewer.prototype.mainSliderControlChanged = function () {
  this.mainImage.sliceDirection === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
    ? (this.currentCoord.z = parseInt(this.mainSliderControl.val(), 10))
    : this.mainImage.sliceDirection ===
      papaya.viewer.ScreenSlice.DIRECTION_CORONAL
    ? (this.currentCoord.y = parseInt(this.mainSliderControl.val(), 10))
    : this.mainImage.sliceDirection ===
        papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL &&
      (this.currentCoord.x = parseInt(this.mainSliderControl.val(), 10));
  this.gotoCoordinate(this.currentCoord);
};
papaya.viewer.Viewer.prototype.axialSliderControlChanged = function () {
  this.currentCoord.z = parseInt(this.axialSliderControl.val(), 10);
  this.gotoCoordinate(this.currentCoord);
};
papaya.viewer.Viewer.prototype.coronalSliderControlChanged = function () {
  this.currentCoord.y = parseInt(this.coronalSliderControl.val(), 10);
  this.gotoCoordinate(this.currentCoord);
};
papaya.viewer.Viewer.prototype.sagittalSliderControlChanged = function () {
  this.currentCoord.x = parseInt(this.sagittalSliderControl.val(), 10);
  this.gotoCoordinate(this.currentCoord);
};
papaya.viewer.Viewer.prototype.seriesSliderControlChanged = function () {
  this.currentScreenVolume.setTimepoint(
    parseInt(this.seriesSliderControl.val(), 10)
  );
  this.currentScreenVolume.isOverlay() &&
    this.container.syncOverlaySeries &&
    this.reconcileOverlaySeriesPoint(this.currentScreenVolume);
  this.timepointChanged();
};
papaya.viewer.Viewer.prototype.updateSliceSliderControl = function () {
  this.mainSliderControl &&
    this.doUpdateSliceSliderControl(
      this.mainSliderControl,
      this.mainImage.sliceDirection
    );
  this.axialSliderControl &&
    this.doUpdateSliceSliderControl(
      this.axialSliderControl,
      papaya.viewer.ScreenSlice.DIRECTION_AXIAL
    );
  this.coronalSliderControl &&
    this.doUpdateSliceSliderControl(
      this.coronalSliderControl,
      papaya.viewer.ScreenSlice.DIRECTION_CORONAL
    );
  this.sagittalSliderControl &&
    this.doUpdateSliceSliderControl(
      this.sagittalSliderControl,
      papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL
    );
  this.seriesSliderControl &&
    this.doUpdateSliceSliderControl(
      this.seriesSliderControl,
      papaya.viewer.ScreenSlice.DIRECTION_TEMPORAL
    );
};
papaya.viewer.Viewer.prototype.doUpdateSliceSliderControl = function (a, b) {
  this.initialized
    ? (a.prop("disabled", !1),
      a.prop("min", "0"),
      a.prop("step", "1"),
      b === papaya.viewer.ScreenSlice.DIRECTION_AXIAL
        ? (a.prop(
            "max",
            (this.volume.header.imageDimensions.zDim - 1).toString()
          ),
          a.val(this.currentCoord.z))
        : b === papaya.viewer.ScreenSlice.DIRECTION_CORONAL
        ? (a.prop(
            "max",
            (this.volume.header.imageDimensions.yDim - 1).toString()
          ),
          a.val(this.currentCoord.y))
        : b === papaya.viewer.ScreenSlice.DIRECTION_SAGITTAL
        ? (a.prop(
            "max",
            (this.volume.header.imageDimensions.xDim - 1).toString()
          ),
          a.val(this.currentCoord.x))
        : b === papaya.viewer.ScreenSlice.DIRECTION_TEMPORAL &&
          (a.prop(
            "max",
            (
              this.currentScreenVolume.volume.header.imageDimensions
                .timepoints - 1
            ).toString()
          ),
          a.val(this.currentScreenVolume.currentTimepoint)))
    : (a.prop("disabled", !0),
      a.prop("min", "0"),
      a.prop("step", "1"),
      a.prop("max", "1"),
      a.val(0));
};
papaya.viewer.Viewer.prototype.incrementSeriesPoint = function () {
  this.currentScreenVolume.incrementTimepoint();
  this.currentScreenVolume.isOverlay() &&
    this.container.syncOverlaySeries &&
    this.reconcileOverlaySeriesPoint(this.currentScreenVolume);
  this.timepointChanged();
};
papaya.viewer.Viewer.prototype.decrementSeriesPoint = function () {
  this.currentScreenVolume.decrementTimepoint();
  this.currentScreenVolume.isOverlay() &&
    this.container.syncOverlaySeries &&
    this.reconcileOverlaySeriesPoint(this.currentScreenVolume);
  this.timepointChanged();
};
papaya.viewer.Viewer.prototype.reconcileOverlaySeriesPoint = function (a) {
  var b;
  if (this.worldSpace) {
    var c = a.getCurrentTime();
    for (b = 1; b < this.screenVolumes.length; b += 1)
      this.screenVolumes[b] !== a && this.screenVolumes[b].setCurrentTime(c);
  } else
    for (c = a.currentTimepoint, b = 1; b < this.screenVolumes.length; b += 1)
      this.screenVolumes[b] !== a && this.screenVolumes[b].setTimepoint(c);
};
papaya.viewer.Viewer.prototype.hasParametricPair = function (a) {
  return a ? null !== this.screenVolumes[a].negativeScreenVol : !1;
};
papaya.viewer.Viewer.prototype.getScreenVolumeIndex = function (a) {
  var b;
  if (a)
    for (b = 0; b < this.screenVolumes.length; b += 1)
      if (a === this.screenVolumes[b]) return b;
  return -1;
};
papaya.viewer.Viewer.prototype.getScreenVolumeByName = function (a) {
  var b;
  for (b = 0; b < this.screenVolumes.length; b += 1)
    if (a == this.screenVolumes[b].volume.fileName)
      return this.screenVolumes[b];
  return null;
};
papaya.viewer.Viewer.prototype.isShowingRuler = function () {
  return "Yes" === this.container.preferences.showRuler;
};
papaya.viewer.Viewer.prototype.isShowingOrientation = function () {
  return "Yes" === this.container.preferences.showOrientation;
};
papaya.viewer.Viewer.prototype.isShowingCrosshairs = function () {
  return "Yes" === this.container.preferences.showCrosshairs;
};
papaya.viewer.Viewer.prototype.isShowingSurfacePlanes = function () {
  return this.surfaceView && this.surfaceView.showSurfacePlanes;
};
papaya.viewer.Viewer.prototype.isShowingSurfaceCrosshairs = function () {
  return this.surfaceView && this.surfaceView.showSurfaceCrosshairs;
};
papaya.viewer.Viewer.prototype.isShowingVolumeBoundaries = function () {
  return "Yes" === this.container.preferences.showVolumeBoundaries;
};
papaya.viewer.Viewer.prototype.isShowingSurfaceBoundaries = function () {
  return "Yes" === this.container.preferences.showSurfaceBoundaries;
};
papaya.viewer.Viewer.prototype.restart = function (a, b, c, e) {
  this.resetViewer();
  this.container.toolbar.updateImageButtons();
  this.loadImage(a, b, c, e);
};
papaya.viewer.Viewer.prototype.removeOverlay = function (a) {
  a = this.container.viewer.screenVolumes[a];
  var b = a.negativeScreenVol;
  this.closeOverlayByRef(a);
  this.container.combineParametric && this.closeOverlayByRef(b);
  this.drawViewer(!0, !1);
};
papaya.viewer.Viewer.prototype.toggleOverlay = function (a) {
  a = this.container.viewer.screenVolumes[a];
  a.hidden = !a.hidden;
  var b = a.negativeScreenVol;
  this.container.combineParametric && b && (b.hidden = !b.hidden);
  this.drawViewer(!0, !1);
  return a.hidden;
};
papaya.viewer.Viewer.prototype.addParametric = function (a) {
  a = this.container.viewer.screenVolumes[a];
  var b;
  null === a.negativeScreenVol &&
    ((this.screenVolumes[this.screenVolumes.length] = b =
      new papaya.viewer.ScreenVolume(
        a.volume,
        {},
        papaya.viewer.ColorTable.PARAMETRIC_COLOR_TABLES[1].name,
        !1,
        !0,
        this.currentCoord
      )),
    (a.negativeScreenVol = b),
    (b.screenMax = -a.screenMax),
    (b.screenMin = -a.screenMin),
    this.setCurrentScreenVol(this.screenVolumes.length - 1),
    this.drawViewer(!0, !1),
    this.container.toolbar.buildToolbar(),
    this.container.toolbar.updateImageButtons());
};
("use strict");
papaya = papaya || {};
papaya.viewer = papaya.viewer || {};
var shaderVert =
    "precision mediump float;\nattribute vec3 aVertexPosition;\nattribute vec3 aVertexNormal;\nattribute vec4 aVertexColor;\nattribute vec2 aTextureCoord;\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat3 uNMatrix;\nuniform vec3 uAmbientColor;\nuniform vec3 uPointLightingLocation;\nuniform vec3 uPointLightingColor;\nuniform bool uActivePlane;\nuniform bool uActivePlaneEdge;\nuniform bool uCrosshairs;\nuniform bool uColors;\nuniform bool uColorPicking;\nuniform bool uTrianglePicking;\nuniform bool uColorSolid;\nuniform vec4 uSolidColor;\nuniform bool uOrientationText;\nuniform bool uRuler;\nuniform float uAlpha;\nvarying vec3 vLightWeighting;\nvarying lowp vec4 vColor;\nvarying vec2 vTextureCoord;\nvoid main(void) {\n    vec4 mvPosition = uMVMatrix * vec4(aVertexPosition, 1.0);\n    gl_Position = uPMatrix * mvPosition;\n    if (!uActivePlane && !uActivePlaneEdge && !uCrosshairs && !uOrientationText && !uRuler) {\n       vec3 lightDirection = normalize(uPointLightingLocation - mvPosition.xyz);\n       vec3 transformedNormal = uNMatrix * aVertexNormal;\n       float directionalLightWeighting = max(dot(transformedNormal, lightDirection), 0.0);\n       vLightWeighting = uAmbientColor + uPointLightingColor * directionalLightWeighting;\n       if (uColors) {\n           vColor = aVertexColor;\n       }\n   }\n   if (uColorSolid) {\n       vColor = uSolidColor;\n   }\n   if (uOrientationText) {\n       vTextureCoord = aTextureCoord;\n   }\n}",
  shaderFrag =
    "precision mediump float;\nuniform bool uActivePlane;\nuniform bool uActivePlaneEdge;\nuniform bool uCrosshairs;\nuniform bool uColors;\nuniform bool uColorPicking;\nuniform bool uTrianglePicking;\nuniform bool uColorSolid;\nuniform vec4 uSolidColor;\nuniform bool uOrientationText;\nuniform bool uRuler;\nuniform sampler2D uSampler;\nuniform float uAlpha;\nvarying vec3 vLightWeighting;\nvarying lowp vec4 vColor;\nvarying vec2 vTextureCoord;\nvec4 packFloatToVec4i(const float value) {\n   const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n   const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n   vec4 res = fract(value * bitSh);\n   res -= res.xxyz * bitMsk;\n   return res;\n}\nvoid main(void) {\n    vec4 fragmentColor = vec4(1.0, 1.0, 1.0, 1.0);\n    if (uColors) {\n       fragmentColor = vColor;\n    } else if (uColorSolid) {\n       fragmentColor = vColor;\n    }\n    if (uActivePlane) {\n       gl_FragColor = vec4(0.10980392156863, 0.52549019607843, 0.93333333333333, 0.5);\n    } else if (uActivePlaneEdge) {\n       gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n    } else if (uRuler) {\n       gl_FragColor = vec4(1.0, 0.078, 0.576, 1.0);\n    } else if (uOrientationText) {\n        vec4 textureColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n        if (textureColor.a > 0.0) {\n           gl_FragColor = vec4(textureColor.rgb, textureColor.a);\n        } else {\n           gl_FragColor = vec4(textureColor.rgb, 0);\n        }\n    } else if (uCrosshairs) {\n       gl_FragColor = vec4(0.10980392156863, 0.52549019607843, 0.93333333333333, 1.0);\n    } else if (uColorPicking) {\n       gl_FragColor = vec4(fragmentColor.r, fragmentColor.g, fragmentColor.b, 1);\n    } else if (uTrianglePicking) {\n       gl_FragColor = packFloatToVec4i(gl_FragCoord.z);\n    } else {\n       gl_FragColor = vec4(fragmentColor.rgb * vLightWeighting, uAlpha);\n    }\n}";
papaya.viewer.ScreenSurface =
  papaya.viewer.ScreenSurface ||
  function (a, b, c, e) {
    this.shaderProgram = null;
    this.mvMatrix = mat4.create();
    this.pMatrix = mat4.create();
    this.pMatrix1 = mat4.create();
    this.centerMat = mat4.create();
    this.centerMatInv = mat4.create();
    this.tempMat = mat4.create();
    this.tempMat2 = mat4.create();
    this.pickingBuffer = null;
    this.initialized = !1;
    this.screenDim = this.screenOffsetY = this.screenOffsetX = 0;
    this.screenTransform = [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1],
    ];
    this.volume = a;
    this.surfaces = b;
    this.viewer = c;
    this.currentCoord = c.currentCoord;
    this.zoom = 0;
    this.sliceDirection = papaya.viewer.ScreenSlice.DIRECTION_SURFACE;
    this.dynamicStartY = this.dynamicStartX = -1;
    this.activePlaneVertsAxial = new Float32Array(12);
    this.activePlaneVertsCoronal = new Float32Array(12);
    this.activePlaneVertsSagittal = new Float32Array(12);
    this.activePlaneVertsAxialEdges = new Float32Array(24);
    this.activePlaneVertsCoronalEdges = new Float32Array(24);
    this.activePlaneVertsSagittalEdges = new Float32Array(24);
    this.orientationVerts = new Float32Array(24);
    this.crosshairLineVertsX = new Float32Array(6);
    this.crosshairLineVertsY = new Float32Array(6);
    this.crosshairLineVertsZ = new Float32Array(6);
    this.mouseRotDragX = this.clearTransform([]);
    this.mouseRotDragY = this.clearTransform([]);
    this.mouseRotDrag = this.clearTransform([]);
    this.mouseTransDrag = this.clearTransform([]);
    this.mouseRotCurrent = this.clearTransform([]);
    this.mouseTransCurrent = this.clearTransform([]);
    this.mouseRotTemp = this.clearTransform([]);
    this.mouseTransTemp = this.clearTransform([]);
    this.crosshairLineZBuffer =
      this.crosshairLineYBuffer =
      this.crosshairLineXBuffer =
      this.orientationBuffer =
      this.activePlaneSagittalEdgesBuffer =
      this.activePlaneCoronalEdgesBuffer =
      this.activePlaneAxialEdgesBuffer =
      this.activePlaneSagittalBuffer =
      this.activePlaneCoronalBuffer =
      this.activePlaneAxialBuffer =
        null;
    this.xSize = this.volume.header.voxelDimensions.xSize;
    this.xDim = this.volume.header.imageDimensions.xDim;
    this.xHalf = (this.xDim * this.xSize) / 2;
    this.ySize = this.volume.header.voxelDimensions.ySize;
    this.yDim = this.volume.header.imageDimensions.yDim;
    this.yHalf = (this.yDim * this.ySize) / 2;
    this.zSize = this.volume.header.voxelDimensions.zSize;
    this.zDim = this.volume.header.imageDimensions.zDim;
    this.zHalf = (this.zDim * this.zSize) / 2;
    this.showSurfacePlanes =
      "Yes" === c.container.preferences.showSurfacePlanes;
    this.backgroundColor = papaya.viewer.ScreenSurface.DEFAULT_BACKGROUND;
    this.pickLocY = this.pickLocX = 0;
    this.needsPickColor = !1;
    this.pickedColor = null;
    this.needsPick = !1;
    this.pickedCoordinate = null;
    this.scaleFactor = 1;
    this.rulerPoints =
      this.orientationContext =
      this.orientationCanvas =
      this.orientationTextureCoordBuffer =
      this.orientationTextureCoords =
      this.orientationTexture =
        null;
    this.grabbedRulerPoint = -1;
    this.processParams(e);
  };
papaya.viewer.ScreenSurface.DEFAULT_ORIENTATION = [
  0.048971585322198447, -0.5197227838697135, 0.8529302568859667, 0,
  0.9973082748260628, -0.021211909620762606, -0.0701863275311922, 0,
  0.0545697721466714, 0.8540715289187434, 0.5172851540944708, 0, 0, 0, 0, 1,
];
papaya.viewer.ScreenSurface.MOUSE_SENSITIVITY = 0.3;
papaya.viewer.ScreenSurface.DEFAULT_BACKGROUND = [0.5, 0.5, 0.5];
papaya.viewer.ScreenSurface.TEXT_SIZE = 50;
papaya.viewer.ScreenSurface.ORIENTATION_SIZE = 10;
papaya.viewer.ScreenSurface.RULER_COLOR = [1, 0.078, 0.576];
papaya.viewer.ScreenSurface.RULER_NUM_LINES = 25;
papaya.viewer.ScreenSurface.RULER_RADIUS = 1;
papaya.viewer.ScreenSurface.EXT_INT = null;
papaya.viewer.ScreenSurface.makeShader = function (a, b, c) {
  c = a.createShader(c);
  a.shaderSource(c, b);
  a.compileShader(c);
  return a.getShaderParameter(c, a.COMPILE_STATUS)
    ? c
    : (console.log(a.getShaderInfoLog(c)), null);
};
papaya.viewer.ScreenSurface.initShaders = function (a) {
  var b = papaya.viewer.ScreenSurface.makeShader(
      a,
      shaderVert,
      a.VERTEX_SHADER
    ),
    c = papaya.viewer.ScreenSurface.makeShader(
      a,
      shaderFrag,
      a.FRAGMENT_SHADER
    ),
    e = a.createProgram();
  a.attachShader(e, c);
  a.attachShader(e, b);
  a.linkProgram(e);
  a.getProgramParameter(e, a.LINK_STATUS) ||
    console.log("Could not initialise shaders");
  a.useProgram(e);
  e.vertexPositionAttribute = a.getAttribLocation(e, "aVertexPosition");
  a.enableVertexAttribArray(e.vertexPositionAttribute);
  e.vertexNormalAttribute = a.getAttribLocation(e, "aVertexNormal");
  a.enableVertexAttribArray(e.vertexNormalAttribute);
  e.vertexColorAttribute = a.getAttribLocation(e, "aVertexColor");
  e.textureCoordAttribute = a.getAttribLocation(e, "aTextureCoord");
  e.pMatrixUniform = a.getUniformLocation(e, "uPMatrix");
  e.mvMatrixUniform = a.getUniformLocation(e, "uMVMatrix");
  e.nMatrixUniform = a.getUniformLocation(e, "uNMatrix");
  e.ambientColorUniform = a.getUniformLocation(e, "uAmbientColor");
  e.pointLightingLocationUniform = a.getUniformLocation(
    e,
    "uPointLightingLocation"
  );
  e.pointLightingColorUniform = a.getUniformLocation(e, "uPointLightingColor");
  e.activePlane = a.getUniformLocation(e, "uActivePlane");
  e.activePlaneEdge = a.getUniformLocation(e, "uActivePlaneEdge");
  e.colorPicking = a.getUniformLocation(e, "uColorPicking");
  e.trianglePicking = a.getUniformLocation(e, "uTrianglePicking");
  e.crosshairs = a.getUniformLocation(e, "uCrosshairs");
  e.hasColors = a.getUniformLocation(e, "uColors");
  e.hasSolidColor = a.getUniformLocation(e, "uColorSolid");
  e.solidColor = a.getUniformLocation(e, "uSolidColor");
  e.orientationText = a.getUniformLocation(e, "uOrientationText");
  e.samplerUniform = a.getUniformLocation(e, "uSampler");
  e.ruler = a.getUniformLocation(e, "uRuler");
  e.alphaVal = a.getUniformLocation(e, "uAlpha");
  return e;
};
papaya.viewer.ScreenSurface.prototype.initialize = function () {
  var a;
  this.initialized = !0;
  this.canvas = document.createElement("canvas");
  this.canvas.width = this.screenDim;
  this.canvas.height = this.screenDim;
  this.context =
    this.canvas.getContext("webgl") ||
    this.canvas.getContext("experimental-webgl");
  this.context.viewportWidth = this.canvas.width;
  this.context.viewportHeight = this.canvas.height;
  this.zoom =
    this.volume.header.imageDimensions.yDim *
    this.volume.header.voxelDimensions.ySize *
    1.5;
  this.initPerspective();
  this.shaderProgram = papaya.viewer.ScreenSurface.initShaders(this.context);
  for (a = 0; a < this.surfaces.length; a += 1)
    this.initBuffers(this.context, this.surfaces[a]);
  this.calculateScaleFactor();
  this.initActivePlaneBuffers(this.context);
  this.initRulerBuffers(this.context);
  mat4.multiply(
    this.centerMat,
    papaya.viewer.ScreenSurface.DEFAULT_ORIENTATION,
    this.tempMat
  );
  mat4.multiply(this.tempMat, this.centerMatInv, this.mouseRotCurrent);
  papaya.viewer.ScreenSurface.EXT_INT = this.context.getExtension(
    "OES_element_index_uint"
  );
  papaya.viewer.ScreenSurface.EXT_INT ||
    console.log(
      "This browser does not support OES_element_index_uint extension!"
    );
  this.updateBackgroundColor();
};
papaya.viewer.ScreenSurface.prototype.calculateScaleFactor = function () {
  var a = this.ySize * this.yDim,
    b = this.zSize * this.zDim,
    c = this.xSize * this.xDim;
  a > c && (c = a);
  b > c && (c = b);
  this.scaleFactor = c / 256;
};
papaya.viewer.ScreenSurface.prototype.resize = function (a) {
  this.initialized || this.initialize();
  this.screenDim = a;
  this.canvas.width = this.screenDim;
  this.canvas.height = this.screenDim;
  this.context.viewportWidth = this.canvas.width;
  this.context.viewportHeight = this.canvas.height;
};
papaya.viewer.ScreenSurface.prototype.applyMatrixUniforms = function (a) {
  a.uniformMatrix4fv(this.shaderProgram.pMatrixUniform, !1, this.pMatrix);
  a.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform, !1, this.mvMatrix);
  var b = mat3.create();
  mat4.toInverseMat3(this.mvMatrix, b);
  mat3.transpose(b);
  a.uniformMatrix3fv(this.shaderProgram.nMatrixUniform, !1, b);
};
papaya.viewer.ScreenSurface.prototype.draw = function () {
  0 < this.surfaces.length &&
    (this.initialized || this.initialize(), this.drawScene(this.context));
};
papaya.viewer.ScreenSurface.prototype.initBuffers = function (a, b) {
  b.pointsBuffer = a.createBuffer();
  a.bindBuffer(a.ARRAY_BUFFER, b.pointsBuffer);
  a.bufferData(a.ARRAY_BUFFER, b.pointData, a.STATIC_DRAW);
  b.pointsBuffer.itemSize = 3;
  b.pointsBuffer.numItems = b.numPoints;
  b.normalsBuffer = a.createBuffer();
  a.bindBuffer(a.ARRAY_BUFFER, b.normalsBuffer);
  a.bufferData(a.ARRAY_BUFFER, b.normalsData, a.STATIC_DRAW);
  b.normalsBuffer.itemSize = 3;
  b.normalsBuffer.numItems = b.numPoints;
  b.colorsData &&
    ((b.colorsBuffer = a.createBuffer()),
    a.bindBuffer(a.ARRAY_BUFFER, b.colorsBuffer),
    a.bufferData(a.ARRAY_BUFFER, b.colorsData, a.DYNAMIC_DRAW),
    (b.colorsBuffer.itemSize = 4),
    (b.colorsBuffer.numItems = b.numPoints));
  b.trianglesBuffer = a.createBuffer();
  a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, b.trianglesBuffer);
  a.bufferData(a.ELEMENT_ARRAY_BUFFER, b.triangleData, a.STATIC_DRAW);
  b.trianglesBuffer.itemSize = 1;
  b.trianglesBuffer.numItems = 3 * b.numTriangles;
};
papaya.viewer.ScreenSurface.prototype.initOrientationBuffers = function (a) {
  this.makeOrientedTextSquare();
  this.orientationBuffer = a.createBuffer();
  this.orientationBuffer.itemSize = 3;
  this.orientationBuffer.numItems = 4;
  this.orientationTextureCoordBuffer = a.createBuffer();
  a.bindBuffer(a.ARRAY_BUFFER, this.orientationTextureCoordBuffer);
  this.orientationTextureCoords = [0, 1, 0, 0, 1, 1, 1, 0];
  a.bufferData(
    a.ARRAY_BUFFER,
    new Float32Array(this.orientationTextureCoords),
    a.STATIC_DRAW
  );
  this.orientationTextureCoordBuffer.itemSize = 2;
  this.orientationTextureCoordBuffer.numItems = 4;
};
papaya.viewer.ScreenSurface.prototype.initActivePlaneBuffers = function (a) {
  this.updateActivePlanes();
  this.activePlaneAxialBuffer = a.createBuffer();
  this.activePlaneAxialBuffer.itemSize = 3;
  this.activePlaneAxialBuffer.numItems = 4;
  this.activePlaneCoronalBuffer = a.createBuffer();
  this.activePlaneCoronalBuffer.itemSize = 3;
  this.activePlaneCoronalBuffer.numItems = 4;
  this.activePlaneSagittalBuffer = a.createBuffer();
  this.activePlaneSagittalBuffer.itemSize = 3;
  this.activePlaneSagittalBuffer.numItems = 4;
  this.activePlaneAxialEdgesBuffer = a.createBuffer();
  this.activePlaneAxialEdgesBuffer.itemSize = 3;
  this.activePlaneAxialEdgesBuffer.numItems = 8;
  this.activePlaneCoronalEdgesBuffer = a.createBuffer();
  this.activePlaneCoronalEdgesBuffer.itemSize = 3;
  this.activePlaneCoronalEdgesBuffer.numItems = 8;
  this.activePlaneSagittalEdgesBuffer = a.createBuffer();
  this.activePlaneSagittalEdgesBuffer.itemSize = 3;
  this.activePlaneSagittalEdgesBuffer.numItems = 8;
  this.crosshairLineXBuffer = a.createBuffer();
  this.crosshairLineXBuffer.itemSize = 3;
  this.crosshairLineXBuffer.numItems = 2;
  this.crosshairLineYBuffer = a.createBuffer();
  this.crosshairLineYBuffer.itemSize = 3;
  this.crosshairLineYBuffer.numItems = 2;
  this.crosshairLineZBuffer = a.createBuffer();
  this.crosshairLineZBuffer.itemSize = 3;
  this.crosshairLineZBuffer.numItems = 2;
};
papaya.viewer.ScreenSurface.prototype.initRulerBuffers = function (a) {
  this.rulerPointData = this.makeSphere(
    papaya.viewer.ScreenSurface.RULER_NUM_LINES,
    papaya.viewer.ScreenSurface.RULER_NUM_LINES,
    papaya.viewer.ScreenSurface.RULER_RADIUS * this.scaleFactor
  );
  this.sphereVertexPositionBuffer = a.createBuffer();
  this.sphereVertexPositionBuffer.itemSize = 3;
  this.sphereVertexPositionBuffer.numItems =
    this.rulerPointData.vertices.length / 3;
  this.sphereNormalsPositionBuffer = a.createBuffer();
  this.sphereNormalsPositionBuffer.itemSize = 3;
  this.sphereNormalsPositionBuffer.numItems =
    this.rulerPointData.normals.length / 3;
  this.sphereVertexIndexBuffer = a.createBuffer();
  this.sphereVertexIndexBuffer.itemSize = 1;
  this.sphereVertexIndexBuffer.numItems = this.rulerPointData.indices.length;
  this.rulerLineBuffer = a.createBuffer();
  this.rulerLineBuffer.itemSize = 3;
  this.rulerLineBuffer.numItems = 2;
};
papaya.viewer.ScreenSurface.prototype.initPerspective = function () {
  mat4.perspective(45, 1, 10, 1e5, this.pMatrix1);
  this.eye = new vec3.create();
  this.eye[0] = 0;
  this.eye[1] = 0;
  this.center = new vec3.create();
  this.centerWorld = new papaya.core.Coordinate();
  this.viewer.getWorldCoordinateAtIndex(
    parseInt(this.xDim / 2, 10),
    parseInt(this.yDim / 2, 10),
    parseInt(this.zDim / 2, 10),
    this.centerWorld
  );
  this.center[0] = this.centerWorld.x;
  this.center[1] = this.centerWorld.y;
  this.center[2] = this.centerWorld.z;
  mat4.identity(this.centerMat);
  mat4.translate(this.centerMat, [
    this.center[0],
    this.center[1],
    this.center[2],
  ]);
  mat4.identity(this.centerMatInv);
  mat4.translate(this.centerMatInv, [
    -this.center[0],
    -this.center[1],
    -this.center[2],
  ]);
  this.up = new vec3.create();
  this.up[0] = 0;
  this.up[1] = 1;
  this.up[2] = 0;
};
papaya.viewer.ScreenSurface.prototype.updatePerspective = function () {
  this.eye[2] = this.zoom;
  var a = mat4.lookAt(this.eye, this.center, this.up);
  mat4.multiply(this.pMatrix1, a, this.pMatrix);
};
papaya.viewer.ScreenSurface.prototype.unpackFloatFromVec4i = function (a) {
  var b = [1 / 16777216, 1 / 65536, 1 / 256, 1];
  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];
};
papaya.viewer.ScreenSurface.prototype.hasTranslucentSurfaces = function () {
  var a;
  for (a = 0; a < this.surfaces.length; a += 1)
    if (1 > this.surfaces[a].alpha) return !0;
  return !1;
};
papaya.viewer.ScreenSurface.prototype.drawScene = function (a) {
  var b;
  var c = this.hasTranslucentSurfaces();
  a.clearColor(
    this.backgroundColor[0],
    this.backgroundColor[1],
    this.backgroundColor[2],
    1
  );
  a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT);
  a.viewport(0, 0, a.viewportWidth, a.viewportHeight);
  mat4.identity(this.mvMatrix);
  mat4.multiply(this.mouseRotDrag, this.mouseRotCurrent, this.mouseRotTemp);
  mat4.multiply(
    this.mouseTransDrag,
    this.mouseTransCurrent,
    this.mouseTransTemp
  );
  mat4.multiply(this.mouseTransTemp, this.mouseRotTemp, this.tempMat);
  mat4.set(this.tempMat, this.mvMatrix);
  this.updatePerspective();
  this.applyMatrixUniforms(a);
  a.uniform3f(this.shaderProgram.ambientColorUniform, 0.2, 0.2, 0.2);
  a.uniform3f(
    this.shaderProgram.pointLightingLocationUniform,
    0,
    0,
    300 * this.scaleFactor
  );
  a.uniform3f(this.shaderProgram.pointLightingColorUniform, 0.8, 0.8, 0.8);
  a.uniform1i(this.shaderProgram.orientationText, 0);
  a.uniform1i(this.shaderProgram.activePlane, 0);
  a.uniform1i(this.shaderProgram.activePlaneEdge, 0);
  a.uniform1i(this.shaderProgram.crosshairs, 0);
  a.uniform1i(this.shaderProgram.hasColors, 0);
  a.uniform1i(this.shaderProgram.colorPicking, 0);
  a.uniform1i(this.shaderProgram.trianglePicking, 0);
  if (this.needsPick) {
    if (
      (a.uniform1i(this.shaderProgram.trianglePicking, 1),
      null === this.pickingBuffer ||
        this.pickingBuffer.length !== a.viewportWidth * a.viewportHeight * 4)
    )
      this.pickingBuffer = new Uint8Array(
        a.viewportWidth * a.viewportHeight * 4
      );
  } else
    this.needsPickColor &&
      (a.uniform1i(this.shaderProgram.colorPicking, 1),
      null === this.pickingBuffer ||
        this.pickingBuffer.length !== a.viewportWidth * a.viewportHeight * 4) &&
      (this.pickingBuffer = new Uint8Array(
        a.viewportWidth * a.viewportHeight * 4
      ));
  a.enable(a.DEPTH_TEST);
  for (b = 0; b < this.surfaces.length; b += 1)
    this.renderSurface(a, b, 1 > this.surfaces[b].alpha, !0, !1);
  a.uniform1i(this.shaderProgram.hasSolidColor, 0);
  a.uniform1i(this.shaderProgram.hasColors, 0);
  if (this.needsPick)
    (this.needsPick = !1),
      (this.pickedCoordinate = this.findPickedCoordinate(
        a,
        this.pickLocX,
        this.pickLocY
      )),
      a.uniform1i(this.shaderProgram.trianglePicking, 0);
  else if (this.needsPickColor)
    (this.needsPickColor = !1),
      (this.pickedColor = this.findPickedColor(a)),
      a.uniform1i(this.shaderProgram.colorPicking, 0);
  else {
    this.showSurfacePlanes &&
      (this.needsUpdateActivePlanes &&
        ((this.needsUpdateActivePlanes = !1), this.bindActivePlanes(a)),
      a.depthMask(!1),
      a.uniform1i(this.shaderProgram.activePlane, 1),
      a.enable(a.BLEND),
      a.blendFunc(a.SRC_ALPHA, a.ONE_MINUS_SRC_ALPHA),
      a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneAxialBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.activePlaneAxialBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.TRIANGLE_STRIP, 0, 4),
      a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneCoronalBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.activePlaneCoronalBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.TRIANGLE_STRIP, 0, 4),
      a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneSagittalBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.activePlaneSagittalBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.TRIANGLE_STRIP, 0, 4),
      a.depthMask(!0),
      a.disable(a.BLEND),
      a.uniform1i(this.shaderProgram.activePlane, 0),
      a.uniform1i(this.shaderProgram.activePlaneEdge, 1),
      a.lineWidth(this.isMainView() ? 3 : 2),
      a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneAxialEdgesBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.activePlaneAxialEdgesBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.LINES, 0, 8),
      a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneCoronalEdgesBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.activePlaneCoronalEdgesBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.LINES, 0, 8),
      a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneSagittalEdgesBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.activePlaneSagittalEdgesBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.LINES, 0, 8),
      a.uniform1i(this.shaderProgram.activePlaneEdge, 0));
    this.viewer.isShowingCrosshairs() &&
      (this.viewer.mainImage !== this || this.viewer.toggleMainCrosshairs) &&
      (this.needsUpdateActivePlanes &&
        ((this.needsUpdateActivePlanes = !1), this.bindActivePlanes(a)),
      a.uniform1i(this.shaderProgram.crosshairs, 1),
      a.lineWidth(this.isMainView() ? 3 : 2),
      a.bindBuffer(a.ARRAY_BUFFER, this.crosshairLineXBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.crosshairLineXBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.LINES, 0, 2),
      a.bindBuffer(a.ARRAY_BUFFER, this.crosshairLineYBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.crosshairLineYBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.LINES, 0, 2),
      a.bindBuffer(a.ARRAY_BUFFER, this.crosshairLineZBuffer),
      a.vertexAttribPointer(
        this.shaderProgram.vertexPositionAttribute,
        this.crosshairLineZBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ),
      a.drawArrays(a.LINES, 0, 2),
      a.uniform1i(this.shaderProgram.crosshairs, 0));
    a.enable(a.DEPTH_TEST);
    for (b = 0; b < this.surfaces.length; b += 1)
      c && this.renderSurface(a, b, 1 > this.surfaces[b].alpha, !1, !0);
    if (
      this.viewer.mainImage === this.viewer.surfaceView &&
      "Yes" === this.viewer.container.preferences.showOrientation
    ) {
      b = this.currentCoord.x + (this.xDim / 2 - this.volume.header.origin.x);
      c =
        this.yDim -
        this.currentCoord.y -
        (this.yDim / 2 - this.volume.header.origin.y);
      var e =
        this.zDim -
        this.currentCoord.z -
        (this.zDim / 2 - this.volume.header.origin.z);
      this.drawOrientedText(a, "S", papaya.viewer.ScreenSurface.TEXT_SIZE, [
        b * this.xSize - this.xHalf,
        c * this.ySize - this.yHalf,
        this.zHalf +
          papaya.viewer.ScreenSurface.ORIENTATION_SIZE * this.scaleFactor -
          (this.zDim / 2 - this.volume.header.origin.z) * this.zSize,
      ]);
      this.drawOrientedText(a, "I", papaya.viewer.ScreenSurface.TEXT_SIZE, [
        b * this.xSize - this.xHalf,
        c * this.ySize - this.yHalf,
        -this.zHalf -
          papaya.viewer.ScreenSurface.ORIENTATION_SIZE * this.scaleFactor -
          (this.zDim / 2 - this.volume.header.origin.z) * this.zSize,
      ]);
      this.drawOrientedText(a, "P", papaya.viewer.ScreenSurface.TEXT_SIZE, [
        b * this.xSize - this.xHalf,
        -this.yHalf -
          papaya.viewer.ScreenSurface.ORIENTATION_SIZE * this.scaleFactor -
          (this.yDim / 2 - this.volume.header.origin.y) * this.ySize,
        e * this.zSize - this.zHalf,
      ]);
      this.drawOrientedText(a, "A", papaya.viewer.ScreenSurface.TEXT_SIZE, [
        b * this.xSize - this.xHalf,
        this.yHalf +
          papaya.viewer.ScreenSurface.ORIENTATION_SIZE * this.scaleFactor -
          (this.yDim / 2 - this.volume.header.origin.y) * this.ySize,
        e * this.zSize - this.zHalf,
      ]);
      this.drawOrientedText(a, "L", papaya.viewer.ScreenSurface.TEXT_SIZE, [
        -this.xHalf -
          papaya.viewer.ScreenSurface.ORIENTATION_SIZE * this.scaleFactor +
          (this.xDim / 2 - this.volume.header.origin.x) * this.xSize,
        c * this.ySize - this.yHalf,
        e * this.zSize - this.zHalf,
      ]);
      this.drawOrientedText(a, "R", papaya.viewer.ScreenSurface.TEXT_SIZE, [
        this.xHalf +
          papaya.viewer.ScreenSurface.ORIENTATION_SIZE * this.scaleFactor +
          (this.xDim / 2 - this.volume.header.origin.x) * this.xSize,
        c * this.ySize - this.yHalf,
        e * this.zSize - this.zHalf,
      ]);
    }
    "Yes" === this.viewer.container.preferences.showRuler
      ? this.isMainView() && this.drawRuler(a)
      : (this.rulerPoints = null);
  }
  a.disable(a.DEPTH_TEST);
};
papaya.viewer.ScreenSurface.prototype.renderSurface = function (a, b, c, e, d) {
  a.uniform1f(this.shaderProgram.alphaVal, this.surfaces[b].alpha);
  c
    ? e
      ? (a.enable(a.BLEND),
        a.enable(a.CULL_FACE),
        a.blendFunc(a.SRC_ALPHA, a.ONE_MINUS_SRC_ALPHA),
        a.frontFace(a.CCW),
        a.cullFace(a.FRONT),
        a.uniform3f(this.shaderProgram.ambientColorUniform, 0, 0, 0),
        a.uniform3f(
          this.shaderProgram.pointLightingLocationUniform,
          0,
          0,
          -300 * this.scaleFactor
        ))
      : d &&
        (a.enable(a.BLEND),
        a.enable(a.CULL_FACE),
        a.blendFunc(a.SRC_ALPHA, a.ONE_MINUS_SRC_ALPHA),
        a.frontFace(a.CCW),
        a.cullFace(a.BACK),
        a.uniform3f(this.shaderProgram.ambientColorUniform, 0.2, 0.2, 0.2),
        a.uniform3f(
          this.shaderProgram.pointLightingLocationUniform,
          0,
          0,
          300 * this.scaleFactor
        ))
    : (a.uniform3f(this.shaderProgram.ambientColorUniform, 0.2, 0.2, 0.2),
      a.uniform3f(
        this.shaderProgram.pointLightingLocationUniform,
        0,
        0,
        300 * this.scaleFactor
      ));
  a.uniform1i(this.shaderProgram.hasSolidColor, 0);
  a.uniform1i(this.shaderProgram.hasColors, 0);
  this.surfaces[b].solidColor &&
    (a.uniform1i(this.shaderProgram.hasSolidColor, 1),
    a.uniform4f(
      this.shaderProgram.solidColor,
      this.surfaces[b].solidColor[0],
      this.surfaces[b].solidColor[1],
      this.surfaces[b].solidColor[2],
      1
    ));
  a.bindBuffer(a.ARRAY_BUFFER, this.surfaces[b].pointsBuffer);
  a.vertexAttribPointer(
    this.shaderProgram.vertexPositionAttribute,
    this.surfaces[b].pointsBuffer.itemSize,
    a.FLOAT,
    !1,
    0,
    0
  );
  a.bindBuffer(a.ARRAY_BUFFER, this.surfaces[b].normalsBuffer);
  a.vertexAttribPointer(
    this.shaderProgram.vertexNormalAttribute,
    this.surfaces[b].normalsBuffer.itemSize,
    a.FLOAT,
    !1,
    0,
    0
  );
  this.surfaces[b].colorsData
    ? (a.uniform1i(this.shaderProgram.hasColors, 1),
      a.bindBuffer(a.ARRAY_BUFFER, this.surfaces[b].colorsBuffer),
      a.bufferData(a.ARRAY_BUFFER, this.surfaces[b].colorsData, a.DYNAMIC_DRAW),
      a.enableVertexAttribArray(this.shaderProgram.vertexColorAttribute),
      a.vertexAttribPointer(
        this.shaderProgram.vertexColorAttribute,
        this.surfaces[b].colorsBuffer.itemSize,
        a.FLOAT,
        !1,
        0,
        0
      ))
    : a.disableVertexAttribArray(this.shaderProgram.vertexColorAttribute);
  a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.surfaces[b].trianglesBuffer);
  a.drawElements(
    a.TRIANGLES,
    this.surfaces[b].trianglesBuffer.numItems,
    a.UNSIGNED_INT,
    0
  );
  c && (e || d) && (a.disable(a.BLEND), a.disable(a.CULL_FACE));
};
papaya.viewer.ScreenSurface.prototype.drawRuler = function (a) {
  var b = !0;
  null === this.rulerPoints &&
    ((this.rulerPoints = new Float32Array(6)),
    (b = this.findInitialRulerPoints(a)),
    this.drawScene(a));
  b &&
    (a.uniform1i(this.shaderProgram.ruler, 1),
    this.drawRulerPoint(
      a,
      this.rulerPoints[0],
      this.rulerPoints[1],
      this.rulerPoints[2]
    ),
    this.drawRulerPoint(
      a,
      this.rulerPoints[3],
      this.rulerPoints[4],
      this.rulerPoints[5]
    ),
    a.bindBuffer(a.ARRAY_BUFFER, this.rulerLineBuffer),
    a.bufferData(a.ARRAY_BUFFER, this.rulerPoints, a.DYNAMIC_DRAW),
    a.bindBuffer(a.ARRAY_BUFFER, this.rulerLineBuffer),
    a.vertexAttribPointer(
      this.shaderProgram.vertexPositionAttribute,
      this.rulerLineBuffer.itemSize,
      a.FLOAT,
      !1,
      0,
      0
    ),
    a.drawArrays(a.LINES, 0, 2),
    a.uniform1i(this.shaderProgram.ruler, 0));
};
papaya.viewer.ScreenSurface.prototype.drawRulerPoint = function (a, b, c, e) {
  this.sphereVertexPositionBuffer.numItems =
    this.rulerPointData.vertices.length / 3;
  a.bindBuffer(a.ARRAY_BUFFER, this.sphereVertexPositionBuffer);
  a.bufferData(
    a.ARRAY_BUFFER,
    new Float32Array(this.rulerPointData.vertices),
    a.STATIC_DRAW
  );
  this.sphereNormalsPositionBuffer.numItems =
    this.rulerPointData.normals.length / 3;
  a.bindBuffer(a.ARRAY_BUFFER, this.sphereNormalsPositionBuffer);
  a.bufferData(
    a.ARRAY_BUFFER,
    new Float32Array(this.rulerPointData.normals),
    a.STATIC_DRAW
  );
  this.sphereVertexIndexBuffer.numItems = this.rulerPointData.indices.length;
  a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.sphereVertexIndexBuffer);
  a.bufferData(
    a.ELEMENT_ARRAY_BUFFER,
    new Uint16Array(this.rulerPointData.indices),
    a.STATIC_DRAW
  );
  a.uniform1i(this.shaderProgram.hasSolidColor, 1);
  a.uniform4f(
    this.shaderProgram.solidColor,
    papaya.viewer.ScreenSurface.RULER_COLOR[0],
    papaya.viewer.ScreenSurface.RULER_COLOR[1],
    papaya.viewer.ScreenSurface.RULER_COLOR[2],
    1
  );
  a.bindBuffer(a.ARRAY_BUFFER, this.sphereVertexPositionBuffer);
  a.vertexAttribPointer(
    this.shaderProgram.vertexPositionAttribute,
    this.sphereVertexPositionBuffer.itemSize,
    a.FLOAT,
    !1,
    0,
    0
  );
  a.bindBuffer(a.ARRAY_BUFFER, this.sphereNormalsPositionBuffer);
  a.vertexAttribPointer(
    this.shaderProgram.vertexNormalAttribute,
    this.sphereNormalsPositionBuffer.itemSize,
    a.FLOAT,
    !1,
    0,
    0
  );
  mat4.set(this.mvMatrix, this.tempMat);
  mat4.translate(this.mvMatrix, [b, c, e]);
  this.applyMatrixUniforms(a);
  a.bindBuffer(a.ELEMENT_ARRAY_BUFFER, this.sphereVertexIndexBuffer);
  a.drawElements(
    a.TRIANGLES,
    this.sphereVertexIndexBuffer.numItems,
    a.UNSIGNED_SHORT,
    0
  );
  mat4.set(this.tempMat, this.mvMatrix);
  this.applyMatrixUniforms(a);
};
papaya.viewer.ScreenSurface.prototype.drawOrientedText = function (a, b, c, e) {
  null === this.orientationCanvas && this.initOrientationBuffers(this.context);
  this.updateOrientedTextSquare(c, b);
  null === this.orientationTexture &&
    (this.orientationTexture = a.createTexture());
  this.bindOrientation(a);
  a.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute);
  a.uniform1i(this.shaderProgram.orientationText, 1);
  a.enable(a.BLEND);
  a.blendFunc(a.SRC_ALPHA, a.ONE_MINUS_SRC_ALPHA);
  this.orientationContext.imageSmoothingEnabled = !0;
  this.orientationContext.mozImageSmoothingEnabled = !0;
  this.orientationContext.msImageSmoothingEnabled = !0;
  this.orientationContext.textAlign = "center";
  this.orientationContext.textBaseline = "middle";
  this.orientationContext.font = c + "px sans-serif";
  this.orientationContext.clearRect(
    0,
    0,
    this.orientationCanvas.width,
    this.orientationCanvas.height
  );
  this.orientationContext.fillStyle = "#FFFFFF";
  this.orientationContext.fillText(
    b,
    this.orientationCanvas.width / 2,
    this.orientationCanvas.height / 2
  );
  mat4.set(this.mvMatrix, this.tempMat);
  mat4.multiplyVec3(this.mvMatrix, e);
  mat4.identity(this.mvMatrix);
  a.bindBuffer(a.ARRAY_BUFFER, this.orientationBuffer);
  a.vertexAttribPointer(
    this.shaderProgram.vertexPositionAttribute,
    this.orientationBuffer.itemSize,
    a.FLOAT,
    !1,
    0,
    0
  );
  a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL, 1);
  a.bindTexture(a.TEXTURE_2D, this.orientationTexture);
  a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_S, a.CLAMP_TO_EDGE);
  a.texParameteri(a.TEXTURE_2D, a.TEXTURE_WRAP_T, a.CLAMP_TO_EDGE);
  a.texImage2D(
    a.TEXTURE_2D,
    0,
    a.RGBA,
    a.RGBA,
    a.UNSIGNED_BYTE,
    this.orientationCanvas
  );
  a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, a.LINEAR);
  a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, a.LINEAR_MIPMAP_NEAREST);
  a.generateMipmap(a.TEXTURE_2D);
  a.bindTexture(a.TEXTURE_2D, null);
  a.bindBuffer(a.ARRAY_BUFFER, this.orientationTextureCoordBuffer);
  a.vertexAttribPointer(
    this.shaderProgram.textureCoordAttribute,
    this.orientationTextureCoordBuffer.itemSize,
    a.FLOAT,
    !1,
    0,
    0
  );
  a.activeTexture(a.TEXTURE0);
  a.bindTexture(a.TEXTURE_2D, this.orientationTexture);
  a.uniform1i(this.shaderProgram.samplerUniform, 0);
  mat4.translate(this.mvMatrix, e);
  this.applyMatrixUniforms(a);
  a.drawArrays(a.TRIANGLE_STRIP, 0, 4);
  mat4.set(this.tempMat, this.mvMatrix);
  this.applyMatrixUniforms(a);
  a.disable(a.BLEND);
  a.uniform1i(this.shaderProgram.orientationText, 0);
  a.disableVertexAttribArray(this.shaderProgram.textureCoordAttribute);
};
papaya.viewer.ScreenSurface.prototype.bindOrientation = function (a) {
  a.bindBuffer(a.ARRAY_BUFFER, this.orientationBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.orientationVerts, a.DYNAMIC_DRAW);
};
papaya.viewer.ScreenSurface.prototype.bindActivePlanes = function (a) {
  a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneAxialBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.activePlaneVertsAxial, a.DYNAMIC_DRAW);
  a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneCoronalBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.activePlaneVertsCoronal, a.DYNAMIC_DRAW);
  a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneSagittalBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.activePlaneVertsSagittal, a.DYNAMIC_DRAW);
  a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneAxialEdgesBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.activePlaneVertsAxialEdges, a.DYNAMIC_DRAW);
  a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneCoronalEdgesBuffer);
  a.bufferData(
    a.ARRAY_BUFFER,
    this.activePlaneVertsCoronalEdges,
    a.DYNAMIC_DRAW
  );
  a.bindBuffer(a.ARRAY_BUFFER, this.activePlaneSagittalEdgesBuffer);
  a.bufferData(
    a.ARRAY_BUFFER,
    this.activePlaneVertsSagittalEdges,
    a.DYNAMIC_DRAW
  );
  a.bindBuffer(a.ARRAY_BUFFER, this.crosshairLineXBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.crosshairLineVertsX, a.DYNAMIC_DRAW);
  a.bindBuffer(a.ARRAY_BUFFER, this.crosshairLineYBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.crosshairLineVertsY, a.DYNAMIC_DRAW);
  a.bindBuffer(a.ARRAY_BUFFER, this.crosshairLineZBuffer);
  a.bufferData(a.ARRAY_BUFFER, this.crosshairLineVertsZ, a.DYNAMIC_DRAW);
};
papaya.viewer.ScreenSurface.prototype.clearDTILinesImage = function () {};
papaya.viewer.ScreenSurface.prototype.findProximalRulerHandle = function (
  a,
  b
) {
  this.pick(a, b, !0);
  this.grabbedRulerPoint = -1;
  this.pickedCoordinate &&
    this.rulerPoints &&
    (papaya.utilities.MathUtils.lineDistance3d(
      this.rulerPoints[0],
      this.rulerPoints[1],
      this.rulerPoints[2],
      this.pickedCoordinate.coordinate[0],
      this.pickedCoordinate.coordinate[1],
      this.pickedCoordinate.coordinate[2]
    ) <
    papaya.viewer.ScreenSlice.GRAB_RADIUS * this.scaleFactor
      ? (this.grabbedRulerPoint = 0)
      : papaya.utilities.MathUtils.lineDistance3d(
          this.rulerPoints[3],
          this.rulerPoints[4],
          this.rulerPoints[5],
          this.pickedCoordinate.coordinate[0],
          this.pickedCoordinate.coordinate[1],
          this.pickedCoordinate.coordinate[2]
        ) <
          papaya.viewer.ScreenSlice.GRAB_RADIUS * this.scaleFactor &&
        (this.grabbedRulerPoint = 1));
  return -1 !== this.grabbedRulerPoint;
};
papaya.viewer.ScreenSurface.prototype.setStartDynamic = function (a, b) {
  this.dynamicStartX = a;
  this.dynamicStartY = b;
};
papaya.viewer.ScreenSurface.prototype.updateDynamic = function (a, b, c) {
  b =
    (b - this.dynamicStartY) *
    papaya.viewer.ScreenSurface.MOUSE_SENSITIVITY *
    c;
  a =
    ((a - this.dynamicStartX) *
      papaya.viewer.ScreenSurface.MOUSE_SENSITIVITY *
      c *
      Math.PI) /
    180;
  mat4.identity(this.mouseRotDragX);
  mat4.rotateY(this.mouseRotDragX, a);
  a = (b * Math.PI) / 180;
  mat4.identity(this.mouseRotDragY);
  mat4.rotateX(this.mouseRotDragY, a);
  mat4.multiply(this.centerMat, this.mouseRotDragY, this.tempMat);
  mat4.multiply(this.tempMat, this.mouseRotDragX, this.tempMat2);
  mat4.multiply(this.tempMat2, this.centerMatInv, this.mouseRotDrag);
};
papaya.viewer.ScreenSurface.prototype.updateTranslateDynamic = function (
  a,
  b,
  c
) {
  a =
    (a - this.dynamicStartX) *
    papaya.viewer.ScreenSurface.MOUSE_SENSITIVITY *
    c;
  b =
    (b - this.dynamicStartY) *
    papaya.viewer.ScreenSurface.MOUSE_SENSITIVITY *
    c *
    -1;
  mat4.identity(this.mouseTransDrag);
  mat4.translate(this.mouseTransDrag, [a, b, 0]);
};
papaya.viewer.ScreenSurface.prototype.updateCurrent = function () {
  var a = mat4.multiply(this.mouseRotDrag, this.mouseRotCurrent);
  mat4.set(a, this.mouseRotCurrent);
  a = mat4.multiply(this.mouseTransDrag, this.mouseTransCurrent);
  mat4.set(a, this.mouseTransCurrent);
  mat4.identity(this.mouseTransDrag);
  mat4.identity(this.mouseRotDragX);
  mat4.identity(this.mouseRotDragY);
  mat4.identity(this.mouseRotDrag);
};
papaya.viewer.ScreenSurface.prototype.resetRotation = function () {
  this.updateCurrent();
  this.mouseTransCurrent = this.clearTransform([]);
  mat4.multiply(
    this.centerMat,
    papaya.viewer.ScreenSurface.DEFAULT_ORIENTATION,
    this.tempMat
  );
  mat4.multiply(this.tempMat, this.centerMatInv, this.mouseRotCurrent);
};
papaya.viewer.ScreenSurface.prototype.clearTransform = function (a) {
  mat4.identity(a);
  return a;
};
papaya.viewer.ScreenSurface.prototype.makeOrientedTextSquare = function () {
  var a = papaya.viewer.ScreenSurface.ORIENTATION_SIZE * this.scaleFactor;
  this.orientationVerts[0] = -a;
  this.orientationVerts[1] = a;
  this.orientationVerts[2] = 0;
  this.orientationVerts[3] = -a;
  this.orientationVerts[4] = -a;
  this.orientationVerts[5] = 0;
  this.orientationVerts[6] = a;
  this.orientationVerts[7] = a;
  this.orientationVerts[8] = 0;
  this.orientationVerts[9] = a;
  this.orientationVerts[10] = -a;
  this.orientationVerts[11] = 0;
  this.orientationCanvas = document.createElement("canvas");
  this.orientationContext = this.orientationCanvas.getContext("2d");
  this.orientationContext.imageSmoothingEnabled = !0;
  this.orientationContext.mozImageSmoothingEnabled = !0;
  this.orientationContext.msImageSmoothingEnabled = !0;
  this.orientationContext.fillStyle = "#FFFFFF";
  this.orientationContext.textAlign = "center";
  this.orientationContext.textBaseline = "middle";
};
papaya.viewer.ScreenSurface.prototype.updateOrientedTextSquare = function (
  a,
  b
) {
  this.orientationContext.imageSmoothingEnabled = !0;
  this.orientationContext.mozImageSmoothingEnabled = !0;
  this.orientationContext.msImageSmoothingEnabled = !0;
  this.orientationContext.fillStyle = "#FFFFFF";
  this.orientationContext.textAlign = "center";
  this.orientationContext.textBaseline = "middle";
  this.orientationContext.font = a + "px sans-serif";
  b = this.orientationContext.measureText(b).width;
  a = Math.max(b, a);
  this.orientationCanvas.width = papaya.utilities.MathUtils.getPowerOfTwo(a);
  this.orientationCanvas.height = papaya.utilities.MathUtils.getPowerOfTwo(a);
};
papaya.viewer.ScreenSurface.prototype.updateActivePlanes = function () {
  function a(h) {
    h.x = b.xSize * (h.x + (b.xDim / 2 - b.volume.header.origin.x)) - b.xHalf;
    h.y =
      b.ySize * (b.yDim - h.y - (b.yDim / 2 - b.volume.header.origin.y)) -
      b.yHalf;
    h.z =
      b.zSize * (b.zDim - h.z - (b.zDim / 2 - b.volume.header.origin.z)) -
      b.zHalf;
    return h;
  }
  if (this.showSurfacePlanes || this.viewer.isShowingCrosshairs()) {
    var b = this,
      c = a(this.viewer.getIndexAt(0, 0, this.currentCoord.z, !0)),
      e = a(this.viewer.getIndexAt(this.xDim, 0, this.currentCoord.z, !0)),
      d = a(this.viewer.getIndexAt(0, this.yDim, this.currentCoord.z, !0)),
      g = a(
        this.viewer.getIndexAt(this.xDim, this.yDim, this.currentCoord.z, !0)
      );
    this.activePlaneVertsAxial[0] = d.x;
    this.activePlaneVertsAxial[1] = d.y;
    this.activePlaneVertsAxial[2] = d.z;
    this.activePlaneVertsAxial[3] = c.x;
    this.activePlaneVertsAxial[4] = c.y;
    this.activePlaneVertsAxial[5] = c.z;
    this.activePlaneVertsAxial[6] = g.x;
    this.activePlaneVertsAxial[7] = g.y;
    this.activePlaneVertsAxial[8] = g.z;
    this.activePlaneVertsAxial[9] = e.x;
    this.activePlaneVertsAxial[10] = e.y;
    this.activePlaneVertsAxial[11] = e.z;
    this.activePlaneVertsAxialEdges[0] = d.x;
    this.activePlaneVertsAxialEdges[1] = d.y;
    this.activePlaneVertsAxialEdges[2] = d.z;
    this.activePlaneVertsAxialEdges[3] = c.x;
    this.activePlaneVertsAxialEdges[4] = c.y;
    this.activePlaneVertsAxialEdges[5] = c.z;
    this.activePlaneVertsAxialEdges[6] = c.x;
    this.activePlaneVertsAxialEdges[7] = c.y;
    this.activePlaneVertsAxialEdges[8] = c.z;
    this.activePlaneVertsAxialEdges[9] = e.x;
    this.activePlaneVertsAxialEdges[10] = e.y;
    this.activePlaneVertsAxialEdges[11] = e.z;
    this.activePlaneVertsAxialEdges[12] = e.x;
    this.activePlaneVertsAxialEdges[13] = e.y;
    this.activePlaneVertsAxialEdges[14] = e.z;
    this.activePlaneVertsAxialEdges[15] = g.x;
    this.activePlaneVertsAxialEdges[16] = g.y;
    this.activePlaneVertsAxialEdges[17] = g.z;
    this.activePlaneVertsAxialEdges[18] = g.x;
    this.activePlaneVertsAxialEdges[19] = g.y;
    this.activePlaneVertsAxialEdges[20] = g.z;
    this.activePlaneVertsAxialEdges[21] = d.x;
    this.activePlaneVertsAxialEdges[22] = d.y;
    this.activePlaneVertsAxialEdges[23] = d.z;
    c = a(this.viewer.getIndexAt(0, this.currentCoord.y, 0, !0));
    e = a(this.viewer.getIndexAt(this.xDim, this.currentCoord.y, 0, !0));
    d = a(this.viewer.getIndexAt(0, this.currentCoord.y, this.zDim, !0));
    g = a(
      this.viewer.getIndexAt(this.xDim, this.currentCoord.y, this.zDim, !0)
    );
    this.activePlaneVertsCoronal[0] = d.x;
    this.activePlaneVertsCoronal[1] = d.y;
    this.activePlaneVertsCoronal[2] = d.z;
    this.activePlaneVertsCoronal[3] = c.x;
    this.activePlaneVertsCoronal[4] = c.y;
    this.activePlaneVertsCoronal[5] = c.z;
    this.activePlaneVertsCoronal[6] = g.x;
    this.activePlaneVertsCoronal[7] = g.y;
    this.activePlaneVertsCoronal[8] = g.z;
    this.activePlaneVertsCoronal[9] = e.x;
    this.activePlaneVertsCoronal[10] = e.y;
    this.activePlaneVertsCoronal[11] = e.z;
    this.activePlaneVertsCoronalEdges[0] = d.x;
    this.activePlaneVertsCoronalEdges[1] = d.y;
    this.activePlaneVertsCoronalEdges[2] = d.z;
    this.activePlaneVertsCoronalEdges[3] = c.x;
    this.activePlaneVertsCoronalEdges[4] = c.y;
    this.activePlaneVertsCoronalEdges[5] = c.z;
    this.activePlaneVertsCoronalEdges[6] = c.x;
    this.activePlaneVertsCoronalEdges[7] = c.y;
    this.activePlaneVertsCoronalEdges[8] = c.z;
    this.activePlaneVertsCoronalEdges[9] = e.x;
    this.activePlaneVertsCoronalEdges[10] = e.y;
    this.activePlaneVertsCoronalEdges[11] = e.z;
    this.activePlaneVertsCoronalEdges[12] = e.x;
    this.activePlaneVertsCoronalEdges[13] = e.y;
    this.activePlaneVertsCoronalEdges[14] = e.z;
    this.activePlaneVertsCoronalEdges[15] = g.x;
    this.activePlaneVertsCoronalEdges[16] = g.y;
    this.activePlaneVertsCoronalEdges[17] = g.z;
    this.activePlaneVertsCoronalEdges[18] = g.x;
    this.activePlaneVertsCoronalEdges[19] = g.y;
    this.activePlaneVertsCoronalEdges[20] = g.z;
    this.activePlaneVertsCoronalEdges[21] = d.x;
    this.activePlaneVertsCoronalEdges[22] = d.y;
    this.activePlaneVertsCoronalEdges[23] = d.z;
    c = a(this.viewer.getIndexAt(this.currentCoord.x, 0, 0, !0));
    e = a(this.viewer.getIndexAt(this.currentCoord.x, this.yDim, 0, !0));
    d = a(this.viewer.getIndexAt(this.currentCoord.x, 0, this.zDim, !0));
    g = a(
      this.viewer.getIndexAt(this.currentCoord.x, this.yDim, this.zDim, !0)
    );
    this.activePlaneVertsSagittal[0] = d.x;
    this.activePlaneVertsSagittal[1] = d.y;
    this.activePlaneVertsSagittal[2] = d.z;
    this.activePlaneVertsSagittal[3] = c.x;
    this.activePlaneVertsSagittal[4] = c.y;
    this.activePlaneVertsSagittal[5] = c.z;
    this.activePlaneVertsSagittal[6] = g.x;
    this.activePlaneVertsSagittal[7] = g.y;
    this.activePlaneVertsSagittal[8] = g.z;
    this.activePlaneVertsSagittal[9] = e.x;
    this.activePlaneVertsSagittal[10] = e.y;
    this.activePlaneVertsSagittal[11] = e.z;
    this.activePlaneVertsSagittalEdges[0] = d.x;
    this.activePlaneVertsSagittalEdges[1] = d.y;
    this.activePlaneVertsSagittalEdges[2] = d.z;
    this.activePlaneVertsSagittalEdges[3] = c.x;
    this.activePlaneVertsSagittalEdges[4] = c.y;
    this.activePlaneVertsSagittalEdges[5] = c.z;
    this.activePlaneVertsSagittalEdges[6] = c.x;
    this.activePlaneVertsSagittalEdges[7] = c.y;
    this.activePlaneVertsSagittalEdges[8] = c.z;
    this.activePlaneVertsSagittalEdges[9] = e.x;
    this.activePlaneVertsSagittalEdges[10] = e.y;
    this.activePlaneVertsSagittalEdges[11] = e.z;
    this.activePlaneVertsSagittalEdges[12] = e.x;
    this.activePlaneVertsSagittalEdges[13] = e.y;
    this.activePlaneVertsSagittalEdges[14] = e.z;
    this.activePlaneVertsSagittalEdges[15] = g.x;
    this.activePlaneVertsSagittalEdges[16] = g.y;
    this.activePlaneVertsSagittalEdges[17] = g.z;
    this.activePlaneVertsSagittalEdges[18] = g.x;
    this.activePlaneVertsSagittalEdges[19] = g.y;
    this.activePlaneVertsSagittalEdges[20] = g.z;
    this.activePlaneVertsSagittalEdges[21] = d.x;
    this.activePlaneVertsSagittalEdges[22] = d.y;
    this.activePlaneVertsSagittalEdges[23] = d.z;
    c = a(
      this.viewer.getIndexAt(this.currentCoord.x, this.currentCoord.y, 0, !0)
    );
    e = a(
      this.viewer.getIndexAt(
        this.currentCoord.x,
        this.currentCoord.y,
        this.zDim,
        !0
      )
    );
    this.crosshairLineVertsZ[0] = c.x;
    this.crosshairLineVertsZ[1] = c.y;
    this.crosshairLineVertsZ[2] = c.z;
    this.crosshairLineVertsZ[3] = e.x;
    this.crosshairLineVertsZ[4] = e.y;
    this.crosshairLineVertsZ[5] = e.z;
    c = a(
      this.viewer.getIndexAt(this.currentCoord.x, 0, this.currentCoord.z, !0)
    );
    e = a(
      this.viewer.getIndexAt(
        this.currentCoord.x,
        this.yDim,
        this.currentCoord.z,
        !0
      )
    );
    this.crosshairLineVertsY[0] = c.x;
    this.crosshairLineVertsY[1] = c.y;
    this.crosshairLineVertsY[2] = c.z;
    this.crosshairLineVertsY[3] = e.x;
    this.crosshairLineVertsY[4] = e.y;
    this.crosshairLineVertsY[5] = e.z;
    c = a(
      this.viewer.getIndexAt(0, this.currentCoord.y, this.currentCoord.z, !0)
    );
    e = a(
      this.viewer.getIndexAt(
        this.xDim,
        this.currentCoord.y,
        this.currentCoord.z,
        !0
      )
    );
    this.crosshairLineVertsX[0] = c.x;
    this.crosshairLineVertsX[1] = c.y;
    this.crosshairLineVertsX[2] = c.z;
    this.crosshairLineVertsX[3] = e.x;
    this.crosshairLineVertsX[4] = e.y;
    this.crosshairLineVertsX[5] = e.z;
    this.needsUpdateActivePlanes = !0;
  }
};
papaya.viewer.ScreenSurface.prototype.pick = function (a, b, c) {
  this.needsPick = !0;
  this.pickLocX = a;
  this.pickLocY = b;
  this.draw();
  if (c) return this.pickedCoordinate;
  this.draw();
  return this.pickedCoordinate;
};
papaya.viewer.ScreenSurface.prototype.pickRuler = function (a, b) {
  this.needsPick = !0;
  this.pickLocX = a;
  this.pickLocY = b;
  this.draw();
  this.pickedCoordinate &&
    ((this.rulerPoints[3 * this.grabbedRulerPoint] =
      this.pickedCoordinate.coordinate[0]),
    (this.rulerPoints[3 * this.grabbedRulerPoint + 1] =
      this.pickedCoordinate.coordinate[1]),
    (this.rulerPoints[3 * this.grabbedRulerPoint + 2] =
      this.pickedCoordinate.coordinate[2]),
    this.draw());
  return this.pickedCoordinate;
};
papaya.viewer.ScreenSurface.prototype.pickColor = function (a, b) {
  this.needsPickColor = !0;
  this.pickLocX = a;
  this.pickLocY = b;
  this.draw();
  this.draw();
  return this.pickedColor;
};
papaya.viewer.ScreenSurface.prototype.findPickedCoordinate = function (
  a,
  b,
  c
) {
  c = a.viewportHeight - 1 - c;
  var e = [];
  a.readPixels(b, c, 1, 1, a.RGBA, a.UNSIGNED_BYTE, this.pickingBuffer);
  var d = this.unpackFloatFromVec4i(this.pickingBuffer) / 255;
  return 1 <= d
    ? null
    : GLU.unProject(
        b,
        c,
        d,
        this.mvMatrix,
        this.pMatrix,
        [0, 0, a.viewportWidth, a.viewportHeight],
        e
      )
    ? { coordinate: e, depth: d }
    : null;
};
papaya.viewer.ScreenSurface.prototype.findInitialRulerPoints = function (a) {
  var b = a.viewportWidth,
    c = a.viewportHeight;
  a = [];
  var e = [],
    d;
  for (d = 1; 5 > d; d += 1) {
    var g = parseInt(0.1 * b * d, 10);
    var h = parseInt(0.1 * c * d, 10);
    (g = this.pick(g, h, !0)) && a.push(g);
    g = parseInt(b - 0.1 * b * d, 10);
    h = parseInt(0.1 * c * d, 10);
    (g = this.pick(g, h, !0)) && a.push(g);
    g = parseInt(b - 0.1 * b * d, 10);
    h = parseInt(c - 0.1 * c * d, 10);
    (g = this.pick(g, h, !0)) && a.push(g);
    g = parseInt(0.1 * b * d, 10);
    h = parseInt(c - 0.1 * c * d, 10);
    (g = this.pick(g, h, !0)) && a.push(g);
  }
  if (2 > a) return !1;
  for (d = b = 0; d < a.length; d += 1) a[d].depth < a[b].depth && (b = d);
  e.push(a[b].coordinate);
  a.splice(b, 1);
  for (d = b = 0; d < a.length; d += 1) a[d].depth < a[b].depth && (b = d);
  e.push(a[b].coordinate);
  this.rulerPoints[0] = e[0][0];
  this.rulerPoints[1] = e[0][1];
  this.rulerPoints[2] = e[0][2];
  this.rulerPoints[3] = e[1][0];
  this.rulerPoints[4] = e[1][1];
  this.rulerPoints[5] = e[1][2];
  return !0;
};
papaya.viewer.ScreenSurface.prototype.findPickedColor = function (a) {
  a.readPixels(
    0,
    0,
    a.viewportWidth,
    a.viewportHeight,
    a.RGBA,
    a.UNSIGNED_BYTE,
    this.pickingBuffer
  );
  a =
    (a.viewportHeight - 1 - this.pickLocY) * a.viewportWidth * 4 +
    4 * this.pickLocX;
  return [
    this.pickingBuffer[a],
    this.pickingBuffer[a + 1],
    this.pickingBuffer[a + 2],
  ];
};
papaya.viewer.ScreenSurface.prototype.getBackgroundColor = function () {
  return (
    "rgba(" +
    parseInt(255 * this.backgroundColor[0] + 0.5) +
    "," +
    parseInt(255 * this.backgroundColor[1] + 0.5) +
    "," +
    parseInt(255 * this.backgroundColor[2] + 0.5) +
    ",255)"
  );
};
papaya.viewer.ScreenSurface.prototype.updatePreferences = function () {
  this.updateBackgroundColor();
};
papaya.viewer.ScreenSurface.prototype.updateBackgroundColor = function () {
  var a = this.viewer.container.preferences.surfaceBackgroundColor;
  this.backgroundColor =
    "Black" === a
      ? [0, 0, 0]
      : "Dark Gray" === a
      ? [0.25, 0.25, 0.25]
      : "Gray" === a
      ? [0.5, 0.5, 0.5]
      : "Light Gray" === a
      ? [0.75, 0.75, 0.75]
      : "White" === a
      ? [1, 1, 1]
      : papaya.viewer.ScreenSurface.DEFAULT_BACKGROUND;
};
papaya.viewer.ScreenSurface.prototype.isMainView = function () {
  return this.viewer.mainImage === this.viewer.surfaceView;
};
papaya.viewer.ScreenSurface.prototype.processParams = function (a) {
  this.viewer.container.isDesktopMode() ||
    void 0 === a.surfaceBackground ||
    (this.viewer.container.preferences.surfaceBackgroundColor =
      a.surfaceBackground);
};
papaya.viewer.ScreenSurface.prototype.makeSphere = function (a, b, c) {
  var e,
    d = [],
    g = [];
  for (e = 0; e <= a; e++) {
    var h = (e * Math.PI) / a;
    var n = Math.sin(h),
      q = Math.cos(h);
    for (h = 0; h <= b; h++) {
      var t = (2 * h * Math.PI) / b,
        u = Math.cos(t) * n,
        A = q;
      t = Math.sin(t) * n;
      g.push(u);
      g.push(A);
      g.push(t);
      d.push(c * u);
      d.push(c * A);
      d.push(c * t);
    }
  }
  c = [];
  for (e = 0; e < a; e++)
    for (h = 0; h < b; h++)
      (n = e * (b + 1) + h),
        (q = n + b + 1),
        c.push(n),
        c.push(q),
        c.push(n + 1),
        c.push(q),
        c.push(q + 1),
        c.push(n + 1);
  return { vertices: d, normals: g, indices: c };
};
papaya.viewer.ScreenSurface.prototype.getRulerLength = function () {
  return papaya.utilities.MathUtils.lineDistance3d(
    this.rulerPoints[0],
    this.rulerPoints[1],
    this.rulerPoints[2],
    this.rulerPoints[3],
    this.rulerPoints[4],
    this.rulerPoints[5]
  );
};
("use strict");
papaya = papaya || {};
var papayaContainers = [];
papayaLoadableImages = papayaLoadableImages || [];
var papayaDroppedFiles = [];
papaya.Container =
  papaya.Container ||
  function (a) {
    this.containerHtml = a;
    this.preferences =
      this.toolbar =
      this.display =
      this.viewer =
      this.sliderControlHtml =
      this.titlebarHtml =
      this.displayHtml =
      this.viewerHtml =
      this.toolbarHtml =
      this.containerIndex =
        null;
    this.params = [];
    this.loadingSurfaceIndex = this.loadingImageIndex = 0;
    this.collapsable = this.nestedViewer = !1;
    this.orthogonal = !0;
    this.noNewFiles =
      this.kioskMode =
      this.orthogonalDynamic =
      this.orthogonalTall =
        !1;
    this.showControls = !0;
    this.showControlBar = !1;
    this.fullScreenPadding = this.showImageButtons = !0;
    this.combineParametric = !1;
    this.dropTimeout = null;
    this.showRuler = !1;
    this.syncOverlaySeries = !0;
    this.surfaceParams = {};
    this.contextManager = null;
    this.allowScroll = !0;
    this.loadingComplete = null;
    this.resetComponents();
  };
papaya.Container.LICENSE_TEXT =
  "<p>THIS PRODUCT IS NOT FOR CLINICAL USE.<br /><br />This software is available for use, as is, free of charge.  The software and data derived from this software may not be used for clinical purposes.<br /><br />The authors of this software make no representations or warranties about the suitability of the software, either express or implied, including but not limited to the implied warranties of merchantability, fitness for a particular purpose, non-infringement, or conformance to a specification or standard. The authors of this software shall not be liable for any damages suffered by licensee as a result of using or modifying this software or its derivatives.<br /><br />By using this software, you agree to be bounded by the terms of this license.  If you do not agree to the terms of this license, do not use this software.</p>";
papaya.Container.KEYBOARD_REF_TEXT =
  "<span style='color:#B5CBD3'>[Spacebar]</span> Cycle the main slice view in a clockwise rotation.<br /><br /><span style='color:#B5CBD3'>[Page Up]</span> or <span style='color:#B5CBD3'>[']</span> Increment the axial slice.<br /><br /><span style='color:#B5CBD3'>[Page Down]</span> or <span style='color:#B5CBD3'>[/]</span> Decrement the axial slice.<br /><br /><span style='color:#B5CBD3'>[Arrow Up]</span> and <span style='color:#B5CBD3'>[Arrow Down]</span> Increment/decrement the coronal slice.<br /><br /><span style='color:#B5CBD3'>[Arrow Right]</span> and <span style='color:#B5CBD3'>[Arrow Left]</span> Increment/decrement the sagittal slice.<br /><br /><span style='color:#B5CBD3'>[g]</span> and <span style='color:#B5CBD3'>[v]</span> Increment/decrement main slice.<br /><br /><span style='color:#B5CBD3'>[<]</span> or <span style='color:#B5CBD3'>[,]</span> Decrement the series point.<br /><br /><span style='color:#B5CBD3'>[>]</span> or <span style='color:#B5CBD3'>[.]</span> Increment the series point.<br /><br /><span style='color:#B5CBD3'>[o]</span> Navigate viewer to the image origin.<br /><br /><span style='color:#B5CBD3'>[c]</span> Navigate viewer to the center of the image.<br /><br /><span style='color:#B5CBD3'>[a]</span> Toggle main crosshairs on/off.";
papaya.Container.MOUSE_REF_TEXT =
  "<span style='color:#B5CBD3'>(Left-click and drag)</span> Change current coordinate.<br /><br /><span style='color:#B5CBD3'>[Alt](Left-click and drag)</span> Zoom in and out.<br /><br /><span style='color:#B5CBD3'>[Alt](Double left-click)</span> Reset zoom.<br /><br /><span style='color:#B5CBD3'>[Alt][Shift](Left-click and drag)</span> Pan zoomed image.<br /><br /><span style='color:#B5CBD3'>(Right-click and drag)</span> Window level controls.<br /><br /><span style='color:#B5CBD3'>(Scroll wheel)</span> See Preferences.<br /><br />";
papaya.Container.DICOM_SUPPORT = !0;
papaya.Container.syncViewers = !1;
papaya.Container.syncViewersWorld = !1;
papaya.Container.allowPropagation = !1;
papaya.Container.papayaLastHoveredViewer = null;
papaya.Container.ignorePatterns = [/^[.]/];
papaya.Container.atlas = null;
papaya.Container.atlasWorldSpace = !0;
papaya.Container.restartViewer = function (a, b, c, e, d) {
  papayaContainers[a].viewer.restart(b, c, e, d);
};
papaya.Container.resetViewer = function (a, b) {
  b ||
    ((b = papayaContainers[a].params),
    b.loadedImages && (b.images = b.loadedImages),
    b.loadedEncodedImages && (b.encodedImages = b.loadedEncodedImages),
    b.loadedBinaryImages && (b.binaryImages = b.loadedBinaryImages),
    b.loadedSurfaces && (b.surfaces = b.loadedSurfaces),
    b.loadedEncodedSurfaces && (b.encodedSurfaces = b.loadedEncodedSurfaces),
    b.loadedFiles && (b.files = b.loadedFiles));
  papayaContainers[a].viewer.resetViewer();
  papayaContainers[a].toolbar.updateImageButtons();
  papayaContainers[a].reset();
  papayaContainers[a].params = b;
  papayaContainers[a].readGlobalParams();
  papayaContainers[a].rebuildContainer(b, a);
  papayaContainers[a].viewer.processParams(b);
};
papaya.Container.removeImage = function (a, b) {
  1 > b &&
    console.log(
      "Cannot remove the base image.  Try papaya.Container.resetViewer() instead."
    );
  papayaContainers[a].viewer.removeOverlay(b);
};
papaya.Container.hideImage = function (a, b) {
  papayaContainers[a].viewer.screenVolumes[b].hidden = !0;
  papayaContainers[a].viewer.drawViewer(!0, !1);
};
papaya.Container.showImage = function (a, b) {
  papayaContainers[a].viewer.screenVolumes[b].hidden = !1;
  papayaContainers[a].viewer.drawViewer(!0, !1);
};
papaya.Container.addImage = function (a, b, c) {
  c &&
    (papayaContainers[a].params = $.extend({}, papayaContainers[a].params, c));
  b instanceof Array ? (c = b) : ((c = []), (c[0] = b));
  papayaContainers[a].params.images
    ? papayaContainers[a].viewer.loadImage(c, !0, !1, !1)
    : papayaContainers[a].params.binaryImages
    ? papayaContainers[a].viewer.loadImage(c, !1, !1, !0)
    : papayaContainers[a].params.encodedImages &&
      papayaContainers[a].viewer.loadImage(c, !1, !0, !1);
};
papaya.Container.findParameters = function (a) {
  var b = null;
  var c = a.data("params");
  c || ((a = a.find("." + PAPAYA_VIEWER_CSS)) && (c = a.data("params")));
  c && ("object" === typeof c ? (b = c) : window[c] && (b = window[c]));
  b && papaya.utilities.UrlUtils.getQueryParams(b);
  return b;
};
papaya.Container.fillContainerHTML = function (a, b, c, e) {
  if (b) {
    c = a.find("#" + PAPAYA_DEFAULT_TOOLBAR_ID);
    var d = a.find("#" + PAPAYA_DEFAULT_VIEWER_ID);
    b = a.find("#" + PAPAYA_DEFAULT_DISPLAY_ID);
    c
      ? c.addClass(PAPAYA_TOOLBAR_CSS)
      : a.prepend(
          "<div class='" +
            PAPAYA_TOOLBAR_CSS +
            "' id='" +
            PAPAYA_DEFAULT_TOOLBAR_ID +
            "'></div>"
        );
    d
      ? d.addClass(PAPAYA_VIEWER_CSS)
      : $(
          "<div class='" +
            PAPAYA_VIEWER_CSS +
            "' id='" +
            PAPAYA_DEFAULT_VIEWER_ID +
            "'></div>"
        ).insertAfter($("#" + PAPAYA_DEFAULT_TOOLBAR_ID));
    b
      ? b.addClass(PAPAYA_DISPLAY_CSS)
      : $(
          "<div class='" +
            PAPAYA_DISPLAY_CSS +
            "' id='" +
            PAPAYA_DEFAULT_DISPLAY_ID +
            "'></div>"
        ).insertAfter($("#" + PAPAYA_DEFAULT_VIEWER_ID));
    console.log(
      "This method of adding a Papaya container is deprecated.  Try simply <div class='papaya' data-params='params'></div> instead..."
    );
  } else
    (b = void 0 !== e ? e : papayaContainers.length),
      a.attr("id", PAPAYA_DEFAULT_CONTAINER_ID + b),
      (c && void 0 !== c.kioskMode && c.kioskMode) ||
        a.append(
          "<div id='" +
            (PAPAYA_DEFAULT_TOOLBAR_ID + b) +
            "' class='" +
            PAPAYA_TOOLBAR_CSS +
            "'></div>"
        ),
      a.append(
        "<div id='" +
          (PAPAYA_DEFAULT_VIEWER_ID + b) +
          "' class='" +
          PAPAYA_VIEWER_CSS +
          "'></div>"
      ),
      a.append(
        "<div id='" +
          (PAPAYA_DEFAULT_DISPLAY_ID + b) +
          "' class='" +
          PAPAYA_DISPLAY_CSS +
          "'></div>"
      ),
      c && c.showControlBar && (void 0 === c.showControls || c.showControls)
        ? (a.append(
            "<div id='" +
              PAPAYA_KIOSK_CONTROLS_CSS +
              b +
              "' class='" +
              PAPAYA_KIOSK_CONTROLS_CSS +
              "'><div id='" +
              (PAPAYA_DEFAULT_SLIDER_ID + b) +
              "main' class='" +
              PAPAYA_SLIDER_CSS +
              " " +
              PAPAYA_CONTROL_MAIN_SLIDER +
              "'><span class='" +
              PAPAYA_CONTROL_BAR_LABELS_CSS +
              "'>Slice: </span> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>+</button> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>-</button> </div><div id='" +
              (PAPAYA_DEFAULT_SLIDER_ID + b) +
              "axial' class='" +
              PAPAYA_SLIDER_CSS +
              " " +
              PAPAYA_CONTROL_DIRECTION_SLIDER +
              "'><span class='" +
              PAPAYA_CONTROL_BAR_LABELS_CSS +
              "'>Axial: </span> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>+</button> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>-</button> </div><div id='" +
              (PAPAYA_DEFAULT_SLIDER_ID + b) +
              "coronal' class='" +
              PAPAYA_SLIDER_CSS +
              " " +
              PAPAYA_CONTROL_DIRECTION_SLIDER +
              "'><span class='" +
              PAPAYA_CONTROL_BAR_LABELS_CSS +
              "'>Coronal: </span> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>+</button> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>-</button> </div><div id='" +
              (PAPAYA_DEFAULT_SLIDER_ID + b) +
              "sagittal' class='" +
              PAPAYA_SLIDER_CSS +
              " " +
              PAPAYA_CONTROL_DIRECTION_SLIDER +
              "'><span class='" +
              PAPAYA_CONTROL_BAR_LABELS_CSS +
              "'>Sagittal: </span> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>+</button> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>-</button> </div><div id='" +
              (PAPAYA_DEFAULT_SLIDER_ID + b) +
              "series' class='" +
              PAPAYA_SLIDER_CSS +
              " " +
              PAPAYA_CONTROL_DIRECTION_SLIDER +
              "'><span class='" +
              PAPAYA_CONTROL_BAR_LABELS_CSS +
              "'>Series: </span> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>&lt;</button> <button type='button' class='" +
              PAPAYA_CONTROL_INCREMENT_BUTTON_CSS +
              "'>&gt;</button> </div>&nbsp;&nbsp;&nbsp;<button type='button' " +
              (c.kioskMode &&
              (void 0 === c.showImageButtons || c.showImageButtons)
                ? ""
                : "style='float:right;margin-left:5px;' ") +
              "class='" +
              PAPAYA_CONTROL_SWAP_BUTTON_CSS +
              "'>Swap View</button> <button type='button' " +
              (c.kioskMode &&
              (void 0 === c.showImageButtons || c.showImageButtons)
                ? ""
                : "style='float:right;margin-left:5px;' ") +
              "class='" +
              PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS +
              "'>Go To Center</button> <button type='button' " +
              (c.kioskMode &&
              (void 0 === c.showImageButtons || c.showImageButtons)
                ? ""
                : "style='float:right;margin-left:5px;' ") +
              "class='" +
              PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS +
              "'>Go To Origin</button> </div>"
          ),
          $("." + PAPAYA_CONTROL_INCREMENT_BUTTON_CSS).prop("disabled", !0),
          $("." + PAPAYA_CONTROL_SWAP_BUTTON_CSS).prop("disabled", !0),
          $("." + PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).prop("disabled", !0),
          $("." + PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).prop("disabled", !0))
        : c &&
          (void 0 === c.showControls || c.showControls) &&
          (a.append(
            "<button type='button' id='" +
              (PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS + b) +
              "' class='" +
              PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS +
              "'>+</button> "
          ),
          a.append(
            "<button type='button' id='" +
              (PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS + b) +
              "' class='" +
              PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS +
              "'>-</button> "
          ),
          a.append(
            "<button type='button' id='" +
              (PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS + b) +
              "' class='" +
              PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS +
              "'>Swap View</button> "
          ),
          a.append(
            "<button type='button' id='" +
              (PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS + b) +
              "' class='" +
              PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
              "'>Go To Center</button> "
          ),
          a.append(
            "<button type='button' id='" +
              (PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS + b) +
              "' class='" +
              PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
              "'>Go To Origin</button> "
          ),
          $("#" + PAPAYA_CONTROL_MAIN_INCREMENT_BUTTON_CSS + b).css({
            display: "none",
          }),
          $("#" + PAPAYA_CONTROL_MAIN_DECREMENT_BUTTON_CSS + b).css({
            display: "none",
          }),
          $("#" + PAPAYA_CONTROL_MAIN_SWAP_BUTTON_CSS + b).css({
            display: "none",
          }),
          $("#" + PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS + b).css({
            display: "none",
          }),
          $("#" + PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS + b).css({
            display: "none",
          }));
  return d;
};
papaya.Container.buildContainer = function (a, b, c) {
  var e = papaya.utilities.PlatformUtils.checkForBrowserCompatibility();
  var d = a.find("." + PAPAYA_VIEWER_CSS);
  if (null !== e)
    papaya.Container.removeCheckForJSClasses(a, d),
      a.addClass(PAPAYA_UTILS_UNSUPPORTED_CSS),
      d.addClass(PAPAYA_UTILS_UNSUPPORTED_MESSAGE_CSS),
      d.html(e);
  else {
    e = void 0 !== c ? c : papayaContainers.length;
    c = new papaya.Container(a);
    c.containerIndex = e;
    c.preferences = new papaya.viewer.Preferences();
    papaya.Container.removeCheckForJSClasses(a, d);
    b && (c.params = $.extend(c.params, b));
    c.nestedViewer = "BODY" !== a.parent()[0].tagName.toUpperCase();
    c.readGlobalParams();
    c.isDesktopMode() && c.preferences.readPreferences();
    c.buildViewer(c.params);
    c.buildDisplay();
    c.showControlBar && c.buildSliderControl();
    c.buildToolbar();
    c.setUpDnD();
    if ((d = d.data("load-url"))) {
      var g = d;
      g instanceof Array || ((g = []), (g[0] = d));
      c.viewer.loadImage(g, !0, !1, !1);
    } else
      c.params.images
        ? ((g = c.params.images[0]),
          g instanceof Array || ((g = []), (g[0] = c.params.images[0])),
          c.viewer.loadImage(g, !0, !1, !1))
        : c.params.encodedImages
        ? ((g = c.params.encodedImages[0]),
          g instanceof Array || ((g = []), (g[0] = c.params.encodedImages[0])),
          c.viewer.loadImage(g, !1, !0, !1))
        : c.params.binaryImages
        ? ((g = c.params.binaryImages[0]), c.viewer.loadImage(g, !1, !1, !0))
        : c.params.files
        ? ((g = c.params.files[0]),
          g instanceof Array || ((g = []), (g[0] = c.params.files[0])),
          c.viewer.loadImage(g, !1, !1, !1))
        : c.viewer.finishedLoading();
    c.resizeViewerComponents(!1);
    c.nestedViewer || (a.parent().height("100%"), a.parent().width("100%"));
    papayaContainers[e] = c;
    papaya.Container.showLicense(c, b);
  }
};
papaya.Container.prototype.rebuildContainer = function (a, b) {
  this.containerHtml.empty();
  papaya.Container.fillContainerHTML(this.containerHtml, !1, a, b);
  papaya.Container.buildContainer(this.containerHtml, a, b);
  1 !== papayaContainers.length ||
    papayaContainers[0].nestedViewer ||
    ($("html").addClass(PAPAYA_CONTAINER_FULLSCREEN),
    $("body").addClass(PAPAYA_CONTAINER_FULLSCREEN),
    papaya.Container.setToFullPage());
};
papaya.Container.buildAllContainers = function () {
  var a = $("#" + PAPAYA_DEFAULT_CONTAINER_ID);
  if (0 < a.length) {
    papaya.Container.fillContainerHTML(a, !0);
    var b = papaya.Container.findParameters(a);
    papaya.Container.buildContainer(a, b);
  } else
    $("." + PAPAYA_CONTAINER_CLASS_NAME).each(function () {
      b = papaya.Container.findParameters($(this));
      null === b && (b = []);
      !0 === b.fullScreen &&
        ((b.fullScreenPadding = !1),
        (b.kioskMode = !0),
        (b.showControlBar = !1),
        $("body").css({ "background-color": "black" }));
      papaya.Container.fillContainerHTML($(this), !1, b);
      papaya.Container.buildContainer($(this), b);
    });
  1 !== papayaContainers.length ||
    papayaContainers[0].nestedViewer ||
    ($("html").addClass(PAPAYA_CONTAINER_FULLSCREEN),
    $("body").addClass(PAPAYA_CONTAINER_FULLSCREEN),
    papaya.Container.setToFullPage(),
    papayaContainers[0].resizeViewerComponents(!0));
};
papaya.Container.startPapaya = function () {
  setTimeout(function () {
    window.scrollTo(0, 0);
  }, 0);
  papaya.Container.DICOM_SUPPORT = "undefined" !== typeof daikon;
  papaya.Container.buildAllContainers();
};
papaya.Container.resizePapaya = function (a, b) {
  papaya.Container.updateOrthogonalState();
  if (1 !== papayaContainers.length || papayaContainers[0].nestedViewer)
    for (a = 0; a < papayaContainers.length; a += 1)
      papayaContainers[a].resizeViewerComponents(!0);
  else
    (papaya.utilities.PlatformUtils.smallScreen && !b) ||
      papayaContainers[0].resizeViewerComponents(!0);
  setTimeout(function () {
    window.scrollTo(0, 0);
  }, 0);
};
papaya.Container.addViewer = function (a, b, c) {
  var e = $("#" + a);
  a = $('<div class="papaya"></div>');
  e.html(a);
  e[0].onclick = "";
  e.off("click");
  papaya.Container.fillContainerHTML(a, !1, b);
  papaya.Container.buildContainer(a, b);
  c && c();
};
papaya.Container.removeCheckForJSClasses = function (a, b) {
  b.removeClass(PAPAYA_CONTAINER_CLASS_NAME);
  b.removeClass(PAPAYA_UTILS_CHECKFORJS_CSS);
  a.removeClass(PAPAYA_CONTAINER_CLASS_NAME);
  a.removeClass(PAPAYA_UTILS_CHECKFORJS_CSS);
};
papaya.Container.setToFullPage = function () {
  document.body.style.marginTop = 0;
  document.body.style.marginBottom = 0;
  document.body.style.marginLeft = "auto";
  document.body.style.marginRight = "auto";
  document.body.style.padding = 0;
  document.body.style.overflow = "hidden";
  document.body.style.width = "100%";
  document.body.style.height = "100%";
};
papaya.Container.getLicense = function () {
  return papaya.Container.LICENSE_TEXT;
};
papaya.Container.getKeyboardReference = function () {
  return papaya.Container.KEYBOARD_REF_TEXT;
};
papaya.Container.getMouseReference = function () {
  return papaya.Container.MOUSE_REF_TEXT;
};
papaya.Container.setLicenseRead = function () {
  papaya.utilities.UrlUtils.createCookie(
    papaya.viewer.Preferences.COOKIE_PREFIX + "eula",
    "Yes",
    papaya.viewer.Preferences.COOKIE_EXPIRY_DAYS
  );
};
papaya.Container.isLicenseRead = function () {
  var a = papaya.utilities.UrlUtils.readCookie(
    papaya.viewer.Preferences.COOKIE_PREFIX + "eula"
  );
  return a && "Yes" === a;
};
papaya.Container.showLicense = function (a, b) {
  b &&
    void 0 !== b.showEULA &&
    b.showEULA &&
    !papaya.Container.isLicenseRead() &&
    new papaya.ui.Dialog(
      a,
      "License",
      papaya.ui.Toolbar.LICENSE_DATA,
      papaya.Container,
      null,
      papaya.Container.setLicenseRead,
      null,
      !0
    ).showDialog();
};
papaya.Container.updateOrthogonalState = function () {
  var a;
  for (a = 0; a < papayaContainers.length; a += 1)
    papayaContainers[a].orthogonal &&
      (papaya.utilities.PlatformUtils.mobile ||
        papayaContainers[a].orthogonalDynamic) &&
      ($(window).height() > $(window).width()
        ? (papayaContainers[a].orthogonalTall = !0)
        : (papayaContainers[a].orthogonalTall = !1));
};
papaya.Container.reorientPapaya = function () {
  var a;
  for (a = 0; a < papayaContainers.length; a += 1)
    papayaContainers[a].toolbar.closeAllMenus();
  papaya.Container.updateOrthogonalState();
  papaya.Container.resizePapaya(null, !0);
};
papaya.Container.prototype.resetComponents = function () {
  this.containerHtml.css({ height: "auto" });
  this.containerHtml.css({ width: "auto" });
  this.containerHtml.css({ margin: "auto" });
  $("head").append("<style>div#papayaViewer:before{ content:'' }</style>");
};
papaya.Container.prototype.hasSurface = function () {
  return this.viewer && 0 < this.viewer.surfaces.length;
};
papaya.Container.prototype.hasBoundaries = function () {
  return this.hasVolumeBoundaries() || this.hasSurfaceBoundaries();
};
papaya.Container.prototype.hasVolumeBoundaries = function () {
  return (
    this.viewer &&
    this.viewer.atlas &&
    this.viewer.atlas.boundaryData &&
    this.viewer.atlas.boundaryData.boundaryimagefile &&
    null !==
      this.findLoadableImage(this.viewer.atlas.boundaryData.boundaryimagefile)
  );
};
papaya.Container.prototype.hasSurfaceBoundaries = function () {
  return (
    this.viewer &&
    this.viewer.atlas &&
    this.viewer.atlas.boundaryData &&
    this.viewer.atlas.boundaryData.boundarysurfacefile &&
    null !==
      this.findLoadableImage(
        this.viewer.atlas.boundaryData.boundarysurfacefile,
        !0
      )
  );
};
papaya.Container.prototype.getViewerDimensions = function () {
  var a =
    this.containerHtml.parent().width() -
    (this.fullScreenPadding ? 2 * PAPAYA_PADDING : 0);
  var b = this.orthogonal ? (this.hasSurface() ? 1.333 : 1.5) : 1;
  if (this.orthogonalTall || !this.orthogonal) {
    a =
      (this.collapsable
        ? window.innerHeight
        : this.containerHtml.parent().height()) -
      (papaya.viewer.Display.SIZE +
        (this.kioskMode ? 0 : papaya.ui.Toolbar.SIZE + PAPAYA_SPACING) +
        PAPAYA_SPACING +
        (this.fullScreenPadding && !this.nestedViewer
          ? 2 * PAPAYA_CONTAINER_PADDING_TOP
          : 0)) -
      (this.showControlBar ? 2 * papaya.ui.Toolbar.SIZE : 0);
    var c = papayaRoundFast(a / b);
  } else (c = a), (a = papayaRoundFast(c / b));
  if (!this.nestedViewer || this.collapsable)
    if (this.orthogonalTall) {
      var e =
        window.innerWidth - (this.fullScreenPadding ? 2 * PAPAYA_PADDING : 0);
      c > e && ((c = e), (a = papayaRoundFast(c * b)));
    } else
      (e =
        window.innerHeight -
        (papaya.viewer.Display.SIZE +
          (this.kioskMode ? 0 : papaya.ui.Toolbar.SIZE + PAPAYA_SPACING) +
          PAPAYA_SPACING +
          (this.fullScreenPadding ? 2 * PAPAYA_CONTAINER_PADDING_TOP : 0)) -
        (this.showControlBar ? 2 * papaya.ui.Toolbar.SIZE : 0)),
        a > e && ((a = e), (c = papayaRoundFast(a * b)));
  return [c, a];
};
papaya.Container.prototype.getViewerPadding = function () {
  var a =
    this.containerHtml.parent().width() -
    (this.fullScreenPadding ? 2 * PAPAYA_PADDING : 0);
  var b = this.getViewerDimensions();
  return (a - b[0]) / 2;
};
papaya.Container.prototype.readGlobalParams = function () {
  this.kioskMode =
    !0 === this.params.kioskMode || papaya.utilities.PlatformUtils.smallScreen;
  this.combineParametric = !0 === this.params.combineParametric;
  this.params.loadingComplete &&
    (this.loadingComplete = this.params.loadingComplete);
  void 0 !== this.params.showControls &&
    (this.showControls = this.params.showControls);
  void 0 !== this.params.noNewFiles &&
    (this.noNewFiles = this.params.noNewFiles);
  void 0 !== this.params.showImageButtons &&
    (this.showImageButtons = this.params.showImageButtons);
  papaya.utilities.PlatformUtils.smallScreen && (this.showImageButtons = !1);
  void 0 !== this.params.fullScreenPadding &&
    (this.fullScreenPadding = this.params.fullScreenPadding);
  void 0 !== this.params.orthogonal &&
    (this.orthogonal = this.params.orthogonal);
  this.surfaceParams.showSurfacePlanes = !0 === this.params.showSurfacePlanes;
  this.surfaceParams.showSurfaceCrosshairs =
    !0 === this.params.showSurfaceCrosshairs;
  this.surfaceParams.surfaceBackground = this.params.surfaceBackground;
  this.orthogonalTall = this.orthogonal && !0 === this.params.orthogonalTall;
  this.orthogonalDynamic =
    this.orthogonal && !0 === this.params.orthogonalDynamic;
  void 0 !== this.params.allowScroll &&
    (this.allowScroll = this.params.allowScroll);
  (papaya.utilities.PlatformUtils.mobile || this.orthogonalDynamic) &&
    this.orthogonal &&
    ($(window).height() > $(window).width()
      ? (this.orthogonalTall = !0)
      : (this.orthogonalTall = !1));
  void 0 !== this.params.syncOverlaySeries &&
    (this.syncOverlaySeries = this.params.syncOverlaySeries);
  void 0 !== this.params.showControlBar &&
    (this.showControlBar = this.showControls && this.params.showControlBar);
  void 0 !== this.params.contextManager &&
    (this.contextManager = this.params.contextManager);
  !0 === this.params.fullScreen &&
    ((this.fullScreenPadding = this.params.fullScreenPadding = !1),
    (this.kioskMode = this.params.kioskMode = !0),
    (this.showControlBar = this.params.showControlBar = !1),
    $("body").css("background-color:'black'"));
};
papaya.Container.prototype.reset = function () {
  this.loadingSurfaceIndex = this.loadingImageIndex = 0;
  this.collapsable = this.nestedViewer = !1;
  this.orthogonal = !0;
  this.noNewFiles =
    this.kioskMode =
    this.orthogonalDynamic =
    this.orthogonalTall =
      !1;
  this.showControls = !0;
  this.showControlBar = !1;
  this.fullScreenPadding = !0;
  this.showRuler = this.combineParametric = !1;
};
papaya.Container.prototype.resizeViewerComponents = function (a) {
  var b = 0;
  this.toolbar.closeAllMenus();
  var c = this.getViewerDimensions();
  var e = this.getViewerPadding();
  this.toolbarHtml.css({ width: c[0] + "px" });
  this.toolbarHtml.css({ height: papaya.ui.Toolbar.SIZE + "px" });
  this.toolbarHtml.css({ paddingLeft: e + "px" });
  this.toolbarHtml.css({ paddingBottom: PAPAYA_SPACING + "px" });
  this.viewerHtml.css({ width: c[0] + "px" });
  this.viewerHtml.css({ height: c[1] + "px" });
  this.viewerHtml.css({ paddingLeft: e + "px" });
  a && this.viewer.resizeViewer(c);
  this.displayHtml.css({ height: papaya.viewer.Display.SIZE + "px" });
  this.displayHtml.css({ paddingLeft: e + "px" });
  this.displayHtml.css({ paddingTop: PAPAYA_SPACING + "px" });
  this.display.canvas.width = c[0];
  this.showControls && this.showControlBar
    ? (this.sliderControlHtml.css({ width: c[0] + "px" }),
      this.sliderControlHtml.css({ height: papaya.viewer.Display.SIZE + "px" }),
      (b = this.kioskMode ? b + 0 : b + -50),
      (b = this.viewer.hasSeries ? b + 200 : b + 0),
      c[0] < 775 + b
        ? ($("." + PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).css({
            display: "none",
          }),
          $("." + PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).css({
            display: "none",
          }))
        : ($("." + PAPAYA_CONTROL_GOTO_CENTER_BUTTON_CSS).css({
            display: "inline",
          }),
          $("." + PAPAYA_CONTROL_GOTO_ORIGIN_BUTTON_CSS).css({
            display: "inline",
          })),
      c[0] < 600 + b
        ? ($("." + PAPAYA_CONTROL_DIRECTION_SLIDER).css({ display: "none" }),
          $("." + PAPAYA_CONTROL_MAIN_SLIDER).css({ display: "inline" }))
        : ($("." + PAPAYA_CONTROL_DIRECTION_SLIDER).css({ display: "inline" }),
          $("." + PAPAYA_CONTROL_MAIN_SLIDER).css({ display: "none" })),
      this.viewer.hasSeries &&
        c[0] < 450 + b &&
        $("." + PAPAYA_CONTROL_MAIN_SLIDER).css({ display: "none" }),
      200 > c[0]
        ? $("." + PAPAYA_CONTROL_SWAP_BUTTON_CSS).css({ display: "none" })
        : $("." + PAPAYA_CONTROL_SWAP_BUTTON_CSS).css({ display: "inline" }),
      this.viewer.hasSeries
        ? $("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(3)
            .css({ display: "inline" })
        : $("." + PAPAYA_CONTROL_DIRECTION_SLIDER)
            .eq(3)
            .css({ display: "none" }))
    : this.showControls &&
      this.viewer.initialized &&
      (600 > c[0]
        ? ($(
            "#" +
              PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
              this.containerIndex
          ).css({ display: "none" }),
          $(
            "#" +
              PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
              this.containerIndex
          ).css({ display: "none" }))
        : this.viewer.controlsHidden ||
          ($(
            "#" +
              PAPAYA_CONTROL_MAIN_GOTO_CENTER_BUTTON_CSS +
              this.containerIndex
          ).css({ display: "inline" }),
          $(
            "#" +
              PAPAYA_CONTROL_MAIN_GOTO_ORIGIN_BUTTON_CSS +
              this.containerIndex
          ).css({ display: "inline" })));
  this.isDesktopMode() &&
    (600 > c[0]
      ? this.titlebarHtml.css({ visibility: "hidden" })
      : this.titlebarHtml.css({ visibility: "visible" }));
  (this.nestedViewer && !this.collapsable) || !this.fullScreenPadding
    ? this.containerHtml.css({ paddingTop: "0" })
    : this.containerHtml.css({
        paddingTop: PAPAYA_CONTAINER_PADDING_TOP + "px",
      });
  this.fullScreenPadding &&
    (this.containerHtml.css({
      paddingLeft: PAPAYA_PADDING + "px",
    }),
    this.containerHtml.css({ paddingRight: PAPAYA_PADDING + "px" }));
  this.viewer.initialized
    ? this.viewer.drawViewer(!1, !0)
    : (this.viewer.drawEmptyViewer(), this.display.drawEmptyDisplay());
  this.titlebarHtml.css({ width: c[0] + "px", top: 0 });
};
papaya.Container.prototype.updateViewerSize = function () {
  this.toolbar.closeAllMenus();
  this.viewer.resizeViewer(this.getViewerDimensions());
  this.viewer.updateOffsetRect();
};
papaya.Container.prototype.buildViewer = function (a) {
  this.viewerHtml = this.containerHtml.find("." + PAPAYA_VIEWER_CSS);
  papaya.Container.removeCheckForJSClasses(this.containerHtml, this.viewerHtml);
  this.viewerHtml.html("");
  var b = this.getViewerDimensions();
  this.viewer = new papaya.viewer.Viewer(this, b[0], b[1], a);
  this.viewerHtml.append($(this.viewer.canvas));
  this.preferences.viewer = this.viewer;
};
papaya.Container.prototype.buildDisplay = function () {
  this.displayHtml = this.containerHtml.find("." + PAPAYA_DISPLAY_CSS);
  var a = this.getViewerDimensions();
  this.display = new papaya.viewer.Display(this, a[0]);
  this.displayHtml.append($(this.display.canvas));
};
papaya.Container.prototype.buildSliderControl = function () {
  this.sliderControlHtml = this.containerHtml.find(
    "." + PAPAYA_KIOSK_CONTROLS_CSS
  );
};
papaya.Container.prototype.buildToolbar = function () {
  this.toolbarHtml = this.containerHtml.find("." + PAPAYA_TOOLBAR_CSS);
  this.toolbar = new papaya.ui.Toolbar(this);
  this.toolbar.buildToolbar();
  this.toolbar.updateImageButtons();
};
papaya.Container.prototype.readFile = function (a, b) {
  a.file(
    function (c, e) {
      c && "." !== e.name.charAt(0) && c(e);
    }.bind(this, b)
  );
};
papaya.Container.prototype.readDir = function (a) {
  this.readDirNextEntries(a.createReader());
};
papaya.Container.prototype.readDirNextEntries = function (a) {
  var b = this;
  a.readEntries(function (c) {
    var e = c.length,
      d;
    if (0 < e) {
      for (d = 0; d < e; d += 1) {
        var g = c[d];
        g.isFile &&
          b.readFile(g, papaya.utilities.ObjectUtils.bind(b, b.addDroppedFile));
      }
      b.readDirNextEntries(a);
    }
  });
};
papaya.Container.prototype.setUpDnD = function () {
  var a = this;
  this.containerHtml[0].ondragover = function () {
    a.viewer.draggingOver = !0;
    a.viewer.initialized || a.viewer.drawEmptyViewer();
    return !1;
  };
  this.containerHtml[0].ondragleave = function () {
    a.viewer.draggingOver = !1;
    a.viewer.initialized || a.viewer.drawEmptyViewer();
    return !1;
  };
  this.containerHtml[0].ondragend = function () {
    a.viewer.draggingOver = !1;
    a.viewer.initialized || a.viewer.drawEmptyViewer();
    return !1;
  };
  this.containerHtml[0].ondrop = function (b) {
    b.preventDefault();
    var c = b.dataTransfer;
    a.display.drawProgress(0.1, "Loading");
    if (c)
      if (c.items && 0 < c.items.length) {
        b = c.items;
        c = b.length;
        var e;
        for (e = 0; e < c; e += 1) {
          var d = b[e];
          d.getAsEntry
            ? (d = d.getAsEntry())
            : d.webkitGetAsEntry && (d = d.webkitGetAsEntry());
          d.isFile
            ? a.readFile(
                d,
                papaya.utilities.ObjectUtils.bind(a, a.addDroppedFile)
              )
            : d.isDirectory && a.readDir(d);
        }
      } else
        c.files &&
          0 < c.files.length &&
          a.viewer.loadImage(b.dataTransfer.files);
    return !1;
  };
};
papaya.Container.prototype.addDroppedFile = function (a) {
  clearTimeout(this.dropTimeout);
  papayaDroppedFiles.push(a);
  this.dropTimeout = setTimeout(
    papaya.utilities.ObjectUtils.bind(this, this.droppedFilesFinishedLoading),
    100
  );
};
papaya.Container.prototype.droppedFilesFinishedLoading = function () {
  papaya.surface.Surface.findSurfaceType(papayaDroppedFiles[0].name) !==
  papaya.surface.Surface.SURFACE_TYPE_UNKNOWN
    ? this.viewer.loadSurface(papayaDroppedFiles)
    : this.viewer.loadImage(papayaDroppedFiles);
  papayaDroppedFiles = [];
};
papaya.Container.prototype.clearParams = function () {
  this.params = [];
};
papaya.Container.prototype.loadNext = function () {
  this.hasImageToLoad()
    ? this.loadNextImage()
    : this.hasSurfaceToLoad()
    ? this.loadNextSurface()
    : this.hasAtlasToLoad() && this.viewer.loadAtlas();
};
papaya.Container.prototype.hasMoreToLoad = function () {
  return (
    this.hasImageToLoad() || this.hasSurfaceToLoad() || this.hasAtlasToLoad()
  );
};
papaya.Container.prototype.hasImageToLoad = function () {
  return this.params.images
    ? this.loadingImageIndex < this.params.images.length
    : this.params.binaryImages
    ? this.loadingImageIndex < this.params.binaryImages.length
    : this.params.encodedImages
    ? this.loadingImageIndex < this.params.encodedImages.length
    : this.params.files
    ? this.loadingImageIndex < this.params.files.length
    : !1;
};
papaya.Container.prototype.hasAtlasToLoad = function () {
  return null == papaya.Container.atlas && this.viewer.hasDefinedAtlas();
};
papaya.Container.prototype.hasSurfaceToLoad = function () {
  return papaya.utilities.PlatformUtils.isWebGLSupported()
    ? this.params.surfaces
      ? this.loadingSurfaceIndex < this.params.surfaces.length
      : this.params.encodedSurfaces
      ? this.loadingSurfaceIndex < this.params.encodedSurfaces.length
      : !1
    : (console.log(
        "Warning: This browser version is not able to load surfaces."
      ),
      !1);
};
papaya.Container.prototype.loadNextSurface = function () {
  var a = !1;
  if (this.params.surfaces)
    if (this.loadingSurfaceIndex < this.params.surfaces.length) {
      a = !0;
      var b = this.params.surfaces[this.loadingSurfaceIndex];
      this.loadingSurfaceIndex += 1;
      this.viewer.loadSurface(b, !0, !1);
    } else
      (this.params.loadedSurfaces = this.params.surfaces),
        (this.params.surfaces = []);
  else
    this.params.encodedSurfaces &&
      (this.loadingSurfaceIndex < this.params.encodedSurfaces.length
        ? ((a = !0),
          (b = this.params.encodedSurfaces[this.loadingSurfaceIndex]),
          b instanceof Array ||
            ((b = []),
            (b[0] = this.params.encodedSurfaces[this.loadingSurfaceIndex])),
          this.viewer.loadSurface(b, !1, !0),
          (this.loadingSurfaceIndex += 1))
        : ((this.params.loadedEncodedSurfaces = this.params.encodedSurfaces),
          (this.params.encodedSurfaces = [])));
  return a;
};
papaya.Container.prototype.loadNextImage = function () {
  var a = !1;
  if (this.params.images)
    if (this.loadingImageIndex < this.params.images.length) {
      a = !0;
      var b = this.params.images[this.loadingImageIndex];
      b instanceof Array ||
        ((b = []), (b[0] = this.params.images[this.loadingImageIndex]));
      this.viewer.loadImage(b, !0, !1, !1);
      this.loadingImageIndex += 1;
    } else
      (this.params.loadedImages = this.params.images),
        (this.params.images = []);
  else
    this.params.binaryImages
      ? this.loadingImageIndex < this.params.binaryImages.length
        ? ((a = !0),
          (b = this.params.binaryImages[this.loadingImageIndex]),
          b instanceof Array ||
            ((b = []),
            (b[0] = this.params.binaryImages[this.loadingImageIndex])),
          this.viewer.loadImage(b, !1, !1, !0),
          (this.loadingImageIndex += 1))
        : ((this.params.loadedEncodedImages = this.params.binaryImages),
          (this.params.binaryImages = []))
      : this.params.encodedImages
      ? this.loadingImageIndex < this.params.encodedImages.length
        ? ((a = !0),
          (b = this.params.encodedImages[this.loadingImageIndex]),
          b instanceof Array ||
            ((b = []),
            (b[0] = this.params.encodedImages[this.loadingImageIndex])),
          this.viewer.loadImage(b, !1, !0, !1),
          (this.loadingImageIndex += 1))
        : ((this.params.loadedEncodedImages = this.params.encodedImages),
          (this.params.encodedImages = []))
      : this.params.files &&
        (this.loadingImageIndex < this.params.files.length
          ? ((a = !0),
            (b = this.params.files[this.loadingImageIndex]),
            b instanceof Array ||
              ((b = []), (b[0] = this.params.files[this.loadingImageIndex])),
            this.viewer.loadImage(b, !1, !1, !1),
            (this.loadingImageIndex += 1))
          : ((this.params.loadedFiles = this.params.files),
            (this.params.files = [])));
  return a;
};
papaya.Container.prototype.readyForDnD = function () {
  return (
    !this.kioskMode &&
    (void 0 === this.params.images ||
      this.loadingImageIndex >= this.params.images.length) &&
    (void 0 === this.params.binaryImages ||
      this.loadingImageIndex >= this.params.binaryImages.length) &&
    (void 0 === this.params.encodedImages ||
      this.loadingImageIndex >= this.params.encodedImages.length) &&
    (void 0 === this.params.encodedSurfaces ||
      this.loadingSurfaceIndex >= this.params.encodedSurfaces.length)
  );
};
papaya.Container.prototype.findLoadableImage = function (a, b) {
  var c;
  for (c = 0; c < papayaLoadableImages.length; c += 1)
    if (b) {
      if (papayaLoadableImages[c].surface && papayaLoadableImages[c].name == a)
        return papayaLoadableImages[c];
    } else if (papayaLoadableImages[c].name == a)
      return papayaLoadableImages[c];
  return void 0 !== window[a] ? { encode: a } : null;
};
papaya.Container.prototype.findLoadableImages = function (a, b) {
  var c,
    e,
    d = [];
  Array.isArray(a) || (a = [a]);
  if (a)
    for (c = 0; c < a.length; c++)
      (e = this.findLoadableImage(a[c], b)) && d.push(e);
  return 0 < d.length ? d : null;
};
papaya.Container.prototype.expandViewer = function () {
  var a = this;
  this.nestedViewer &&
    ((this.nestedViewer = !1),
    (this.collapsable = !0),
    (this.tempScrollTop = $(window).scrollTop()),
    $(":hidden").addClass(PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT),
    $(document.body).children().hide(),
    this.containerHtml.show(),
    (this.originalStyle = {}),
    (this.originalStyle.width = document.body.style.width),
    (this.originalStyle.height = document.body.style.height),
    (this.originalStyle.marginTop = document.body.style.marginTop),
    (this.originalStyle.marginRight = document.body.style.marginRight),
    (this.originalStyle.marginBottom = document.body.style.marginBottom),
    (this.originalStyle.marginLeft = document.body.style.marginLeft),
    (this.originalStyle.paddingTop = document.body.style.paddingTop),
    (this.originalStyle.paddingRight = document.body.style.paddingRight),
    (this.originalStyle.paddingBottom = document.body.style.paddingBottom),
    (this.originalStyle.paddingLeft = document.body.style.paddingLeft),
    (this.originalStyle.overflow = document.body.style.overflow),
    papaya.Container.setToFullPage(),
    this.containerHtml.after(
      '<div style="display:none" class="' +
        PAPAYA_CONTAINER_COLLAPSABLE +
        '"></div>'
    ),
    $(document.body).prepend(this.containerHtml),
    this.resizeViewerComponents(!0),
    this.viewer.updateOffsetRect(),
    this.updateViewerSize(),
    setTimeout(function () {
      window.scrollTo(0, 0);
      a.viewer.addScroll();
    }, 0));
};
papaya.Container.prototype.collapseViewer = function () {
  var a;
  var b = this;
  if (this.collapsable) {
    this.nestedViewer = !0;
    this.collapsable = !1;
    document.body.style.width = this.originalStyle.width;
    document.body.style.height = this.originalStyle.height;
    document.body.style.marginTop = this.originalStyle.marginTop;
    document.body.style.marginRight = this.originalStyle.marginRight;
    document.body.style.marginBottom = this.originalStyle.marginBottom;
    document.body.style.marginLeft = this.originalStyle.marginLeft;
    document.body.style.paddingTop = this.originalStyle.paddingTop;
    document.body.style.paddingRight = this.originalStyle.paddingRight;
    document.body.style.paddingBottom = this.originalStyle.paddingBottom;
    document.body.style.paddingLeft = this.originalStyle.paddingLeft;
    document.body.style.overflow = this.originalStyle.overflow;
    $("." + PAPAYA_CONTAINER_COLLAPSABLE).replaceWith(this.containerHtml);
    $(document.body)
      .children(":not(." + PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT + ")")
      .show();
    $("." + PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT).removeClass(
      PAPAYA_CONTAINER_COLLAPSABLE_EXEMPT
    );
    this.resizeViewerComponents(!0);
    for (a = 0; a < papayaContainers.length; a += 1)
      papayaContainers[a].updateViewerSize(),
        papayaContainers[a].viewer.drawViewer(!0);
    setTimeout(function () {
      $(window).scrollTop(b.tempScrollTop);
      b.viewer.removeScroll();
    }, 0);
  }
};
papaya.Container.prototype.isNestedViewer = function () {
  return this.nestedViewer || this.collapsable;
};
papaya.Container.prototype.isDesktopMode = function () {
  return !this.kioskMode;
};
papaya.Container.prototype.hasLoadedDTI = function () {
  return this.viewer.hasLoadedDTI();
};
papaya.Container.prototype.disableScrollWheel = function () {
  return this.isNestedViewer() || papaya.utilities.PlatformUtils.ios;
};
papaya.Container.prototype.canOpenInMango = function () {
  return this.params.canOpenInMango;
};
papaya.Container.prototype.isExpandable = function () {
  return this.params.expandable && this.isNestedViewer();
};
papaya.Container.prototype.isParametricCombined = function (a) {
  return this.combineParametric && this.viewer.hasParametricPair(a);
};
papaya.Container.prototype.isNonParametricCombined = function (a) {
  return !this.isParametricCombined(a);
};
papaya.Container.prototype.coordinateChanged = function (a) {
  var b,
    c = a.currentCoord;
  if (!a.ignoreSync)
    if (papaya.Container.syncViewersWorld)
      for (b = 0; b < papayaContainers.length; b += 1) {
        if (
          papayaContainers[b].viewer !== a &&
          !papayaContainers[b].viewer.ignoreSync
        ) {
          var e = new papaya.core.Coordinate();
          papayaContainers[b].viewer.gotoWorldCoordinate(
            a.getWorldCoordinateAtIndex(c.x, c.y, c.z, e),
            !0
          );
        }
      }
    else if (papaya.Container.syncViewers)
      for (b = 0; b < papayaContainers.length; b += 1)
        papayaContainers[b].viewer === a ||
          papayaContainers[b].viewer.ignoreSync ||
          papayaContainers[b].viewer.gotoCoordinate(c, !0);
  a.surfaceView && a.surfaceView.updateActivePlanes();
  this.contextManager &&
    this.contextManager.clearContext &&
    this.contextManager.clearContext();
};
papaya.Container.prototype.canCurrentOverlayLoadNegatives = function () {
  var a = this.viewer.currentScreenVolume;
  return !a.negative && null === a.negativeScreenVol;
};
papaya.Container.prototype.canCurrentOverlayLoadMod = function () {
  var a = this.viewer.currentScreenVolume;
  return a.dti && null === a.dtiVolumeMod;
};
papaya.Container.prototype.canCurrentOverlayModulate = function () {
  var a = this.viewer.currentScreenVolume;
  return a.dti && null !== a.dtiVolumeMod;
};
window.addEventListener("resize", papaya.Container.resizePapaya, !1);
window.addEventListener(
  "orientationchange",
  papaya.Container.reorientPapaya,
  !1
);
window.addEventListener("load", papaya.Container.startPapaya, !1);
window.addEventListener(
  "message",
  function (a) {
    a.data === PAPAYA_MANGO_INSTALLED && (papaya.mangoinstalled = !0);
  },
  !1
);
